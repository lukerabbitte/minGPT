train_loss is: 5.614692313486039
action scaled by temperature: tensor([[82]], device='cuda:0')
action picked by argmax: tensor([24], device='cuda:0')
tensor([[ 24,  76,  75, 160, 237, 268,  54, 180,  37, 196]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
50          1       25       5        51
277         2       25       4         5
749         3       25       4       204
1042        4       25       5       224
1232        5       25       5       141
       user_id  item_id  rating  timestep
12295       46       25       5        11
12795       47       25       4       238
13004       48       25       5       174
13315       49       25       4       212
13403       50       25       4        27
average_rating for this rec across 50 users from same group (less noisy) was: 4.68
all_actions shape just before sample torch.Size([1, 1, 1])
action scaled by temperature: tensor([[251]], device='cuda:0')
action picked by argmax: tensor([24], device='cuda:0')
tensor([[ 24,  76,  75, 160, 237, 268,  54, 180,  37, 196]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
50          1       25       5        51
277         2       25       4         5
749         3       25       4       204
1042        4       25       5       224
1232        5       25       5       141
       user_id  item_id  rating  timestep
12295       46       25       5        11
12795       47       25       4       238
13004       48       25       5       174
13315       49       25       4       212
13403       50       25       4        27
average_rating for this rec across 50 users from same group (less noisy) was: 4.68
all_actions shape just before sample torch.Size([1, 2, 1])
action scaled by temperature: tensor([[57]], device='cuda:0')
action picked by argmax: tensor([76], device='cuda:0')
tensor([[ 76,  24,  75, 160, 237, 268,  37,  54, 180, 196]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
243         1       77       5       244
432         2       77       5       160
743         3       77       5       198
835         4       77       4        17
1233        5       77       4       142
       user_id  item_id  rating  timestep
12393       46       77       3       109
12719       47       77       4       162
13098       48       77       5       268
13143       49       77       4        40
13500       50       77       3       124
average_rating for this rec across 50 users from same group (less noisy) was: 3.96
all_actions shape just before sample torch.Size([1, 3, 1])
action scaled by temperature: tensor([[46]], device='cuda:0')
action picked by argmax: tensor([76], device='cuda:0')
tensor([[ 76,  24,  75, 160, 237, 268,  54,  37, 180, 196]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
243         1       77       5       244
432         2       77       5       160
743         3       77       5       198
835         4       77       4        17
1233        5       77       4       142
       user_id  item_id  rating  timestep
12393       46       77       3       109
12719       47       77       4       162
13098       48       77       5       268
13143       49       77       4        40
13500       50       77       3       124
average_rating for this rec across 50 users from same group (less noisy) was: 3.96
all_actions shape just before sample torch.Size([1, 4, 1])
action scaled by temperature: tensor([[195]], device='cuda:0')
action picked by argmax: tensor([24], device='cuda:0')
tensor([[ 24,  76,  75, 237, 160, 268, 180, 196,  54,  37]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
50          1       25       5        51
277         2       25       4         5
749         3       25       4       204
1042        4       25       5       224
1232        5       25       5       141
       user_id  item_id  rating  timestep
12295       46       25       5        11
12795       47       25       4       238
13004       48       25       5       174
13315       49       25       4       212
13403       50       25       4        27
average_rating for this rec across 50 users from same group (less noisy) was: 4.68
all_actions shape just before sample torch.Size([1, 5, 1])
action scaled by temperature: tensor([[29]], device='cuda:0')
action picked by argmax: tensor([76], device='cuda:0')
tensor([[ 76,  24,  75, 160, 237,  37, 268,  54, 180, 196]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
243         1       77       5       244
432         2       77       5       160
743         3       77       5       198
835         4       77       4        17
1233        5       77       4       142
       user_id  item_id  rating  timestep
12393       46       77       3       109
12719       47       77       4       162
13098       48       77       5       268
13143       49       77       4        40
13500       50       77       3       124
average_rating for this rec across 50 users from same group (less noisy) was: 3.96
all_actions shape just before sample torch.Size([1, 6, 1])
action scaled by temperature: tensor([[123]], device='cuda:0')
action picked by argmax: tensor([76], device='cuda:0')
tensor([[ 76,  24,  75, 160, 237, 268,  37, 180,  54, 196]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
243         1       77       5       244
432         2       77       5       160
743         3       77       5       198
835         4       77       4        17
1233        5       77       4       142
       user_id  item_id  rating  timestep
12393       46       77       3       109
12719       47       77       4       162
13098       48       77       5       268
13143       49       77       4        40
13500       50       77       3       124
average_rating for this rec across 50 users from same group (less noisy) was: 3.96
all_actions shape just before sample torch.Size([1, 7, 1])
action scaled by temperature: tensor([[168]], device='cuda:0')
action picked by argmax: tensor([76], device='cuda:0')
tensor([[ 76,  24,  75, 160, 237,  37, 268,  54, 180,  48]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
243         1       77       5       244
432         2       77       5       160
743         3       77       5       198
835         4       77       4        17
1233        5       77       4       142
       user_id  item_id  rating  timestep
12393       46       77       3       109
12719       47       77       4       162
13098       48       77       5       268
13143       49       77       4        40
13500       50       77       3       124
average_rating for this rec across 50 users from same group (less noisy) was: 3.96
all_actions shape just before sample torch.Size([1, 8, 1])
action scaled by temperature: tensor([[218]], device='cuda:0')
action picked by argmax: tensor([76], device='cuda:0')
tensor([[ 76,  24,  75, 160, 237, 268,  37,  54, 180, 196]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
243         1       77       5       244
432         2       77       5       160
743         3       77       5       198
835         4       77       4        17
1233        5       77       4       142
       user_id  item_id  rating  timestep
12393       46       77       3       109
12719       47       77       4       162
13098       48       77       5       268
13143       49       77       4        40
13500       50       77       3       124
average_rating for this rec across 50 users from same group (less noisy) was: 3.96
all_actions shape just before sample torch.Size([1, 9, 1])
action scaled by temperature: tensor([[109]], device='cuda:0')
action picked by argmax: tensor([76], device='cuda:0')
tensor([[ 76,  24,  75, 160, 237, 268,  37,  54, 180, 196]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
243         1       77       5       244
432         2       77       5       160
743         3       77       5       198
835         4       77       4        17
1233        5       77       4       142
       user_id  item_id  rating  timestep
12393       46       77       3       109
12719       47       77       4       162
13098       48       77       5       268
13143       49       77       4        40
13500       50       77       3       124
average_rating for this rec across 50 users from same group (less noisy) was: 3.96
all_actions shape just before sample torch.Size([1, 10, 1])
action scaled by temperature: tensor([[19]], device='cuda:0')
action picked by argmax: tensor([24], device='cuda:0')
tensor([[ 24,  76,  75, 160, 237, 268,  37, 180,  54, 196]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
50          1       25       5        51
277         2       25       4         5
749         3       25       4       204
1042        4       25       5       224
1232        5       25       5       141
       user_id  item_id  rating  timestep
12295       46       25       5        11
12795       47       25       4       238
13004       48       25       5       174
13315       49       25       4       212
13403       50       25       4        27
average_rating for this rec across 50 users from same group (less noisy) was: 4.68
all_actions shape just before sample torch.Size([1, 11, 1])
action scaled by temperature: tensor([[239]], device='cuda:0')
action picked by argmax: tensor([24], device='cuda:0')
tensor([[ 24,  76,  75, 160, 237, 268,  37, 180,  54, 196]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
50          1       25       5        51
277         2       25       4         5
749         3       25       4       204
1042        4       25       5       224
1232        5       25       5       141
       user_id  item_id  rating  timestep
12295       46       25       5        11
12795       47       25       4       238
13004       48       25       5       174
13315       49       25       4       212
13403       50       25       4        27
average_rating for this rec across 50 users from same group (less noisy) was: 4.68
all_actions shape just before sample torch.Size([1, 12, 1])
action scaled by temperature: tensor([[51]], device='cuda:0')
action picked by argmax: tensor([76], device='cuda:0')
tensor([[ 76,  24,  75, 160, 237, 268,  37,  54, 180, 196]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
243         1       77       5       244
432         2       77       5       160
743         3       77       5       198
835         4       77       4        17
1233        5       77       4       142
       user_id  item_id  rating  timestep
12393       46       77       3       109
12719       47       77       4       162
13098       48       77       5       268
13143       49       77       4        40
13500       50       77       3       124
average_rating for this rec across 50 users from same group (less noisy) was: 3.96
all_actions shape just before sample torch.Size([1, 13, 1])
action scaled by temperature: tensor([[185]], device='cuda:0')
action picked by argmax: tensor([76], device='cuda:0')
tensor([[ 76,  24,  75, 160, 237,  37, 268,  54, 180,  48]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
243         1       77       5       244
432         2       77       5       160
743         3       77       5       198
835         4       77       4        17
1233        5       77       4       142
       user_id  item_id  rating  timestep
12393       46       77       3       109
12719       47       77       4       162
13098       48       77       5       268
13143       49       77       4        40
13500       50       77       3       124
average_rating for this rec across 50 users from same group (less noisy) was: 3.96
all_actions shape just before sample torch.Size([1, 14, 1])
action scaled by temperature: tensor([[160]], device='cuda:0')
action picked by argmax: tensor([76], device='cuda:0')
tensor([[ 76,  24,  75, 160, 237, 268,  37, 180,  54, 196]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
243         1       77       5       244
432         2       77       5       160
743         3       77       5       198
835         4       77       4        17
1233        5       77       4       142
       user_id  item_id  rating  timestep
12393       46       77       3       109
12719       47       77       4       162
13098       48       77       5       268
13143       49       77       4        40
13500       50       77       3       124
average_rating for this rec across 50 users from same group (less noisy) was: 3.96
all_actions shape just before sample torch.Size([1, 15, 1])
action scaled by temperature: tensor([[122]], device='cuda:0')
action picked by argmax: tensor([76], device='cuda:0')
tensor([[ 76,  24,  75, 160, 237,  37, 268,  54, 180,  48]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
243         1       77       5       244
432         2       77       5       160
743         3       77       5       198
835         4       77       4        17
1233        5       77       4       142
       user_id  item_id  rating  timestep
12393       46       77       3       109
12719       47       77       4       162
13098       48       77       5       268
13143       49       77       4        40
13500       50       77       3       124
average_rating for this rec across 50 users from same group (less noisy) was: 3.96
all_actions shape just before sample torch.Size([1, 16, 1])
action scaled by temperature: tensor([[111]], device='cuda:0')
action picked by argmax: tensor([76], device='cuda:0')
tensor([[ 76,  24,  75, 160, 237, 268,  37, 180,  54, 196]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
243         1       77       5       244
432         2       77       5       160
743         3       77       5       198
835         4       77       4        17
1233        5       77       4       142
       user_id  item_id  rating  timestep
12393       46       77       3       109
12719       47       77       4       162
13098       48       77       5       268
13143       49       77       4        40
13500       50       77       3       124
average_rating for this rec across 50 users from same group (less noisy) was: 3.96
all_actions shape just before sample torch.Size([1, 17, 1])
action scaled by temperature: tensor([[74]], device='cuda:0')
action picked by argmax: tensor([24], device='cuda:0')
tensor([[ 24,  76,  75, 160, 237, 268,  37, 180,  54, 196]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
50          1       25       5        51
277         2       25       4         5
749         3       25       4       204
1042        4       25       5       224
1232        5       25       5       141
       user_id  item_id  rating  timestep
12295       46       25       5        11
12795       47       25       4       238
13004       48       25       5       174
13315       49       25       4       212
13403       50       25       4        27
average_rating for this rec across 50 users from same group (less noisy) was: 4.68
all_actions shape just before sample torch.Size([1, 18, 1])
action scaled by temperature: tensor([[260]], device='cuda:0')
action picked by argmax: tensor([76], device='cuda:0')
tensor([[ 76,  24,  75, 160, 237, 268,  37,  54, 180, 196]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
243         1       77       5       244
432         2       77       5       160
743         3       77       5       198
835         4       77       4        17
1233        5       77       4       142
       user_id  item_id  rating  timestep
12393       46       77       3       109
12719       47       77       4       162
13098       48       77       5       268
13143       49       77       4        40
13500       50       77       3       124
average_rating for this rec across 50 users from same group (less noisy) was: 3.96
all_actions shape just before sample torch.Size([1, 19, 1])
action scaled by temperature: tensor([[68]], device='cuda:0')
action picked by argmax: tensor([76], device='cuda:0')
tensor([[ 76,  24,  75, 160, 237, 268,  37, 180,  54, 196]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
243         1       77       5       244
432         2       77       5       160
743         3       77       5       198
835         4       77       4        17
1233        5       77       4       142
       user_id  item_id  rating  timestep
12393       46       77       3       109
12719       47       77       4       162
13098       48       77       5       268
13143       49       77       4        40
13500       50       77       3       124
average_rating for this rec across 50 users from same group (less noisy) was: 3.96
all_actions shape just before sample torch.Size([1, 20, 1])
action scaled by temperature: tensor([[157]], device='cuda:0')
action picked by argmax: tensor([76], device='cuda:0')
tensor([[ 76,  24,  75, 160, 237, 268,  37, 180,  54, 196]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
243         1       77       5       244
432         2       77       5       160
743         3       77       5       198
835         4       77       4        17
1233        5       77       4       142
       user_id  item_id  rating  timestep
12393       46       77       3       109
12719       47       77       4       162
13098       48       77       5       268
13143       49       77       4        40
13500       50       77       3       124
average_rating for this rec across 50 users from same group (less noisy) was: 3.96
all_actions shape just before sample torch.Size([1, 21, 1])
action scaled by temperature: tensor([[126]], device='cuda:0')
action picked by argmax: tensor([76], device='cuda:0')
tensor([[ 76,  24,  75, 160, 237,  37, 268,  54, 180,  48]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
243         1       77       5       244
432         2       77       5       160
743         3       77       5       198
835         4       77       4        17
1233        5       77       4       142
       user_id  item_id  rating  timestep
12393       46       77       3       109
12719       47       77       4       162
13098       48       77       5       268
13143       49       77       4        40
13500       50       77       3       124
average_rating for this rec across 50 users from same group (less noisy) was: 3.96
all_actions shape just before sample torch.Size([1, 22, 1])
action scaled by temperature: tensor([[130]], device='cuda:0')
action picked by argmax: tensor([76], device='cuda:0')
tensor([[ 76,  24,  75, 160, 237, 268,  37,  54, 180, 196]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
243         1       77       5       244
432         2       77       5       160
743         3       77       5       198
835         4       77       4        17
1233        5       77       4       142
       user_id  item_id  rating  timestep
12393       46       77       3       109
12719       47       77       4       162
13098       48       77       5       268
13143       49       77       4        40
13500       50       77       3       124
average_rating for this rec across 50 users from same group (less noisy) was: 3.96
all_actions shape just before sample torch.Size([1, 23, 1])
action scaled by temperature: tensor([[25]], device='cuda:0')
action picked by argmax: tensor([76], device='cuda:0')
tensor([[ 76,  24,  75, 160, 237, 268,  37,  54, 180, 196]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
243         1       77       5       244
432         2       77       5       160
743         3       77       5       198
835         4       77       4        17
1233        5       77       4       142
       user_id  item_id  rating  timestep
12393       46       77       3       109
12719       47       77       4       162
13098       48       77       5       268
13143       49       77       4        40
13500       50       77       3       124
average_rating for this rec across 50 users from same group (less noisy) was: 3.96
all_actions shape just before sample torch.Size([1, 24, 1])
action scaled by temperature: tensor([[253]], device='cuda:0')
action picked by argmax: tensor([76], device='cuda:0')
tensor([[ 76,  24,  75, 160, 237,  37, 268,  54, 180, 196]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
243         1       77       5       244
432         2       77       5       160
743         3       77       5       198
835         4       77       4        17
1233        5       77       4       142
       user_id  item_id  rating  timestep
12393       46       77       3       109
12719       47       77       4       162
13098       48       77       5       268
13143       49       77       4        40
13500       50       77       3       124
average_rating for this rec across 50 users from same group (less noisy) was: 3.96
all_actions shape just before sample torch.Size([1, 25, 1])
action scaled by temperature: tensor([[41]], device='cuda:0')
action picked by argmax: tensor([24], device='cuda:0')
tensor([[ 24,  76,  75, 237, 160, 268, 180, 196,  54,  37]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
50          1       25       5        51
277         2       25       4         5
749         3       25       4       204
1042        4       25       5       224
1232        5       25       5       141
       user_id  item_id  rating  timestep
12295       46       25       5        11
12795       47       25       4       238
13004       48       25       5       174
13315       49       25       4       212
13403       50       25       4        27
average_rating for this rec across 50 users from same group (less noisy) was: 4.68
all_actions shape just before sample torch.Size([1, 26, 1])
action scaled by temperature: tensor([[256]], device='cuda:0')
action picked by argmax: tensor([24], device='cuda:0')
tensor([[ 24,  76,  75, 160, 237, 268, 180,  37,  54, 196]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
50          1       25       5        51
277         2       25       4         5
749         3       25       4       204
1042        4       25       5       224
1232        5       25       5       141
       user_id  item_id  rating  timestep
12295       46       25       5        11
12795       47       25       4       238
13004       48       25       5       174
13315       49       25       4       212
13403       50       25       4        27
average_rating for this rec across 50 users from same group (less noisy) was: 4.68
all_actions shape just before sample torch.Size([1, 27, 1])
action scaled by temperature: tensor([[43]], device='cuda:0')
action picked by argmax: tensor([24], device='cuda:0')
tensor([[ 24,  76,  75, 237, 160, 268, 180,  37,  54, 196]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
50          1       25       5        51
277         2       25       4         5
749         3       25       4       204
1042        4       25       5       224
1232        5       25       5       141
       user_id  item_id  rating  timestep
12295       46       25       5        11
12795       47       25       4       238
13004       48       25       5       174
13315       49       25       4       212
13403       50       25       4        27
average_rating for this rec across 50 users from same group (less noisy) was: 4.68
all_actions shape just before sample torch.Size([1, 28, 1])
action scaled by temperature: tensor([[263]], device='cuda:0')
action picked by argmax: tensor([76], device='cuda:0')
tensor([[ 76,  24,  75, 160, 237,  37, 268,  54, 180,  48]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
243         1       77       5       244
432         2       77       5       160
743         3       77       5       198
835         4       77       4        17
1233        5       77       4       142
       user_id  item_id  rating  timestep
12393       46       77       3       109
12719       47       77       4       162
13098       48       77       5       268
13143       49       77       4        40
13500       50       77       3       124
average_rating for this rec across 50 users from same group (less noisy) was: 3.96
all_actions shape just before sample torch.Size([1, 29, 1])
action scaled by temperature: tensor([[151]], device='cuda:0')
action picked by argmax: tensor([24], device='cuda:0')
tensor([[ 24,  76,  75, 160, 237, 268,  37, 180,  54, 196]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
50          1       25       5        51
277         2       25       4         5
749         3       25       4       204
1042        4       25       5       224
1232        5       25       5       141
       user_id  item_id  rating  timestep
12295       46       25       5        11
12795       47       25       4       238
13004       48       25       5       174
13315       49       25       4       212
13403       50       25       4        27
average_rating for this rec across 50 users from same group (less noisy) was: 4.68
all_actions shape just before sample torch.Size([1, 30, 1])
action scaled by temperature: tensor([[180]], device='cuda:0')
action picked by argmax: tensor([24], device='cuda:0')
tensor([[ 24,  76,  75, 237, 160, 268, 180,  37,  54, 196]], device='cuda:0')
Just recommended 30 new items to 50 users from group 1 and the total rating was 125.99999999999994
train_loss is: 5.60392835042248
action scaled by temperature: tensor([[250]], device='cuda:0')
action picked by argmax: tensor([231], device='cuda:0')
tensor([[231, 196, 237,  76, 246, 209,  81, 268, 117,  37]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
250         1      232       4       251
469         2      232       4       197
557         3      232       4        12
922         4      232       5       104
1265        5      232       5       174
       user_id  item_id  rating  timestep
12299       46      232       5        15
12815       47      232       3       258
12865       48      232       4        35
13142       49      232       5        39
13469       50      232       3        93
average_rating for this rec across 50 users from same group (less noisy) was: 4.38
all_actions shape just before sample torch.Size([1, 1, 1])
action scaled by temperature: tensor([[156]], device='cuda:0')
action picked by argmax: tensor([231], device='cuda:0')
tensor([[231, 196, 237,  76, 246, 209, 268,  37,  81, 117]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
250         1      232       4       251
469         2      232       4       197
557         3      232       4        12
922         4      232       5       104
1265        5      232       5       174
       user_id  item_id  rating  timestep
12299       46      232       5        15
12815       47      232       3       258
12865       48      232       4        35
13142       49      232       5        39
13469       50      232       3        93
average_rating for this rec across 50 users from same group (less noisy) was: 4.38
all_actions shape just before sample torch.Size([1, 2, 1])
action scaled by temperature: tensor([[126]], device='cuda:0')
action picked by argmax: tensor([231], device='cuda:0')
tensor([[231, 196, 237,  76, 246, 209, 268,  37, 117,  81]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
250         1      232       4       251
469         2      232       4       197
557         3      232       4        12
922         4      232       5       104
1265        5      232       5       174
       user_id  item_id  rating  timestep
12299       46      232       5        15
12815       47      232       3       258
12865       48      232       4        35
13142       49      232       5        39
13469       50      232       3        93
average_rating for this rec across 50 users from same group (less noisy) was: 4.38
all_actions shape just before sample torch.Size([1, 3, 1])
action scaled by temperature: tensor([[202]], device='cuda:0')
action picked by argmax: tensor([231], device='cuda:0')
tensor([[231,  76, 246,  37,  28, 200, 196, 205, 237,  35]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
250         1      232       4       251
469         2      232       4       197
557         3      232       4        12
922         4      232       5       104
1265        5      232       5       174
       user_id  item_id  rating  timestep
12299       46      232       5        15
12815       47      232       3       258
12865       48      232       4        35
13142       49      232       5        39
13469       50      232       3        93
average_rating for this rec across 50 users from same group (less noisy) was: 4.38
all_actions shape just before sample torch.Size([1, 4, 1])
action scaled by temperature: tensor([[104]], device='cuda:0')
action picked by argmax: tensor([76], device='cuda:0')
tensor([[ 76, 231,  37, 246,  28, 200, 196, 205,  64,  35]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
243         1       77       5       244
432         2       77       5       160
743         3       77       5       198
835         4       77       4        17
1233        5       77       4       142
       user_id  item_id  rating  timestep
12393       46       77       3       109
12719       47       77       4       162
13098       48       77       5       268
13143       49       77       4        40
13500       50       77       3       124
average_rating for this rec across 50 users from same group (less noisy) was: 3.96
all_actions shape just before sample torch.Size([1, 5, 1])
action scaled by temperature: tensor([[219]], device='cuda:0')
action picked by argmax: tensor([76], device='cuda:0')
tensor([[ 76, 246,  37,  28, 200,  30,  64,  40, 231, 196]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
243         1       77       5       244
432         2       77       5       160
743         3       77       5       198
835         4       77       4        17
1233        5       77       4       142
       user_id  item_id  rating  timestep
12393       46       77       3       109
12719       47       77       4       162
13098       48       77       5       268
13143       49       77       4        40
13500       50       77       3       124
average_rating for this rec across 50 users from same group (less noisy) was: 3.96
all_actions shape just before sample torch.Size([1, 6, 1])
action scaled by temperature: tensor([[112]], device='cuda:0')
action picked by argmax: tensor([246], device='cuda:0')
tensor([[246,  76,  37,  28, 200,  30,  64,  40, 157,  10]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
185         1      247       4       186
384         2      247       4       112
620         3      247       5        75
986         4      247       5       168
1337        5      247       4       246
       user_id  item_id  rating  timestep
12355       46      247       4        71
12740       47      247       4       183
12928       48      247       5        98
13339       49      247       3       236
13639       50      247       4       263
average_rating for this rec across 50 users from same group (less noisy) was: 4.12
all_actions shape just before sample torch.Size([1, 7, 1])
action scaled by temperature: tensor([[106]], device='cuda:0')
action picked by argmax: tensor([246], device='cuda:0')
tensor([[246,  76, 200,  37, 231,  28, 196,  64,  35,  30]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
185         1      247       4       186
384         2      247       4       112
620         3      247       5        75
986         4      247       5       168
1337        5      247       4       246
       user_id  item_id  rating  timestep
12355       46      247       4        71
12740       47      247       4       183
12928       48      247       5        98
13339       49      247       3       236
13639       50      247       4       263
average_rating for this rec across 50 users from same group (less noisy) was: 4.12
all_actions shape just before sample torch.Size([1, 8, 1])
action scaled by temperature: tensor([[148]], device='cuda:0')
action picked by argmax: tensor([246], device='cuda:0')
tensor([[246,  76, 200, 231,  28, 196,  37,  64,  35, 205]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
185         1      247       4       186
384         2      247       4       112
620         3      247       5        75
986         4      247       5       168
1337        5      247       4       246
       user_id  item_id  rating  timestep
12355       46      247       4        71
12740       47      247       4       183
12928       48      247       5        98
13339       49      247       3       236
13639       50      247       4       263
average_rating for this rec across 50 users from same group (less noisy) was: 4.12
all_actions shape just before sample torch.Size([1, 9, 1])
action scaled by temperature: tensor([[217]], device='cuda:0')
action picked by argmax: tensor([246], device='cuda:0')
tensor([[246,  76, 231, 200, 196,  28,  37,  35,  64, 205]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
185         1      247       4       186
384         2      247       4       112
620         3      247       5        75
986         4      247       5       168
1337        5      247       4       246
       user_id  item_id  rating  timestep
12355       46      247       4        71
12740       47      247       4       183
12928       48      247       5        98
13339       49      247       3       236
13639       50      247       4       263
average_rating for this rec across 50 users from same group (less noisy) was: 4.12
all_actions shape just before sample torch.Size([1, 10, 1])
action scaled by temperature: tensor([[226]], device='cuda:0')
action picked by argmax: tensor([246], device='cuda:0')
tensor([[246,  76, 200, 231,  28,  37, 196,  64,  35, 205]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
185         1      247       4       186
384         2      247       4       112
620         3      247       5        75
986         4      247       5       168
1337        5      247       4       246
       user_id  item_id  rating  timestep
12355       46      247       4        71
12740       47      247       4       183
12928       48      247       5        98
13339       49      247       3       236
13639       50      247       4       263
average_rating for this rec across 50 users from same group (less noisy) was: 4.12
all_actions shape just before sample torch.Size([1, 11, 1])
action scaled by temperature: tensor([[174]], device='cuda:0')
action picked by argmax: tensor([246], device='cuda:0')
tensor([[246,  76, 200,  37,  28, 231, 196,  64,  35,  30]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
185         1      247       4       186
384         2      247       4       112
620         3      247       5        75
986         4      247       5       168
1337        5      247       4       246
       user_id  item_id  rating  timestep
12355       46      247       4        71
12740       47      247       4       183
12928       48      247       5        98
13339       49      247       3       236
13639       50      247       4       263
average_rating for this rec across 50 users from same group (less noisy) was: 4.12
all_actions shape just before sample torch.Size([1, 12, 1])
action scaled by temperature: tensor([[191]], device='cuda:0')
action picked by argmax: tensor([246], device='cuda:0')
tensor([[246,  76, 200,  28,  37,  64,  30, 196,  40, 231]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
185         1      247       4       186
384         2      247       4       112
620         3      247       5        75
986         4      247       5       168
1337        5      247       4       246
       user_id  item_id  rating  timestep
12355       46      247       4        71
12740       47      247       4       183
12928       48      247       5        98
13339       49      247       3       236
13639       50      247       4       263
average_rating for this rec across 50 users from same group (less noisy) was: 4.12
all_actions shape just before sample torch.Size([1, 13, 1])
action scaled by temperature: tensor([[257]], device='cuda:0')
action picked by argmax: tensor([246], device='cuda:0')
tensor([[246,  76,  40, 200,  30,  37,  28,  64, 157,  10]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
185         1      247       4       186
384         2      247       4       112
620         3      247       5        75
986         4      247       5       168
1337        5      247       4       246
       user_id  item_id  rating  timestep
12355       46      247       4        71
12740       47      247       4       183
12928       48      247       5        98
13339       49      247       3       236
13639       50      247       4       263
average_rating for this rec across 50 users from same group (less noisy) was: 4.12
all_actions shape just before sample torch.Size([1, 14, 1])
action scaled by temperature: tensor([[145]], device='cuda:0')
action picked by argmax: tensor([246], device='cuda:0')
tensor([[246,  76, 200,  28,  37,  64,  30,  40, 157,  10]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
185         1      247       4       186
384         2      247       4       112
620         3      247       5        75
986         4      247       5       168
1337        5      247       4       246
       user_id  item_id  rating  timestep
12355       46      247       4        71
12740       47      247       4       183
12928       48      247       5        98
13339       49      247       3       236
13639       50      247       4       263
average_rating for this rec across 50 users from same group (less noisy) was: 4.12
all_actions shape just before sample torch.Size([1, 15, 1])
action scaled by temperature: tensor([[249]], device='cuda:0')
action picked by argmax: tensor([76], device='cuda:0')
tensor([[ 76, 246, 200,  37,  28,  30,  64,  40, 157,  10]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
243         1       77       5       244
432         2       77       5       160
743         3       77       5       198
835         4       77       4        17
1233        5       77       4       142
       user_id  item_id  rating  timestep
12393       46       77       3       109
12719       47       77       4       162
13098       48       77       5       268
13143       49       77       4        40
13500       50       77       3       124
average_rating for this rec across 50 users from same group (less noisy) was: 3.96
all_actions shape just before sample torch.Size([1, 16, 1])
action scaled by temperature: tensor([[128]], device='cuda:0')
action picked by argmax: tensor([76], device='cuda:0')
tensor([[ 76, 246, 200,  37,  28,  64, 231,  30, 196,  40]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
243         1       77       5       244
432         2       77       5       160
743         3       77       5       198
835         4       77       4        17
1233        5       77       4       142
       user_id  item_id  rating  timestep
12393       46       77       3       109
12719       47       77       4       162
13098       48       77       5       268
13143       49       77       4        40
13500       50       77       3       124
average_rating for this rec across 50 users from same group (less noisy) was: 3.96
all_actions shape just before sample torch.Size([1, 17, 1])
action scaled by temperature: tensor([[6]], device='cuda:0')
action picked by argmax: tensor([246], device='cuda:0')
tensor([[246,  76, 200,  28,  37,  64,  30, 196, 231,  35]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
185         1      247       4       186
384         2      247       4       112
620         3      247       5        75
986         4      247       5       168
1337        5      247       4       246
       user_id  item_id  rating  timestep
12355       46      247       4        71
12740       47      247       4       183
12928       48      247       5        98
13339       49      247       3       236
13639       50      247       4       263
average_rating for this rec across 50 users from same group (less noisy) was: 4.12
all_actions shape just before sample torch.Size([1, 18, 1])
action scaled by temperature: tensor([[211]], device='cuda:0')
action picked by argmax: tensor([246], device='cuda:0')
tensor([[246,  76, 200,  28,  37,  64,  30,  40,  10, 157]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
185         1      247       4       186
384         2      247       4       112
620         3      247       5        75
986         4      247       5       168
1337        5      247       4       246
       user_id  item_id  rating  timestep
12355       46      247       4        71
12740       47      247       4       183
12928       48      247       5        98
13339       49      247       3       236
13639       50      247       4       263
average_rating for this rec across 50 users from same group (less noisy) was: 4.12
all_actions shape just before sample torch.Size([1, 19, 1])
action scaled by temperature: tensor([[240]], device='cuda:0')
action picked by argmax: tensor([76], device='cuda:0')
tensor([[ 76, 246, 200,  37,  40,  28,  30,  64, 157,  10]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
243         1       77       5       244
432         2       77       5       160
743         3       77       5       198
835         4       77       4        17
1233        5       77       4       142
       user_id  item_id  rating  timestep
12393       46       77       3       109
12719       47       77       4       162
13098       48       77       5       268
13143       49       77       4        40
13500       50       77       3       124
average_rating for this rec across 50 users from same group (less noisy) was: 3.96
all_actions shape just before sample torch.Size([1, 20, 1])
action scaled by temperature: tensor([[138]], device='cuda:0')
action picked by argmax: tensor([246], device='cuda:0')
tensor([[246,  76, 200,  28,  37,  30,  40,  64, 157,  10]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
185         1      247       4       186
384         2      247       4       112
620         3      247       5        75
986         4      247       5       168
1337        5      247       4       246
       user_id  item_id  rating  timestep
12355       46      247       4        71
12740       47      247       4       183
12928       48      247       5        98
13339       49      247       3       236
13639       50      247       4       263
average_rating for this rec across 50 users from same group (less noisy) was: 4.12
all_actions shape just before sample torch.Size([1, 21, 1])
action scaled by temperature: tensor([[20]], device='cuda:0')
action picked by argmax: tensor([246], device='cuda:0')
tensor([[246,  76, 200,  40,  37,  28,  30,  64, 157,  10]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
185         1      247       4       186
384         2      247       4       112
620         3      247       5        75
986         4      247       5       168
1337        5      247       4       246
       user_id  item_id  rating  timestep
12355       46      247       4        71
12740       47      247       4       183
12928       48      247       5        98
13339       49      247       3       236
13639       50      247       4       263
average_rating for this rec across 50 users from same group (less noisy) was: 4.12
all_actions shape just before sample torch.Size([1, 22, 1])
action scaled by temperature: tensor([[259]], device='cuda:0')
action picked by argmax: tensor([246], device='cuda:0')
tensor([[246,  76, 200,  37,  28,  64,  30, 231, 196,  40]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
185         1      247       4       186
384         2      247       4       112
620         3      247       5        75
986         4      247       5       168
1337        5      247       4       246
       user_id  item_id  rating  timestep
12355       46      247       4        71
12740       47      247       4       183
12928       48      247       5        98
13339       49      247       3       236
13639       50      247       4       263
average_rating for this rec across 50 users from same group (less noisy) was: 4.12
all_actions shape just before sample torch.Size([1, 23, 1])
action scaled by temperature: tensor([[129]], device='cuda:0')
action picked by argmax: tensor([246], device='cuda:0')
tensor([[246,  76, 231, 200,  37, 196,  28,  64,  35, 205]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
185         1      247       4       186
384         2      247       4       112
620         3      247       5        75
986         4      247       5       168
1337        5      247       4       246
       user_id  item_id  rating  timestep
12355       46      247       4        71
12740       47      247       4       183
12928       48      247       5        98
13339       49      247       3       236
13639       50      247       4       263
average_rating for this rec across 50 users from same group (less noisy) was: 4.12
all_actions shape just before sample torch.Size([1, 24, 1])
action scaled by temperature: tensor([[230]], device='cuda:0')
action picked by argmax: tensor([246], device='cuda:0')
tensor([[246,  76, 200,  37,  28, 231, 196,  64,  30,  35]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
185         1      247       4       186
384         2      247       4       112
620         3      247       5        75
986         4      247       5       168
1337        5      247       4       246
       user_id  item_id  rating  timestep
12355       46      247       4        71
12740       47      247       4       183
12928       48      247       5        98
13339       49      247       3       236
13639       50      247       4       263
average_rating for this rec across 50 users from same group (less noisy) was: 4.12
all_actions shape just before sample torch.Size([1, 25, 1])
action scaled by temperature: tensor([[244]], device='cuda:0')
action picked by argmax: tensor([246], device='cuda:0')
tensor([[246,  76, 200,  37,  28,  64, 231, 196,  30,  35]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
185         1      247       4       186
384         2      247       4       112
620         3      247       5        75
986         4      247       5       168
1337        5      247       4       246
       user_id  item_id  rating  timestep
12355       46      247       4        71
12740       47      247       4       183
12928       48      247       5        98
13339       49      247       3       236
13639       50      247       4       263
average_rating for this rec across 50 users from same group (less noisy) was: 4.12
all_actions shape just before sample torch.Size([1, 26, 1])
action scaled by temperature: tensor([[96]], device='cuda:0')
action picked by argmax: tensor([246], device='cuda:0')
tensor([[246,  76, 200, 231,  37,  28, 196,  64,  35,  30]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
185         1      247       4       186
384         2      247       4       112
620         3      247       5        75
986         4      247       5       168
1337        5      247       4       246
       user_id  item_id  rating  timestep
12355       46      247       4        71
12740       47      247       4       183
12928       48      247       5        98
13339       49      247       3       236
13639       50      247       4       263
average_rating for this rec across 50 users from same group (less noisy) was: 4.12
all_actions shape just before sample torch.Size([1, 27, 1])
action scaled by temperature: tensor([[260]], device='cuda:0')
action picked by argmax: tensor([246], device='cuda:0')
tensor([[246,  76, 200,  37,  28,  64,  30, 196, 231,  40]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
185         1      247       4       186
384         2      247       4       112
620         3      247       5        75
986         4      247       5       168
1337        5      247       4       246
       user_id  item_id  rating  timestep
12355       46      247       4        71
12740       47      247       4       183
12928       48      247       5        98
13339       49      247       3       236
13639       50      247       4       263
average_rating for this rec across 50 users from same group (less noisy) was: 4.12
all_actions shape just before sample torch.Size([1, 28, 1])
action scaled by temperature: tensor([[5]], device='cuda:0')
action picked by argmax: tensor([246], device='cuda:0')
tensor([[246,  76, 200,  37,  28,  64,  30,  40, 157,  10]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
185         1      247       4       186
384         2      247       4       112
620         3      247       5        75
986         4      247       5       168
1337        5      247       4       246
       user_id  item_id  rating  timestep
12355       46      247       4        71
12740       47      247       4       183
12928       48      247       5        98
13339       49      247       3       236
13639       50      247       4       263
average_rating for this rec across 50 users from same group (less noisy) was: 4.12
all_actions shape just before sample torch.Size([1, 29, 1])
action scaled by temperature: tensor([[184]], device='cuda:0')
action picked by argmax: tensor([246], device='cuda:0')
tensor([[246,  76, 200,  37,  28, 231, 196,  64,  35,  30]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
185         1      247       4       186
384         2      247       4       112
620         3      247       5        75
986         4      247       5       168
1337        5      247       4       246
       user_id  item_id  rating  timestep
12355       46      247       4        71
12740       47      247       4       183
12928       48      247       5        98
13339       49      247       3       236
13639       50      247       4       263
average_rating for this rec across 50 users from same group (less noisy) was: 4.12
all_actions shape just before sample torch.Size([1, 30, 1])
action scaled by temperature: tensor([[20]], device='cuda:0')
action picked by argmax: tensor([246], device='cuda:0')
tensor([[246,  76,  37, 200,  28, 231, 196,  64,  30,  35]], device='cuda:0')
Just recommended 30 new items to 50 users from group 1 and the total rating was 123.84000000000002
train_loss is: 5.5952024198558235
action scaled by temperature: tensor([[83]], device='cuda:0')
action picked by argmax: tensor([75], device='cuda:0')
tensor([[ 75, 187, 237,  54, 107,  24, 200, 227, 263, 250]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
76          1       76       5        77
330         2       76       4        58
571         3       76       3        26
915         4       76       4        97
1167        5       76       4        76
       user_id  item_id  rating  timestep
12440       46       76       3       156
12588       47       76       4        31
12957       48       76       3       127
13325       49       76       5       222
13468       50       76       5        92
average_rating for this rec across 50 users from same group (less noisy) was: 4.04
all_actions shape just before sample torch.Size([1, 1, 1])
action scaled by temperature: tensor([[153]], device='cuda:0')
action picked by argmax: tensor([75], device='cuda:0')
tensor([[ 75, 109, 257, 187, 209,  36,  10, 237, 263,  54]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
76          1       76       5        77
330         2       76       4        58
571         3       76       3        26
915         4       76       4        97
1167        5       76       4        76
       user_id  item_id  rating  timestep
12440       46       76       3       156
12588       47       76       4        31
12957       48       76       3       127
13325       49       76       5       222
13468       50       76       5        92
average_rating for this rec across 50 users from same group (less noisy) was: 4.04
all_actions shape just before sample torch.Size([1, 2, 1])
action scaled by temperature: tensor([[190]], device='cuda:0')
action picked by argmax: tensor([109], device='cuda:0')
tensor([[109,  36,  75, 209, 257,  10, 187, 263, 268, 237]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
132         1      110       4       133
472         2      110       5       200
687         3      110       5       142
910         4      110       5        92
1217        5      110       4       126
       user_id  item_id  rating  timestep
12408       46      110       5       124
12729       47      110       5       172
12956       48      110       5       126
13369       49      110       5       266
13458       50      110       5        82
average_rating for this rec across 50 users from same group (less noisy) was: 4.66
all_actions shape just before sample torch.Size([1, 3, 1])
action scaled by temperature: tensor([[272]], device='cuda:0')
action picked by argmax: tensor([36], device='cuda:0')
tensor([[ 36, 209, 257, 109,  24, 268, 263, 180, 237,  81]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
201         1       37       2       202
424         2       37       5       152
565         3       37       4        20
1025        4       37       3       207
1221        5       37       4       130
       user_id  item_id  rating  timestep
12390       46       37       4       106
12575       47       37       4        18
13059       48       37       4       229
13368       49       37       5       265
13436       50       37       3        60
average_rating for this rec across 50 users from same group (less noisy) was: 3.72
all_actions shape just before sample torch.Size([1, 4, 1])
action scaled by temperature: tensor([[233]], device='cuda:0')
action picked by argmax: tensor([109], device='cuda:0')
tensor([[109,  75,  36,  10, 257, 209, 187, 263, 268, 237]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
132         1      110       4       133
472         2      110       5       200
687         3      110       5       142
910         4      110       5        92
1217        5      110       4       126
       user_id  item_id  rating  timestep
12408       46      110       5       124
12729       47      110       5       172
12956       48      110       5       126
13369       49      110       5       266
13458       50      110       5        82
average_rating for this rec across 50 users from same group (less noisy) was: 4.66
all_actions shape just before sample torch.Size([1, 5, 1])
action scaled by temperature: tensor([[172]], device='cuda:0')
action picked by argmax: tensor([109], device='cuda:0')
tensor([[109,  36,  75, 257,  10, 209, 187, 268, 180, 263]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
132         1      110       4       133
472         2      110       5       200
687         3      110       5       142
910         4      110       5        92
1217        5      110       4       126
       user_id  item_id  rating  timestep
12408       46      110       5       124
12729       47      110       5       172
12956       48      110       5       126
13369       49      110       5       266
13458       50      110       5        82
average_rating for this rec across 50 users from same group (less noisy) was: 4.66
all_actions shape just before sample torch.Size([1, 6, 1])
action scaled by temperature: tensor([[160]], device='cuda:0')
action picked by argmax: tensor([10], device='cuda:0')
tensor([[ 10,  75, 109, 187, 180,  36, 237, 257, 209, 268]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
183         1       11       1       184
302         2       11       4        30
616         3       11       3        71
877         4       11       2        59
1096        5       11       3         5
       user_id  item_id  rating  timestep
12340       46       11       2        56
12829       47       11       1       272
12922       48       11       3        92
13155       49       11       2        52
13410       50       11       2        34
average_rating for this rec across 50 users from same group (less noisy) was: 2.2
all_actions shape just before sample torch.Size([1, 7, 1])
action scaled by temperature: tensor([[49]], device='cuda:0')
action picked by argmax: tensor([36], device='cuda:0')
tensor([[ 36, 109, 209,  10, 257, 268,  75, 180, 263, 187]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
201         1       37       2       202
424         2       37       5       152
565         3       37       4        20
1025        4       37       3       207
1221        5       37       4       130
       user_id  item_id  rating  timestep
12390       46       37       4       106
12575       47       37       4        18
13059       48       37       4       229
13368       49       37       5       265
13436       50       37       3        60
average_rating for this rec across 50 users from same group (less noisy) was: 3.72
all_actions shape just before sample torch.Size([1, 8, 1])
action scaled by temperature: tensor([[48]], device='cuda:0')
action picked by argmax: tensor([10], device='cuda:0')
tensor([[ 10,  75, 187, 109, 223, 135, 180, 237, 157, 215]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
183         1       11       1       184
302         2       11       4        30
616         3       11       3        71
877         4       11       2        59
1096        5       11       3         5
       user_id  item_id  rating  timestep
12340       46       11       2        56
12829       47       11       1       272
12922       48       11       3        92
13155       49       11       2        52
13410       50       11       2        34
average_rating for this rec across 50 users from same group (less noisy) was: 2.2
all_actions shape just before sample torch.Size([1, 9, 1])
action scaled by temperature: tensor([[28]], device='cuda:0')
action picked by argmax: tensor([10], device='cuda:0')
tensor([[ 10,  75, 109, 187, 135, 157, 223, 180, 215, 237]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
183         1       11       1       184
302         2       11       4        30
616         3       11       3        71
877         4       11       2        59
1096        5       11       3         5
       user_id  item_id  rating  timestep
12340       46       11       2        56
12829       47       11       1       272
12922       48       11       3        92
13155       49       11       2        52
13410       50       11       2        34
average_rating for this rec across 50 users from same group (less noisy) was: 2.2
all_actions shape just before sample torch.Size([1, 10, 1])
action scaled by temperature: tensor([[61]], device='cuda:0')
action picked by argmax: tensor([10], device='cuda:0')
tensor([[ 10, 109,  75,  36, 257, 209, 187, 268, 263, 180]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
183         1       11       1       184
302         2       11       4        30
616         3       11       3        71
877         4       11       2        59
1096        5       11       3         5
       user_id  item_id  rating  timestep
12340       46       11       2        56
12829       47       11       1       272
12922       48       11       3        92
13155       49       11       2        52
13410       50       11       2        34
average_rating for this rec across 50 users from same group (less noisy) was: 2.2
all_actions shape just before sample torch.Size([1, 11, 1])
action scaled by temperature: tensor([[1]], device='cuda:0')
action picked by argmax: tensor([10], device='cuda:0')
tensor([[ 10, 109,  75,  36, 209, 257, 187, 180, 268, 263]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
183         1       11       1       184
302         2       11       4        30
616         3       11       3        71
877         4       11       2        59
1096        5       11       3         5
       user_id  item_id  rating  timestep
12340       46       11       2        56
12829       47       11       1       272
12922       48       11       3        92
13155       49       11       2        52
13410       50       11       2        34
average_rating for this rec across 50 users from same group (less noisy) was: 2.2
all_actions shape just before sample torch.Size([1, 12, 1])
action scaled by temperature: tensor([[85]], device='cuda:0')
action picked by argmax: tensor([10], device='cuda:0')
tensor([[ 10, 109,  36, 209,  75, 268, 180, 187, 257, 263]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
183         1       11       1       184
302         2       11       4        30
616         3       11       3        71
877         4       11       2        59
1096        5       11       3         5
       user_id  item_id  rating  timestep
12340       46       11       2        56
12829       47       11       1       272
12922       48       11       3        92
13155       49       11       2        52
13410       50       11       2        34
average_rating for this rec across 50 users from same group (less noisy) was: 2.2
all_actions shape just before sample torch.Size([1, 13, 1])
action scaled by temperature: tensor([[93]], device='cuda:0')
action picked by argmax: tensor([10], device='cuda:0')
tensor([[ 10, 109,  36,  75, 209, 180, 268, 187, 257, 263]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
183         1       11       1       184
302         2       11       4        30
616         3       11       3        71
877         4       11       2        59
1096        5       11       3         5
       user_id  item_id  rating  timestep
12340       46       11       2        56
12829       47       11       1       272
12922       48       11       3        92
13155       49       11       2        52
13410       50       11       2        34
average_rating for this rec across 50 users from same group (less noisy) was: 2.2
all_actions shape just before sample torch.Size([1, 14, 1])
action scaled by temperature: tensor([[141]], device='cuda:0')
action picked by argmax: tensor([10], device='cuda:0')
tensor([[ 10, 109,  75,  36, 209, 187, 268, 180, 257, 263]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
183         1       11       1       184
302         2       11       4        30
616         3       11       3        71
877         4       11       2        59
1096        5       11       3         5
       user_id  item_id  rating  timestep
12340       46       11       2        56
12829       47       11       1       272
12922       48       11       3        92
13155       49       11       2        52
13410       50       11       2        34
average_rating for this rec across 50 users from same group (less noisy) was: 2.2
all_actions shape just before sample torch.Size([1, 15, 1])
action scaled by temperature: tensor([[230]], device='cuda:0')
action picked by argmax: tensor([10], device='cuda:0')
tensor([[ 10, 157,  75, 205,  40, 135, 223,  37,  30, 187]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
183         1       11       1       184
302         2       11       4        30
616         3       11       3        71
877         4       11       2        59
1096        5       11       3         5
       user_id  item_id  rating  timestep
12340       46       11       2        56
12829       47       11       1       272
12922       48       11       3        92
13155       49       11       2        52
13410       50       11       2        34
average_rating for this rec across 50 users from same group (less noisy) was: 2.2
all_actions shape just before sample torch.Size([1, 16, 1])
action scaled by temperature: tensor([[32]], device='cuda:0')
action picked by argmax: tensor([75], device='cuda:0')
tensor([[ 75,  10, 109, 187, 257,  36, 209, 237,  54, 180]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
76          1       76       5        77
330         2       76       4        58
571         3       76       3        26
915         4       76       4        97
1167        5       76       4        76
       user_id  item_id  rating  timestep
12440       46       76       3       156
12588       47       76       4        31
12957       48       76       3       127
13325       49       76       5       222
13468       50       76       5        92
average_rating for this rec across 50 users from same group (less noisy) was: 4.04
all_actions shape just before sample torch.Size([1, 17, 1])
action scaled by temperature: tensor([[6]], device='cuda:0')
action picked by argmax: tensor([10], device='cuda:0')
tensor([[ 10,  75, 157, 109, 135, 223, 180, 187, 250, 268]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
183         1       11       1       184
302         2       11       4        30
616         3       11       3        71
877         4       11       2        59
1096        5       11       3         5
       user_id  item_id  rating  timestep
12340       46       11       2        56
12829       47       11       1       272
12922       48       11       3        92
13155       49       11       2        52
13410       50       11       2        34
average_rating for this rec across 50 users from same group (less noisy) was: 2.2
all_actions shape just before sample torch.Size([1, 18, 1])
action scaled by temperature: tensor([[72]], device='cuda:0')
action picked by argmax: tensor([10], device='cuda:0')
tensor([[ 10, 157, 135,  40,  30, 223, 205,  75, 246,  37]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
183         1       11       1       184
302         2       11       4        30
616         3       11       3        71
877         4       11       2        59
1096        5       11       3         5
       user_id  item_id  rating  timestep
12340       46       11       2        56
12829       47       11       1       272
12922       48       11       3        92
13155       49       11       2        52
13410       50       11       2        34
average_rating for this rec across 50 users from same group (less noisy) was: 2.2
all_actions shape just before sample torch.Size([1, 19, 1])
action scaled by temperature: tensor([[46]], device='cuda:0')
action picked by argmax: tensor([10], device='cuda:0')
tensor([[ 10, 157,  75,  40, 135, 205, 223,  30,  37, 187]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
183         1       11       1       184
302         2       11       4        30
616         3       11       3        71
877         4       11       2        59
1096        5       11       3         5
       user_id  item_id  rating  timestep
12340       46       11       2        56
12829       47       11       1       272
12922       48       11       3        92
13155       49       11       2        52
13410       50       11       2        34
average_rating for this rec across 50 users from same group (less noisy) was: 2.2
all_actions shape just before sample torch.Size([1, 20, 1])
action scaled by temperature: tensor([[160]], device='cuda:0')
action picked by argmax: tensor([10], device='cuda:0')
tensor([[ 10,  75, 157, 135, 109, 223, 180,  35, 187, 268]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
183         1       11       1       184
302         2       11       4        30
616         3       11       3        71
877         4       11       2        59
1096        5       11       3         5
       user_id  item_id  rating  timestep
12340       46       11       2        56
12829       47       11       1       272
12922       48       11       3        92
13155       49       11       2        52
13410       50       11       2        34
average_rating for this rec across 50 users from same group (less noisy) was: 2.2
all_actions shape just before sample torch.Size([1, 21, 1])
action scaled by temperature: tensor([[150]], device='cuda:0')
action picked by argmax: tensor([10], device='cuda:0')
tensor([[ 10, 157, 135,  75, 223,  40,  30, 180, 109, 187]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
183         1       11       1       184
302         2       11       4        30
616         3       11       3        71
877         4       11       2        59
1096        5       11       3         5
       user_id  item_id  rating  timestep
12340       46       11       2        56
12829       47       11       1       272
12922       48       11       3        92
13155       49       11       2        52
13410       50       11       2        34
average_rating for this rec across 50 users from same group (less noisy) was: 2.2
all_actions shape just before sample torch.Size([1, 22, 1])
action scaled by temperature: tensor([[4]], device='cuda:0')
action picked by argmax: tensor([209], device='cuda:0')
tensor([[209,  36, 268, 263, 109, 257, 255,  24, 237, 180]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
60          1      210       5        61
336         2      210       4        64
564         3      210       3        19
916         4      210       2        98
1118        5      210       5        27
       user_id  item_id  rating  timestep
12528       46      210       4       244
12569       47      210       4        12
12854       48      210       3        24
13288       49      210       4       185
13535       50      210       5       159
average_rating for this rec across 50 users from same group (less noisy) was: 3.94
all_actions shape just before sample torch.Size([1, 23, 1])
action scaled by temperature: tensor([[109]], device='cuda:0')
action picked by argmax: tensor([209], device='cuda:0')
tensor([[209,  36, 109, 263, 257, 268,  10,  24,  75, 255]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
60          1      210       5        61
336         2      210       4        64
564         3      210       3        19
916         4      210       2        98
1118        5      210       5        27
       user_id  item_id  rating  timestep
12528       46      210       4       244
12569       47      210       4        12
12854       48      210       3        24
13288       49      210       4       185
13535       50      210       5       159
average_rating for this rec across 50 users from same group (less noisy) was: 3.94
all_actions shape just before sample torch.Size([1, 24, 1])
action scaled by temperature: tensor([[58]], device='cuda:0')
action picked by argmax: tensor([10], device='cuda:0')
tensor([[ 10,  75, 109, 187, 257,  36, 237, 180, 209, 223]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
183         1       11       1       184
302         2       11       4        30
616         3       11       3        71
877         4       11       2        59
1096        5       11       3         5
       user_id  item_id  rating  timestep
12340       46       11       2        56
12829       47       11       1       272
12922       48       11       3        92
13155       49       11       2        52
13410       50       11       2        34
average_rating for this rec across 50 users from same group (less noisy) was: 2.2
all_actions shape just before sample torch.Size([1, 25, 1])
action scaled by temperature: tensor([[16]], device='cuda:0')
action picked by argmax: tensor([75], device='cuda:0')
tensor([[ 75, 257, 109, 187,  24, 209,  36, 263,  54, 237]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
76          1       76       5        77
330         2       76       4        58
571         3       76       3        26
915         4       76       4        97
1167        5       76       4        76
       user_id  item_id  rating  timestep
12440       46       76       3       156
12588       47       76       4        31
12957       48       76       3       127
13325       49       76       5       222
13468       50       76       5        92
average_rating for this rec across 50 users from same group (less noisy) was: 4.04
all_actions shape just before sample torch.Size([1, 26, 1])
action scaled by temperature: tensor([[157]], device='cuda:0')
action picked by argmax: tensor([109], device='cuda:0')
tensor([[109,  75, 257,  10,  36, 209, 187, 263, 268, 237]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
132         1      110       4       133
472         2      110       5       200
687         3      110       5       142
910         4      110       5        92
1217        5      110       4       126
       user_id  item_id  rating  timestep
12408       46      110       5       124
12729       47      110       5       172
12956       48      110       5       126
13369       49      110       5       266
13458       50      110       5        82
average_rating for this rec across 50 users from same group (less noisy) was: 4.66
all_actions shape just before sample torch.Size([1, 27, 1])
action scaled by temperature: tensor([[130]], device='cuda:0')
action picked by argmax: tensor([10], device='cuda:0')
tensor([[ 10,  75, 209, 109,  36, 257, 263, 187, 268, 237]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
183         1       11       1       184
302         2       11       4        30
616         3       11       3        71
877         4       11       2        59
1096        5       11       3         5
       user_id  item_id  rating  timestep
12340       46       11       2        56
12829       47       11       1       272
12922       48       11       3        92
13155       49       11       2        52
13410       50       11       2        34
average_rating for this rec across 50 users from same group (less noisy) was: 2.2
all_actions shape just before sample torch.Size([1, 28, 1])
action scaled by temperature: tensor([[47]], device='cuda:0')
action picked by argmax: tensor([209], device='cuda:0')
tensor([[209,  36, 268, 255, 263, 264, 109, 250,  24, 203]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
60          1      210       5        61
336         2      210       4        64
564         3      210       3        19
916         4      210       2        98
1118        5      210       5        27
       user_id  item_id  rating  timestep
12528       46      210       4       244
12569       47      210       4        12
12854       48      210       3        24
13288       49      210       4       185
13535       50      210       5       159
average_rating for this rec across 50 users from same group (less noisy) was: 3.94
all_actions shape just before sample torch.Size([1, 29, 1])
action scaled by temperature: tensor([[54]], device='cuda:0')
action picked by argmax: tensor([209], device='cuda:0')
tensor([[209,  24,  36, 264, 186, 268, 255,  96, 203, 263]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
60          1      210       5        61
336         2      210       4        64
564         3      210       3        19
916         4      210       2        98
1118        5      210       5        27
       user_id  item_id  rating  timestep
12528       46      210       4       244
12569       47      210       4        12
12854       48      210       3        24
13288       49      210       4       185
13535       50      210       5       159
average_rating for this rec across 50 users from same group (less noisy) was: 3.94
all_actions shape just before sample torch.Size([1, 30, 1])
action scaled by temperature: tensor([[269]], device='cuda:0')
action picked by argmax: tensor([40], device='cuda:0')
tensor([[ 40,  30,  39, 158,  37, 205,  10, 111,  74, 183]], device='cuda:0')
Just recommended 30 new items to 50 users from group 1 and the total rating was 93.20000000000003
train_loss is: 5.572816123701122
action scaled by temperature: tensor([[33]], device='cuda:0')
action picked by argmax: tensor([75], device='cuda:0')
tensor([[ 75, 237,  37, 205,  30, 231, 200, 107, 211, 227]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
76          1       76       5        77
330         2       76       4        58
571         3       76       3        26
915         4       76       4        97
1167        5       76       4        76
       user_id  item_id  rating  timestep
12440       46       76       3       156
12588       47       76       4        31
12957       48       76       3       127
13325       49       76       5       222
13468       50       76       5        92
average_rating for this rec across 50 users from same group (less noisy) was: 4.04
all_actions shape just before sample torch.Size([1, 1, 1])
action scaled by temperature: tensor([[183]], device='cuda:0')
action picked by argmax: tensor([75], device='cuda:0')
tensor([[ 75, 237,  37,  10, 205,  30, 157, 257, 107, 200]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
76          1       76       5        77
330         2       76       4        58
571         3       76       3        26
915         4       76       4        97
1167        5       76       4        76
       user_id  item_id  rating  timestep
12440       46       76       3       156
12588       47       76       4        31
12957       48       76       3       127
13325       49       76       5       222
13468       50       76       5        92
average_rating for this rec across 50 users from same group (less noisy) was: 4.04
all_actions shape just before sample torch.Size([1, 2, 1])
action scaled by temperature: tensor([[17]], device='cuda:0')
action picked by argmax: tensor([75], device='cuda:0')
tensor([[ 75, 237,  10, 157,  37, 205,  30, 257, 200, 187]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
76          1       76       5        77
330         2       76       4        58
571         3       76       3        26
915         4       76       4        97
1167        5       76       4        76
       user_id  item_id  rating  timestep
12440       46       76       3       156
12588       47       76       4        31
12957       48       76       3       127
13325       49       76       5       222
13468       50       76       5        92
average_rating for this rec across 50 users from same group (less noisy) was: 4.04
all_actions shape just before sample torch.Size([1, 3, 1])
action scaled by temperature: tensor([[55]], device='cuda:0')
action picked by argmax: tensor([75], device='cuda:0')
tensor([[ 75, 237,  10,  37, 205, 257, 157, 109,  30, 200]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
76          1       76       5        77
330         2       76       4        58
571         3       76       3        26
915         4       76       4        97
1167        5       76       4        76
       user_id  item_id  rating  timestep
12440       46       76       3       156
12588       47       76       4        31
12957       48       76       3       127
13325       49       76       5       222
13468       50       76       5        92
average_rating for this rec across 50 users from same group (less noisy) was: 4.04
all_actions shape just before sample torch.Size([1, 4, 1])
action scaled by temperature: tensor([[153]], device='cuda:0')
action picked by argmax: tensor([75], device='cuda:0')
tensor([[ 75,  10, 237, 157, 257, 205, 109,  37, 200,   4]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
76          1       76       5        77
330         2       76       4        58
571         3       76       3        26
915         4       76       4        97
1167        5       76       4        76
       user_id  item_id  rating  timestep
12440       46       76       3       156
12588       47       76       4        31
12957       48       76       3       127
13325       49       76       5       222
13468       50       76       5        92
average_rating for this rec across 50 users from same group (less noisy) was: 4.04
all_actions shape just before sample torch.Size([1, 5, 1])
action scaled by temperature: tensor([[96]], device='cuda:0')
action picked by argmax: tensor([75], device='cuda:0')
tensor([[ 75,  10, 237, 157, 257, 205,  37, 109, 200,   4]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
76          1       76       5        77
330         2       76       4        58
571         3       76       3        26
915         4       76       4        97
1167        5       76       4        76
       user_id  item_id  rating  timestep
12440       46       76       3       156
12588       47       76       4        31
12957       48       76       3       127
13325       49       76       5       222
13468       50       76       5        92
average_rating for this rec across 50 users from same group (less noisy) was: 4.04
all_actions shape just before sample torch.Size([1, 6, 1])
action scaled by temperature: tensor([[38]], device='cuda:0')
action picked by argmax: tensor([75], device='cuda:0')
tensor([[ 75, 237,  37, 205,  10, 157,  30, 107, 200, 257]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
76          1       76       5        77
330         2       76       4        58
571         3       76       3        26
915         4       76       4        97
1167        5       76       4        76
       user_id  item_id  rating  timestep
12440       46       76       3       156
12588       47       76       4        31
12957       48       76       3       127
13325       49       76       5       222
13468       50       76       5        92
average_rating for this rec across 50 users from same group (less noisy) was: 4.04
all_actions shape just before sample torch.Size([1, 7, 1])
action scaled by temperature: tensor([[13]], device='cuda:0')
action picked by argmax: tensor([75], device='cuda:0')
tensor([[ 75,  10, 237,  37, 205, 157,  30, 257, 200, 109]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
76          1       76       5        77
330         2       76       4        58
571         3       76       3        26
915         4       76       4        97
1167        5       76       4        76
       user_id  item_id  rating  timestep
12440       46       76       3       156
12588       47       76       4        31
12957       48       76       3       127
13325       49       76       5       222
13468       50       76       5        92
average_rating for this rec across 50 users from same group (less noisy) was: 4.04
all_actions shape just before sample torch.Size([1, 8, 1])
action scaled by temperature: tensor([[169]], device='cuda:0')
action picked by argmax: tensor([75], device='cuda:0')
tensor([[ 75, 237,  37,  10, 205,  30, 157, 257, 107, 200]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
76          1       76       5        77
330         2       76       4        58
571         3       76       3        26
915         4       76       4        97
1167        5       76       4        76
       user_id  item_id  rating  timestep
12440       46       76       3       156
12588       47       76       4        31
12957       48       76       3       127
13325       49       76       5       222
13468       50       76       5        92
average_rating for this rec across 50 users from same group (less noisy) was: 4.04
all_actions shape just before sample torch.Size([1, 9, 1])
action scaled by temperature: tensor([[256]], device='cuda:0')
action picked by argmax: tensor([75], device='cuda:0')
tensor([[ 75,  37, 205, 237,  10,  30, 157, 107, 200, 257]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
76          1       76       5        77
330         2       76       4        58
571         3       76       3        26
915         4       76       4        97
1167        5       76       4        76
       user_id  item_id  rating  timestep
12440       46       76       3       156
12588       47       76       4        31
12957       48       76       3       127
13325       49       76       5       222
13468       50       76       5        92
average_rating for this rec across 50 users from same group (less noisy) was: 4.04
all_actions shape just before sample torch.Size([1, 10, 1])
action scaled by temperature: tensor([[28]], device='cuda:0')
action picked by argmax: tensor([75], device='cuda:0')
tensor([[ 75,  37, 205, 237,  30,  10, 107, 157, 200, 257]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
76          1       76       5        77
330         2       76       4        58
571         3       76       3        26
915         4       76       4        97
1167        5       76       4        76
       user_id  item_id  rating  timestep
12440       46       76       3       156
12588       47       76       4        31
12957       48       76       3       127
13325       49       76       5       222
13468       50       76       5        92
average_rating for this rec across 50 users from same group (less noisy) was: 4.04
all_actions shape just before sample torch.Size([1, 11, 1])
action scaled by temperature: tensor([[56]], device='cuda:0')
action picked by argmax: tensor([75], device='cuda:0')
tensor([[ 75,  37, 205, 237,  30,  10, 107, 157, 200, 227]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
76          1       76       5        77
330         2       76       4        58
571         3       76       3        26
915         4       76       4        97
1167        5       76       4        76
       user_id  item_id  rating  timestep
12440       46       76       3       156
12588       47       76       4        31
12957       48       76       3       127
13325       49       76       5       222
13468       50       76       5        92
average_rating for this rec across 50 users from same group (less noisy) was: 4.04
all_actions shape just before sample torch.Size([1, 12, 1])
action scaled by temperature: tensor([[0]], device='cuda:0')
action picked by argmax: tensor([37], device='cuda:0')
tensor([[ 37,  75, 205,  30, 237, 107, 227, 157,  64, 200]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
118         1       38       3       119
455         2       38       2       183
757         3       38       5       212
856         4       38       4        38
1253        5       38       5       162
       user_id  item_id  rating  timestep
12320       46       38       2        36
12622       47       38       3        65
13068       48       38       3       238
13336       49       38       3       233
13466       50       38       5        90
average_rating for this rec across 50 users from same group (less noisy) was: 3.36
all_actions shape just before sample torch.Size([1, 13, 1])
action scaled by temperature: tensor([[8]], device='cuda:0')
action picked by argmax: tensor([75], device='cuda:0')
tensor([[ 75,  37, 205,  30, 237, 107, 227, 157, 200,  10]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
76          1       76       5        77
330         2       76       4        58
571         3       76       3        26
915         4       76       4        97
1167        5       76       4        76
       user_id  item_id  rating  timestep
12440       46       76       3       156
12588       47       76       4        31
12957       48       76       3       127
13325       49       76       5       222
13468       50       76       5        92
average_rating for this rec across 50 users from same group (less noisy) was: 4.04
all_actions shape just before sample torch.Size([1, 14, 1])
action scaled by temperature: tensor([[184]], device='cuda:0')
action picked by argmax: tensor([75], device='cuda:0')
tensor([[ 75,  37, 205, 237,  30,  10, 157, 107, 200, 227]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
76          1       76       5        77
330         2       76       4        58
571         3       76       3        26
915         4       76       4        97
1167        5       76       4        76
       user_id  item_id  rating  timestep
12440       46       76       3       156
12588       47       76       4        31
12957       48       76       3       127
13325       49       76       5       222
13468       50       76       5        92
average_rating for this rec across 50 users from same group (less noisy) was: 4.04
all_actions shape just before sample torch.Size([1, 15, 1])
action scaled by temperature: tensor([[146]], device='cuda:0')
action picked by argmax: tensor([75], device='cuda:0')
tensor([[ 75,  37, 205,  30, 237, 157, 107,  10, 227, 200]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
76          1       76       5        77
330         2       76       4        58
571         3       76       3        26
915         4       76       4        97
1167        5       76       4        76
       user_id  item_id  rating  timestep
12440       46       76       3       156
12588       47       76       4        31
12957       48       76       3       127
13325       49       76       5       222
13468       50       76       5        92
average_rating for this rec across 50 users from same group (less noisy) was: 4.04
all_actions shape just before sample torch.Size([1, 16, 1])
action scaled by temperature: tensor([[120]], device='cuda:0')
action picked by argmax: tensor([75], device='cuda:0')
tensor([[ 75,  37, 205, 237, 107,  30, 157,  10, 200, 227]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
76          1       76       5        77
330         2       76       4        58
571         3       76       3        26
915         4       76       4        97
1167        5       76       4        76
       user_id  item_id  rating  timestep
12440       46       76       3       156
12588       47       76       4        31
12957       48       76       3       127
13325       49       76       5       222
13468       50       76       5        92
average_rating for this rec across 50 users from same group (less noisy) was: 4.04
all_actions shape just before sample torch.Size([1, 17, 1])
action scaled by temperature: tensor([[3]], device='cuda:0')
action picked by argmax: tensor([75], device='cuda:0')
tensor([[ 75, 205,  37, 237, 107, 227, 200,  30, 157, 245]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
76          1       76       5        77
330         2       76       4        58
571         3       76       3        26
915         4       76       4        97
1167        5       76       4        76
       user_id  item_id  rating  timestep
12440       46       76       3       156
12588       47       76       4        31
12957       48       76       3       127
13325       49       76       5       222
13468       50       76       5        92
average_rating for this rec across 50 users from same group (less noisy) was: 4.04
all_actions shape just before sample torch.Size([1, 18, 1])
action scaled by temperature: tensor([[162]], device='cuda:0')
action picked by argmax: tensor([37], device='cuda:0')
tensor([[ 37,  75, 205,  30, 237, 157, 107, 227,  64, 200]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
118         1       38       3       119
455         2       38       2       183
757         3       38       5       212
856         4       38       4        38
1253        5       38       5       162
       user_id  item_id  rating  timestep
12320       46       38       2        36
12622       47       38       3        65
13068       48       38       3       238
13336       49       38       3       233
13466       50       38       5        90
average_rating for this rec across 50 users from same group (less noisy) was: 3.36
all_actions shape just before sample torch.Size([1, 19, 1])
action scaled by temperature: tensor([[234]], device='cuda:0')
action picked by argmax: tensor([75], device='cuda:0')
tensor([[ 75,  37, 205,  30, 157,  10,  64, 237, 158,  40]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
76          1       76       5        77
330         2       76       4        58
571         3       76       3        26
915         4       76       4        97
1167        5       76       4        76
       user_id  item_id  rating  timestep
12440       46       76       3       156
12588       47       76       4        31
12957       48       76       3       127
13325       49       76       5       222
13468       50       76       5        92
average_rating for this rec across 50 users from same group (less noisy) was: 4.04
all_actions shape just before sample torch.Size([1, 20, 1])
action scaled by temperature: tensor([[176]], device='cuda:0')
action picked by argmax: tensor([37], device='cuda:0')
tensor([[ 37,  30, 205,  75,  64, 157, 158,  40,  10, 227]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
118         1       38       3       119
455         2       38       2       183
757         3       38       5       212
856         4       38       4        38
1253        5       38       5       162
       user_id  item_id  rating  timestep
12320       46       38       2        36
12622       47       38       3        65
13068       48       38       3       238
13336       49       38       3       233
13466       50       38       5        90
average_rating for this rec across 50 users from same group (less noisy) was: 3.36
all_actions shape just before sample torch.Size([1, 21, 1])
action scaled by temperature: tensor([[186]], device='cuda:0')
action picked by argmax: tensor([158], device='cuda:0')
tensor([[158,  37,  30,  64, 205,  61, 251,  39, 171, 157]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
129         1      159       3       130
480         2      159       3       208
579         3      159       3        34
1057        4      159       3       239
1270        5      159       2       179
       user_id  item_id  rating  timestep
12525       46      159       5       241
12736       47      159       4       179
12973       48      159       5       143
13326       49      159       4       223
13490       50      159       4       114
average_rating for this rec across 50 users from same group (less noisy) was: 3.6
all_actions shape just before sample torch.Size([1, 22, 1])
action scaled by temperature: tensor([[74]], device='cuda:0')
action picked by argmax: tensor([37], device='cuda:0')
tensor([[ 37, 205,  30,  75,  64, 158, 227, 157,  40, 107]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
118         1       38       3       119
455         2       38       2       183
757         3       38       5       212
856         4       38       4        38
1253        5       38       5       162
       user_id  item_id  rating  timestep
12320       46       38       2        36
12622       47       38       3        65
13068       48       38       3       238
13336       49       38       3       233
13466       50       38       5        90
average_rating for this rec across 50 users from same group (less noisy) was: 3.36
all_actions shape just before sample torch.Size([1, 23, 1])
action scaled by temperature: tensor([[2]], device='cuda:0')
action picked by argmax: tensor([37], device='cuda:0')
tensor([[ 37,  75,  30, 205, 157,  64,  10, 158, 237, 227]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
118         1       38       3       119
455         2       38       2       183
757         3       38       5       212
856         4       38       4        38
1253        5       38       5       162
       user_id  item_id  rating  timestep
12320       46       38       2        36
12622       47       38       3        65
13068       48       38       3       238
13336       49       38       3       233
13466       50       38       5        90
average_rating for this rec across 50 users from same group (less noisy) was: 3.36
all_actions shape just before sample torch.Size([1, 24, 1])
action scaled by temperature: tensor([[5]], device='cuda:0')
action picked by argmax: tensor([37], device='cuda:0')
tensor([[ 37, 205,  30, 227,  75, 158,  64, 107,  40,  61]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
118         1       38       3       119
455         2       38       2       183
757         3       38       5       212
856         4       38       4        38
1253        5       38       5       162
       user_id  item_id  rating  timestep
12320       46       38       2        36
12622       47       38       3        65
13068       48       38       3       238
13336       49       38       3       233
13466       50       38       5        90
average_rating for this rec across 50 users from same group (less noisy) was: 3.36
all_actions shape just before sample torch.Size([1, 25, 1])
action scaled by temperature: tensor([[160]], device='cuda:0')
action picked by argmax: tensor([37], device='cuda:0')
tensor([[ 37, 205,  30, 227, 158,  64,  75, 107,  40, 157]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
118         1       38       3       119
455         2       38       2       183
757         3       38       5       212
856         4       38       4        38
1253        5       38       5       162
       user_id  item_id  rating  timestep
12320       46       38       2        36
12622       47       38       3        65
13068       48       38       3       238
13336       49       38       3       233
13466       50       38       5        90
average_rating for this rec across 50 users from same group (less noisy) was: 3.36
all_actions shape just before sample torch.Size([1, 26, 1])
action scaled by temperature: tensor([[64]], device='cuda:0')
action picked by argmax: tensor([37], device='cuda:0')
tensor([[ 37, 205,  30, 158,  64, 157,  75, 227,  40,  61]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
118         1       38       3       119
455         2       38       2       183
757         3       38       5       212
856         4       38       4        38
1253        5       38       5       162
       user_id  item_id  rating  timestep
12320       46       38       2        36
12622       47       38       3        65
13068       48       38       3       238
13336       49       38       3       233
13466       50       38       5        90
average_rating for this rec across 50 users from same group (less noisy) was: 3.36
all_actions shape just before sample torch.Size([1, 27, 1])
action scaled by temperature: tensor([[24]], device='cuda:0')
action picked by argmax: tensor([158], device='cuda:0')
tensor([[158,  37,  64,  30, 205, 157,  40,  61, 251,  39]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
129         1      159       3       130
480         2      159       3       208
579         3      159       3        34
1057        4      159       3       239
1270        5      159       2       179
       user_id  item_id  rating  timestep
12525       46      159       5       241
12736       47      159       4       179
12973       48      159       5       143
13326       49      159       4       223
13490       50      159       4       114
average_rating for this rec across 50 users from same group (less noisy) was: 3.6
all_actions shape just before sample torch.Size([1, 28, 1])
action scaled by temperature: tensor([[171]], device='cuda:0')
action picked by argmax: tensor([171], device='cuda:0')
tensor([[171, 153,  30,  74, 158,  37, 111,  39,  61, 205]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
6           1      172       4         7
376         2      172       4       104
568         3      172       3        23
964         4      172       4       146
1252        5      172       4       161
       user_id  item_id  rating  timestep
12301       46      172       3        17
12572       47      172       4        15
13077       48      172       4       247
13163       49      172       4        60
13546       50      172       3       170
average_rating for this rec across 50 users from same group (less noisy) was: 4.08
all_actions shape just before sample torch.Size([1, 29, 1])
action scaled by temperature: tensor([[89]], device='cuda:0')
action picked by argmax: tensor([171], device='cuda:0')
tensor([[171, 153,  74, 111, 195,  30,  39,  63, 158,  37]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
6           1      172       4         7
376         2      172       4       104
568         3      172       3        23
964         4      172       4       146
1252        5      172       4       161
       user_id  item_id  rating  timestep
12301       46      172       3        17
12572       47      172       4        15
13077       48      172       4       247
13163       49      172       4        60
13546       50      172       3       170
average_rating for this rec across 50 users from same group (less noisy) was: 4.08
all_actions shape just before sample torch.Size([1, 30, 1])
action scaled by temperature: tensor([[218]], device='cuda:0')
action picked by argmax: tensor([171], device='cuda:0')
tensor([[171,  30, 153,  37, 111, 227, 205,  28,  61, 158]], device='cuda:0')
Just recommended 30 new items to 50 users from group 1 and the total rating was 114.96
train_loss is: 5.544280947071233
action scaled by temperature: tensor([[76]], device='cuda:0')
action picked by argmax: tensor([237], device='cuda:0')
tensor([[237, 231,  75,  83, 211, 187,  54, 196,  37,  35]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
228         1      238       4       229
475         2      238       3       203
719         3      238       3       174
860         4      238       5        42
1166        5      238       5        75
       user_id  item_id  rating  timestep
12462       46      238       3       178
12618       47      238       4        61
13000       48      238       5       170
13192       49      238       3        89
13431       50      238       5        55
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 1, 1])
action scaled by temperature: tensor([[247]], device='cuda:0')
action picked by argmax: tensor([237], device='cuda:0')
tensor([[237,  75,  30,  37, 231, 211, 187,  54,  83, 252]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
228         1      238       4       229
475         2      238       3       203
719         3      238       3       174
860         4      238       5        42
1166        5      238       5        75
       user_id  item_id  rating  timestep
12462       46      238       3       178
12618       47      238       4        61
13000       48      238       5       170
13192       49      238       3        89
13431       50      238       5        55
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 2, 1])
action scaled by temperature: tensor([[195]], device='cuda:0')
action picked by argmax: tensor([237], device='cuda:0')
tensor([[237,  75, 231,  37, 211,  83, 187,  30,  54, 157]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
228         1      238       4       229
475         2      238       3       203
719         3      238       3       174
860         4      238       5        42
1166        5      238       5        75
       user_id  item_id  rating  timestep
12462       46      238       3       178
12618       47      238       4        61
13000       48      238       5       170
13192       49      238       3        89
13431       50      238       5        55
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 3, 1])
action scaled by temperature: tensor([[89]], device='cuda:0')
action picked by argmax: tensor([75], device='cuda:0')
tensor([[ 75, 237,  37, 231,  83, 187,  30, 157, 211, 205]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
76          1       76       5        77
330         2       76       4        58
571         3       76       3        26
915         4       76       4        97
1167        5       76       4        76
       user_id  item_id  rating  timestep
12440       46       76       3       156
12588       47       76       4        31
12957       48       76       3       127
13325       49       76       5       222
13468       50       76       5        92
average_rating for this rec across 50 users from same group (less noisy) was: 4.04
all_actions shape just before sample torch.Size([1, 4, 1])
action scaled by temperature: tensor([[242]], device='cuda:0')
action picked by argmax: tensor([75], device='cuda:0')
tensor([[ 75, 237,  10, 157, 211,  37, 205, 231,  30,   4]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
76          1       76       5        77
330         2       76       4        58
571         3       76       3        26
915         4       76       4        97
1167        5       76       4        76
       user_id  item_id  rating  timestep
12440       46       76       3       156
12588       47       76       4        31
12957       48       76       3       127
13325       49       76       5       222
13468       50       76       5        92
average_rating for this rec across 50 users from same group (less noisy) was: 4.04
all_actions shape just before sample torch.Size([1, 5, 1])
action scaled by temperature: tensor([[235]], device='cuda:0')
action picked by argmax: tensor([75], device='cuda:0')
tensor([[ 75, 237,  10, 157,  37, 205,  30, 211, 231,   4]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
76          1       76       5        77
330         2       76       4        58
571         3       76       3        26
915         4       76       4        97
1167        5       76       4        76
       user_id  item_id  rating  timestep
12440       46       76       3       156
12588       47       76       4        31
12957       48       76       3       127
13325       49       76       5       222
13468       50       76       5        92
average_rating for this rec across 50 users from same group (less noisy) was: 4.04
all_actions shape just before sample torch.Size([1, 6, 1])
action scaled by temperature: tensor([[70]], device='cuda:0')
action picked by argmax: tensor([75], device='cuda:0')
tensor([[ 75,  37,  30, 237, 157,  10, 205, 227, 231, 211]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
76          1       76       5        77
330         2       76       4        58
571         3       76       3        26
915         4       76       4        97
1167        5       76       4        76
       user_id  item_id  rating  timestep
12440       46       76       3       156
12588       47       76       4        31
12957       48       76       3       127
13325       49       76       5       222
13468       50       76       5        92
average_rating for this rec across 50 users from same group (less noisy) was: 4.04
all_actions shape just before sample torch.Size([1, 7, 1])
action scaled by temperature: tensor([[64]], device='cuda:0')
action picked by argmax: tensor([75], device='cuda:0')
tensor([[ 75, 237,  10, 157,  37, 205,  30, 211,   4, 231]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
76          1       76       5        77
330         2       76       4        58
571         3       76       3        26
915         4       76       4        97
1167        5       76       4        76
       user_id  item_id  rating  timestep
12440       46       76       3       156
12588       47       76       4        31
12957       48       76       3       127
13325       49       76       5       222
13468       50       76       5        92
average_rating for this rec across 50 users from same group (less noisy) was: 4.04
all_actions shape just before sample torch.Size([1, 8, 1])
action scaled by temperature: tensor([[178]], device='cuda:0')
action picked by argmax: tensor([75], device='cuda:0')
tensor([[ 75,  37,  30, 237, 205, 227, 157,  10, 231, 211]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
76          1       76       5        77
330         2       76       4        58
571         3       76       3        26
915         4       76       4        97
1167        5       76       4        76
       user_id  item_id  rating  timestep
12440       46       76       3       156
12588       47       76       4        31
12957       48       76       3       127
13325       49       76       5       222
13468       50       76       5        92
average_rating for this rec across 50 users from same group (less noisy) was: 4.04
all_actions shape just before sample torch.Size([1, 9, 1])
action scaled by temperature: tensor([[241]], device='cuda:0')
action picked by argmax: tensor([75], device='cuda:0')
tensor([[ 75,  37,  30, 157, 237, 205,  10, 227, 187, 211]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
76          1       76       5        77
330         2       76       4        58
571         3       76       3        26
915         4       76       4        97
1167        5       76       4        76
       user_id  item_id  rating  timestep
12440       46       76       3       156
12588       47       76       4        31
12957       48       76       3       127
13325       49       76       5       222
13468       50       76       5        92
average_rating for this rec across 50 users from same group (less noisy) was: 4.04
all_actions shape just before sample torch.Size([1, 10, 1])
action scaled by temperature: tensor([[14]], device='cuda:0')
action picked by argmax: tensor([75], device='cuda:0')
tensor([[ 75,  37,  30, 205, 237, 157,  10, 227, 231, 211]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
76          1       76       5        77
330         2       76       4        58
571         3       76       3        26
915         4       76       4        97
1167        5       76       4        76
       user_id  item_id  rating  timestep
12440       46       76       3       156
12588       47       76       4        31
12957       48       76       3       127
13325       49       76       5       222
13468       50       76       5        92
average_rating for this rec across 50 users from same group (less noisy) was: 4.04
all_actions shape just before sample torch.Size([1, 11, 1])
action scaled by temperature: tensor([[193]], device='cuda:0')
action picked by argmax: tensor([37], device='cuda:0')
tensor([[ 37,  75,  30, 227, 205, 237, 157, 231,  28,  10]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
118         1       38       3       119
455         2       38       2       183
757         3       38       5       212
856         4       38       4        38
1253        5       38       5       162
       user_id  item_id  rating  timestep
12320       46       38       2        36
12622       47       38       3        65
13068       48       38       3       238
13336       49       38       3       233
13466       50       38       5        90
average_rating for this rec across 50 users from same group (less noisy) was: 3.36
all_actions shape just before sample torch.Size([1, 12, 1])
action scaled by temperature: tensor([[192]], device='cuda:0')
action picked by argmax: tensor([37], device='cuda:0')
tensor([[ 37,  75,  30, 227, 205, 237, 157, 231,  10,  28]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
118         1       38       3       119
455         2       38       2       183
757         3       38       5       212
856         4       38       4        38
1253        5       38       5       162
       user_id  item_id  rating  timestep
12320       46       38       2        36
12622       47       38       3        65
13068       48       38       3       238
13336       49       38       3       233
13466       50       38       5        90
average_rating for this rec across 50 users from same group (less noisy) was: 3.36
all_actions shape just before sample torch.Size([1, 13, 1])
action scaled by temperature: tensor([[35]], device='cuda:0')
action picked by argmax: tensor([75], device='cuda:0')
tensor([[ 75,  37,  30, 227, 237, 205, 157, 231,  10,  28]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
76          1       76       5        77
330         2       76       4        58
571         3       76       3        26
915         4       76       4        97
1167        5       76       4        76
       user_id  item_id  rating  timestep
12440       46       76       3       156
12588       47       76       4        31
12957       48       76       3       127
13325       49       76       5       222
13468       50       76       5        92
average_rating for this rec across 50 users from same group (less noisy) was: 4.04
all_actions shape just before sample torch.Size([1, 14, 1])
action scaled by temperature: tensor([[11]], device='cuda:0')
action picked by argmax: tensor([75], device='cuda:0')
tensor([[ 75,  37,  30, 205, 157, 227, 237,  10, 231, 107]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
76          1       76       5        77
330         2       76       4        58
571         3       76       3        26
915         4       76       4        97
1167        5       76       4        76
       user_id  item_id  rating  timestep
12440       46       76       3       156
12588       47       76       4        31
12957       48       76       3       127
13325       49       76       5       222
13468       50       76       5        92
average_rating for this rec across 50 users from same group (less noisy) was: 4.04
all_actions shape just before sample torch.Size([1, 15, 1])
action scaled by temperature: tensor([[91]], device='cuda:0')
action picked by argmax: tensor([75], device='cuda:0')
tensor([[ 75,  37,  30, 237, 227, 157, 205,  10, 231,  28]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
76          1       76       5        77
330         2       76       4        58
571         3       76       3        26
915         4       76       4        97
1167        5       76       4        76
       user_id  item_id  rating  timestep
12440       46       76       3       156
12588       47       76       4        31
12957       48       76       3       127
13325       49       76       5       222
13468       50       76       5        92
average_rating for this rec across 50 users from same group (less noisy) was: 4.04
all_actions shape just before sample torch.Size([1, 16, 1])
action scaled by temperature: tensor([[227]], device='cuda:0')
action picked by argmax: tensor([75], device='cuda:0')
tensor([[ 75,  37, 205, 237,  30, 157, 227,  10, 231, 107]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
76          1       76       5        77
330         2       76       4        58
571         3       76       3        26
915         4       76       4        97
1167        5       76       4        76
       user_id  item_id  rating  timestep
12440       46       76       3       156
12588       47       76       4        31
12957       48       76       3       127
13325       49       76       5       222
13468       50       76       5        92
average_rating for this rec across 50 users from same group (less noisy) was: 4.04
all_actions shape just before sample torch.Size([1, 17, 1])
action scaled by temperature: tensor([[212]], device='cuda:0')
action picked by argmax: tensor([75], device='cuda:0')
tensor([[ 75,  37, 237, 205, 227, 231,  30, 157,  88, 107]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
76          1       76       5        77
330         2       76       4        58
571         3       76       3        26
915         4       76       4        97
1167        5       76       4        76
       user_id  item_id  rating  timestep
12440       46       76       3       156
12588       47       76       4        31
12957       48       76       3       127
13325       49       76       5       222
13468       50       76       5        92
average_rating for this rec across 50 users from same group (less noisy) was: 4.04
all_actions shape just before sample torch.Size([1, 18, 1])
action scaled by temperature: tensor([[257]], device='cuda:0')
action picked by argmax: tensor([37], device='cuda:0')
tensor([[ 37,  75,  30, 227, 157, 205, 237,  10, 231,  28]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
118         1       38       3       119
455         2       38       2       183
757         3       38       5       212
856         4       38       4        38
1253        5       38       5       162
       user_id  item_id  rating  timestep
12320       46       38       2        36
12622       47       38       3        65
13068       48       38       3       238
13336       49       38       3       233
13466       50       38       5        90
average_rating for this rec across 50 users from same group (less noisy) was: 3.36
all_actions shape just before sample torch.Size([1, 19, 1])
action scaled by temperature: tensor([[37]], device='cuda:0')
action picked by argmax: tensor([75], device='cuda:0')
tensor([[ 75,  37,  30, 157, 205, 227, 237,  10, 231,  64]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
76          1       76       5        77
330         2       76       4        58
571         3       76       3        26
915         4       76       4        97
1167        5       76       4        76
       user_id  item_id  rating  timestep
12440       46       76       3       156
12588       47       76       4        31
12957       48       76       3       127
13325       49       76       5       222
13468       50       76       5        92
average_rating for this rec across 50 users from same group (less noisy) was: 4.04
all_actions shape just before sample torch.Size([1, 20, 1])
action scaled by temperature: tensor([[5]], device='cuda:0')
action picked by argmax: tensor([37], device='cuda:0')
tensor([[ 37,  75,  30, 205, 227, 157, 237, 231, 107,  10]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
118         1       38       3       119
455         2       38       2       183
757         3       38       5       212
856         4       38       4        38
1253        5       38       5       162
       user_id  item_id  rating  timestep
12320       46       38       2        36
12622       47       38       3        65
13068       48       38       3       238
13336       49       38       3       233
13466       50       38       5        90
average_rating for this rec across 50 users from same group (less noisy) was: 3.36
all_actions shape just before sample torch.Size([1, 21, 1])
action scaled by temperature: tensor([[228]], device='cuda:0')
action picked by argmax: tensor([37], device='cuda:0')
tensor([[ 37,  30, 227, 157, 205,  75, 158,  64, 231,  28]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
118         1       38       3       119
455         2       38       2       183
757         3       38       5       212
856         4       38       4        38
1253        5       38       5       162
       user_id  item_id  rating  timestep
12320       46       38       2        36
12622       47       38       3        65
13068       48       38       3       238
13336       49       38       3       233
13466       50       38       5        90
average_rating for this rec across 50 users from same group (less noisy) was: 3.36
all_actions shape just before sample torch.Size([1, 22, 1])
action scaled by temperature: tensor([[146]], device='cuda:0')
action picked by argmax: tensor([37], device='cuda:0')
tensor([[ 37,  30,  75, 227, 157, 205, 237, 231, 158,  10]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
118         1       38       3       119
455         2       38       2       183
757         3       38       5       212
856         4       38       4        38
1253        5       38       5       162
       user_id  item_id  rating  timestep
12320       46       38       2        36
12622       47       38       3        65
13068       48       38       3       238
13336       49       38       3       233
13466       50       38       5        90
average_rating for this rec across 50 users from same group (less noisy) was: 3.36
all_actions shape just before sample torch.Size([1, 23, 1])
action scaled by temperature: tensor([[195]], device='cuda:0')
action picked by argmax: tensor([37], device='cuda:0')
tensor([[ 37, 157,  30,  75, 205, 227,  10,  64, 158, 237]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
118         1       38       3       119
455         2       38       2       183
757         3       38       5       212
856         4       38       4        38
1253        5       38       5       162
       user_id  item_id  rating  timestep
12320       46       38       2        36
12622       47       38       3        65
13068       48       38       3       238
13336       49       38       3       233
13466       50       38       5        90
average_rating for this rec across 50 users from same group (less noisy) was: 3.36
all_actions shape just before sample torch.Size([1, 24, 1])
action scaled by temperature: tensor([[66]], device='cuda:0')
action picked by argmax: tensor([37], device='cuda:0')
tensor([[ 37,  30, 157, 158,  64, 205, 227,  40,  75,  10]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
118         1       38       3       119
455         2       38       2       183
757         3       38       5       212
856         4       38       4        38
1253        5       38       5       162
       user_id  item_id  rating  timestep
12320       46       38       2        36
12622       47       38       3        65
13068       48       38       3       238
13336       49       38       3       233
13466       50       38       5        90
average_rating for this rec across 50 users from same group (less noisy) was: 3.36
all_actions shape just before sample torch.Size([1, 25, 1])
action scaled by temperature: tensor([[90]], device='cuda:0')
action picked by argmax: tensor([37], device='cuda:0')
tensor([[ 37,  30, 227,  75, 157, 205, 237, 158,  64,  10]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
118         1       38       3       119
455         2       38       2       183
757         3       38       5       212
856         4       38       4        38
1253        5       38       5       162
       user_id  item_id  rating  timestep
12320       46       38       2        36
12622       47       38       3        65
13068       48       38       3       238
13336       49       38       3       233
13466       50       38       5        90
average_rating for this rec across 50 users from same group (less noisy) was: 3.36
all_actions shape just before sample torch.Size([1, 26, 1])
action scaled by temperature: tensor([[12]], device='cuda:0')
action picked by argmax: tensor([157], device='cuda:0')
tensor([[157,  37,  30, 158,  64,  10, 227, 205,  75,  40]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
156         1      158       4       157
496         2      158       5       224
798         3      158       4       253
1015        4      158       4       197
1351        5      158       4       260
       user_id  item_id  rating  timestep
12457       46      158       4       173
12809       47      158       5       252
13046       48      158       5       216
13322       49      158       3       219
13399       50      158       5        23
average_rating for this rec across 50 users from same group (less noisy) was: 4.42
all_actions shape just before sample torch.Size([1, 27, 1])
action scaled by temperature: tensor([[149]], device='cuda:0')
action picked by argmax: tensor([268], device='cuda:0')
tensor([[268, 189,   0,  56,  96,  77, 173, 124, 167, 197]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
146         1      269       5       147
338         2      269       4        66
695         3      269       5       150
1049        4      269       5       231
1295        5      269       4       204
       user_id  item_id  rating  timestep
12474       46      269       4       190
12685       47      269       5       128
13091       48      269       4       261
13338       49      269       4       235
13558       50      269       5       182
average_rating for this rec across 50 users from same group (less noisy) was: 4.12
all_actions shape just before sample torch.Size([1, 28, 1])
action scaled by temperature: tensor([[207]], device='cuda:0')
action picked by argmax: tensor([96], device='cuda:0')
tensor([[ 96, 268, 210, 189,  99, 173, 247, 122, 124,  77]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
46          1       97       5        47
363         2       97       4        91
656         3       97       5       111
1059        4       97       4       241
1138        5       97       5        47
       user_id  item_id  rating  timestep
12431       46       97       5       147
12715       47       97       5       158
12880       48       97       5        50
13198       49       97       5        95
13414       50       97       4        38
average_rating for this rec across 50 users from same group (less noisy) was: 4.5
all_actions shape just before sample torch.Size([1, 29, 1])
action scaled by temperature: tensor([[67]], device='cuda:0')
action picked by argmax: tensor([124], device='cuda:0')
tensor([[124,  99, 268, 122, 167, 210, 173, 266,  56,   0]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
203         1      125       3       204
439         2      125       5       167
584         3      125       5        39
959         4      125       5       141
1123        5      125       3        32
       user_id  item_id  rating  timestep
12347       46      125       4        63
12670       47      125       5       113
13037       48      125       3       207
13144       49      125       4        41
13613       50      125       5       237
average_rating for this rec across 50 users from same group (less noisy) was: 3.92
all_actions shape just before sample torch.Size([1, 30, 1])
action scaled by temperature: tensor([[146]], device='cuda:0')
action picked by argmax: tensor([210], device='cuda:0')
tensor([[210, 266, 132, 264, 235, 149,  60, 247, 186,  35]], device='cuda:0')
Just recommended 30 new items to 50 users from group 1 and the total rating was 115.94000000000001
train_loss is: 5.52362474458947
action scaled by temperature: tensor([[35]], device='cuda:0')
action picked by argmax: tensor([237], device='cuda:0')
tensor([[237,  83, 231, 187,  35,  54, 117, 211,  75, 186]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
228         1      238       4       229
475         2      238       3       203
719         3      238       3       174
860         4      238       5        42
1166        5      238       5        75
       user_id  item_id  rating  timestep
12462       46      238       3       178
12618       47      238       4        61
13000       48      238       5       170
13192       49      238       3        89
13431       50      238       5        55
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 1, 1])
action scaled by temperature: tensor([[80]], device='cuda:0')
action picked by argmax: tensor([30], device='cuda:0')
tensor([[ 30, 237, 187, 231,  75,  37,  28,  54, 117,  83]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
31          1       31       4        32
538         2       31       4       266
740         3       31       4       195
1053        4       31       5       235
1186        5       31       5        95
       user_id  item_id  rating  timestep
12404       46       31       5       120
12738       47       31       5       181
12892       48       31       5        62
13137       49       31       5        34
13462       50       31       4        86
average_rating for this rec across 50 users from same group (less noisy) was: 4.8
all_actions shape just before sample torch.Size([1, 2, 1])
action scaled by temperature: tensor([[239]], device='cuda:0')
action picked by argmax: tensor([237], device='cuda:0')
tensor([[237, 231,  75, 187,  83,  30,  37,  54,  28, 117]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
228         1      238       4       229
475         2      238       3       203
719         3      238       3       174
860         4      238       5        42
1166        5      238       5        75
       user_id  item_id  rating  timestep
12462       46      238       3       178
12618       47      238       4        61
13000       48      238       5       170
13192       49      238       3        89
13431       50      238       5        55
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 3, 1])
action scaled by temperature: tensor([[167]], device='cuda:0')
action picked by argmax: tensor([30], device='cuda:0')
tensor([[ 30,  37, 227, 237, 231,  28, 187,  75,  83, 205]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
31          1       31       4        32
538         2       31       4       266
740         3       31       4       195
1053        4       31       5       235
1186        5       31       5        95
       user_id  item_id  rating  timestep
12404       46       31       5       120
12738       47       31       5       181
12892       48       31       5        62
13137       49       31       5        34
13462       50       31       4        86
average_rating for this rec across 50 users from same group (less noisy) was: 4.8
all_actions shape just before sample torch.Size([1, 4, 1])
action scaled by temperature: tensor([[115]], device='cuda:0')
action picked by argmax: tensor([231], device='cuda:0')
tensor([[231, 187, 237,  75,  83,  37,  30, 227,  28, 205]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
250         1      232       4       251
469         2      232       4       197
557         3      232       4        12
922         4      232       5       104
1265        5      232       5       174
       user_id  item_id  rating  timestep
12299       46      232       5        15
12815       47      232       3       258
12865       48      232       4        35
13142       49      232       5        39
13469       50      232       3        93
average_rating for this rec across 50 users from same group (less noisy) was: 4.38
all_actions shape just before sample torch.Size([1, 5, 1])
action scaled by temperature: tensor([[122]], device='cuda:0')
action picked by argmax: tensor([30], device='cuda:0')
tensor([[ 30,  37, 227,  28,  75, 237, 187, 205, 231, 107]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
31          1       31       4        32
538         2       31       4       266
740         3       31       4       195
1053        4       31       5       235
1186        5       31       5        95
       user_id  item_id  rating  timestep
12404       46       31       5       120
12738       47       31       5       181
12892       48       31       5        62
13137       49       31       5        34
13462       50       31       4        86
average_rating for this rec across 50 users from same group (less noisy) was: 4.8
all_actions shape just before sample torch.Size([1, 6, 1])
action scaled by temperature: tensor([[267]], device='cuda:0')
action picked by argmax: tensor([37], device='cuda:0')
tensor([[ 37, 227,  30,  28,  39, 151, 187,  84, 107, 137]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
118         1       38       3       119
455         2       38       2       183
757         3       38       5       212
856         4       38       4        38
1253        5       38       5       162
       user_id  item_id  rating  timestep
12320       46       38       2        36
12622       47       38       3        65
13068       48       38       3       238
13336       49       38       3       233
13466       50       38       5        90
average_rating for this rec across 50 users from same group (less noisy) was: 3.36
all_actions shape just before sample torch.Size([1, 7, 1])
action scaled by temperature: tensor([[131]], device='cuda:0')
action picked by argmax: tensor([37], device='cuda:0')
tensor([[ 37,  30, 227,  28,  39, 137, 205,  21, 148, 111]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
118         1       38       3       119
455         2       38       2       183
757         3       38       5       212
856         4       38       4        38
1253        5       38       5       162
       user_id  item_id  rating  timestep
12320       46       38       2        36
12622       47       38       3        65
13068       48       38       3       238
13336       49       38       3       233
13466       50       38       5        90
average_rating for this rec across 50 users from same group (less noisy) was: 3.36
all_actions shape just before sample torch.Size([1, 8, 1])
action scaled by temperature: tensor([[261]], device='cuda:0')
action picked by argmax: tensor([37], device='cuda:0')
tensor([[ 37,  30, 227,  28,  39, 137, 111,  84, 148,   0]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
118         1       38       3       119
455         2       38       2       183
757         3       38       5       212
856         4       38       4        38
1253        5       38       5       162
       user_id  item_id  rating  timestep
12320       46       38       2        36
12622       47       38       3        65
13068       48       38       3       238
13336       49       38       3       233
13466       50       38       5        90
average_rating for this rec across 50 users from same group (less noisy) was: 3.36
all_actions shape just before sample torch.Size([1, 9, 1])
action scaled by temperature: tensor([[115]], device='cuda:0')
action picked by argmax: tensor([37], device='cuda:0')
tensor([[ 37, 227,  30,  39,  28, 111, 137, 148,   0,  84]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
118         1       38       3       119
455         2       38       2       183
757         3       38       5       212
856         4       38       4        38
1253        5       38       5       162
       user_id  item_id  rating  timestep
12320       46       38       2        36
12622       47       38       3        65
13068       48       38       3       238
13336       49       38       3       233
13466       50       38       5        90
average_rating for this rec across 50 users from same group (less noisy) was: 3.36
all_actions shape just before sample torch.Size([1, 10, 1])
action scaled by temperature: tensor([[69]], device='cuda:0')
action picked by argmax: tensor([37], device='cuda:0')
tensor([[ 37, 227,  30,  28,  39,   0, 137, 148, 111,  84]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
118         1       38       3       119
455         2       38       2       183
757         3       38       5       212
856         4       38       4        38
1253        5       38       5       162
       user_id  item_id  rating  timestep
12320       46       38       2        36
12622       47       38       3        65
13068       48       38       3       238
13336       49       38       3       233
13466       50       38       5        90
average_rating for this rec across 50 users from same group (less noisy) was: 3.36
all_actions shape just before sample torch.Size([1, 11, 1])
action scaled by temperature: tensor([[18]], device='cuda:0')
action picked by argmax: tensor([227], device='cuda:0')
tensor([[227,  37,  30,  39, 111, 148,  28,   0, 171, 137]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
205         1      228       4       206
490         2      228       3       218
663         3      228       3       118
1070        4      228       2       252
1271        5      228       3       180
       user_id  item_id  rating  timestep
12329       46      228       4        45
12703       47      228       3       146
12879       48      228       5        49
13111       49      228       2         8
13530       50      228       4       154
average_rating for this rec across 50 users from same group (less noisy) was: 3.34
all_actions shape just before sample torch.Size([1, 12, 1])
action scaled by temperature: tensor([[108]], device='cuda:0')
action picked by argmax: tensor([111], device='cuda:0')
tensor([[111, 120, 153,  39, 171,  74, 148,  37,  30, 106]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
271         1      112       4       272
479         2      112       5       207
553         3      112       5         8
1041        4      112       5       223
1094        5      112       5         3
       user_id  item_id  rating  timestep
12382       46      112       5        98
12566       47      112       5         9
12954       48      112       4       124
13319       49      112       4       216
13388       50      112       5        12
average_rating for this rec across 50 users from same group (less noisy) was: 4.7
all_actions shape just before sample torch.Size([1, 13, 1])
action scaled by temperature: tensor([[28]], device='cuda:0')
action picked by argmax: tensor([37], device='cuda:0')
tensor([[ 37, 111,  39, 171,  30, 148, 227, 153, 106, 120]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
118         1       38       3       119
455         2       38       2       183
757         3       38       5       212
856         4       38       4        38
1253        5       38       5       162
       user_id  item_id  rating  timestep
12320       46       38       2        36
12622       47       38       3        65
13068       48       38       3       238
13336       49       38       3       233
13466       50       38       5        90
average_rating for this rec across 50 users from same group (less noisy) was: 3.36
all_actions shape just before sample torch.Size([1, 14, 1])
action scaled by temperature: tensor([[183]], device='cuda:0')
action picked by argmax: tensor([111], device='cuda:0')
tensor([[111,  37, 120,  39, 153, 171,  74, 148,  30, 106]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
271         1      112       4       272
479         2      112       5       207
553         3      112       5         8
1041        4      112       5       223
1094        5      112       5         3
       user_id  item_id  rating  timestep
12382       46      112       5        98
12566       47      112       5         9
12954       48      112       4       124
13319       49      112       4       216
13388       50      112       5        12
average_rating for this rec across 50 users from same group (less noisy) was: 4.7
all_actions shape just before sample torch.Size([1, 15, 1])
action scaled by temperature: tensor([[95]], device='cuda:0')
action picked by argmax: tensor([111], device='cuda:0')
tensor([[111,  37, 120,  39,  74, 148, 153, 171,  30, 106]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
271         1      112       4       272
479         2      112       5       207
553         3      112       5         8
1041        4      112       5       223
1094        5      112       5         3
       user_id  item_id  rating  timestep
12382       46      112       5        98
12566       47      112       5         9
12954       48      112       4       124
13319       49      112       4       216
13388       50      112       5        12
average_rating for this rec across 50 users from same group (less noisy) was: 4.7
all_actions shape just before sample torch.Size([1, 16, 1])
action scaled by temperature: tensor([[211]], device='cuda:0')
action picked by argmax: tensor([111], device='cuda:0')
tensor([[111, 120,  74, 171, 153,  39, 148,  37, 106,  63]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
271         1      112       4       272
479         2      112       5       207
553         3      112       5         8
1041        4      112       5       223
1094        5      112       5         3
       user_id  item_id  rating  timestep
12382       46      112       5        98
12566       47      112       5         9
12954       48      112       4       124
13319       49      112       4       216
13388       50      112       5        12
average_rating for this rec across 50 users from same group (less noisy) was: 4.7
all_actions shape just before sample torch.Size([1, 17, 1])
action scaled by temperature: tensor([[260]], device='cuda:0')
action picked by argmax: tensor([74], device='cuda:0')
tensor([[ 74, 111, 120, 106, 171, 153,  63, 148,  39, 195]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
195         1       75       5       196
284         2       75       5        12
737         3       75       5       192
1026        4       75       4       208
1111        5       75       3        20
       user_id  item_id  rating  timestep
12410       46       75       5       126
12652       47       75       3        95
12974       48       75       3       144
13348       49       75       2       245
13573       50       75       4       197
average_rating for this rec across 50 users from same group (less noisy) was: 3.6
all_actions shape just before sample torch.Size([1, 18, 1])
action scaled by temperature: tensor([[264]], device='cuda:0')
action picked by argmax: tensor([227], device='cuda:0')
tensor([[227,  37,  30, 171, 111,  39, 148,   0, 106, 239]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
205         1      228       4       206
490         2      228       3       218
663         3      228       3       118
1070        4      228       2       252
1271        5      228       3       180
       user_id  item_id  rating  timestep
12329       46      228       4        45
12703       47      228       3       146
12879       48      228       5        49
13111       49      228       2         8
13530       50      228       4       154
average_rating for this rec across 50 users from same group (less noisy) was: 3.34
all_actions shape just before sample torch.Size([1, 19, 1])
action scaled by temperature: tensor([[171]], device='cuda:0')
action picked by argmax: tensor([171], device='cuda:0')
tensor([[171, 153, 148,  37, 106,  39,   0, 158, 111, 251]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
6           1      172       4         7
376         2      172       4       104
568         3      172       3        23
964         4      172       4       146
1252        5      172       4       161
       user_id  item_id  rating  timestep
12301       46      172       3        17
12572       47      172       4        15
13077       48      172       4       247
13163       49      172       4        60
13546       50      172       3       170
average_rating for this rec across 50 users from same group (less noisy) was: 4.08
all_actions shape just before sample torch.Size([1, 20, 1])
action scaled by temperature: tensor([[29]], device='cuda:0')
action picked by argmax: tensor([111], device='cuda:0')
tensor([[111, 195, 106,  63,  74, 171, 120, 153, 221, 239]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
271         1      112       4       272
479         2      112       5       207
553         3      112       5         8
1041        4      112       5       223
1094        5      112       5         3
       user_id  item_id  rating  timestep
12382       46      112       5        98
12566       47      112       5         9
12954       48      112       4       124
13319       49      112       4       216
13388       50      112       5        12
average_rating for this rec across 50 users from same group (less noisy) was: 4.7
all_actions shape just before sample torch.Size([1, 21, 1])
action scaled by temperature: tensor([[55]], device='cuda:0')
action picked by argmax: tensor([195], device='cuda:0')
tensor([[195,  63, 111, 106, 171,  74, 120, 153, 221, 239]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
253         1      196       3       254
520         2      196       5       248
629         3      196       5        84
912         4      196       3        94
1143        5      196       5        52
       user_id  item_id  rating  timestep
12296       46      196       5        12
12577       47      196       5        20
13039       48      196       5       209
13316       49      196       5       213
13609       50      196       4       233
average_rating for this rec across 50 users from same group (less noisy) was: 4.3
all_actions shape just before sample torch.Size([1, 22, 1])
action scaled by temperature: tensor([[216]], device='cuda:0')
action picked by argmax: tensor([195], device='cuda:0')
tensor([[195, 111,  63,  74, 106, 120, 171, 221, 153, 239]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
253         1      196       3       254
520         2      196       5       248
629         3      196       5        84
912         4      196       3        94
1143        5      196       5        52
       user_id  item_id  rating  timestep
12296       46      196       5        12
12577       47      196       5        20
13039       48      196       5       209
13316       49      196       5       213
13609       50      196       4       233
average_rating for this rec across 50 users from same group (less noisy) was: 4.3
all_actions shape just before sample torch.Size([1, 23, 1])
action scaled by temperature: tensor([[116]], device='cuda:0')
action picked by argmax: tensor([106], device='cuda:0')
tensor([[106, 111, 171,  74,  63, 120, 153, 195,  39,  37]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
173         1      107       4       174
382         2      107       4       110
769         3      107       4       224
995         4      107       5       177
1261        5      107       4       170
       user_id  item_id  rating  timestep
12344       46      107       3        60
12657       47      107       4       100
12939       48      107       5       109
13284       49      107       3       181
13531       50      107       4       155
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 24, 1])
action scaled by temperature: tensor([[89]], device='cuda:0')
action picked by argmax: tensor([106], device='cuda:0')
tensor([[106, 171,  63, 239,  74, 153, 111,   0,  39,  37]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
173         1      107       4       174
382         2      107       4       110
769         3      107       4       224
995         4      107       5       177
1261        5      107       4       170
       user_id  item_id  rating  timestep
12344       46      107       3        60
12657       47      107       4       100
12939       48      107       5       109
13284       49      107       3       181
13531       50      107       4       155
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 25, 1])
action scaled by temperature: tensor([[205]], device='cuda:0')
action picked by argmax: tensor([171], device='cuda:0')
tensor([[171, 106,  63, 239, 111,  74, 153,  39,  37, 195]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
6           1      172       4         7
376         2      172       4       104
568         3      172       3        23
964         4      172       4       146
1252        5      172       4       161
       user_id  item_id  rating  timestep
12301       46      172       3        17
12572       47      172       4        15
13077       48      172       4       247
13163       49      172       4        60
13546       50      172       3       170
average_rating for this rec across 50 users from same group (less noisy) was: 4.08
all_actions shape just before sample torch.Size([1, 26, 1])
action scaled by temperature: tensor([[182]], device='cuda:0')
action picked by argmax: tensor([106], device='cuda:0')
tensor([[106, 171,  63, 111,  74, 239, 153, 195,  39,  37]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
173         1      107       4       174
382         2      107       4       110
769         3      107       4       224
995         4      107       5       177
1261        5      107       4       170
       user_id  item_id  rating  timestep
12344       46      107       3        60
12657       47      107       4       100
12939       48      107       5       109
13284       49      107       3       181
13531       50      107       4       155
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 27, 1])
action scaled by temperature: tensor([[51]], device='cuda:0')
action picked by argmax: tensor([171], device='cuda:0')
tensor([[171, 106,  63, 111,  74, 239, 153, 195,  39, 120]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
6           1      172       4         7
376         2      172       4       104
568         3      172       3        23
964         4      172       4       146
1252        5      172       4       161
       user_id  item_id  rating  timestep
12301       46      172       3        17
12572       47      172       4        15
13077       48      172       4       247
13163       49      172       4        60
13546       50      172       3       170
average_rating for this rec across 50 users from same group (less noisy) was: 4.08
all_actions shape just before sample torch.Size([1, 28, 1])
action scaled by temperature: tensor([[9]], device='cuda:0')
action picked by argmax: tensor([106], device='cuda:0')
tensor([[106,  63, 171,  74, 111, 195, 120, 153, 239, 221]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
173         1      107       4       174
382         2      107       4       110
769         3      107       4       224
995         4      107       5       177
1261        5      107       4       170
       user_id  item_id  rating  timestep
12344       46      107       3        60
12657       47      107       4       100
12939       48      107       5       109
13284       49      107       3       181
13531       50      107       4       155
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 29, 1])
action scaled by temperature: tensor([[251]], device='cuda:0')
action picked by argmax: tensor([106], device='cuda:0')
tensor([[106, 171,  63,  74, 111, 239, 153,   0, 148,  39]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
173         1      107       4       174
382         2      107       4       110
769         3      107       4       224
995         4      107       5       177
1261        5      107       4       170
       user_id  item_id  rating  timestep
12344       46      107       3        60
12657       47      107       4       100
12939       48      107       5       109
13284       49      107       3       181
13531       50      107       4       155
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 30, 1])
action scaled by temperature: tensor([[32]], device='cuda:0')
action picked by argmax: tensor([106], device='cuda:0')
tensor([[106, 171,  63, 111,  74, 239, 153, 195, 120,  39]], device='cuda:0')
Just recommended 30 new items to 50 users from group 1 and the total rating was 121.98
train_loss is: 5.504104307253066
action scaled by temperature: tensor([[169]], device='cuda:0')
action picked by argmax: tensor([211], device='cuda:0')
tensor([[211, 231,  83,  35, 196, 237,  54, 180, 187, 117]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
16          1      212       4        17
467         2      212       5       195
562         3      212       5        17
1019        4      212       5       201
1164        5      212       4        73
       user_id  item_id  rating  timestep
12469       46      212       5       185
12820       47      212       5       263
13061       48      212       5       231
13249       49      212       4       146
13422       50      212       5        46
average_rating for this rec across 50 users from same group (less noisy) was: 4.66
all_actions shape just before sample torch.Size([1, 1, 1])
action scaled by temperature: tensor([[30]], device='cuda:0')
action picked by argmax: tensor([227], device='cuda:0')
tensor([[227, 111, 106,  63, 171, 195,  87,  39,  37, 148]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
205         1      228       4       206
490         2      228       3       218
663         3      228       3       118
1070        4      228       2       252
1271        5      228       3       180
       user_id  item_id  rating  timestep
12329       46      228       4        45
12703       47      228       3       146
12879       48      228       5        49
13111       49      228       2         8
13530       50      228       4       154
average_rating for this rec across 50 users from same group (less noisy) was: 3.34
all_actions shape just before sample torch.Size([1, 2, 1])
action scaled by temperature: tensor([[258]], device='cuda:0')
action picked by argmax: tensor([227], device='cuda:0')
tensor([[227, 106, 171,  87, 148,  14,   0,  28,  37,  39]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
205         1      228       4       206
490         2      228       3       218
663         3      228       3       118
1070        4      228       2       252
1271        5      228       3       180
       user_id  item_id  rating  timestep
12329       46      228       4        45
12703       47      228       3       146
12879       48      228       5        49
13111       49      228       2         8
13530       50      228       4       154
average_rating for this rec across 50 users from same group (less noisy) was: 3.34
all_actions shape just before sample torch.Size([1, 3, 1])
action scaled by temperature: tensor([[109]], device='cuda:0')
action picked by argmax: tensor([106], device='cuda:0')
tensor([[106, 227,  63, 171, 111, 239, 148,  87,   0,  37]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
173         1      107       4       174
382         2      107       4       110
769         3      107       4       224
995         4      107       5       177
1261        5      107       4       170
       user_id  item_id  rating  timestep
12344       46      107       3        60
12657       47      107       4       100
12939       48      107       5       109
13284       49      107       3       181
13531       50      107       4       155
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 4, 1])
action scaled by temperature: tensor([[153]], device='cuda:0')
action picked by argmax: tensor([227], device='cuda:0')
tensor([[227, 106, 171,   0, 148,  37,  87,  63,  28,  39]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
205         1      228       4       206
490         2      228       3       218
663         3      228       3       118
1070        4      228       2       252
1271        5      228       3       180
       user_id  item_id  rating  timestep
12329       46      228       4        45
12703       47      228       3       146
12879       48      228       5        49
13111       49      228       2         8
13530       50      228       4       154
average_rating for this rec across 50 users from same group (less noisy) was: 3.34
all_actions shape just before sample torch.Size([1, 5, 1])
action scaled by temperature: tensor([[233]], device='cuda:0')
action picked by argmax: tensor([106], device='cuda:0')
tensor([[106, 227, 171,   0, 148,  87,  37,  63, 102,  39]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
173         1      107       4       174
382         2      107       4       110
769         3      107       4       224
995         4      107       5       177
1261        5      107       4       170
       user_id  item_id  rating  timestep
12344       46      107       3        60
12657       47      107       4       100
12939       48      107       5       109
13284       49      107       3       181
13531       50      107       4       155
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 6, 1])
action scaled by temperature: tensor([[218]], device='cuda:0')
action picked by argmax: tensor([106], device='cuda:0')
tensor([[106, 227, 171,   0, 148,  63,  87,  37, 102,  39]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
173         1      107       4       174
382         2      107       4       110
769         3      107       4       224
995         4      107       5       177
1261        5      107       4       170
       user_id  item_id  rating  timestep
12344       46      107       3        60
12657       47      107       4       100
12939       48      107       5       109
13284       49      107       3       181
13531       50      107       4       155
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 7, 1])
action scaled by temperature: tensor([[149]], device='cuda:0')
action picked by argmax: tensor([106], device='cuda:0')
tensor([[106, 227, 171,   0,  63, 148,  87,  37, 239,  55]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
173         1      107       4       174
382         2      107       4       110
769         3      107       4       224
995         4      107       5       177
1261        5      107       4       170
       user_id  item_id  rating  timestep
12344       46      107       3        60
12657       47      107       4       100
12939       48      107       5       109
13284       49      107       3       181
13531       50      107       4       155
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 8, 1])
action scaled by temperature: tensor([[39]], device='cuda:0')
action picked by argmax: tensor([227], device='cuda:0')
tensor([[227, 106, 171,   0,  37,  84, 113,  28, 148,  87]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
205         1      228       4       206
490         2      228       3       218
663         3      228       3       118
1070        4      228       2       252
1271        5      228       3       180
       user_id  item_id  rating  timestep
12329       46      228       4        45
12703       47      228       3       146
12879       48      228       5        49
13111       49      228       2         8
13530       50      228       4       154
average_rating for this rec across 50 users from same group (less noisy) was: 3.34
all_actions shape just before sample torch.Size([1, 9, 1])
action scaled by temperature: tensor([[89]], device='cuda:0')
action picked by argmax: tensor([106], device='cuda:0')
tensor([[106, 171, 227,  63, 148, 111,   0,  39,  37, 239]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
173         1      107       4       174
382         2      107       4       110
769         3      107       4       224
995         4      107       5       177
1261        5      107       4       170
       user_id  item_id  rating  timestep
12344       46      107       3        60
12657       47      107       4       100
12939       48      107       5       109
13284       49      107       3       181
13531       50      107       4       155
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 10, 1])
action scaled by temperature: tensor([[199]], device='cuda:0')
action picked by argmax: tensor([106], device='cuda:0')
tensor([[106, 171,  63, 227, 111,  74, 239, 148,   0, 102]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
173         1      107       4       174
382         2      107       4       110
769         3      107       4       224
995         4      107       5       177
1261        5      107       4       170
       user_id  item_id  rating  timestep
12344       46      107       3        60
12657       47      107       4       100
12939       48      107       5       109
13284       49      107       3       181
13531       50      107       4       155
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 11, 1])
action scaled by temperature: tensor([[39]], device='cuda:0')
action picked by argmax: tensor([106], device='cuda:0')
tensor([[106, 171,  74,  63, 148, 227,   0, 111, 120, 239]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
173         1      107       4       174
382         2      107       4       110
769         3      107       4       224
995         4      107       5       177
1261        5      107       4       170
       user_id  item_id  rating  timestep
12344       46      107       3        60
12657       47      107       4       100
12939       48      107       5       109
13284       49      107       3       181
13531       50      107       4       155
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 12, 1])
action scaled by temperature: tensor([[93]], device='cuda:0')
action picked by argmax: tensor([106], device='cuda:0')
tensor([[106, 171,  74,  63,   0, 148, 239, 227,  55, 152]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
173         1      107       4       174
382         2      107       4       110
769         3      107       4       224
995         4      107       5       177
1261        5      107       4       170
       user_id  item_id  rating  timestep
12344       46      107       3        60
12657       47      107       4       100
12939       48      107       5       109
13284       49      107       3       181
13531       50      107       4       155
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 13, 1])
action scaled by temperature: tensor([[100]], device='cuda:0')
action picked by argmax: tensor([106], device='cuda:0')
tensor([[106, 171,  63,   0,  74, 227, 148,  55, 239, 251]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
173         1      107       4       174
382         2      107       4       110
769         3      107       4       224
995         4      107       5       177
1261        5      107       4       170
       user_id  item_id  rating  timestep
12344       46      107       3        60
12657       47      107       4       100
12939       48      107       5       109
13284       49      107       3       181
13531       50      107       4       155
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 14, 1])
action scaled by temperature: tensor([[88]], device='cuda:0')
action picked by argmax: tensor([106], device='cuda:0')
tensor([[106, 171,   0,  55, 227, 251,  63, 148, 239, 102]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
173         1      107       4       174
382         2      107       4       110
769         3      107       4       224
995         4      107       5       177
1261        5      107       4       170
       user_id  item_id  rating  timestep
12344       46      107       3        60
12657       47      107       4       100
12939       48      107       5       109
13284       49      107       3       181
13531       50      107       4       155
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 15, 1])
action scaled by temperature: tensor([[87]], device='cuda:0')
action picked by argmax: tensor([106], device='cuda:0')
tensor([[106, 171,   0, 227,  55, 251, 148,  63, 102, 239]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
173         1      107       4       174
382         2      107       4       110
769         3      107       4       224
995         4      107       5       177
1261        5      107       4       170
       user_id  item_id  rating  timestep
12344       46      107       3        60
12657       47      107       4       100
12939       48      107       5       109
13284       49      107       3       181
13531       50      107       4       155
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 16, 1])
action scaled by temperature: tensor([[116]], device='cuda:0')
action picked by argmax: tensor([106], device='cuda:0')
tensor([[106, 171,   0, 227, 251,  55, 148, 102, 207, 152]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
173         1      107       4       174
382         2      107       4       110
769         3      107       4       224
995         4      107       5       177
1261        5      107       4       170
       user_id  item_id  rating  timestep
12344       46      107       3        60
12657       47      107       4       100
12939       48      107       5       109
13284       49      107       3       181
13531       50      107       4       155
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 17, 1])
action scaled by temperature: tensor([[58]], device='cuda:0')
action picked by argmax: tensor([106], device='cuda:0')
tensor([[106, 171,   0,  55, 227, 251,  63, 148, 239,  83]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
173         1      107       4       174
382         2      107       4       110
769         3      107       4       224
995         4      107       5       177
1261        5      107       4       170
       user_id  item_id  rating  timestep
12344       46      107       3        60
12657       47      107       4       100
12939       48      107       5       109
13284       49      107       3       181
13531       50      107       4       155
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 18, 1])
action scaled by temperature: tensor([[187]], device='cuda:0')
action picked by argmax: tensor([227], device='cuda:0')
tensor([[227,   0, 251,  83, 106, 231,  28, 228,  37, 171]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
205         1      228       4       206
490         2      228       3       218
663         3      228       3       118
1070        4      228       2       252
1271        5      228       3       180
       user_id  item_id  rating  timestep
12329       46      228       4        45
12703       47      228       3       146
12879       48      228       5        49
13111       49      228       2         8
13530       50      228       4       154
average_rating for this rec across 50 users from same group (less noisy) was: 3.34
all_actions shape just before sample torch.Size([1, 19, 1])
action scaled by temperature: tensor([[32]], device='cuda:0')
action picked by argmax: tensor([106], device='cuda:0')
tensor([[106, 251, 171,   0, 102, 148, 152,  74,  55,  83]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
173         1      107       4       174
382         2      107       4       110
769         3      107       4       224
995         4      107       5       177
1261        5      107       4       170
       user_id  item_id  rating  timestep
12344       46      107       3        60
12657       47      107       4       100
12939       48      107       5       109
13284       49      107       3       181
13531       50      107       4       155
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 20, 1])
action scaled by temperature: tensor([[143]], device='cuda:0')
action picked by argmax: tensor([106], device='cuda:0')
tensor([[106, 251,   0, 171,  83, 102, 158, 148,  55, 152]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
173         1      107       4       174
382         2      107       4       110
769         3      107       4       224
995         4      107       5       177
1261        5      107       4       170
       user_id  item_id  rating  timestep
12344       46      107       3        60
12657       47      107       4       100
12939       48      107       5       109
13284       49      107       3       181
13531       50      107       4       155
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 21, 1])
action scaled by temperature: tensor([[262]], device='cuda:0')
action picked by argmax: tensor([106], device='cuda:0')
tensor([[106, 251, 171,   0, 148, 102,  74, 152,  55,  83]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
173         1      107       4       174
382         2      107       4       110
769         3      107       4       224
995         4      107       5       177
1261        5      107       4       170
       user_id  item_id  rating  timestep
12344       46      107       3        60
12657       47      107       4       100
12939       48      107       5       109
13284       49      107       3       181
13531       50      107       4       155
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 22, 1])
action scaled by temperature: tensor([[137]], device='cuda:0')
action picked by argmax: tensor([106], device='cuda:0')
tensor([[106, 251, 171,   0, 148, 227, 102,  55, 152,  83]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
173         1      107       4       174
382         2      107       4       110
769         3      107       4       224
995         4      107       5       177
1261        5      107       4       170
       user_id  item_id  rating  timestep
12344       46      107       3        60
12657       47      107       4       100
12939       48      107       5       109
13284       49      107       3       181
13531       50      107       4       155
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 23, 1])
action scaled by temperature: tensor([[150]], device='cuda:0')
action picked by argmax: tensor([106], device='cuda:0')
tensor([[106, 251,   0, 171, 227,  83, 102, 158,  55, 148]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
173         1      107       4       174
382         2      107       4       110
769         3      107       4       224
995         4      107       5       177
1261        5      107       4       170
       user_id  item_id  rating  timestep
12344       46      107       3        60
12657       47      107       4       100
12939       48      107       5       109
13284       49      107       3       181
13531       50      107       4       155
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 24, 1])
action scaled by temperature: tensor([[201]], device='cuda:0')
action picked by argmax: tensor([106], device='cuda:0')
tensor([[106, 251,   0,  83, 171, 158, 227, 147, 102, 121]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
173         1      107       4       174
382         2      107       4       110
769         3      107       4       224
995         4      107       5       177
1261        5      107       4       170
       user_id  item_id  rating  timestep
12344       46      107       3        60
12657       47      107       4       100
12939       48      107       5       109
13284       49      107       3       181
13531       50      107       4       155
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 25, 1])
action scaled by temperature: tensor([[75]], device='cuda:0')
action picked by argmax: tensor([106], device='cuda:0')
tensor([[106,   0, 251, 227, 171, 102,  55,  83, 148, 158]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
173         1      107       4       174
382         2      107       4       110
769         3      107       4       224
995         4      107       5       177
1261        5      107       4       170
       user_id  item_id  rating  timestep
12344       46      107       3        60
12657       47      107       4       100
12939       48      107       5       109
13284       49      107       3       181
13531       50      107       4       155
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 26, 1])
action scaled by temperature: tensor([[237]], device='cuda:0')
action picked by argmax: tensor([106], device='cuda:0')
tensor([[106,   0, 251, 171, 227,  55, 158,  83, 102, 148]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
173         1      107       4       174
382         2      107       4       110
769         3      107       4       224
995         4      107       5       177
1261        5      107       4       170
       user_id  item_id  rating  timestep
12344       46      107       3        60
12657       47      107       4       100
12939       48      107       5       109
13284       49      107       3       181
13531       50      107       4       155
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 27, 1])
action scaled by temperature: tensor([[222]], device='cuda:0')
action picked by argmax: tensor([106], device='cuda:0')
tensor([[106,   0, 251, 171, 227,  55, 102,  83, 148, 158]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
173         1      107       4       174
382         2      107       4       110
769         3      107       4       224
995         4      107       5       177
1261        5      107       4       170
       user_id  item_id  rating  timestep
12344       46      107       3        60
12657       47      107       4       100
12939       48      107       5       109
13284       49      107       3       181
13531       50      107       4       155
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 28, 1])
action scaled by temperature: tensor([[223]], device='cuda:0')
action picked by argmax: tensor([106], device='cuda:0')
tensor([[106, 251,   0, 171,  83, 227,  55, 102, 148, 158]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
173         1      107       4       174
382         2      107       4       110
769         3      107       4       224
995         4      107       5       177
1261        5      107       4       170
       user_id  item_id  rating  timestep
12344       46      107       3        60
12657       47      107       4       100
12939       48      107       5       109
13284       49      107       3       181
13531       50      107       4       155
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 29, 1])
action scaled by temperature: tensor([[161]], device='cuda:0')
action picked by argmax: tensor([106], device='cuda:0')
tensor([[106,   0, 251, 171, 227,  55,  83, 102, 148, 228]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
173         1      107       4       174
382         2      107       4       110
769         3      107       4       224
995         4      107       5       177
1261        5      107       4       170
       user_id  item_id  rating  timestep
12344       46      107       3        60
12657       47      107       4       100
12939       48      107       5       109
13284       49      107       3       181
13531       50      107       4       155
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 30, 1])
action scaled by temperature: tensor([[65]], device='cuda:0')
action picked by argmax: tensor([106], device='cuda:0')
tensor([[106,   0, 171, 227, 251, 102, 148,  55, 152, 207]], device='cuda:0')
Just recommended 30 new items to 50 users from group 1 and the total rating was 118.80000000000004
train_loss is: 5.482213309910744
action scaled by temperature: tensor([[129]], device='cuda:0')
action picked by argmax: tensor([211], device='cuda:0')
tensor([[211,  35, 231,  83,  52, 200, 196, 117, 107, 180]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
16          1      212       4        17
467         2      212       5       195
562         3      212       5        17
1019        4      212       5       201
1164        5      212       4        73
       user_id  item_id  rating  timestep
12469       46      212       5       185
12820       47      212       5       263
13061       48      212       5       231
13249       49      212       4       146
13422       50      212       5        46
average_rating for this rec across 50 users from same group (less noisy) was: 4.66
all_actions shape just before sample torch.Size([1, 1, 1])
action scaled by temperature: tensor([[12]], device='cuda:0')
action picked by argmax: tensor([63], device='cuda:0')
tensor([[ 63, 106, 227,  20, 221, 111,   0, 195,  87, 171]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
227         1       64       5       228
530         2       64       4       258
781         3       64       4       236
1036        4       64       5       218
1148        5       64       5        57
       user_id  item_id  rating  timestep
12401       46       64       3       117
12630       47       64       3        73
12869       48       64       4        39
13138       49       64       5        35
13605       50       64       4       229
average_rating for this rec across 50 users from same group (less noisy) was: 3.82
all_actions shape just before sample torch.Size([1, 2, 1])
action scaled by temperature: tensor([[114]], device='cuda:0')
action picked by argmax: tensor([106], device='cuda:0')
tensor([[106,  63, 120,  74, 111, 221, 227,   0, 148, 153]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
173         1      107       4       174
382         2      107       4       110
769         3      107       4       224
995         4      107       5       177
1261        5      107       4       170
       user_id  item_id  rating  timestep
12344       46      107       3        60
12657       47      107       4       100
12939       48      107       5       109
13284       49      107       3       181
13531       50      107       4       155
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 3, 1])
action scaled by temperature: tensor([[209]], device='cuda:0')
action picked by argmax: tensor([106], device='cuda:0')
tensor([[106,  63, 120, 221,  74, 111, 249,  20, 171, 153]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
173         1      107       4       174
382         2      107       4       110
769         3      107       4       224
995         4      107       5       177
1261        5      107       4       170
       user_id  item_id  rating  timestep
12344       46      107       3        60
12657       47      107       4       100
12939       48      107       5       109
13284       49      107       3       181
13531       50      107       4       155
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 4, 1])
action scaled by temperature: tensor([[39]], device='cuda:0')
action picked by argmax: tensor([106], device='cuda:0')
tensor([[106,  63, 120,  74,   0, 221, 171, 111,  20, 153]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
173         1      107       4       174
382         2      107       4       110
769         3      107       4       224
995         4      107       5       177
1261        5      107       4       170
       user_id  item_id  rating  timestep
12344       46      107       3        60
12657       47      107       4       100
12939       48      107       5       109
13284       49      107       3       181
13531       50      107       4       155
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 5, 1])
action scaled by temperature: tensor([[184]], device='cuda:0')
action picked by argmax: tensor([106], device='cuda:0')
tensor([[106,  63, 120,  74,   0, 221, 171,  20, 111, 153]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
173         1      107       4       174
382         2      107       4       110
769         3      107       4       224
995         4      107       5       177
1261        5      107       4       170
       user_id  item_id  rating  timestep
12344       46      107       3        60
12657       47      107       4       100
12939       48      107       5       109
13284       49      107       3       181
13531       50      107       4       155
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 6, 1])
action scaled by temperature: tensor([[232]], device='cuda:0')
action picked by argmax: tensor([106], device='cuda:0')
tensor([[106,  63, 120,  74,   0, 171, 221,  20, 153, 207]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
173         1      107       4       174
382         2      107       4       110
769         3      107       4       224
995         4      107       5       177
1261        5      107       4       170
       user_id  item_id  rating  timestep
12344       46      107       3        60
12657       47      107       4       100
12939       48      107       5       109
13284       49      107       3       181
13531       50      107       4       155
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 7, 1])
action scaled by temperature: tensor([[48]], device='cuda:0')
action picked by argmax: tensor([106], device='cuda:0')
tensor([[106,  63, 120,  74,   0, 171, 221,  20, 153, 249]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
173         1      107       4       174
382         2      107       4       110
769         3      107       4       224
995         4      107       5       177
1261        5      107       4       170
       user_id  item_id  rating  timestep
12344       46      107       3        60
12657       47      107       4       100
12939       48      107       5       109
13284       49      107       3       181
13531       50      107       4       155
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 8, 1])
action scaled by temperature: tensor([[217]], device='cuda:0')
action picked by argmax: tensor([106], device='cuda:0')
tensor([[106,   0,  63, 171, 227, 251, 207,  74, 148, 102]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
173         1      107       4       174
382         2      107       4       110
769         3      107       4       224
995         4      107       5       177
1261        5      107       4       170
       user_id  item_id  rating  timestep
12344       46      107       3        60
12657       47      107       4       100
12939       48      107       5       109
13284       49      107       3       181
13531       50      107       4       155
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 9, 1])
action scaled by temperature: tensor([[254]], device='cuda:0')
action picked by argmax: tensor([106], device='cuda:0')
tensor([[106,   0,  63, 171, 251, 227,  74, 207, 148, 102]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
173         1      107       4       174
382         2      107       4       110
769         3      107       4       224
995         4      107       5       177
1261        5      107       4       170
       user_id  item_id  rating  timestep
12344       46      107       3        60
12657       47      107       4       100
12939       48      107       5       109
13284       49      107       3       181
13531       50      107       4       155
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 10, 1])
action scaled by temperature: tensor([[172]], device='cuda:0')
action picked by argmax: tensor([106], device='cuda:0')
tensor([[106,  63,   0, 171, 227, 207,  74, 251,  20, 148]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
173         1      107       4       174
382         2      107       4       110
769         3      107       4       224
995         4      107       5       177
1261        5      107       4       170
       user_id  item_id  rating  timestep
12344       46      107       3        60
12657       47      107       4       100
12939       48      107       5       109
13284       49      107       3       181
13531       50      107       4       155
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 11, 1])
action scaled by temperature: tensor([[224]], device='cuda:0')
action picked by argmax: tensor([106], device='cuda:0')
tensor([[106,   0,  63, 171, 251,  74, 207, 227, 102, 152]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
173         1      107       4       174
382         2      107       4       110
769         3      107       4       224
995         4      107       5       177
1261        5      107       4       170
       user_id  item_id  rating  timestep
12344       46      107       3        60
12657       47      107       4       100
12939       48      107       5       109
13284       49      107       3       181
13531       50      107       4       155
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 12, 1])
action scaled by temperature: tensor([[128]], device='cuda:0')
action picked by argmax: tensor([106], device='cuda:0')
tensor([[106,  63,   0, 171, 251, 227, 207,  74, 102,  20]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
173         1      107       4       174
382         2      107       4       110
769         3      107       4       224
995         4      107       5       177
1261        5      107       4       170
       user_id  item_id  rating  timestep
12344       46      107       3        60
12657       47      107       4       100
12939       48      107       5       109
13284       49      107       3       181
13531       50      107       4       155
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 13, 1])
action scaled by temperature: tensor([[87]], device='cuda:0')
action picked by argmax: tensor([106], device='cuda:0')
tensor([[106,   0,  63, 171, 251, 227, 207,  55, 102, 152]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
173         1      107       4       174
382         2      107       4       110
769         3      107       4       224
995         4      107       5       177
1261        5      107       4       170
       user_id  item_id  rating  timestep
12344       46      107       3        60
12657       47      107       4       100
12939       48      107       5       109
13284       49      107       3       181
13531       50      107       4       155
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 14, 1])
action scaled by temperature: tensor([[90]], device='cuda:0')
action picked by argmax: tensor([106], device='cuda:0')
tensor([[106,   0, 171,  63, 251,  55, 207, 227,  83, 148]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
173         1      107       4       174
382         2      107       4       110
769         3      107       4       224
995         4      107       5       177
1261        5      107       4       170
       user_id  item_id  rating  timestep
12344       46      107       3        60
12657       47      107       4       100
12939       48      107       5       109
13284       49      107       3       181
13531       50      107       4       155
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 15, 1])
action scaled by temperature: tensor([[9]], device='cuda:0')
action picked by argmax: tensor([106], device='cuda:0')
tensor([[106,   0, 171,  63, 251,  55, 207, 227, 152, 148]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
173         1      107       4       174
382         2      107       4       110
769         3      107       4       224
995         4      107       5       177
1261        5      107       4       170
       user_id  item_id  rating  timestep
12344       46      107       3        60
12657       47      107       4       100
12939       48      107       5       109
13284       49      107       3       181
13531       50      107       4       155
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 16, 1])
action scaled by temperature: tensor([[89]], device='cuda:0')
action picked by argmax: tensor([106], device='cuda:0')
tensor([[106,   0, 171,  63, 251,  55, 227, 207, 148, 152]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
173         1      107       4       174
382         2      107       4       110
769         3      107       4       224
995         4      107       5       177
1261        5      107       4       170
       user_id  item_id  rating  timestep
12344       46      107       3        60
12657       47      107       4       100
12939       48      107       5       109
13284       49      107       3       181
13531       50      107       4       155
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 17, 1])
action scaled by temperature: tensor([[5]], device='cuda:0')
action picked by argmax: tensor([106], device='cuda:0')
tensor([[106,   0, 171,  63,  55, 251, 227,  83, 207,  20]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
173         1      107       4       174
382         2      107       4       110
769         3      107       4       224
995         4      107       5       177
1261        5      107       4       170
       user_id  item_id  rating  timestep
12344       46      107       3        60
12657       47      107       4       100
12939       48      107       5       109
13284       49      107       3       181
13531       50      107       4       155
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 18, 1])
action scaled by temperature: tensor([[74]], device='cuda:0')
action picked by argmax: tensor([0], device='cuda:0')
tensor([[  0, 106, 251,  83, 227, 171,  55, 147, 207, 231]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
62          1        1       4        63
522         2        1       5       250
671         3        1       4       126
892         4        1       4        74
1204        5        1       5       113
       user_id  item_id  rating  timestep
12375       46        1       5        91
12816       47        1       5       259
13045       48        1       4       215
13375       49        1       5       272
13542       50        1       5       166
average_rating for this rec across 50 users from same group (less noisy) was: 4.66
all_actions shape just before sample torch.Size([1, 19, 1])
action scaled by temperature: tensor([[265]], device='cuda:0')
action picked by argmax: tensor([106], device='cuda:0')
tensor([[106,   0,  63, 171, 251, 207, 152,  20, 102, 153]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
173         1      107       4       174
382         2      107       4       110
769         3      107       4       224
995         4      107       5       177
1261        5      107       4       170
       user_id  item_id  rating  timestep
12344       46      107       3        60
12657       47      107       4       100
12939       48      107       5       109
13284       49      107       3       181
13531       50      107       4       155
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 20, 1])
action scaled by temperature: tensor([[184]], device='cuda:0')
action picked by argmax: tensor([106], device='cuda:0')
tensor([[106,   0, 171,  63, 251, 207,  20, 152,  55, 102]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
173         1      107       4       174
382         2      107       4       110
769         3      107       4       224
995         4      107       5       177
1261        5      107       4       170
       user_id  item_id  rating  timestep
12344       46      107       3        60
12657       47      107       4       100
12939       48      107       5       109
13284       49      107       3       181
13531       50      107       4       155
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 21, 1])
action scaled by temperature: tensor([[49]], device='cuda:0')
action picked by argmax: tensor([106], device='cuda:0')
tensor([[106,   0,  63, 171, 251, 207,  20,  55, 227, 152]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
173         1      107       4       174
382         2      107       4       110
769         3      107       4       224
995         4      107       5       177
1261        5      107       4       170
       user_id  item_id  rating  timestep
12344       46      107       3        60
12657       47      107       4       100
12939       48      107       5       109
13284       49      107       3       181
13531       50      107       4       155
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 22, 1])
action scaled by temperature: tensor([[186]], device='cuda:0')
action picked by argmax: tensor([106], device='cuda:0')
tensor([[106,   0, 171,  63, 251, 227,  55, 207,  20, 113]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
173         1      107       4       174
382         2      107       4       110
769         3      107       4       224
995         4      107       5       177
1261        5      107       4       170
       user_id  item_id  rating  timestep
12344       46      107       3        60
12657       47      107       4       100
12939       48      107       5       109
13284       49      107       3       181
13531       50      107       4       155
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 23, 1])
action scaled by temperature: tensor([[187]], device='cuda:0')
action picked by argmax: tensor([0], device='cuda:0')
tensor([[  0, 106, 251,  83, 171, 147,  55, 227, 228, 113]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
62          1        1       4        63
522         2        1       5       250
671         3        1       4       126
892         4        1       4        74
1204        5        1       5       113
       user_id  item_id  rating  timestep
12375       46        1       5        91
12816       47        1       5       259
13045       48        1       4       215
13375       49        1       5       272
13542       50        1       5       166
average_rating for this rec across 50 users from same group (less noisy) was: 4.66
all_actions shape just before sample torch.Size([1, 24, 1])
action scaled by temperature: tensor([[102]], device='cuda:0')
action picked by argmax: tensor([106], device='cuda:0')
tensor([[106,   0, 171,  63, 251, 113,  55, 227, 207,  20]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
173         1      107       4       174
382         2      107       4       110
769         3      107       4       224
995         4      107       5       177
1261        5      107       4       170
       user_id  item_id  rating  timestep
12344       46      107       3        60
12657       47      107       4       100
12939       48      107       5       109
13284       49      107       3       181
13531       50      107       4       155
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 25, 1])
action scaled by temperature: tensor([[150]], device='cuda:0')
action picked by argmax: tensor([106], device='cuda:0')
tensor([[106,   0,  63, 171, 251, 227,  55, 207,  20, 113]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
173         1      107       4       174
382         2      107       4       110
769         3      107       4       224
995         4      107       5       177
1261        5      107       4       170
       user_id  item_id  rating  timestep
12344       46      107       3        60
12657       47      107       4       100
12939       48      107       5       109
13284       49      107       3       181
13531       50      107       4       155
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 26, 1])
action scaled by temperature: tensor([[109]], device='cuda:0')
action picked by argmax: tensor([0], device='cuda:0')
tensor([[  0, 106, 171,  63, 251, 227, 113,  55, 207,  20]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
62          1        1       4        63
522         2        1       5       250
671         3        1       4       126
892         4        1       4        74
1204        5        1       5       113
       user_id  item_id  rating  timestep
12375       46        1       5        91
12816       47        1       5       259
13045       48        1       4       215
13375       49        1       5       272
13542       50        1       5       166
average_rating for this rec across 50 users from same group (less noisy) was: 4.66
all_actions shape just before sample torch.Size([1, 27, 1])
action scaled by temperature: tensor([[230]], device='cuda:0')
action picked by argmax: tensor([106], device='cuda:0')
tensor([[106,  63,   0, 171, 153, 251,  74, 120, 207,  20]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
173         1      107       4       174
382         2      107       4       110
769         3      107       4       224
995         4      107       5       177
1261        5      107       4       170
       user_id  item_id  rating  timestep
12344       46      107       3        60
12657       47      107       4       100
12939       48      107       5       109
13284       49      107       3       181
13531       50      107       4       155
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 28, 1])
action scaled by temperature: tensor([[92]], device='cuda:0')
action picked by argmax: tensor([106], device='cuda:0')
tensor([[106,   0, 171,  63, 251, 207,  55, 152, 102, 153]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
173         1      107       4       174
382         2      107       4       110
769         3      107       4       224
995         4      107       5       177
1261        5      107       4       170
       user_id  item_id  rating  timestep
12344       46      107       3        60
12657       47      107       4       100
12939       48      107       5       109
13284       49      107       3       181
13531       50      107       4       155
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 29, 1])
action scaled by temperature: tensor([[132]], device='cuda:0')
action picked by argmax: tensor([106], device='cuda:0')
tensor([[106,   0, 171, 251,  63,  55, 227, 207,  83, 113]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
173         1      107       4       174
382         2      107       4       110
769         3      107       4       224
995         4      107       5       177
1261        5      107       4       170
       user_id  item_id  rating  timestep
12344       46      107       3        60
12657       47      107       4       100
12939       48      107       5       109
13284       49      107       3       181
13531       50      107       4       155
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 30, 1])
action scaled by temperature: tensor([[218]], device='cuda:0')
action picked by argmax: tensor([0], device='cuda:0')
tensor([[  0, 106, 251, 227, 171,  55,  83, 147, 207, 228]], device='cuda:0')
Just recommended 30 new items to 50 users from group 1 and the total rating was 123.96000000000002
train_loss is: 5.439589953313679
action scaled by temperature: tensor([[54]], device='cuda:0')
action picked by argmax: tensor([211], device='cuda:0')
tensor([[211, 117,  30, 200, 237,  64, 231, 180, 205,   9]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
16          1      212       4        17
467         2      212       5       195
562         3      212       5        17
1019        4      212       5       201
1164        5      212       4        73
       user_id  item_id  rating  timestep
12469       46      212       5       185
12820       47      212       5       263
13061       48      212       5       231
13249       49      212       4       146
13422       50      212       5        46
average_rating for this rec across 50 users from same group (less noisy) was: 4.66
all_actions shape just before sample torch.Size([1, 1, 1])
action scaled by temperature: tensor([[48]], device='cuda:0')
action picked by argmax: tensor([227], device='cuda:0')
tensor([[227, 171,  37, 218, 111,  29,  30, 231,  55,  84]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
205         1      228       4       206
490         2      228       3       218
663         3      228       3       118
1070        4      228       2       252
1271        5      228       3       180
       user_id  item_id  rating  timestep
12329       46      228       4        45
12703       47      228       3       146
12879       48      228       5        49
13111       49      228       2         8
13530       50      228       4       154
average_rating for this rec across 50 users from same group (less noisy) was: 3.34
all_actions shape just before sample torch.Size([1, 2, 1])
action scaled by temperature: tensor([[200]], device='cuda:0')
action picked by argmax: tensor([227], device='cuda:0')
tensor([[227, 111, 171,  37, 218, 254, 152,  30, 106, 102]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
205         1      228       4       206
490         2      228       3       218
663         3      228       3       118
1070        4      228       2       252
1271        5      228       3       180
       user_id  item_id  rating  timestep
12329       46      228       4        45
12703       47      228       3       146
12879       48      228       5        49
13111       49      228       2         8
13530       50      228       4       154
average_rating for this rec across 50 users from same group (less noisy) was: 3.34
all_actions shape just before sample torch.Size([1, 3, 1])
action scaled by temperature: tensor([[64]], device='cuda:0')
action picked by argmax: tensor([227], device='cuda:0')
tensor([[227, 111, 171,  37, 218, 254, 102, 106,  39,  30]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
205         1      228       4       206
490         2      228       3       218
663         3      228       3       118
1070        4      228       2       252
1271        5      228       3       180
       user_id  item_id  rating  timestep
12329       46      228       4        45
12703       47      228       3       146
12879       48      228       5        49
13111       49      228       2         8
13530       50      228       4       154
average_rating for this rec across 50 users from same group (less noisy) was: 3.34
all_actions shape just before sample torch.Size([1, 4, 1])
action scaled by temperature: tensor([[84]], device='cuda:0')
action picked by argmax: tensor([227], device='cuda:0')
tensor([[227, 111, 102, 254, 171, 106,  39,  63,  37, 148]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
205         1      228       4       206
490         2      228       3       218
663         3      228       3       118
1070        4      228       2       252
1271        5      228       3       180
       user_id  item_id  rating  timestep
12329       46      228       4        45
12703       47      228       3       146
12879       48      228       5        49
13111       49      228       2         8
13530       50      228       4       154
average_rating for this rec across 50 users from same group (less noisy) was: 3.34
all_actions shape just before sample torch.Size([1, 5, 1])
action scaled by temperature: tensor([[153]], device='cuda:0')
action picked by argmax: tensor([227], device='cuda:0')
tensor([[227, 111, 171, 102, 106, 218, 152,  37, 254, 148]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
205         1      228       4       206
490         2      228       3       218
663         3      228       3       118
1070        4      228       2       252
1271        5      228       3       180
       user_id  item_id  rating  timestep
12329       46      228       4        45
12703       47      228       3       146
12879       48      228       5        49
13111       49      228       2         8
13530       50      228       4       154
average_rating for this rec across 50 users from same group (less noisy) was: 3.34
all_actions shape just before sample torch.Size([1, 6, 1])
action scaled by temperature: tensor([[81]], device='cuda:0')
action picked by argmax: tensor([106], device='cuda:0')
tensor([[106, 227, 102, 152, 111, 120, 171,  74,  40, 218]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
173         1      107       4       174
382         2      107       4       110
769         3      107       4       224
995         4      107       5       177
1261        5      107       4       170
       user_id  item_id  rating  timestep
12344       46      107       3        60
12657       47      107       4       100
12939       48      107       5       109
13284       49      107       3       181
13531       50      107       4       155
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 7, 1])
action scaled by temperature: tensor([[73]], device='cuda:0')
action picked by argmax: tensor([227], device='cuda:0')
tensor([[227, 171, 111, 106, 102, 218, 152,  37, 254,  39]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
205         1      228       4       206
490         2      228       3       218
663         3      228       3       118
1070        4      228       2       252
1271        5      228       3       180
       user_id  item_id  rating  timestep
12329       46      228       4        45
12703       47      228       3       146
12879       48      228       5        49
13111       49      228       2         8
13530       50      228       4       154
average_rating for this rec across 50 users from same group (less noisy) was: 3.34
all_actions shape just before sample torch.Size([1, 8, 1])
action scaled by temperature: tensor([[200]], device='cuda:0')
action picked by argmax: tensor([227], device='cuda:0')
tensor([[227, 106, 102, 111, 152, 171,  39, 148, 254,  37]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
205         1      228       4       206
490         2      228       3       218
663         3      228       3       118
1070        4      228       2       252
1271        5      228       3       180
       user_id  item_id  rating  timestep
12329       46      228       4        45
12703       47      228       3       146
12879       48      228       5        49
13111       49      228       2         8
13530       50      228       4       154
average_rating for this rec across 50 users from same group (less noisy) was: 3.34
all_actions shape just before sample torch.Size([1, 9, 1])
action scaled by temperature: tensor([[91]], device='cuda:0')
action picked by argmax: tensor([106], device='cuda:0')
tensor([[106, 120, 102, 152,  74, 227, 111,  40,  39, 148]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
173         1      107       4       174
382         2      107       4       110
769         3      107       4       224
995         4      107       5       177
1261        5      107       4       170
       user_id  item_id  rating  timestep
12344       46      107       3        60
12657       47      107       4       100
12939       48      107       5       109
13284       49      107       3       181
13531       50      107       4       155
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 10, 1])
action scaled by temperature: tensor([[161]], device='cuda:0')
action picked by argmax: tensor([106], device='cuda:0')
tensor([[106, 171, 152, 102, 227, 120, 111,  14,  39,  11]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
173         1      107       4       174
382         2      107       4       110
769         3      107       4       224
995         4      107       5       177
1261        5      107       4       170
       user_id  item_id  rating  timestep
12344       46      107       3        60
12657       47      107       4       100
12939       48      107       5       109
13284       49      107       3       181
13531       50      107       4       155
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 11, 1])
action scaled by temperature: tensor([[199]], device='cuda:0')
action picked by argmax: tensor([106], device='cuda:0')
tensor([[106, 152, 102,  74, 171, 120, 227, 111,  39,  89]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
173         1      107       4       174
382         2      107       4       110
769         3      107       4       224
995         4      107       5       177
1261        5      107       4       170
       user_id  item_id  rating  timestep
12344       46      107       3        60
12657       47      107       4       100
12939       48      107       5       109
13284       49      107       3       181
13531       50      107       4       155
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 12, 1])
action scaled by temperature: tensor([[185]], device='cuda:0')
action picked by argmax: tensor([106], device='cuda:0')
tensor([[106, 152,  40, 153, 102, 120, 171,  74, 251, 111]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
173         1      107       4       174
382         2      107       4       110
769         3      107       4       224
995         4      107       5       177
1261        5      107       4       170
       user_id  item_id  rating  timestep
12344       46      107       3        60
12657       47      107       4       100
12939       48      107       5       109
13284       49      107       3       181
13531       50      107       4       155
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 13, 1])
action scaled by temperature: tensor([[64]], device='cuda:0')
action picked by argmax: tensor([106], device='cuda:0')
tensor([[106, 171, 152,  83, 102, 251,  55, 153,  40, 147]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
173         1      107       4       174
382         2      107       4       110
769         3      107       4       224
995         4      107       5       177
1261        5      107       4       170
       user_id  item_id  rating  timestep
12344       46      107       3        60
12657       47      107       4       100
12939       48      107       5       109
13284       49      107       3       181
13531       50      107       4       155
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 14, 1])
action scaled by temperature: tensor([[114]], device='cuda:0')
action picked by argmax: tensor([106], device='cuda:0')
tensor([[106, 171, 152,  40,  55,  83, 102, 153, 251, 147]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
173         1      107       4       174
382         2      107       4       110
769         3      107       4       224
995         4      107       5       177
1261        5      107       4       170
       user_id  item_id  rating  timestep
12344       46      107       3        60
12657       47      107       4       100
12939       48      107       5       109
13284       49      107       3       181
13531       50      107       4       155
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 15, 1])
action scaled by temperature: tensor([[111]], device='cuda:0')
action picked by argmax: tensor([171], device='cuda:0')
tensor([[171, 152, 106, 147,  55,  83, 231,  64, 227,  40]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
6           1      172       4         7
376         2      172       4       104
568         3      172       3        23
964         4      172       4       146
1252        5      172       4       161
       user_id  item_id  rating  timestep
12301       46      172       3        17
12572       47      172       4        15
13077       48      172       4       247
13163       49      172       4        60
13546       50      172       3       170
average_rating for this rec across 50 users from same group (less noisy) was: 4.08
all_actions shape just before sample torch.Size([1, 16, 1])
action scaled by temperature: tensor([[113]], device='cuda:0')
action picked by argmax: tensor([221], device='cuda:0')
tensor([[221, 120, 111,  63,  74, 170, 106, 102,  40, 195]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
211         1      222       4       212
390         2      222       2       118
597         3      222       5        52
1001        4      222       4       183
1353        5      222       4       262
       user_id  item_id  rating  timestep
12434       46      222       4       150
12801       47      222       4       244
12884       48      222       3        54
13211       49      222       5       108
13394       50      222       5        18
average_rating for this rec across 50 users from same group (less noisy) was: 4.2
all_actions shape just before sample torch.Size([1, 17, 1])
action scaled by temperature: tensor([[110]], device='cuda:0')
action picked by argmax: tensor([63], device='cuda:0')
tensor([[ 63, 221, 111, 120, 227, 106,  20,  40, 254, 102]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
227         1       64       5       228
530         2       64       4       258
781         3       64       4       236
1036        4       64       5       218
1148        5       64       5        57
       user_id  item_id  rating  timestep
12401       46       64       3       117
12630       47       64       3        73
12869       48       64       4        39
13138       49       64       5        35
13605       50       64       4       229
average_rating for this rec across 50 users from same group (less noisy) was: 3.82
all_actions shape just before sample torch.Size([1, 18, 1])
action scaled by temperature: tensor([[143]], device='cuda:0')
action picked by argmax: tensor([120], device='cuda:0')
tensor([[120, 221,  74,  63,  40, 111, 106, 170, 249, 144]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
140         1      121       4       141
340         2      121       4        68
548         3      121       4         3
1028        4      121       4       210
1324        5      121       4       233
       user_id  item_id  rating  timestep
12449       46      121       3       165
12767       47      121       4       210
13025       48      121       4       195
13269       49      121       4       166
13383       50      121       4         7
average_rating for this rec across 50 users from same group (less noisy) was: 4.02
all_actions shape just before sample torch.Size([1, 19, 1])
action scaled by temperature: tensor([[112]], device='cuda:0')
action picked by argmax: tensor([120], device='cuda:0')
tensor([[120, 221,  74,  63,  40, 106, 111, 170, 153, 249]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
140         1      121       4       141
340         2      121       4        68
548         3      121       4         3
1028        4      121       4       210
1324        5      121       4       233
       user_id  item_id  rating  timestep
12449       46      121       3       165
12767       47      121       4       210
13025       48      121       4       195
13269       49      121       4       166
13383       50      121       4         7
average_rating for this rec across 50 users from same group (less noisy) was: 4.02
all_actions shape just before sample torch.Size([1, 20, 1])
action scaled by temperature: tensor([[178]], device='cuda:0')
action picked by argmax: tensor([120], device='cuda:0')
tensor([[120, 221,  74,  40,  63, 106, 111, 170, 249, 153]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
140         1      121       4       141
340         2      121       4        68
548         3      121       4         3
1028        4      121       4       210
1324        5      121       4       233
       user_id  item_id  rating  timestep
12449       46      121       3       165
12767       47      121       4       210
13025       48      121       4       195
13269       49      121       4       166
13383       50      121       4         7
average_rating for this rec across 50 users from same group (less noisy) was: 4.02
all_actions shape just before sample torch.Size([1, 21, 1])
action scaled by temperature: tensor([[111]], device='cuda:0')
action picked by argmax: tensor([120], device='cuda:0')
tensor([[120, 221,  63,  40,  74, 106, 111, 170, 249, 144]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
140         1      121       4       141
340         2      121       4        68
548         3      121       4         3
1028        4      121       4       210
1324        5      121       4       233
       user_id  item_id  rating  timestep
12449       46      121       3       165
12767       47      121       4       210
13025       48      121       4       195
13269       49      121       4       166
13383       50      121       4         7
average_rating for this rec across 50 users from same group (less noisy) was: 4.02
all_actions shape just before sample torch.Size([1, 22, 1])
action scaled by temperature: tensor([[136]], device='cuda:0')
action picked by argmax: tensor([120], device='cuda:0')
tensor([[120, 221,  63,  74,  40, 106, 111, 170, 249, 144]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
140         1      121       4       141
340         2      121       4        68
548         3      121       4         3
1028        4      121       4       210
1324        5      121       4       233
       user_id  item_id  rating  timestep
12449       46      121       3       165
12767       47      121       4       210
13025       48      121       4       195
13269       49      121       4       166
13383       50      121       4         7
average_rating for this rec across 50 users from same group (less noisy) was: 4.02
all_actions shape just before sample torch.Size([1, 23, 1])
action scaled by temperature: tensor([[83]], device='cuda:0')
action picked by argmax: tensor([120], device='cuda:0')
tensor([[120,  40,  74, 221, 106,  63, 170, 249, 111, 153]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
140         1      121       4       141
340         2      121       4        68
548         3      121       4         3
1028        4      121       4       210
1324        5      121       4       233
       user_id  item_id  rating  timestep
12449       46      121       3       165
12767       47      121       4       210
13025       48      121       4       195
13269       49      121       4       166
13383       50      121       4         7
average_rating for this rec across 50 users from same group (less noisy) was: 4.02
all_actions shape just before sample torch.Size([1, 24, 1])
action scaled by temperature: tensor([[95]], device='cuda:0')
action picked by argmax: tensor([120], device='cuda:0')
tensor([[120,  40, 106,  63, 221,  74, 170, 111, 162, 249]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
140         1      121       4       141
340         2      121       4        68
548         3      121       4         3
1028        4      121       4       210
1324        5      121       4       233
       user_id  item_id  rating  timestep
12449       46      121       3       165
12767       47      121       4       210
13025       48      121       4       195
13269       49      121       4       166
13383       50      121       4         7
average_rating for this rec across 50 users from same group (less noisy) was: 4.02
all_actions shape just before sample torch.Size([1, 25, 1])
action scaled by temperature: tensor([[113]], device='cuda:0')
action picked by argmax: tensor([120], device='cuda:0')
tensor([[120,  40, 106,  63,  74, 221, 249, 170, 162, 153]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
140         1      121       4       141
340         2      121       4        68
548         3      121       4         3
1028        4      121       4       210
1324        5      121       4       233
       user_id  item_id  rating  timestep
12449       46      121       3       165
12767       47      121       4       210
13025       48      121       4       195
13269       49      121       4       166
13383       50      121       4         7
average_rating for this rec across 50 users from same group (less noisy) was: 4.02
all_actions shape just before sample torch.Size([1, 26, 1])
action scaled by temperature: tensor([[0]], device='cuda:0')
action picked by argmax: tensor([106], device='cuda:0')
tensor([[106, 120,  40, 251, 249, 162, 170,  63, 153, 207]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
173         1      107       4       174
382         2      107       4       110
769         3      107       4       224
995         4      107       5       177
1261        5      107       4       170
       user_id  item_id  rating  timestep
12344       46      107       3        60
12657       47      107       4       100
12939       48      107       5       109
13284       49      107       3       181
13531       50      107       4       155
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 27, 1])
action scaled by temperature: tensor([[258]], device='cuda:0')
action picked by argmax: tensor([106], device='cuda:0')
tensor([[106, 251,  40, 152, 121,  55,   0,  64, 139, 102]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
173         1      107       4       174
382         2      107       4       110
769         3      107       4       224
995         4      107       5       177
1261        5      107       4       170
       user_id  item_id  rating  timestep
12344       46      107       3        60
12657       47      107       4       100
12939       48      107       5       109
13284       49      107       3       181
13531       50      107       4       155
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 28, 1])
action scaled by temperature: tensor([[68]], device='cuda:0')
action picked by argmax: tensor([106], device='cuda:0')
tensor([[106,  40, 251,  55, 152,   0, 102, 121, 227, 139]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
173         1      107       4       174
382         2      107       4       110
769         3      107       4       224
995         4      107       5       177
1261        5      107       4       170
       user_id  item_id  rating  timestep
12344       46      107       3        60
12657       47      107       4       100
12939       48      107       5       109
13284       49      107       3       181
13531       50      107       4       155
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 29, 1])
action scaled by temperature: tensor([[148]], device='cuda:0')
action picked by argmax: tensor([40], device='cuda:0')
tensor([[ 40, 106, 251, 231, 121, 152,  55,   0, 227,  10]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
66          1       41       4        67
353         2       41       5        81
756         3       41       3       211
1060        4       41       2       242
1343        5       41       3       252
       user_id  item_id  rating  timestep
12376       46       41       3        92
12615       47       41       3        58
12882       48       41       3        52
13156       49       41       5        53
13485       50       41       4       109
average_rating for this rec across 50 users from same group (less noisy) was: 3.66
all_actions shape just before sample torch.Size([1, 30, 1])
action scaled by temperature: tensor([[158]], device='cuda:0')
action picked by argmax: tensor([40], device='cuda:0')
tensor([[ 40,  10, 141, 158, 196,  54, 133, 237, 231, 121]], device='cuda:0')
Just recommended 30 new items to 50 users from group 1 and the total rating was 116.55999999999997
train_loss is: 5.322082541304637
action scaled by temperature: tensor([[152]], device='cuda:0')
action picked by argmax: tensor([117], device='cuda:0')
tensor([[117,  35, 263, 187, 211, 109, 148, 155,  30, 247]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
70          1      118       4        71
404         2      118       4       132
643         3      118       5        98
1000        4      118       5       182
1302        5      118       4       211
       user_id  item_id  rating  timestep
12489       46      118       4       205
12576       47      118       4        19
12923       48      118       4        93
13374       49      118       3       271
13566       50      118       4       190
average_rating for this rec across 50 users from same group (less noisy) was: 4.3
all_actions shape just before sample torch.Size([1, 1, 1])
action scaled by temperature: tensor([[200]], device='cuda:0')
action picked by argmax: tensor([117], device='cuda:0')
tensor([[117, 263, 245,  35,  30, 187,  43, 247, 109, 155]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
70          1      118       4        71
404         2      118       4       132
643         3      118       5        98
1000        4      118       5       182
1302        5      118       4       211
       user_id  item_id  rating  timestep
12489       46      118       4       205
12576       47      118       4        19
12923       48      118       4        93
13374       49      118       3       271
13566       50      118       4       190
average_rating for this rec across 50 users from same group (less noisy) was: 4.3
all_actions shape just before sample torch.Size([1, 2, 1])
action scaled by temperature: tensor([[194]], device='cuda:0')
action picked by argmax: tensor([117], device='cuda:0')
tensor([[117, 263, 245,  43,  35,  30, 109, 180, 247, 187]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
70          1      118       4        71
404         2      118       4       132
643         3      118       5        98
1000        4      118       5       182
1302        5      118       4       211
       user_id  item_id  rating  timestep
12489       46      118       4       205
12576       47      118       4        19
12923       48      118       4        93
13374       49      118       3       271
13566       50      118       4       190
average_rating for this rec across 50 users from same group (less noisy) was: 4.3
all_actions shape just before sample torch.Size([1, 3, 1])
action scaled by temperature: tensor([[152]], device='cuda:0')
action picked by argmax: tensor([117], device='cuda:0')
tensor([[117, 263,  30,  43, 247, 180, 109, 245,  35, 187]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
70          1      118       4        71
404         2      118       4       132
643         3      118       5        98
1000        4      118       5       182
1302        5      118       4       211
       user_id  item_id  rating  timestep
12489       46      118       4       205
12576       47      118       4        19
12923       48      118       4        93
13374       49      118       3       271
13566       50      118       4       190
average_rating for this rec across 50 users from same group (less noisy) was: 4.3
all_actions shape just before sample torch.Size([1, 4, 1])
action scaled by temperature: tensor([[21]], device='cuda:0')
action picked by argmax: tensor([117], device='cuda:0')
tensor([[117, 148,  30, 119, 247, 180, 137, 109,  35, 187]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
70          1      118       4        71
404         2      118       4       132
643         3      118       5        98
1000        4      118       5       182
1302        5      118       4       211
       user_id  item_id  rating  timestep
12489       46      118       4       205
12576       47      118       4        19
12923       48      118       4        93
13374       49      118       3       271
13566       50      118       4       190
average_rating for this rec across 50 users from same group (less noisy) was: 4.3
all_actions shape just before sample torch.Size([1, 5, 1])
action scaled by temperature: tensor([[98]], device='cuda:0')
action picked by argmax: tensor([119], device='cuda:0')
tensor([[119, 117, 148,  30, 180, 137, 247, 174, 213,  35]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
138         1      120       5       139
524         2      120       4       252
674         3      120       2       129
957         4      120       2       139
1242        5      120       3       151
       user_id  item_id  rating  timestep
12334       46      120       4        50
12574       47      120       3        17
12876       48      120       5        46
13120       49      120       5        17
13389       50      120       5        13
average_rating for this rec across 50 users from same group (less noisy) was: 3.74
all_actions shape just before sample torch.Size([1, 6, 1])
action scaled by temperature: tensor([[148]], device='cuda:0')
action picked by argmax: tensor([117], device='cuda:0')
tensor([[117, 119,  30, 247, 180, 148, 137, 109,  43, 187]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
70          1      118       4        71
404         2      118       4       132
643         3      118       5        98
1000        4      118       5       182
1302        5      118       4       211
       user_id  item_id  rating  timestep
12489       46      118       4       205
12576       47      118       4        19
12923       48      118       4        93
13374       49      118       3       271
13566       50      118       4       190
average_rating for this rec across 50 users from same group (less noisy) was: 4.3
all_actions shape just before sample torch.Size([1, 7, 1])
action scaled by temperature: tensor([[61]], device='cuda:0')
action picked by argmax: tensor([119], device='cuda:0')
tensor([[119, 148, 117,  30, 137, 174, 180, 247,   7, 187]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
138         1      120       5       139
524         2      120       4       252
674         3      120       2       129
957         4      120       2       139
1242        5      120       3       151
       user_id  item_id  rating  timestep
12334       46      120       4        50
12574       47      120       3        17
12876       48      120       5        46
13120       49      120       5        17
13389       50      120       5        13
average_rating for this rec across 50 users from same group (less noisy) was: 3.74
all_actions shape just before sample torch.Size([1, 8, 1])
action scaled by temperature: tensor([[87]], device='cuda:0')
action picked by argmax: tensor([117], device='cuda:0')
tensor([[117, 119,  30, 148, 137, 247, 174, 180, 187, 109]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
70          1      118       4        71
404         2      118       4       132
643         3      118       5        98
1000        4      118       5       182
1302        5      118       4       211
       user_id  item_id  rating  timestep
12489       46      118       4       205
12576       47      118       4        19
12923       48      118       4        93
13374       49      118       3       271
13566       50      118       4       190
average_rating for this rec across 50 users from same group (less noisy) was: 4.3
all_actions shape just before sample torch.Size([1, 9, 1])
action scaled by temperature: tensor([[258]], device='cuda:0')
action picked by argmax: tensor([148], device='cuda:0')
tensor([[148, 239, 119,  30, 137, 100, 142, 174, 166, 162]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
222         1      149       2       223
489         2      149       4       217
780         3      149       3       235
836         4      149       3        18
1112        5      149       3        21
       user_id  item_id  rating  timestep
12501       46      149       3       217
12704       47      149       3       147
12841       48      149       4        11
13331       49      149       4       228
13494       50      149       4       118
average_rating for this rec across 50 users from same group (less noisy) was: 3.48
all_actions shape just before sample torch.Size([1, 10, 1])
action scaled by temperature: tensor([[213]], device='cuda:0')
action picked by argmax: tensor([57], device='cuda:0')
tensor([[ 57, 242,  41, 151, 208, 131, 121, 217,  38,  46]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
131         1       58       4       132
278         2       58       3         6
816         3       58       4       271
852         4       58       5        34
1130        5       58       4        39
       user_id  item_id  rating  timestep
12496       46       58       3       212
12725       47       58       3       168
12938       48       58       4       108
13152       49       58       3        49
13512       50       58       5       136
average_rating for this rec across 50 users from same group (less noisy) was: 3.88
all_actions shape just before sample torch.Size([1, 11, 1])
action scaled by temperature: tensor([[242]], device='cuda:0')
action picked by argmax: tensor([41], device='cuda:0')
tensor([[ 41, 121, 242,  57, 208,  38,   5, 151, 167,   8]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
112         1       42       5       113
421         2       42       5       149
786         3       42       4       241
887         4       42       5        69
1307        5       42       4       216
       user_id  item_id  rating  timestep
12392       46       42       4       108
12660       47       42       5       103
13038       48       42       5       208
13134       49       42       5        31
13377       50       42       5         1
average_rating for this rec across 50 users from same group (less noisy) was: 4.74
all_actions shape just before sample torch.Size([1, 12, 1])
action scaled by temperature: tensor([[18]], device='cuda:0')
action picked by argmax: tensor([41], device='cuda:0')
tensor([[ 41, 242, 167, 217, 121,  57,  38, 131, 208,   8]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
112         1       42       5       113
421         2       42       5       149
786         3       42       4       241
887         4       42       5        69
1307        5       42       4       216
       user_id  item_id  rating  timestep
12392       46       42       4       108
12660       47       42       5       103
13038       48       42       5       208
13134       49       42       5        31
13377       50       42       5         1
average_rating for this rec across 50 users from same group (less noisy) was: 4.74
all_actions shape just before sample torch.Size([1, 13, 1])
action scaled by temperature: tensor([[150]], device='cuda:0')
action picked by argmax: tensor([167], device='cuda:0')
tensor([[167, 242,  38,  77,   8,  41, 208,  55,  59,  84]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
38          1      168       5        39
418         2      168       3       146
699         3      168       4       154
928         4      168       5       110
1133        5      168       5        42
       user_id  item_id  rating  timestep
12493       46      168       3       209
12781       47      168       4       224
12921       48      168       3        91
13219       49      168       5       116
13564       50      168       4       188
average_rating for this rec across 50 users from same group (less noisy) was: 4.08
all_actions shape just before sample torch.Size([1, 14, 1])
action scaled by temperature: tensor([[204]], device='cuda:0')
action picked by argmax: tensor([232], device='cuda:0')
tensor([[232, 174, 199, 194, 111, 207, 106,  12, 120, 217]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
209         1      233       4       210
448         2      233       4       176
785         3      233       4       240
874         4      233       4        56
1180        5      233       4        89
       user_id  item_id  rating  timestep
12504       46      233       4       220
12773       47      233       5       216
12931       48      233       5       101
13193       49      233       4        90
13555       50      233       3       179
average_rating for this rec across 50 users from same group (less noisy) was: 4.08
all_actions shape just before sample torch.Size([1, 15, 1])
action scaled by temperature: tensor([[48]], device='cuda:0')
action picked by argmax: tensor([174], device='cuda:0')
tensor([[174, 232, 111, 199, 194, 217,  12, 152, 171, 208]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
215         1      175       5       216
403         2      175       3       131
698         3      175       5       153
1024        4      175       5       206
1243        5      175       4       152
       user_id  item_id  rating  timestep
12292       46      175       4         8
12752       47      175       4       195
13084       48      175       5       254
13258       49      175       5       155
13595       50      175       4       219
average_rating for this rec across 50 users from same group (less noisy) was: 4.58
all_actions shape just before sample torch.Size([1, 16, 1])
action scaled by temperature: tensor([[231]], device='cuda:0')
action picked by argmax: tensor([27], device='cuda:0')
tensor([[ 27, 212, 231, 245, 222,  35, 109, 203,  70, 239]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
0           1       28       4         1
294         2       28       4        22
736         3       28       5       191
1051        4       28       5       233
1244        5       28       3       153
       user_id  item_id  rating  timestep
12297       46       28       3        13
12763       47       28       4       206
13040       48       28       5       210
13309       49       28       5       206
13583       50       28       5       207
average_rating for this rec across 50 users from same group (less noisy) was: 4.3
all_actions shape just before sample torch.Size([1, 17, 1])
action scaled by temperature: tensor([[58]], device='cuda:0')
action picked by argmax: tensor([203], device='cuda:0')
tensor([[203, 212,  35, 231, 222,  27, 244, 168,  15, 133]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
63          1      204       3        64
400         2      204       3       128
755         3      204       3       210
1045        4      204       4       227
1220        5      204       3       129
       user_id  item_id  rating  timestep
12398       46      204       4       114
12571       47      204       5        14
12977       48      204       3       147
13282       49      204       4       179
13547       50      204       4       171
average_rating for this rec across 50 users from same group (less noisy) was: 3.52
all_actions shape just before sample torch.Size([1, 18, 1])
action scaled by temperature: tensor([[58]], device='cuda:0')
action picked by argmax: tensor([35], device='cuda:0')
tensor([[ 35, 203, 212, 231, 226,  13, 168, 244, 252, 164]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
155         1       36       4       156
356         2       36       4        84
651         3       36       5       106
923         4       36       5       105
1293        5       36       4       202
       user_id  item_id  rating  timestep
12444       46       36       5       160
12705       47       36       5       148
13096       48       36       5       266
13242       49       36       4       139
13488       50       36       4       112
average_rating for this rec across 50 users from same group (less noisy) was: 4.46
all_actions shape just before sample torch.Size([1, 19, 1])
action scaled by temperature: tensor([[158]], device='cuda:0')
action picked by argmax: tensor([161], device='cuda:0')
tensor([[161, 157, 212, 191, 177, 256,  80, 179, 160, 257]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
43          1      162       5        44
465         2      162       3       193
730         3      162       4       185
1044        4      162       4       226
1294        5      162       4       203
       user_id  item_id  rating  timestep
12438       46      162       4       154
12716       47      162       4       159
13031       48      162       5       201
13132       49      162       4        29
13539       50      162       3       163
average_rating for this rec across 50 users from same group (less noisy) was: 4.26
all_actions shape just before sample torch.Size([1, 20, 1])
action scaled by temperature: tensor([[84]], device='cuda:0')
action picked by argmax: tensor([157], device='cuda:0')
tensor([[157, 161, 248, 177, 191, 142,  42, 218, 164, 179]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
156         1      158       4       157
496         2      158       5       224
798         3      158       4       253
1015        4      158       4       197
1351        5      158       4       260
       user_id  item_id  rating  timestep
12457       46      158       4       173
12809       47      158       5       252
13046       48      158       5       216
13322       49      158       3       219
13399       50      158       5        23
average_rating for this rec across 50 users from same group (less noisy) was: 4.42
all_actions shape just before sample torch.Size([1, 21, 1])
action scaled by temperature: tensor([[13]], device='cuda:0')
action picked by argmax: tensor([115], device='cuda:0')
tensor([[115, 179, 177,  42,  87, 161, 190, 112, 237,  28]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
67          1      116       4        68
361         2      116       5        89
638         3      116       5        93
996         4      116       5       178
1352        5      116       4       261
       user_id  item_id  rating  timestep
12312       46      116       3        28
12563       47      116       4         6
12970       48      116       4       140
13358       49      116       5       255
13484       50      116       5       108
average_rating for this rec across 50 users from same group (less noisy) was: 4.28
all_actions shape just before sample torch.Size([1, 22, 1])
action scaled by temperature: tensor([[63]], device='cuda:0')
action picked by argmax: tensor([115], device='cuda:0')
tensor([[115, 177, 179,  87, 112,  42, 140,  28, 190, 161]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
67          1      116       4        68
361         2      116       5        89
638         3      116       5        93
996         4      116       5       178
1352        5      116       4       261
       user_id  item_id  rating  timestep
12312       46      116       3        28
12563       47      116       4         6
12970       48      116       4       140
13358       49      116       5       255
13484       50      116       5       108
average_rating for this rec across 50 users from same group (less noisy) was: 4.28
all_actions shape just before sample torch.Size([1, 23, 1])
action scaled by temperature: tensor([[262]], device='cuda:0')
action picked by argmax: tensor([115], device='cuda:0')
tensor([[115, 179, 177,  87, 140, 112,  28,  42, 190, 237]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
67          1      116       4        68
361         2      116       5        89
638         3      116       5        93
996         4      116       5       178
1352        5      116       4       261
       user_id  item_id  rating  timestep
12312       46      116       3        28
12563       47      116       4         6
12970       48      116       4       140
13358       49      116       5       255
13484       50      116       5       108
average_rating for this rec across 50 users from same group (less noisy) was: 4.28
all_actions shape just before sample torch.Size([1, 24, 1])
action scaled by temperature: tensor([[109]], device='cuda:0')
action picked by argmax: tensor([140], device='cuda:0')
tensor([[140,  87, 179, 115, 177, 190,  28,  42, 161, 237]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
251         1      141       3       252
306         2      141       5        34
794         3      141       5       249
1064        4      141       1       246
1339        5      141       4       248
       user_id  item_id  rating  timestep
12480       46      141       3       196
12668       47      141       4       111
12998       48      141       4       168
13234       49      141       5       131
13406       50      141       4        30
average_rating for this rec across 50 users from same group (less noisy) was: 3.82
all_actions shape just before sample torch.Size([1, 25, 1])
action scaled by temperature: tensor([[140]], device='cuda:0')
action picked by argmax: tensor([87], device='cuda:0')
tensor([[ 87, 115,  28, 177, 179,  47, 140, 237, 190,  13]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
100         1       88       5       101
371         2       88       3        99
604         3       88       5        59
1067        4       88       2       249
1296        5       88       4       205
       user_id  item_id  rating  timestep
12380       46       88       3        96
12761       47       88       5       204
12910       48       88       4        80
13257       49       88       3       154
13501       50       88       4       125
average_rating for this rec across 50 users from same group (less noisy) was: 3.98
all_actions shape just before sample torch.Size([1, 26, 1])
action scaled by temperature: tensor([[149]], device='cuda:0')
action picked by argmax: tensor([143], device='cuda:0')
tensor([[143, 190, 191,  13, 179, 161, 115,  28, 157,  89]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
106         1      144       4       107
528         2      144       4       256
803         3      144       5       258
944         4      144       5       126
1205        5      144       4       114
       user_id  item_id  rating  timestep
12458       46      144       4       174
12825       47      144       4       268
12999       48      144       4       169
13140       49      144       3        37
13640       50      144       5       264
average_rating for this rec across 50 users from same group (less noisy) was: 4.12
all_actions shape just before sample torch.Size([1, 27, 1])
action scaled by temperature: tensor([[93]], device='cuda:0')
action picked by argmax: tensor([190], device='cuda:0')
tensor([[190,  87, 140,  47, 170,  28, 143, 262, 157, 237]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
128         1      191       5       129
357         2      191       4        85
609         3      191       4        64
862         4      191       5        44
1319        5      191       4       228
       user_id  item_id  rating  timestep
12515       46      191       5       231
12649       47      191       5        92
12915       48      191       4        85
13130       49      191       5        27
13506       50      191       5       130
average_rating for this rec across 50 users from same group (less noisy) was: 4.48
all_actions shape just before sample torch.Size([1, 28, 1])
action scaled by temperature: tensor([[210]], device='cuda:0')
action picked by argmax: tensor([190], device='cuda:0')
tensor([[190, 143,  87,  28, 262,  47,  13, 140, 157, 170]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
128         1      191       5       129
357         2      191       4        85
609         3      191       4        64
862         4      191       5        44
1319        5      191       4       228
       user_id  item_id  rating  timestep
12515       46      191       5       231
12649       47      191       5        92
12915       48      191       4        85
13130       49      191       5        27
13506       50      191       5       130
average_rating for this rec across 50 users from same group (less noisy) was: 4.48
all_actions shape just before sample torch.Size([1, 29, 1])
action scaled by temperature: tensor([[210]], device='cuda:0')
action picked by argmax: tensor([140], device='cuda:0')
tensor([[140,  87,  28, 190, 262, 177, 157, 143, 170,  13]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
251         1      141       3       252
306         2      141       5        34
794         3      141       5       249
1064        4      141       1       246
1339        5      141       4       248
       user_id  item_id  rating  timestep
12480       46      141       3       196
12668       47      141       4       111
12998       48      141       4       168
13234       49      141       5       131
13406       50      141       4        30
average_rating for this rec across 50 users from same group (less noisy) was: 3.82
all_actions shape just before sample torch.Size([1, 30, 1])
action scaled by temperature: tensor([[175]], device='cuda:0')
action picked by argmax: tensor([87], device='cuda:0')
tensor([[ 87, 140,  28, 190, 170,  76,  47, 262,  13,  18]], device='cuda:0')
Just recommended 30 new items to 50 users from group 1 and the total rating was 125.66
train_loss is: 5.020728575040216
action scaled by temperature: tensor([[58]], device='cuda:0')
action picked by argmax: tensor([250], device='cuda:0')
tensor([[250,   0,  27, 100,  35, 247, 245, 235,  13,  22]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
22          1      251       5        23
442         2      251       4       170
691         3      251       3       146
846         4      251       3        28
1092        5      251       4         1
       user_id  item_id  rating  timestep
12533       46      251       5       249
12709       47      251       5       152
13094       48      251       4       264
13262       49      251       2       159
13395       50      251       4        19
average_rating for this rec across 50 users from same group (less noisy) was: 3.88
all_actions shape just before sample torch.Size([1, 1, 1])
action scaled by temperature: tensor([[125]], device='cuda:0')
action picked by argmax: tensor([235], device='cuda:0')
tensor([[235,   0, 247, 100,  87,  27,  22, 120, 250, 180]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
57          1      236       5        58
392         2      236       4       120
770         3      236       4       225
825         4      236       5         7
1151        5      236       4        60
       user_id  item_id  rating  timestep
12321       46      236       3        37
12669       47      236       5       112
12940       48      236       3       110
13113       49      236       4        10
13638       50      236       3       262
average_rating for this rec across 50 users from same group (less noisy) was: 4.26
all_actions shape just before sample torch.Size([1, 2, 1])
action scaled by temperature: tensor([[53]], device='cuda:0')
action picked by argmax: tensor([196], device='cuda:0')
tensor([[196, 250, 103, 169,  90, 255,  83,  81,  10, 141]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
98          1      197       3        99
369         2      197       4        97
729         3      197       3       184
867         4      197       5        49
1109        5      197       4        18
       user_id  item_id  rating  timestep
12311       46      197       2        27
12645       47      197       4        88
13014       48      197       3       184
13119       49      197       1        16
13636       50      197       3       260
average_rating for this rec across 50 users from same group (less noisy) was: 3.28
all_actions shape just before sample torch.Size([1, 3, 1])
action scaled by temperature: tensor([[183]], device='cuda:0')
action picked by argmax: tensor([250], device='cuda:0')
tensor([[250, 196,  90,  83, 141, 103,  81,  10, 244, 156]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
22          1      251       5        23
442         2      251       4       170
691         3      251       3       146
846         4      251       3        28
1092        5      251       4         1
       user_id  item_id  rating  timestep
12533       46      251       5       249
12709       47      251       5       152
13094       48      251       4       264
13262       49      251       2       159
13395       50      251       4        19
average_rating for this rec across 50 users from same group (less noisy) was: 3.88
all_actions shape just before sample torch.Size([1, 4, 1])
action scaled by temperature: tensor([[128]], device='cuda:0')
action picked by argmax: tensor([250], device='cuda:0')
tensor([[250, 169,  13,  83, 244,  51,  10,  62,  42, 159]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
22          1      251       5        23
442         2      251       4       170
691         3      251       3       146
846         4      251       3        28
1092        5      251       4         1
       user_id  item_id  rating  timestep
12533       46      251       5       249
12709       47      251       5       152
13094       48      251       4       264
13262       49      251       2       159
13395       50      251       4        19
average_rating for this rec across 50 users from same group (less noisy) was: 3.88
all_actions shape just before sample torch.Size([1, 5, 1])
action scaled by temperature: tensor([[133]], device='cuda:0')
action picked by argmax: tensor([42], device='cuda:0')
tensor([[ 42, 123,  22,  13, 119,  62, 261, 197, 160, 172]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
208         1       43       2       209
518         2       43       5       246
577         3       43       5        32
981         4       43       4       163
1203        5       43       4       112
       user_id  item_id  rating  timestep
12510       46       43       3       226
12665       47       43       3       108
12896       48       43       5        66
13195       49       43       4        92
13464       50       43       3        88
average_rating for this rec across 50 users from same group (less noisy) was: 3.86
all_actions shape just before sample torch.Size([1, 6, 1])
action scaled by temperature: tensor([[40]], device='cuda:0')
action picked by argmax: tensor([74], device='cuda:0')
tensor([[ 74, 161, 271, 153, 221, 218, 170, 150, 173,  48]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
195         1       75       5       196
284         2       75       5        12
737         3       75       5       192
1026        4       75       4       208
1111        5       75       3        20
       user_id  item_id  rating  timestep
12410       46       75       5       126
12652       47       75       3        95
12974       48       75       3       144
13348       49       75       2       245
13573       50       75       4       197
average_rating for this rec across 50 users from same group (less noisy) was: 3.6
all_actions shape just before sample torch.Size([1, 7, 1])
action scaled by temperature: tensor([[235]], device='cuda:0')
action picked by argmax: tensor([161], device='cuda:0')
tensor([[161, 271, 173, 218, 184,  35, 100, 150, 170,  17]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
43          1      162       5        44
465         2      162       3       193
730         3      162       4       185
1044        4      162       4       226
1294        5      162       4       203
       user_id  item_id  rating  timestep
12438       46      162       4       154
12716       47      162       4       159
13031       48      162       5       201
13132       49      162       4        29
13539       50      162       3       163
average_rating for this rec across 50 users from same group (less noisy) was: 4.26
all_actions shape just before sample torch.Size([1, 8, 1])
action scaled by temperature: tensor([[131]], device='cuda:0')
action picked by argmax: tensor([100], device='cuda:0')
tensor([[100, 179, 167,  32, 150,  58, 126, 189, 240,  90]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
5           1      101       3         6
322         2      101       4        50
763         3      101       2       218
946         4      101       5       128
1161        5      101       4        70
       user_id  item_id  rating  timestep
12556       46      101       3       272
12579       47      101       4        22
12877       48      101       5        47
13370       49      101       3       267
13597       50      101       5       221
average_rating for this rec across 50 users from same group (less noisy) was: 3.72
all_actions shape just before sample torch.Size([1, 9, 1])
action scaled by temperature: tensor([[258]], device='cuda:0')
action picked by argmax: tensor([100], device='cuda:0')
tensor([[100, 107, 240, 189,  32,  90, 218, 126, 200,  84]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
5           1      101       3         6
322         2      101       4        50
763         3      101       2       218
946         4      101       5       128
1161        5      101       4        70
       user_id  item_id  rating  timestep
12556       46      101       3       272
12579       47      101       4        22
12877       48      101       5        47
13370       49      101       3       267
13597       50      101       5       221
average_rating for this rec across 50 users from same group (less noisy) was: 3.72
all_actions shape just before sample torch.Size([1, 10, 1])
action scaled by temperature: tensor([[134]], device='cuda:0')
action picked by argmax: tensor([107], device='cuda:0')
tensor([[107, 100,  84,  77, 208, 200, 233, 240,  32, 218]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
137         1      108       4       138
320         2      108       5        48
555         3      108       5        10
1033        4      108       4       215
1304        5      108       4       213
       user_id  item_id  rating  timestep
12385       46      108       5       101
12814       47      108       4       257
12864       48      108       5        34
13276       49      108       4       173
13592       50      108       5       216
average_rating for this rec across 50 users from same group (less noisy) was: 4.4
all_actions shape just before sample torch.Size([1, 11, 1])
action scaled by temperature: tensor([[98]], device='cuda:0')
action picked by argmax: tensor([107], device='cuda:0')
tensor([[107, 189, 233, 100, 240, 218, 126,  91, 134, 146]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
137         1      108       4       138
320         2      108       5        48
555         3      108       5        10
1033        4      108       4       215
1304        5      108       4       213
       user_id  item_id  rating  timestep
12385       46      108       5       101
12814       47      108       4       257
12864       48      108       5        34
13276       49      108       4       173
13592       50      108       5       216
average_rating for this rec across 50 users from same group (less noisy) was: 4.4
all_actions shape just before sample torch.Size([1, 12, 1])
action scaled by temperature: tensor([[54]], device='cuda:0')
action picked by argmax: tensor([189], device='cuda:0')
tensor([[189, 107, 233, 134, 126, 100, 218, 240,  84, 216]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
54          1      190       5        55
354         2      190       4        82
732         3      190       4       187
1016        4      190       4       198
1119        5      190       5        28
       user_id  item_id  rating  timestep
12308       46      190       3        24
12634       47      190       4        77
13085       48      190       4       255
13209       49      190       4       106
13502       50      190       5       126
average_rating for this rec across 50 users from same group (less noisy) was: 4.14
all_actions shape just before sample torch.Size([1, 13, 1])
action scaled by temperature: tensor([[200]], device='cuda:0')
action picked by argmax: tensor([164], device='cuda:0')
tensor([[164, 259, 132, 179, 214, 151, 131,   5,  84, 193]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
64          1      165       5        65
381         2      165       4       109
758         3      165       4       213
1003        4      165       5       185
1276        5      165       5       185
       user_id  item_id  rating  timestep
12289       46      165       4         5
12681       47      165       4       124
13095       48      165       5       265
13328       49      165       4       225
13633       50      165       3       257
average_rating for this rec across 50 users from same group (less noisy) was: 4.02
all_actions shape just before sample torch.Size([1, 14, 1])
action scaled by temperature: tensor([[225]], device='cuda:0')
action picked by argmax: tensor([146], device='cuda:0')
tensor([[146, 164, 179, 242, 186,  30, 250, 113,  28, 243]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
97          1      147       4        98
492         2      147       4       220
612         3      147       4        67
897         4      147       3        79
1350        5      147       5       259
       user_id  item_id  rating  timestep
12336       46      147       5        52
12647       47      147       4        90
12962       48      147       4       132
13367       49      147       4       264
13443       50      147       5        67
average_rating for this rec across 50 users from same group (less noisy) was: 4.24
all_actions shape just before sample torch.Size([1, 15, 1])
action scaled by temperature: tensor([[182]], device='cuda:0')
action picked by argmax: tensor([164], device='cuda:0')
tensor([[164, 146, 179,  79, 188, 186,  49,   6, 243,  30]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
64          1      165       5        65
381         2      165       4       109
758         3      165       4       213
1003        4      165       5       185
1276        5      165       5       185
       user_id  item_id  rating  timestep
12289       46      165       4         5
12681       47      165       4       124
13095       48      165       5       265
13328       49      165       4       225
13633       50      165       3       257
average_rating for this rec across 50 users from same group (less noisy) was: 4.02
all_actions shape just before sample torch.Size([1, 16, 1])
action scaled by temperature: tensor([[55]], device='cuda:0')
action picked by argmax: tensor([146], device='cuda:0')
tensor([[146, 149,  49, 179, 164,  79, 222,   6, 186,  28]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
97          1      147       4        98
492         2      147       4       220
612         3      147       4        67
897         4      147       3        79
1350        5      147       5       259
       user_id  item_id  rating  timestep
12336       46      147       5        52
12647       47      147       4        90
12962       48      147       4       132
13367       49      147       4       264
13443       50      147       5        67
average_rating for this rec across 50 users from same group (less noisy) was: 4.24
all_actions shape just before sample torch.Size([1, 17, 1])
action scaled by temperature: tensor([[244]], device='cuda:0')
action picked by argmax: tensor([149], device='cuda:0')
tensor([[149,  49, 164, 179, 243,   6, 146,  79, 188, 186]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
59          1      150       4        60
274         2      150       1         2
792         3      150       3       247
952         4      150       4       134
1175        5      150       3        84
       user_id  item_id  rating  timestep
12343       46      150       3        59
12750       47      150       3       193
13050       48      150       2       220
13125       49      150       2        22
13522       50      150       4       146
average_rating for this rec across 50 users from same group (less noisy) was: 3.26
all_actions shape just before sample torch.Size([1, 18, 1])
action scaled by temperature: tensor([[168]], device='cuda:0')
action picked by argmax: tensor([149], device='cuda:0')
tensor([[149,  79, 164, 243, 146,   6,  49,  25, 188, 117]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
59          1      150       4        60
274         2      150       1         2
792         3      150       3       247
952         4      150       4       134
1175        5      150       3        84
       user_id  item_id  rating  timestep
12343       46      150       3        59
12750       47      150       3       193
13050       48      150       2       220
13125       49      150       2        22
13522       50      150       4       146
average_rating for this rec across 50 users from same group (less noisy) was: 3.26
all_actions shape just before sample torch.Size([1, 19, 1])
action scaled by temperature: tensor([[176]], device='cuda:0')
action picked by argmax: tensor([149], device='cuda:0')
tensor([[149,   6, 243, 164,  49,  79, 201, 125, 151, 146]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
59          1      150       4        60
274         2      150       1         2
792         3      150       3       247
952         4      150       4       134
1175        5      150       3        84
       user_id  item_id  rating  timestep
12343       46      150       3        59
12750       47      150       3       193
13050       48      150       2       220
13125       49      150       2        22
13522       50      150       4       146
average_rating for this rec across 50 users from same group (less noisy) was: 3.26
all_actions shape just before sample torch.Size([1, 20, 1])
action scaled by temperature: tensor([[52]], device='cuda:0')
action picked by argmax: tensor([149], device='cuda:0')
tensor([[149,   6, 243,  79,  49, 146, 201, 191,  25, 164]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
59          1      150       4        60
274         2      150       1         2
792         3      150       3       247
952         4      150       4       134
1175        5      150       3        84
       user_id  item_id  rating  timestep
12343       46      150       3        59
12750       47      150       3       193
13050       48      150       2       220
13125       49      150       2        22
13522       50      150       4       146
average_rating for this rec across 50 users from same group (less noisy) was: 3.26
all_actions shape just before sample torch.Size([1, 21, 1])
action scaled by temperature: tensor([[23]], device='cuda:0')
action picked by argmax: tensor([149], device='cuda:0')
tensor([[149, 125,   6, 201, 243, 245,  49,  79, 222, 164]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
59          1      150       4        60
274         2      150       1         2
792         3      150       3       247
952         4      150       4       134
1175        5      150       3        84
       user_id  item_id  rating  timestep
12343       46      150       3        59
12750       47      150       3       193
13050       48      150       2       220
13125       49      150       2        22
13522       50      150       4       146
average_rating for this rec across 50 users from same group (less noisy) was: 3.26
all_actions shape just before sample torch.Size([1, 22, 1])
action scaled by temperature: tensor([[151]], device='cuda:0')
action picked by argmax: tensor([149], device='cuda:0')
tensor([[149, 243,   6, 125,  49, 151, 201, 222,  95, 164]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
59          1      150       4        60
274         2      150       1         2
792         3      150       3       247
952         4      150       4       134
1175        5      150       3        84
       user_id  item_id  rating  timestep
12343       46      150       3        59
12750       47      150       3       193
13050       48      150       2       220
13125       49      150       2        22
13522       50      150       4       146
average_rating for this rec across 50 users from same group (less noisy) was: 3.26
all_actions shape just before sample torch.Size([1, 23, 1])
action scaled by temperature: tensor([[127]], device='cuda:0')
action picked by argmax: tensor([149], device='cuda:0')
tensor([[149,   6, 125, 201, 243, 151,  49,  79, 225, 245]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
59          1      150       4        60
274         2      150       1         2
792         3      150       3       247
952         4      150       4       134
1175        5      150       3        84
       user_id  item_id  rating  timestep
12343       46      150       3        59
12750       47      150       3       193
13050       48      150       2       220
13125       49      150       2        22
13522       50      150       4       146
average_rating for this rec across 50 users from same group (less noisy) was: 3.26
all_actions shape just before sample torch.Size([1, 24, 1])
action scaled by temperature: tensor([[115]], device='cuda:0')
action picked by argmax: tensor([149], device='cuda:0')
tensor([[149,   6, 243,  49,  79, 151, 201, 125, 113, 249]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
59          1      150       4        60
274         2      150       1         2
792         3      150       3       247
952         4      150       4       134
1175        5      150       3        84
       user_id  item_id  rating  timestep
12343       46      150       3        59
12750       47      150       3       193
13050       48      150       2       220
13125       49      150       2        22
13522       50      150       4       146
average_rating for this rec across 50 users from same group (less noisy) was: 3.26
all_actions shape just before sample torch.Size([1, 25, 1])
action scaled by temperature: tensor([[35]], device='cuda:0')
action picked by argmax: tensor([149], device='cuda:0')
tensor([[149,   6, 243,  79, 151, 125, 201,  49, 249, 113]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
59          1      150       4        60
274         2      150       1         2
792         3      150       3       247
952         4      150       4       134
1175        5      150       3        84
       user_id  item_id  rating  timestep
12343       46      150       3        59
12750       47      150       3       193
13050       48      150       2       220
13125       49      150       2        22
13522       50      150       4       146
average_rating for this rec across 50 users from same group (less noisy) was: 3.26
all_actions shape just before sample torch.Size([1, 26, 1])
action scaled by temperature: tensor([[149]], device='cuda:0')
action picked by argmax: tensor([149], device='cuda:0')
tensor([[149,   6, 125, 151, 243, 201,  49, 245,  79, 225]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
59          1      150       4        60
274         2      150       1         2
792         3      150       3       247
952         4      150       4       134
1175        5      150       3        84
       user_id  item_id  rating  timestep
12343       46      150       3        59
12750       47      150       3       193
13050       48      150       2       220
13125       49      150       2        22
13522       50      150       4       146
average_rating for this rec across 50 users from same group (less noisy) was: 3.26
all_actions shape just before sample torch.Size([1, 27, 1])
action scaled by temperature: tensor([[253]], device='cuda:0')
action picked by argmax: tensor([6], device='cuda:0')
tensor([[  6, 149, 201, 269, 225, 113, 125,  79,  29,  66]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
82          1        7       4        83
388         2        7       4       116
811         3        7       4       266
990         4        7       4       172
1154        5        7       3        63
       user_id  item_id  rating  timestep
12491       46        7       3       207
12722       47        7       4       165
13002       48        7       5       172
13104       49        7       4         1
13378       50        7       5         2
average_rating for this rec across 50 users from same group (less noisy) was: 3.68
all_actions shape just before sample torch.Size([1, 28, 1])
action scaled by temperature: tensor([[127]], device='cuda:0')
action picked by argmax: tensor([45], device='cuda:0')
tensor([[ 45, 102, 100, 221, 220, 123,   7,  17,  20,  48]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
139         1       46       5       140
296         2       46       5        24
714         3       46       5       169
973         4       46       3       155
1219        5       46       5       128
       user_id  item_id  rating  timestep
12425       46       46       5       141
12651       47       46       5        94
12862       48       46       4        32
13247       49       46       4       144
13537       50       46       3       161
average_rating for this rec across 50 users from same group (less noisy) was: 4.14
all_actions shape just before sample torch.Size([1, 29, 1])
action scaled by temperature: tensor([[221]], device='cuda:0')
action picked by argmax: tensor([185], device='cuda:0')
tensor([[185, 221, 100, 102, 153, 148, 154,  29, 132, 169]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
149         1      186       3       150
283         2      186       3        11
635         3      186       2        90
1052        4      186       4       234
1137        5      186       3        46
       user_id  item_id  rating  timestep
12412       46      186       4       128
12689       47      186       2       132
12858       48      186       3        28
13206       49      186       4       103
13612       50      186       3       236
average_rating for this rec across 50 users from same group (less noisy) was: 3.22
all_actions shape just before sample torch.Size([1, 30, 1])
action scaled by temperature: tensor([[148]], device='cuda:0')
action picked by argmax: tensor([148], device='cuda:0')
tensor([[148, 154,  29, 132, 169, 185, 221, 100, 264, 102]], device='cuda:0')
Just recommended 30 new items to 50 users from group 1 and the total rating was 111.44000000000005
train_loss is: 4.364032933701119
action scaled by temperature: tensor([[150]], device='cuda:0')
action picked by argmax: tensor([52], device='cuda:0')
tensor([[ 52,  80, 113, 222,  88, 166, 218, 117, 137,  87]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
125         1       53       4       126
456         2       53       5       184
677         3       53       3       132
858         4       53       3        40
1177        5       53       5        86
       user_id  item_id  rating  timestep
12439       46       53       3       155
12677       47       53       4       120
12975       48       53       4       145
13213       49       53       5       110
13474       50       53       3        98
average_rating for this rec across 50 users from same group (less noisy) was: 3.94
all_actions shape just before sample torch.Size([1, 1, 1])
action scaled by temperature: tensor([[9]], device='cuda:0')
action picked by argmax: tensor([52], device='cuda:0')
tensor([[ 52, 113, 218, 166,  54, 137, 222, 211, 144, 171]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
125         1       53       4       126
456         2       53       5       184
677         3       53       3       132
858         4       53       3        40
1177        5       53       5        86
       user_id  item_id  rating  timestep
12439       46       53       3       155
12677       47       53       4       120
12975       48       53       4       145
13213       49       53       5       110
13474       50       53       3        98
average_rating for this rec across 50 users from same group (less noisy) was: 3.94
all_actions shape just before sample torch.Size([1, 2, 1])
action scaled by temperature: tensor([[111]], device='cuda:0')
action picked by argmax: tensor([52], device='cuda:0')
tensor([[ 52, 113, 245, 179, 211,  54, 253, 222,  79, 125]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
125         1       53       4       126
456         2       53       5       184
677         3       53       3       132
858         4       53       3        40
1177        5       53       5        86
       user_id  item_id  rating  timestep
12439       46       53       3       155
12677       47       53       4       120
12975       48       53       4       145
13213       49       53       5       110
13474       50       53       3        98
average_rating for this rec across 50 users from same group (less noisy) was: 3.94
all_actions shape just before sample torch.Size([1, 3, 1])
action scaled by temperature: tensor([[140]], device='cuda:0')
action picked by argmax: tensor([52], device='cuda:0')
tensor([[ 52, 113, 245, 253, 179,  54, 211,  80,  75,  79]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
125         1       53       4       126
456         2       53       5       184
677         3       53       3       132
858         4       53       3        40
1177        5       53       5        86
       user_id  item_id  rating  timestep
12439       46       53       3       155
12677       47       53       4       120
12975       48       53       4       145
13213       49       53       5       110
13474       50       53       3        98
average_rating for this rec across 50 users from same group (less noisy) was: 3.94
all_actions shape just before sample torch.Size([1, 4, 1])
action scaled by temperature: tensor([[245]], device='cuda:0')
action picked by argmax: tensor([113], device='cuda:0')
tensor([[113, 245,  52, 179,  80, 125, 211,  79,  75, 186]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
109         1      114       4       110
324         2      114       3        52
744         3      114       4       199
920         4      114       5       102
1160        5      114       5        69
       user_id  item_id  rating  timestep
12470       46      114       3       186
12608       47      114       4        51
13034       48      114       4       204
13365       49      114       4       262
13593       50      114       5       217
average_rating for this rec across 50 users from same group (less noisy) was: 4.24
all_actions shape just before sample torch.Size([1, 5, 1])
action scaled by temperature: tensor([[13]], device='cuda:0')
action picked by argmax: tensor([80], device='cuda:0')
tensor([[ 80,  52, 238, 197, 179, 253, 184, 259, 167,  19]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
9           1       81       5        10
441         2       81       5       169
675         3       81       5       130
909         4       81       5        91
1344        5       81       5       253
       user_id  item_id  rating  timestep
12478       46       81       4       194
12586       47       81       5        29
13087       48       81       5       257
13352       49       81       5       249
13450       50       81       5        74
average_rating for this rec across 50 users from same group (less noisy) was: 4.56
all_actions shape just before sample torch.Size([1, 6, 1])
action scaled by temperature: tensor([[60]], device='cuda:0')
action picked by argmax: tensor([79], device='cuda:0')
tensor([[ 79, 167, 187,  87, 172, 111, 202, 144, 185, 227]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
8           1       80       5         9
329         2       80       2        57
692         3       80       4       147
822         4       80       4         4
1139        5       80       4        48
       user_id  item_id  rating  timestep
12426       46       80       5       142
12655       47       80       4        98
12995       48       80       3       165
13236       49       80       4       133
13550       50       80       5       174
average_rating for this rec across 50 users from same group (less noisy) was: 4.14
all_actions shape just before sample torch.Size([1, 7, 1])
action scaled by temperature: tensor([[37]], device='cuda:0')
action picked by argmax: tensor([21], device='cuda:0')
tensor([[ 21,  52,  13, 216,  37, 246,  87, 143, 255, 189]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
87          1       22       4        88
425         2       22       4       153
554         3       22       4         9
997         4       22       4       179
1263        5       22       5       172
       user_id  item_id  rating  timestep
12335       46       22       4        51
12810       47       22       5       253
12839       48       22       5         9
13116       49       22       4        13
13577       50       22       4       201
average_rating for this rec across 50 users from same group (less noisy) was: 4.24
all_actions shape just before sample torch.Size([1, 8, 1])
action scaled by temperature: tensor([[6]], device='cuda:0')
action picked by argmax: tensor([259], device='cuda:0')
tensor([[259,  52,  19,  18, 235, 258, 216, 104, 167, 121]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
241         1      260       5       242
427         2      260       5       155
709         3      260       5       164
906         4      260       3        88
1149        5      260       5        58
       user_id  item_id  rating  timestep
12293       46      260       3         9
12601       47      260       5        44
12960       48      260       4       130
13175       49      260       5        72
13511       50      260       4       135
average_rating for this rec across 50 users from same group (less noisy) was: 4.16
all_actions shape just before sample torch.Size([1, 9, 1])
action scaled by temperature: tensor([[105]], device='cuda:0')
action picked by argmax: tensor([18], device='cuda:0')
tensor([[ 18,  19, 259, 229, 268, 166, 235,  98,  17, 261]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
84          1       19       4        85
507         2       19       5       235
684         3       19       5       139
851         4       19       5        33
1163        5       19       5        72
       user_id  item_id  rating  timestep
12466       46       19       4       182
12792       47       19       5       235
13089       48       19       4       259
13200       49       19       4        97
13586       50       19       3       210
average_rating for this rec across 50 users from same group (less noisy) was: 4.42
all_actions shape just before sample torch.Size([1, 10, 1])
action scaled by temperature: tensor([[178]], device='cuda:0')
action picked by argmax: tensor([189], device='cuda:0')
tensor([[189, 140,   0, 111,  17, 235,  21, 119, 212,  74]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
54          1      190       5        55
354         2      190       4        82
732         3      190       4       187
1016        4      190       4       198
1119        5      190       5        28
       user_id  item_id  rating  timestep
12308       46      190       3        24
12634       47      190       4        77
13085       48      190       4       255
13209       49      190       4       106
13502       50      190       5       126
average_rating for this rec across 50 users from same group (less noisy) was: 4.14
all_actions shape just before sample torch.Size([1, 11, 1])
action scaled by temperature: tensor([[55]], device='cuda:0')
action picked by argmax: tensor([88], device='cuda:0')
tensor([[ 88, 126, 262, 111, 235, 193,  19,  54, 121,  41]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
163         1       89       5       164
411         2       89       3       139
725         3       89       3       180
848         4       89       3        30
1215        5       89       3       124
       user_id  item_id  rating  timestep
12396       46       89       3       112
12581       47       89       4        24
12979       48       89       3       149
13286       49       89       2       183
13503       50       89       3       127
average_rating for this rec across 50 users from same group (less noisy) was: 3.38
all_actions shape just before sample torch.Size([1, 12, 1])
action scaled by temperature: tensor([[111]], device='cuda:0')
action picked by argmax: tensor([88], device='cuda:0')
tensor([[ 88, 111, 237, 137, 221,  12, 178,  19,  48,  67]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
163         1       89       5       164
411         2       89       3       139
725         3       89       3       180
848         4       89       3        30
1215        5       89       3       124
       user_id  item_id  rating  timestep
12396       46       89       3       112
12581       47       89       4        24
12979       48       89       3       149
13286       49       89       2       183
13503       50       89       3       127
average_rating for this rec across 50 users from same group (less noisy) was: 3.38
all_actions shape just before sample torch.Size([1, 13, 1])
action scaled by temperature: tensor([[177]], device='cuda:0')
action picked by argmax: tensor([88], device='cuda:0')
tensor([[ 88, 111, 221, 237,  74, 137, 208,  48,  67,  19]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
163         1       89       5       164
411         2       89       3       139
725         3       89       3       180
848         4       89       3        30
1215        5       89       3       124
       user_id  item_id  rating  timestep
12396       46       89       3       112
12581       47       89       4        24
12979       48       89       3       149
13286       49       89       2       183
13503       50       89       3       127
average_rating for this rec across 50 users from same group (less noisy) was: 3.38
all_actions shape just before sample torch.Size([1, 14, 1])
action scaled by temperature: tensor([[111]], device='cuda:0')
action picked by argmax: tensor([88], device='cuda:0')
tensor([[ 88, 111, 237,  74, 221, 208,  48, 137,  62,  12]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
163         1       89       5       164
411         2       89       3       139
725         3       89       3       180
848         4       89       3        30
1215        5       89       3       124
       user_id  item_id  rating  timestep
12396       46       89       3       112
12581       47       89       4        24
12979       48       89       3       149
13286       49       89       2       183
13503       50       89       3       127
average_rating for this rec across 50 users from same group (less noisy) was: 3.38
all_actions shape just before sample torch.Size([1, 15, 1])
action scaled by temperature: tensor([[88]], device='cuda:0')
action picked by argmax: tensor([88], device='cuda:0')
tensor([[ 88, 111,  74, 237,  48, 221,  20, 208, 137,  62]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
163         1       89       5       164
411         2       89       3       139
725         3       89       3       180
848         4       89       3        30
1215        5       89       3       124
       user_id  item_id  rating  timestep
12396       46       89       3       112
12581       47       89       4        24
12979       48       89       3       149
13286       49       89       2       183
13503       50       89       3       127
average_rating for this rec across 50 users from same group (less noisy) was: 3.38
all_actions shape just before sample torch.Size([1, 16, 1])
action scaled by temperature: tensor([[121]], device='cuda:0')
action picked by argmax: tensor([88], device='cuda:0')
tensor([[ 88, 111, 237,  74,  48, 221, 137, 208,  62, 174]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
163         1       89       5       164
411         2       89       3       139
725         3       89       3       180
848         4       89       3        30
1215        5       89       3       124
       user_id  item_id  rating  timestep
12396       46       89       3       112
12581       47       89       4        24
12979       48       89       3       149
13286       49       89       2       183
13503       50       89       3       127
average_rating for this rec across 50 users from same group (less noisy) was: 3.38
all_actions shape just before sample torch.Size([1, 17, 1])
action scaled by temperature: tensor([[237]], device='cuda:0')
action picked by argmax: tensor([88], device='cuda:0')
tensor([[ 88, 111, 237,  74,  48,  12,  62, 137, 208, 217]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
163         1       89       5       164
411         2       89       3       139
725         3       89       3       180
848         4       89       3        30
1215        5       89       3       124
       user_id  item_id  rating  timestep
12396       46       89       3       112
12581       47       89       4        24
12979       48       89       3       149
13286       49       89       2       183
13503       50       89       3       127
average_rating for this rec across 50 users from same group (less noisy) was: 3.38
all_actions shape just before sample torch.Size([1, 18, 1])
action scaled by temperature: tensor([[74]], device='cuda:0')
action picked by argmax: tensor([88], device='cuda:0')
tensor([[ 88, 111,  74, 237,  62, 208,  12,  48, 137, 174]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
163         1       89       5       164
411         2       89       3       139
725         3       89       3       180
848         4       89       3        30
1215        5       89       3       124
       user_id  item_id  rating  timestep
12396       46       89       3       112
12581       47       89       4        24
12979       48       89       3       149
13286       49       89       2       183
13503       50       89       3       127
average_rating for this rec across 50 users from same group (less noisy) was: 3.38
all_actions shape just before sample torch.Size([1, 19, 1])
action scaled by temperature: tensor([[88]], device='cuda:0')
action picked by argmax: tensor([88], device='cuda:0')
tensor([[ 88, 111, 237,  48,  12,  74,  62, 137, 208, 221]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
163         1       89       5       164
411         2       89       3       139
725         3       89       3       180
848         4       89       3        30
1215        5       89       3       124
       user_id  item_id  rating  timestep
12396       46       89       3       112
12581       47       89       4        24
12979       48       89       3       149
13286       49       89       2       183
13503       50       89       3       127
average_rating for this rec across 50 users from same group (less noisy) was: 3.38
all_actions shape just before sample torch.Size([1, 20, 1])
action scaled by temperature: tensor([[88]], device='cuda:0')
action picked by argmax: tensor([88], device='cuda:0')
tensor([[ 88, 111,  74, 237,  48,  62, 137,  12, 208, 221]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
163         1       89       5       164
411         2       89       3       139
725         3       89       3       180
848         4       89       3        30
1215        5       89       3       124
       user_id  item_id  rating  timestep
12396       46       89       3       112
12581       47       89       4        24
12979       48       89       3       149
13286       49       89       2       183
13503       50       89       3       127
average_rating for this rec across 50 users from same group (less noisy) was: 3.38
all_actions shape just before sample torch.Size([1, 21, 1])
action scaled by temperature: tensor([[88]], device='cuda:0')
action picked by argmax: tensor([88], device='cuda:0')
tensor([[ 88,  12,  62,  48, 137, 208, 237, 111,  74, 147]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
163         1       89       5       164
411         2       89       3       139
725         3       89       3       180
848         4       89       3        30
1215        5       89       3       124
       user_id  item_id  rating  timestep
12396       46       89       3       112
12581       47       89       4        24
12979       48       89       3       149
13286       49       89       2       183
13503       50       89       3       127
average_rating for this rec across 50 users from same group (less noisy) was: 3.38
all_actions shape just before sample torch.Size([1, 22, 1])
action scaled by temperature: tensor([[12]], device='cuda:0')
action picked by argmax: tensor([12], device='cuda:0')
tensor([[ 12,  88,  62,  48, 137, 237, 208, 111, 229,   3]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
192         1       13       4       193
315         2       13       5        43
733         3       13       3       188
1066        4       13       5       248
1346        5       13       5       255
       user_id  item_id  rating  timestep
12377       46       13       4        93
12821       47       13       4       264
12916       48       13       5        86
13235       49       13       5       132
13449       50       13       4        73
average_rating for this rec across 50 users from same group (less noisy) was: 4.54
all_actions shape just before sample torch.Size([1, 23, 1])
action scaled by temperature: tensor([[229]], device='cuda:0')
action picked by argmax: tensor([107], device='cuda:0')
tensor([[107, 147,  17,  82, 229,  62, 151, 134, 196,  61]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
137         1      108       4       138
320         2      108       5        48
555         3      108       5        10
1033        4      108       4       215
1304        5      108       4       213
       user_id  item_id  rating  timestep
12385       46      108       5       101
12814       47      108       4       257
12864       48      108       5        34
13276       49      108       4       173
13592       50      108       5       216
average_rating for this rec across 50 users from same group (less noisy) was: 4.4
all_actions shape just before sample torch.Size([1, 24, 1])
action scaled by temperature: tensor([[147]], device='cuda:0')
action picked by argmax: tensor([147], device='cuda:0')
tensor([[147, 107,  17, 151,  82, 229,  61,  62, 205, 246]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
246         1      148       5       247
493         2      148       3       221
652         3      148       3       107
961         4      148       4       143
1311        5      148       3       220
       user_id  item_id  rating  timestep
12463       46      148       4       179
12766       47      148       4       209
13010       48      148       4       180
13299       49      148       4       196
13532       50      148       3       156
average_rating for this rec across 50 users from same group (less noisy) was: 3.76
all_actions shape just before sample torch.Size([1, 25, 1])
action scaled by temperature: tensor([[135]], device='cuda:0')
action picked by argmax: tensor([147], device='cuda:0')
tensor([[147,  17, 107, 135, 197, 258, 137, 151,  27, 255]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
246         1      148       5       247
493         2      148       3       221
652         3      148       3       107
961         4      148       4       143
1311        5      148       3       220
       user_id  item_id  rating  timestep
12463       46      148       4       179
12766       47      148       4       209
13010       48      148       4       180
13299       49      148       4       196
13532       50      148       3       156
average_rating for this rec across 50 users from same group (less noisy) was: 3.76
all_actions shape just before sample torch.Size([1, 26, 1])
action scaled by temperature: tensor([[27]], device='cuda:0')
action picked by argmax: tensor([147], device='cuda:0')
tensor([[147,  17, 258, 194, 135, 107, 197, 151,  27, 137]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
246         1      148       5       247
493         2      148       3       221
652         3      148       3       107
961         4      148       4       143
1311        5      148       3       220
       user_id  item_id  rating  timestep
12463       46      148       4       179
12766       47      148       4       209
13010       48      148       4       180
13299       49      148       4       196
13532       50      148       3       156
average_rating for this rec across 50 users from same group (less noisy) was: 3.76
all_actions shape just before sample torch.Size([1, 27, 1])
action scaled by temperature: tensor([[157]], device='cuda:0')
action picked by argmax: tensor([147], device='cuda:0')
tensor([[147, 258, 157, 222, 137,  27, 197, 135,  17, 256]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
246         1      148       5       247
493         2      148       3       221
652         3      148       3       107
961         4      148       4       143
1311        5      148       3       220
       user_id  item_id  rating  timestep
12463       46      148       4       179
12766       47      148       4       209
13010       48      148       4       180
13299       49      148       4       196
13532       50      148       3       156
average_rating for this rec across 50 users from same group (less noisy) was: 3.76
all_actions shape just before sample torch.Size([1, 28, 1])
action scaled by temperature: tensor([[256]], device='cuda:0')
action picked by argmax: tensor([157], device='cuda:0')
tensor([[157, 222, 256, 258,  27, 197, 137, 119, 201, 111]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
156         1      158       4       157
496         2      158       5       224
798         3      158       4       253
1015        4      158       4       197
1351        5      158       4       260
       user_id  item_id  rating  timestep
12457       46      158       4       173
12809       47      158       5       252
13046       48      158       5       216
13322       49      158       3       219
13399       50      158       5        23
average_rating for this rec across 50 users from same group (less noisy) was: 4.42
all_actions shape just before sample torch.Size([1, 29, 1])
action scaled by temperature: tensor([[3]], device='cuda:0')
action picked by argmax: tensor([124], device='cuda:0')
tensor([[124, 268, 145,  17, 154,   3, 150, 197,   0,  97]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
203         1      125       3       204
439         2      125       5       167
584         3      125       5        39
959         4      125       5       141
1123        5      125       3        32
       user_id  item_id  rating  timestep
12347       46      125       4        63
12670       47      125       5       113
13037       48      125       3       207
13144       49      125       4        41
13613       50      125       5       237
average_rating for this rec across 50 users from same group (less noisy) was: 3.92
all_actions shape just before sample torch.Size([1, 30, 1])
action scaled by temperature: tensor([[124]], device='cuda:0')
action picked by argmax: tensor([124], device='cuda:0')
tensor([[124, 268,  17, 173, 247, 261, 197, 154, 145,  27]], device='cuda:0')
Just recommended 30 new items to 50 users from group 1 and the total rating was 115.16000000000003
train_loss is: 3.524766882804975
action scaled by temperature: tensor([[165]], device='cuda:0')
action picked by argmax: tensor([13], device='cuda:0')
tensor([[ 13, 211, 109, 136, 117, 245,  40, 227,  64, 151]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
265         1       14       5       266
319         2       14       5        47
782         3       14       4       237
1043        4       14       4       225
1336        5       14       5       245
       user_id  item_id  rating  timestep
12497       46       14       4       213
12794       47       14       5       237
13093       48       14       4       263
13293       49       14       5       190
13396       50       14       5        20
average_rating for this rec across 50 users from same group (less noisy) was: 4.64
all_actions shape just before sample torch.Size([1, 1, 1])
action scaled by temperature: tensor([[44]], device='cuda:0')
action picked by argmax: tensor([102], device='cuda:0')
tensor([[102, 202, 254, 120, 153, 227, 170, 107, 218, 201]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
248         1      103       5       249
398         2      103       4       126
585         3      103       5        40
1009        4      103       5       191
1127        5      103       5        36
       user_id  item_id  rating  timestep
12388       46      103       5       104
12771       47      103       5       214
12958       48      103       5       128
13158       49      103       5        55
13411       50      103       4        35
average_rating for this rec across 50 users from same group (less noisy) was: 4.64
all_actions shape just before sample torch.Size([1, 2, 1])
action scaled by temperature: tensor([[153]], device='cuda:0')
action picked by argmax: tensor([113], device='cuda:0')
tensor([[113, 153, 107,  98,  94, 167,  21,  53, 171, 100]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
109         1      114       4       110
324         2      114       3        52
744         3      114       4       199
920         4      114       5       102
1160        5      114       5        69
       user_id  item_id  rating  timestep
12470       46      114       3       186
12608       47      114       4        51
13034       48      114       4       204
13365       49      114       4       262
13593       50      114       5       217
average_rating for this rec across 50 users from same group (less noisy) was: 4.24
all_actions shape just before sample torch.Size([1, 3, 1])
action scaled by temperature: tensor([[113]], device='cuda:0')
action picked by argmax: tensor([113], device='cuda:0')
tensor([[113,  94, 107,  52,  98, 109, 153, 167,  53,  88]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
109         1      114       4       110
324         2      114       3        52
744         3      114       4       199
920         4      114       5       102
1160        5      114       5        69
       user_id  item_id  rating  timestep
12470       46      114       3       186
12608       47      114       4        51
13034       48      114       4       204
13365       49      114       4       262
13593       50      114       5       217
average_rating for this rec across 50 users from same group (less noisy) was: 4.24
all_actions shape just before sample torch.Size([1, 4, 1])
action scaled by temperature: tensor([[120]], device='cuda:0')
action picked by argmax: tensor([94], device='cuda:0')
tensor([[ 94, 107, 113,  98, 109,  52, 167, 153,  87,  53]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
162         1       95       3       163
474         2       95       5       202
762         3       95       5       217
978         4       95       4       160
1355        5       95       3       264
       user_id  item_id  rating  timestep
12350       46       95       3        66
12800       47       95       4       243
12918       48       95       4        88
13240       49       95       4       137
13581       50       95       5       205
average_rating for this rec across 50 users from same group (less noisy) was: 3.76
all_actions shape just before sample torch.Size([1, 5, 1])
action scaled by temperature: tensor([[108]], device='cuda:0')
action picked by argmax: tensor([81], device='cuda:0')
tensor([[ 81, 175, 267, 225, 106, 125, 239,  68,   0,  69]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
68          1       82       5        69
540         2       82       5       268
688         3       82       4       143
963         4       82       5       145
1140        5       82       4        49
       user_id  item_id  rating  timestep
12345       46       82       4        61
12570       47       82       4        13
12926       48       82       5        96
13162       49       82       4        59
13379       50       82       4         3
average_rating for this rec across 50 users from same group (less noisy) was: 4.44
all_actions shape just before sample torch.Size([1, 6, 1])
action scaled by temperature: tensor([[139]], device='cuda:0')
action picked by argmax: tensor([139], device='cuda:0')
tensor([[139, 268, 267, 106,  45, 127,  23,  61, 144,  83]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
175         1      140       4       176
290         2      140       4        18
659         3      140       3       114
1005        4      140       4       187
1179        5      140       5        88
       user_id  item_id  rating  timestep
12482       46      140       3       198
12778       47      140       4       221
13043       48      140       5       213
13285       49      140       4       182
13604       50      140       5       228
average_rating for this rec across 50 users from same group (less noisy) was: 4.16
all_actions shape just before sample torch.Size([1, 7, 1])
action scaled by temperature: tensor([[139]], device='cuda:0')
action picked by argmax: tensor([139], device='cuda:0')
tensor([[139, 268, 106, 127,  45, 267,  61,  23, 187, 111]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
175         1      140       4       176
290         2      140       4        18
659         3      140       3       114
1005        4      140       4       187
1179        5      140       5        88
       user_id  item_id  rating  timestep
12482       46      140       3       198
12778       47      140       4       221
13043       48      140       5       213
13285       49      140       4       182
13604       50      140       5       228
average_rating for this rec across 50 users from same group (less noisy) was: 4.16
all_actions shape just before sample torch.Size([1, 8, 1])
action scaled by temperature: tensor([[106]], device='cuda:0')
action picked by argmax: tensor([106], device='cuda:0')
tensor([[106, 139, 268, 127,  61,  45, 267, 187, 195, 111]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
173         1      107       4       174
382         2      107       4       110
769         3      107       4       224
995         4      107       5       177
1261        5      107       4       170
       user_id  item_id  rating  timestep
12344       46      107       3        60
12657       47      107       4       100
12939       48      107       5       109
13284       49      107       3       181
13531       50      107       4       155
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 9, 1])
action scaled by temperature: tensor([[51]], device='cuda:0')
action picked by argmax: tensor([51], device='cuda:0')
tensor([[ 51, 106,  70, 127, 183, 128, 268,  45, 111,  10]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
206         1       52       4       207
379         2       52       4       107
570         3       52       5        25
844         4       52       4        26
1208        5       52       4       117
       user_id  item_id  rating  timestep
12557       46       52       4       273
12712       47       52       5       155
12944       48       52       4       114
13107       49       52       4         4
13387       50       52       4        11
average_rating for this rec across 50 users from same group (less noisy) was: 4.18
all_actions shape just before sample torch.Size([1, 10, 1])
action scaled by temperature: tensor([[183]], device='cuda:0')
action picked by argmax: tensor([70], device='cuda:0')
tensor([[ 70,  51, 106, 111,  10, 110, 183, 127, 187,  45]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
79          1       71       4        80
435         2       71       4       163
621         3       71       4        76
954         4       71       5       136
1223        5       71       4       132
       user_id  item_id  rating  timestep
12485       46       71       3       201
12744       47       71       4       187
12832       48       71       4         2
13187       49       71       4        84
13540       50       71       5       164
average_rating for this rec across 50 users from same group (less noisy) was: 4.04
all_actions shape just before sample torch.Size([1, 11, 1])
action scaled by temperature: tensor([[88]], device='cuda:0')
action picked by argmax: tensor([88], device='cuda:0')
tensor([[ 88, 193, 137, 119,  27,   3, 202, 265, 266, 180]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
163         1       89       5       164
411         2       89       3       139
725         3       89       3       180
848         4       89       3        30
1215        5       89       3       124
       user_id  item_id  rating  timestep
12396       46       89       3       112
12581       47       89       4        24
12979       48       89       3       149
13286       49       89       2       183
13503       50       89       3       127
average_rating for this rec across 50 users from same group (less noisy) was: 3.38
all_actions shape just before sample torch.Size([1, 12, 1])
action scaled by temperature: tensor([[16]], device='cuda:0')
action picked by argmax: tensor([137], device='cuda:0')
tensor([[137,   3,  88,  27, 193, 178, 202, 119, 270,  31]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
197         1      138       4       198
542         2      138       4       270
636         3      138       5        91
926         4      138       4       108
1195        5      138       5       104
       user_id  item_id  rating  timestep
12538       46      138       4       254
12596       47      138       4        39
13053       48      138       4       223
13354       49      138       5       251
13519       50      138       5       143
average_rating for this rec across 50 users from same group (less noisy) was: 4.36
all_actions shape just before sample torch.Size([1, 13, 1])
action scaled by temperature: tensor([[137]], device='cuda:0')
action picked by argmax: tensor([137], device='cuda:0')
tensor([[137,  31, 270,  12, 202,  27,   3, 178, 203, 126]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
197         1      138       4       198
542         2      138       4       270
636         3      138       5        91
926         4      138       4       108
1195        5      138       5       104
       user_id  item_id  rating  timestep
12538       46      138       4       254
12596       47      138       4        39
13053       48      138       4       223
13354       49      138       5       251
13519       50      138       5       143
average_rating for this rec across 50 users from same group (less noisy) was: 4.36
all_actions shape just before sample torch.Size([1, 14, 1])
action scaled by temperature: tensor([[31]], device='cuda:0')
action picked by argmax: tensor([31], device='cuda:0')
tensor([[ 31, 155, 270, 202,  12, 137, 203,  27,  35, 126]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
207         1       32       4       208
505         2       32       4       233
813         3       32       5       268
833         4       32       5        15
1309        5       32       4       218
       user_id  item_id  rating  timestep
12338       46       32       3        54
12783       47       32       3       226
12917       48       32       5        87
13318       49       32       4       215
13390       50       32       3        14
average_rating for this rec across 50 users from same group (less noisy) was: 4.1
all_actions shape just before sample torch.Size([1, 15, 1])
action scaled by temperature: tensor([[31]], device='cuda:0')
action picked by argmax: tensor([270], device='cuda:0')
tensor([[270, 202, 155,  31, 137, 203,  12,  35, 178,  27]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
262         1      271       4       263
532         2      271       3       260
735         3      271       4       190
958         4      271       5       140
1147        5      271       4        56
       user_id  item_id  rating  timestep
12379       46      271       4        95
12758       47      271       3       201
13055       48      271       4       225
13305       49      271       4       202
13429       50      271       4        53
average_rating for this rec across 50 users from same group (less noisy) was: 4.2
all_actions shape just before sample torch.Size([1, 16, 1])
action scaled by temperature: tensor([[137]], device='cuda:0')
action picked by argmax: tensor([203], device='cuda:0')
tensor([[203, 155, 202, 137,  31, 270,  73,  12,  35,  27]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
63          1      204       3        64
400         2      204       3       128
755         3      204       3       210
1045        4      204       4       227
1220        5      204       3       129
       user_id  item_id  rating  timestep
12398       46      204       4       114
12571       47      204       5        14
12977       48      204       3       147
13282       49      204       4       179
13547       50      204       4       171
average_rating for this rec across 50 users from same group (less noisy) was: 3.52
all_actions shape just before sample torch.Size([1, 17, 1])
action scaled by temperature: tensor([[3]], device='cuda:0')
action picked by argmax: tensor([234], device='cuda:0')
tensor([[234,  32, 153,   3, 135, 241, 132,  27,  31,  85]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
233         1      235       3       234
468         2      235       4       196
662         3      235       4       117
927         4      235       3       109
1185        5      235       4        94
       user_id  item_id  rating  timestep
12305       46      235       3        21
12679       47      235       2       122
12895       48      235       4        65
13238       49      235       5       135
13642       50      235       5       266
average_rating for this rec across 50 users from same group (less noisy) was: 3.78
all_actions shape just before sample torch.Size([1, 18, 1])
action scaled by temperature: tensor([[272]], device='cuda:0')
action picked by argmax: tensor([272], device='cuda:0')
tensor([[272, 269, 196, 234,  30, 135,  97,  35, 139, 123]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
232         1      273       5       233
334         2      273       5        62
694         3      273       4       149
994         4      273       5       176
1131        5      273       5        40
       user_id  item_id  rating  timestep
12539       46      273       4       255
12788       47      273       5       231
12951       48      273       5       121
13264       49      273       5       161
13408       50      273       5        32
average_rating for this rec across 50 users from same group (less noisy) was: 4.5
all_actions shape just before sample torch.Size([1, 19, 1])
action scaled by temperature: tensor([[272]], device='cuda:0')
action picked by argmax: tensor([272], device='cuda:0')
tensor([[272, 269, 196,  30,  35, 139, 234,  28,  97, 180]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
232         1      273       5       233
334         2      273       5        62
694         3      273       4       149
994         4      273       5       176
1131        5      273       5        40
       user_id  item_id  rating  timestep
12539       46      273       4       255
12788       47      273       5       231
12951       48      273       5       121
13264       49      273       5       161
13408       50      273       5        32
average_rating for this rec across 50 users from same group (less noisy) was: 4.5
all_actions shape just before sample torch.Size([1, 20, 1])
action scaled by temperature: tensor([[272]], device='cuda:0')
action picked by argmax: tensor([272], device='cuda:0')
tensor([[272, 269, 196,  35,  30, 234, 139,  60, 223,  97]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
232         1      273       5       233
334         2      273       5        62
694         3      273       4       149
994         4      273       5       176
1131        5      273       5        40
       user_id  item_id  rating  timestep
12539       46      273       4       255
12788       47      273       5       231
12951       48      273       5       121
13264       49      273       5       161
13408       50      273       5        32
average_rating for this rec across 50 users from same group (less noisy) was: 4.5
all_actions shape just before sample torch.Size([1, 21, 1])
action scaled by temperature: tensor([[272]], device='cuda:0')
action picked by argmax: tensor([272], device='cuda:0')
tensor([[272, 269, 196,  35,  30,  60, 139, 234, 223,  97]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
232         1      273       5       233
334         2      273       5        62
694         3      273       4       149
994         4      273       5       176
1131        5      273       5        40
       user_id  item_id  rating  timestep
12539       46      273       4       255
12788       47      273       5       231
12951       48      273       5       121
13264       49      273       5       161
13408       50      273       5        32
average_rating for this rec across 50 users from same group (less noisy) was: 4.5
all_actions shape just before sample torch.Size([1, 22, 1])
action scaled by temperature: tensor([[234]], device='cuda:0')
action picked by argmax: tensor([272], device='cuda:0')
tensor([[272, 269, 196,  35,  30, 223,  60,   9, 231, 234]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
232         1      273       5       233
334         2      273       5        62
694         3      273       4       149
994         4      273       5       176
1131        5      273       5        40
       user_id  item_id  rating  timestep
12539       46      273       4       255
12788       47      273       5       231
12951       48      273       5       121
13264       49      273       5       161
13408       50      273       5        32
average_rating for this rec across 50 users from same group (less noisy) was: 4.5
all_actions shape just before sample torch.Size([1, 23, 1])
action scaled by temperature: tensor([[269]], device='cuda:0')
action picked by argmax: tensor([35], device='cuda:0')
tensor([[ 35, 269, 272, 196,  30, 223,   9,  60, 231, 142]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
155         1       36       4       156
356         2       36       4        84
651         3       36       5       106
923         4       36       5       105
1293        5       36       4       202
       user_id  item_id  rating  timestep
12444       46       36       5       160
12705       47       36       5       148
13096       48       36       5       266
13242       49       36       4       139
13488       50       36       4       112
average_rating for this rec across 50 users from same group (less noisy) was: 4.46
all_actions shape just before sample torch.Size([1, 24, 1])
action scaled by temperature: tensor([[9]], device='cuda:0')
action picked by argmax: tensor([9], device='cuda:0')
tensor([[  9, 181, 140, 231,  65, 201, 145,  87,  21,  22]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
256         1       10       5       257
308         2       10       5        36
626         3       10       4        81
1055        4       10       4       237
1193        5       10       5       102
       user_id  item_id  rating  timestep
12521       46       10       5       237
12698       47       10       5       141
12982       48       10       4       152
13245       49       10       5       142
13461       50       10       4        85
average_rating for this rec across 50 users from same group (less noisy) was: 4.56
all_actions shape just before sample torch.Size([1, 25, 1])
action scaled by temperature: tensor([[201]], device='cuda:0')
action picked by argmax: tensor([201], device='cuda:0')
tensor([[201,  65,  87,   9,  98, 166, 145, 115, 181, 117]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
258         1      202       3       259
510         2      202       3       238
799         3      202       4       254
930         4      202       3       112
1360        5      202       4       269
       user_id  item_id  rating  timestep
12415       46      202       1       131
12676       47      202       4       119
13070       48      202       3       240
13273       49      202       2       170
13643       50      202       3       267
average_rating for this rec across 50 users from same group (less noisy) was: 2.82
all_actions shape just before sample torch.Size([1, 26, 1])
action scaled by temperature: tensor([[22]], device='cuda:0')
action picked by argmax: tensor([22], device='cuda:0')
tensor([[ 22,  11,  21, 266, 142, 255, 162,  87,  43, 212]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
190         1       23       4       191
420         2       23       3       148
642         3       23       4        97
900         4       23       3        82
1125        5       23       5        34
       user_id  item_id  rating  timestep
12326       46       23       3        42
12754       47       23       5       197
13092       48       23       5       262
13190       49       23       2        87
13481       50       23       4       105
average_rating for this rec across 50 users from same group (less noisy) was: 3.82
all_actions shape just before sample torch.Size([1, 27, 1])
action scaled by temperature: tensor([[22]], device='cuda:0')
action picked by argmax: tensor([22], device='cuda:0')
tensor([[ 22,  11,  47, 162, 142, 255,  21, 266, 259,  53]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
190         1       23       4       191
420         2       23       3       148
642         3       23       4        97
900         4       23       3        82
1125        5       23       5        34
       user_id  item_id  rating  timestep
12326       46       23       3        42
12754       47       23       5       197
13092       48       23       5       262
13190       49       23       2        87
13481       50       23       4       105
average_rating for this rec across 50 users from same group (less noisy) was: 3.82
all_actions shape just before sample torch.Size([1, 28, 1])
action scaled by temperature: tensor([[196]], device='cuda:0')
action picked by argmax: tensor([22], device='cuda:0')
tensor([[ 22,  11,  47, 142, 162,  21, 255, 259, 266, 141]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
190         1       23       4       191
420         2       23       3       148
642         3       23       4        97
900         4       23       3        82
1125        5       23       5        34
       user_id  item_id  rating  timestep
12326       46       23       3        42
12754       47       23       5       197
13092       48       23       5       262
13190       49       23       2        87
13481       50       23       4       105
average_rating for this rec across 50 users from same group (less noisy) was: 3.82
all_actions shape just before sample torch.Size([1, 29, 1])
action scaled by temperature: tensor([[47]], device='cuda:0')
action picked by argmax: tensor([22], device='cuda:0')
tensor([[ 22,  11, 142,  47,  21, 162, 266, 259,  53,  43]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
190         1       23       4       191
420         2       23       3       148
642         3       23       4        97
900         4       23       3        82
1125        5       23       5        34
       user_id  item_id  rating  timestep
12326       46       23       3        42
12754       47       23       5       197
13092       48       23       5       262
13190       49       23       2        87
13481       50       23       4       105
average_rating for this rec across 50 users from same group (less noisy) was: 3.82
all_actions shape just before sample torch.Size([1, 30, 1])
action scaled by temperature: tensor([[11]], device='cuda:0')
action picked by argmax: tensor([22], device='cuda:0')
tensor([[ 22,  11,  21, 212,  53,  43, 142,  47, 162, 266]], device='cuda:0')
Just recommended 30 new items to 50 users from group 1 and the total rating was 123.87999999999997
train_loss is: 2.8096437454223633
action scaled by temperature: tensor([[82]], device='cuda:0')
action picked by argmax: tensor([52], device='cuda:0')
tensor([[ 52, 125, 117, 175, 222, 266, 109, 265,  30, 245]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
125         1       53       4       126
456         2       53       5       184
677         3       53       3       132
858         4       53       3        40
1177        5       53       5        86
       user_id  item_id  rating  timestep
12439       46       53       3       155
12677       47       53       4       120
12975       48       53       4       145
13213       49       53       5       110
13474       50       53       3        98
average_rating for this rec across 50 users from same group (less noisy) was: 3.94
all_actions shape just before sample torch.Size([1, 1, 1])
action scaled by temperature: tensor([[144]], device='cuda:0')
action picked by argmax: tensor([125], device='cuda:0')
tensor([[125,  87, 175, 222, 211, 245, 109, 247, 178,  52]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
204         1      126       5       205
367         2      126       3        95
594         3      126       3        49
1031        4      126       2       213
1200        5      126       3       109
       user_id  item_id  rating  timestep
12366       46      126       3        82
12598       47      126       3        41
13012       48      126       3       182
13223       49      126       4       120
13647       50      126       4       271
average_rating for this rec across 50 users from same group (less noisy) was: 3.32
all_actions shape just before sample torch.Size([1, 2, 1])
action scaled by temperature: tensor([[259]], device='cuda:0')
action picked by argmax: tensor([68], device='cuda:0')
tensor([[ 68, 165,  27,  31,  21, 212, 196,  65,  74, 110]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
90          1       69       3        91
513         2       69       4       241
665         3       69       4       120
988         4       69       5       170
1117        5       69       4        26
       user_id  item_id  rating  timestep
12451       46       69       4       167
12690       47       69       5       133
12874       48       69       4        44
13224       49       69       4       121
13590       50       69       4       214
average_rating for this rec across 50 users from same group (less noisy) was: 3.92
all_actions shape just before sample torch.Size([1, 3, 1])
action scaled by temperature: tensor([[74]], device='cuda:0')
action picked by argmax: tensor([50], device='cuda:0')
tensor([[ 50, 212,  91, 123, 126, 207,  72,  74,  68,  43]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
234         1       51       4       235
498         2       51       3       226
789         3       51       4       244
1040        4       51       4       222
1226        5       51       4       135
       user_id  item_id  rating  timestep
12330       46       51       3        46
12720       47       51       5       163
12981       48       51       3       151
13110       49       51       5         7
13618       50       51       4       242
average_rating for this rec across 50 users from same group (less noisy) was: 3.86
all_actions shape just before sample torch.Size([1, 4, 1])
action scaled by temperature: tensor([[43]], device='cuda:0')
action picked by argmax: tensor([44], device='cuda:0')
tensor([[ 44, 212,  91,  43, 108,  82,  11, 214,  68,  16]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
223         1       45       4       224
337         2       45       4        65
608         3       45       3        63
931         4       45       3       113
1241        5       45       4       150
       user_id  item_id  rating  timestep
12328       46       45       4        44
12737       47       45       4       180
13058       48       45       3       228
13244       49       45       4       141
13631       50       45       3       255
average_rating for this rec across 50 users from same group (less noisy) was: 3.84
all_actions shape just before sample torch.Size([1, 5, 1])
action scaled by temperature: tensor([[82]], device='cuda:0')
action picked by argmax: tensor([82], device='cuda:0')
tensor([[ 82,  91,  44, 247, 234, 105,  16, 235,  69, 198]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
23          1       83       4        24
368         2       83       5        96
712         3       83       5       167
1081        4       83       3       263
1124        5       83       5        33
       user_id  item_id  rating  timestep
12536       46       83       4       252
12603       47       83       4        46
12913       48       83       3        83
13185       49       83       4        82
13548       50       83       5       172
average_rating for this rec across 50 users from same group (less noisy) was: 4.28
all_actions shape just before sample torch.Size([1, 6, 1])
action scaled by temperature: tensor([[38]], device='cuda:0')
action picked by argmax: tensor([91], device='cuda:0')
tensor([[ 91,  82,  44, 247,  16, 105, 234, 235,  77,  74]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
114         1       92       5       115
426         2       92       5       154
610         3       92       5        65
955         4       92       5       137
1202        5       92       5       111
       user_id  item_id  rating  timestep
12453       46       92       5       169
12616       47       92       4        59
12924       48       92       5        94
13280       49       92       4       177
13440       50       92       5        64
average_rating for this rec across 50 users from same group (less noisy) was: 4.64
all_actions shape just before sample torch.Size([1, 7, 1])
action scaled by temperature: tensor([[77]], device='cuda:0')
action picked by argmax: tensor([91], device='cuda:0')
tensor([[ 91, 247,  82,  44, 105,  77,  16, 122, 234, 235]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
114         1       92       5       115
426         2       92       5       154
610         3       92       5        65
955         4       92       5       137
1202        5       92       5       111
       user_id  item_id  rating  timestep
12453       46       92       5       169
12616       47       92       4        59
12924       48       92       5        94
13280       49       92       4       177
13440       50       92       5        64
average_rating for this rec across 50 users from same group (less noisy) was: 4.64
all_actions shape just before sample torch.Size([1, 8, 1])
action scaled by temperature: tensor([[89]], device='cuda:0')
action picked by argmax: tensor([91], device='cuda:0')
tensor([[ 91, 247,  82, 105,  44, 235,  77,  16, 141, 183]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
114         1       92       5       115
426         2       92       5       154
610         3       92       5        65
955         4       92       5       137
1202        5       92       5       111
       user_id  item_id  rating  timestep
12453       46       92       5       169
12616       47       92       4        59
12924       48       92       5        94
13280       49       92       4       177
13440       50       92       5        64
average_rating for this rec across 50 users from same group (less noisy) was: 4.64
all_actions shape just before sample torch.Size([1, 9, 1])
action scaled by temperature: tensor([[136]], device='cuda:0')
action picked by argmax: tensor([247], device='cuda:0')
tensor([[247,  91,  82, 105,  44,  77, 183,  69, 122,  16]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
182         1      248       4       183
295         2      248       5        23
739         3      248       5       194
853         4      248       4        35
1345        5      248       4       254
       user_id  item_id  rating  timestep
12548       46      248       5       264
12573       47      248       5        16
12837       48      248       4         7
13252       49      248       4       149
13495       50      248       5       119
average_rating for this rec across 50 users from same group (less noisy) was: 4.46
all_actions shape just before sample torch.Size([1, 10, 1])
action scaled by temperature: tensor([[269]], device='cuda:0')
action picked by argmax: tensor([269], device='cuda:0')
tensor([[269, 180, 120,  85,   6, 208,  40, 153,  30,  77]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
164         1      270       5       165
417         2      270       4       145
772         3      270       5       227
863         4      270       5        45
1211        5      270       5       120
       user_id  item_id  rating  timestep
12341       46      270       4        57
12626       47      270       4        69
12885       48      270       3        55
13182       49      270       4        79
13453       50      270       4        77
average_rating for this rec across 50 users from same group (less noisy) was: 4.28
all_actions shape just before sample torch.Size([1, 11, 1])
action scaled by temperature: tensor([[33]], device='cuda:0')
action picked by argmax: tensor([33], device='cuda:0')
tensor([[ 33,  62, 237,  69,  27, 121, 196, 141, 139,  57]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
18          1       34       3        19
529         2       34       5       257
804         3       34       4       259
1077        4       34       5       259
1250        5       34       4       159
       user_id  item_id  rating  timestep
12531       46       34       4       247
12656       47       34       5        99
12863       48       34       5        33
13215       49       34       3       112
13384       50       34       4         8
average_rating for this rec across 50 users from same group (less noisy) was: 4.18
all_actions shape just before sample torch.Size([1, 12, 1])
action scaled by temperature: tensor([[237]], device='cuda:0')
action picked by argmax: tensor([62], device='cuda:0')
tensor([[ 62, 237,  27, 121,  33,  69, 196, 141, 234, 139]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
221         1       63       5       222
458         2       63       4       186
619         3       63       3        74
1089        4       63       4       271
1340        5       63       3       249
       user_id  item_id  rating  timestep
12354       46       63       4        70
12650       47       63       3        93
12903       48       63       3        73
13166       49       63       3        63
13459       50       63       3        83
average_rating for this rec across 50 users from same group (less noisy) was: 3.72
all_actions shape just before sample torch.Size([1, 13, 1])
action scaled by temperature: tensor([[57]], device='cuda:0')
action picked by argmax: tensor([27], device='cuda:0')
tensor([[ 27, 237,  62, 185, 121,  33, 139, 114,  19,  57]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
0           1       28       4         1
294         2       28       4        22
736         3       28       5       191
1051        4       28       5       233
1244        5       28       3       153
       user_id  item_id  rating  timestep
12297       46       28       3        13
12763       47       28       4       206
13040       48       28       5       210
13309       49       28       5       206
13583       50       28       5       207
average_rating for this rec across 50 users from same group (less noisy) was: 4.3
all_actions shape just before sample torch.Size([1, 14, 1])
action scaled by temperature: tensor([[185]], device='cuda:0')
action picked by argmax: tensor([27], device='cuda:0')
tensor([[ 27, 185, 237,  62, 121, 114,  19, 257, 154, 139]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
0           1       28       4         1
294         2       28       4        22
736         3       28       5       191
1051        4       28       5       233
1244        5       28       3       153
       user_id  item_id  rating  timestep
12297       46       28       3        13
12763       47       28       4       206
13040       48       28       5       210
13309       49       28       5       206
13583       50       28       5       207
average_rating for this rec across 50 users from same group (less noisy) was: 4.3
all_actions shape just before sample torch.Size([1, 15, 1])
action scaled by temperature: tensor([[62]], device='cuda:0')
action picked by argmax: tensor([27], device='cuda:0')
tensor([[ 27, 185, 237, 114, 257,  19,  62, 121, 154, 243]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
0           1       28       4         1
294         2       28       4        22
736         3       28       5       191
1051        4       28       5       233
1244        5       28       3       153
       user_id  item_id  rating  timestep
12297       46       28       3        13
12763       47       28       4       206
13040       48       28       5       210
13309       49       28       5       206
13583       50       28       5       207
average_rating for this rec across 50 users from same group (less noisy) was: 4.3
all_actions shape just before sample torch.Size([1, 16, 1])
action scaled by temperature: tensor([[27]], device='cuda:0')
action picked by argmax: tensor([27], device='cuda:0')
tensor([[ 27, 185, 237, 257, 114,  19,  62, 121,  47, 154]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
0           1       28       4         1
294         2       28       4        22
736         3       28       5       191
1051        4       28       5       233
1244        5       28       3       153
       user_id  item_id  rating  timestep
12297       46       28       3        13
12763       47       28       4       206
13040       48       28       5       210
13309       49       28       5       206
13583       50       28       5       207
average_rating for this rec across 50 users from same group (less noisy) was: 4.3
all_actions shape just before sample torch.Size([1, 17, 1])
action scaled by temperature: tensor([[27]], device='cuda:0')
action picked by argmax: tensor([27], device='cuda:0')
tensor([[ 27, 185, 257, 114, 237,  19, 243,  16, 232,  47]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
0           1       28       4         1
294         2       28       4        22
736         3       28       5       191
1051        4       28       5       233
1244        5       28       3       153
       user_id  item_id  rating  timestep
12297       46       28       3        13
12763       47       28       4       206
13040       48       28       5       210
13309       49       28       5       206
13583       50       28       5       207
average_rating for this rec across 50 users from same group (less noisy) was: 4.3
all_actions shape just before sample torch.Size([1, 18, 1])
action scaled by temperature: tensor([[27]], device='cuda:0')
action picked by argmax: tensor([185], device='cuda:0')
tensor([[185,  27, 257, 114, 237,  19, 232,  47, 104, 197]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
149         1      186       3       150
283         2      186       3        11
635         3      186       2        90
1052        4      186       4       234
1137        5      186       3        46
       user_id  item_id  rating  timestep
12412       46      186       4       128
12689       47      186       2       132
12858       48      186       3        28
13206       49      186       4       103
13612       50      186       3       236
average_rating for this rec across 50 users from same group (less noisy) was: 3.22
all_actions shape just before sample torch.Size([1, 19, 1])
action scaled by temperature: tensor([[257]], device='cuda:0')
action picked by argmax: tensor([19], device='cuda:0')
tensor([[ 19, 257,  47,  79, 104,  27, 237,  88,  96, 222]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
216         1       20       5       217
314         2       20       4        42
634         3       20       5        89
956         4       20       5       138
1316        5       20       3       225
       user_id  item_id  rating  timestep
12535       46       20       5       251
12580       47       20       5        23
12889       48       20       5        59
13188       49       20       4        85
13439       50       20       4        63
average_rating for this rec across 50 users from same group (less noisy) was: 4.56
all_actions shape just before sample torch.Size([1, 20, 1])
action scaled by temperature: tensor([[88]], device='cuda:0')
action picked by argmax: tensor([88], device='cuda:0')
tensor([[ 88, 263, 257,  71,  19, 126, 216,  47, 199, 130]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
163         1       89       5       164
411         2       89       3       139
725         3       89       3       180
848         4       89       3        30
1215        5       89       3       124
       user_id  item_id  rating  timestep
12396       46       89       3       112
12581       47       89       4        24
12979       48       89       3       149
13286       49       89       2       183
13503       50       89       3       127
average_rating for this rec across 50 users from same group (less noisy) was: 3.38
all_actions shape just before sample torch.Size([1, 21, 1])
action scaled by temperature: tensor([[38]], device='cuda:0')
action picked by argmax: tensor([100], device='cuda:0')
tensor([[100,  38, 126,  19,  30, 213, 237,  57, 272,  62]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
5           1      101       3         6
322         2      101       4        50
763         3      101       2       218
946         4      101       5       128
1161        5      101       4        70
       user_id  item_id  rating  timestep
12556       46      101       3       272
12579       47      101       4        22
12877       48      101       5        47
13370       49      101       3       267
13597       50      101       5       221
average_rating for this rec across 50 users from same group (less noisy) was: 3.72
all_actions shape just before sample torch.Size([1, 22, 1])
action scaled by temperature: tensor([[118]], device='cuda:0')
action picked by argmax: tensor([118], device='cuda:0')
tensor([[118, 219,  88, 124, 167, 213,  76,  16, 103,  75]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
52          1      119       5        53
434         2      119       5       162
593         3      119       5        48
948         4      119       5       130
1173        5      119       5        82
       user_id  item_id  rating  timestep
12399       46      119       5       115
12597       47      119       5        40
12859       48      119       5        29
13287       49      119       5       184
13381       50      119       4         5
average_rating for this rec across 50 users from same group (less noisy) was: 4.8
all_actions shape just before sample torch.Size([1, 23, 1])
action scaled by temperature: tensor([[124]], device='cuda:0')
action picked by argmax: tensor([124], device='cuda:0')
tensor([[124, 187, 118, 119, 213,  15, 167,  16, 103, 100]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
203         1      125       3       204
439         2      125       5       167
584         3      125       5        39
959         4      125       5       141
1123        5      125       3        32
       user_id  item_id  rating  timestep
12347       46      125       4        63
12670       47      125       5       113
13037       48      125       3       207
13144       49      125       4        41
13613       50      125       5       237
average_rating for this rec across 50 users from same group (less noisy) was: 3.92
all_actions shape just before sample torch.Size([1, 24, 1])
action scaled by temperature: tensor([[214]], device='cuda:0')
action picked by argmax: tensor([244], device='cuda:0')
tensor([[244, 135, 187, 210,  30, 119, 168, 103, 124, 234]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
244         1      245       3       245
422         2      245       5       150
710         3      245       4       165
980         4      245       2       162
1313        5      245       4       222
       user_id  item_id  rating  timestep
12529       46      245       2       245
12723       47      245       3       166
12986       48      245       3       156
13133       49      245       4        30
13507       50      245       2       131
average_rating for this rec across 50 users from same group (less noisy) was: 3.48
all_actions shape just before sample torch.Size([1, 25, 1])
action scaled by temperature: tensor([[101]], device='cuda:0')
action picked by argmax: tensor([55], device='cuda:0')
tensor([[ 55, 101, 183,  90, 158, 151, 121, 202,  30, 135]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
17          1       56       4        18
500         2       56       4       228
617         3       56       3        72
1080        4       56       4       262
1108        5       56       5        17
       user_id  item_id  rating  timestep
12459       46       56       5       175
12782       47       56       4       225
13071       48       56       4       241
13174       49       56       3        71
13516       50       56       5       140
average_rating for this rec across 50 users from same group (less noisy) was: 4.14
all_actions shape just before sample torch.Size([1, 26, 1])
action scaled by temperature: tensor([[8]], device='cuda:0')
action picked by argmax: tensor([8], device='cuda:0')
tensor([[  8,  15,  12,  27, 233, 213,  19, 167, 135, 199]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
268         1        9       4       269
360         2        9       4        88
573         3        9       4        28
894         4        9       4        76
1213        5        9       4       122
       user_id  item_id  rating  timestep
12358       46        9       4        74
12680       47        9       3       123
12845       48        9       3        15
13300       49        9       4       197
13584       50        9       4       208
average_rating for this rec across 50 users from same group (less noisy) was: 3.72
all_actions shape just before sample torch.Size([1, 27, 1])
action scaled by temperature: tensor([[12]], device='cuda:0')
action picked by argmax: tensor([12], device='cuda:0')
tensor([[ 12, 124,  15, 233,  17,  27,   8, 213, 253,  37]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
192         1       13       4       193
315         2       13       5        43
733         3       13       3       188
1066        4       13       5       248
1346        5       13       5       255
       user_id  item_id  rating  timestep
12377       46       13       4        93
12821       47       13       4       264
12916       48       13       5        86
13235       49       13       5       132
13449       50       13       4        73
average_rating for this rec across 50 users from same group (less noisy) was: 4.54
all_actions shape just before sample torch.Size([1, 28, 1])
action scaled by temperature: tensor([[130]], device='cuda:0')
action picked by argmax: tensor([130], device='cuda:0')
tensor([[130, 125,  92,   4, 223,   9,  37, 160, 141,  35]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
179         1      131       4       180
394         2      131       4       122
702         3      131       4       157
984         4      131       4       166
1272        5      131       3       181
       user_id  item_id  rating  timestep
12300       46      131       4        16
12775       47      131       5       218
12907       48      131       4        77
13164       49      131       4        61
13528       50      131       4       152
average_rating for this rec across 50 users from same group (less noisy) was: 3.92
all_actions shape just before sample torch.Size([1, 29, 1])
action scaled by temperature: tensor([[130]], device='cuda:0')
action picked by argmax: tensor([130], device='cuda:0')
tensor([[130,   4, 223,   9, 125, 141,  92,  35, 160, 134]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
179         1      131       4       180
394         2      131       4       122
702         3      131       4       157
984         4      131       4       166
1272        5      131       3       181
       user_id  item_id  rating  timestep
12300       46      131       4        16
12775       47      131       5       218
12907       48      131       4        77
13164       49      131       4        61
13528       50      131       4       152
average_rating for this rec across 50 users from same group (less noisy) was: 3.92
all_actions shape just before sample torch.Size([1, 30, 1])
action scaled by temperature: tensor([[9]], device='cuda:0')
action picked by argmax: tensor([130], device='cuda:0')
tensor([[130,   4, 223,  35, 125, 160, 141, 122,   9, 134]], device='cuda:0')
Just recommended 30 new items to 50 users from group 1 and the total rating was 122.53999999999999
train_loss is: 2.2657256572758224
action scaled by temperature: tensor([[55]], device='cuda:0')
action picked by argmax: tensor([211], device='cuda:0')
tensor([[211, 159, 109, 200, 154, 147, 186, 178,  51, 113]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
16          1      212       4        17
467         2      212       5       195
562         3      212       5        17
1019        4      212       5       201
1164        5      212       4        73
       user_id  item_id  rating  timestep
12469       46      212       5       185
12820       47      212       5       263
13061       48      212       5       231
13249       49      212       4       146
13422       50      212       5        46
average_rating for this rec across 50 users from same group (less noisy) was: 4.66
all_actions shape just before sample torch.Size([1, 1, 1])
action scaled by temperature: tensor([[147]], device='cuda:0')
action picked by argmax: tensor([269], device='cuda:0')
tensor([[269, 200,  82,  69, 228,  75,  84, 158, 258, 170]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
164         1      270       5       165
417         2      270       4       145
772         3      270       5       227
863         4      270       5        45
1211        5      270       5       120
       user_id  item_id  rating  timestep
12341       46      270       4        57
12626       47      270       4        69
12885       48      270       3        55
13182       49      270       4        79
13453       50      270       4        77
average_rating for this rec across 50 users from same group (less noisy) was: 4.28
all_actions shape just before sample torch.Size([1, 2, 1])
action scaled by temperature: tensor([[20]], device='cuda:0')
action picked by argmax: tensor([247], device='cuda:0')
tensor([[247, 100, 109, 129,  37, 122, 152,  36, 174,  20]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
182         1      248       4       183
295         2      248       5        23
739         3      248       5       194
853         4      248       4        35
1345        5      248       4       254
       user_id  item_id  rating  timestep
12548       46      248       5       264
12573       47      248       5        16
12837       48      248       4         7
13252       49      248       4       149
13495       50      248       5       119
average_rating for this rec across 50 users from same group (less noisy) was: 4.46
all_actions shape just before sample torch.Size([1, 3, 1])
action scaled by temperature: tensor([[141]], device='cuda:0')
action picked by argmax: tensor([69], device='cuda:0')
tensor([[ 69, 141, 203,  11, 121,  81, 237,  51, 267,  93]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
72          1       70       4        73
282         2       70       2        10
591         3       70       5        46
949         4       70       3       131
1329        5       70       3       238
       user_id  item_id  rating  timestep
12414       46       70       5       130
12691       47       70       4       134
12894       48       70       5        64
13323       49       70       5       220
13404       50       70       4        28
average_rating for this rec across 50 users from same group (less noisy) was: 4.08
all_actions shape just before sample torch.Size([1, 4, 1])
action scaled by temperature: tensor([[76]], device='cuda:0')
action picked by argmax: tensor([196], device='cuda:0')
tensor([[196,  78, 214,  69, 141,  93, 133, 135, 259,  76]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
98          1      197       3        99
369         2      197       4        97
729         3      197       3       184
867         4      197       5        49
1109        5      197       4        18
       user_id  item_id  rating  timestep
12311       46      197       2        27
12645       47      197       4        88
13014       48      197       3       184
13119       49      197       1        16
13636       50      197       3       260
average_rating for this rec across 50 users from same group (less noisy) was: 3.28
all_actions shape just before sample torch.Size([1, 5, 1])
action scaled by temperature: tensor([[143]], device='cuda:0')
action picked by argmax: tensor([143], device='cuda:0')
tensor([[143, 214, 223, 133,  78,  37, 101,  76, 231,  69]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
106         1      144       4       107
528         2      144       4       256
803         3      144       5       258
944         4      144       5       126
1205        5      144       4       114
       user_id  item_id  rating  timestep
12458       46      144       4       174
12825       47      144       4       268
12999       48      144       4       169
13140       49      144       3        37
13640       50      144       5       264
average_rating for this rec across 50 users from same group (less noisy) was: 4.12
all_actions shape just before sample torch.Size([1, 6, 1])
action scaled by temperature: tensor([[223]], device='cuda:0')
action picked by argmax: tensor([223], device='cuda:0')
tensor([[223, 143, 133, 197,  76, 214, 185,  90,  66, 157]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
194         1      224       4       195
511         2      224       4       239
726         3      224       5       181
861         4      224       4        43
1145        5      224       5        54
       user_id  item_id  rating  timestep
12371       46      224       5        87
12578       47      224       5        21
12946       48      224       4       116
13334       49      224       5       231
13417       50      224       4        41
average_rating for this rec across 50 users from same group (less noisy) was: 4.4
all_actions shape just before sample torch.Size([1, 7, 1])
action scaled by temperature: tensor([[161]], device='cuda:0')
action picked by argmax: tensor([161], device='cuda:0')
tensor([[161, 222,  61, 179, 264, 186,  89,  92,  44, 243]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
43          1      162       5        44
465         2      162       3       193
730         3      162       4       185
1044        4      162       4       226
1294        5      162       4       203
       user_id  item_id  rating  timestep
12438       46      162       4       154
12716       47      162       4       159
13031       48      162       5       201
13132       49      162       4        29
13539       50      162       3       163
average_rating for this rec across 50 users from same group (less noisy) was: 4.26
all_actions shape just before sample torch.Size([1, 8, 1])
action scaled by temperature: tensor([[222]], device='cuda:0')
action picked by argmax: tensor([222], device='cuda:0')
tensor([[222,  71, 188, 133, 161,  58,  44, 114, 247, 243]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
198         1      223       3       199
386         2      223       4       114
640         3      223       5        95
936         4      223       5       118
1310        5      223       4       219
       user_id  item_id  rating  timestep
12409       46      223       5       125
12619       47      223       5        62
12967       48      223       4       137
13372       49      223       5       269
13567       50      223       4       191
average_rating for this rec across 50 users from same group (less noisy) was: 4.54
all_actions shape just before sample torch.Size([1, 9, 1])
action scaled by temperature: tensor([[71]], device='cuda:0')
action picked by argmax: tensor([71], device='cuda:0')
tensor([[ 71, 222, 165, 133,  40, 114, 150, 265, 261, 188]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
160         1       72       5       161
343         2       72       4        71
807         3       72       4       262
943         4       72       4       125
1141        5       72       4        50
       user_id  item_id  rating  timestep
12332       46       72       4        48
12696       47       72       3       139
12994       48       72       4       164
13136       49       72       5        33
13486       50       72       4       110
average_rating for this rec across 50 users from same group (less noisy) was: 4.0
all_actions shape just before sample torch.Size([1, 10, 1])
action scaled by temperature: tensor([[40]], device='cuda:0')
action picked by argmax: tensor([40], device='cuda:0')
tensor([[ 40, 265, 263,  71, 176, 207, 129, 133,  38, 172]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
66          1       41       4        67
353         2       41       5        81
756         3       41       3       211
1060        4       41       2       242
1343        5       41       3       252
       user_id  item_id  rating  timestep
12376       46       41       3        92
12615       47       41       3        58
12882       48       41       3        52
13156       49       41       5        53
13485       50       41       4       109
average_rating for this rec across 50 users from same group (less noisy) was: 3.66
all_actions shape just before sample torch.Size([1, 11, 1])
action scaled by temperature: tensor([[265]], device='cuda:0')
action picked by argmax: tensor([265], device='cuda:0')
tensor([[265,  76, 193,  19, 240,  40,  41,  90, 263, 215]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
81          1      266       3        82
342         2      266       3        70
793         3      266       4       248
901         4      266       3        83
1113        5      266       4        22
       user_id  item_id  rating  timestep
12394       46      266       5       110
12827       47      266       2       270
12927       48      266       5        97
13151       49      266       4        48
13393       50      266       5        17
average_rating for this rec across 50 users from same group (less noisy) was: 3.82
all_actions shape just before sample torch.Size([1, 12, 1])
action scaled by temperature: tensor([[76]], device='cuda:0')
action picked by argmax: tensor([76], device='cuda:0')
tensor([[ 76, 239,  41, 202, 123, 219, 185, 267, 214, 240]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
243         1       77       5       244
432         2       77       5       160
743         3       77       5       198
835         4       77       4        17
1233        5       77       4       142
       user_id  item_id  rating  timestep
12393       46       77       3       109
12719       47       77       4       162
13098       48       77       5       268
13143       49       77       4        40
13500       50       77       3       124
average_rating for this rec across 50 users from same group (less noisy) was: 3.96
all_actions shape just before sample torch.Size([1, 13, 1])
action scaled by temperature: tensor([[239]], device='cuda:0')
action picked by argmax: tensor([239], device='cuda:0')
tensor([[239, 202,  76, 215, 192, 219, 262, 125, 144, 156]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
187         1      240       4       188
438         2      240       2       166
711         3      240       4       166
911         4      240       3        93
1162        5      240       5        71
       user_id  item_id  rating  timestep
12384       46      240       4       100
12819       47      240       3       262
12972       48      240       4       142
13230       49      240       4       127
13454       50      240       2        78
average_rating for this rec across 50 users from same group (less noisy) was: 3.72
all_actions shape just before sample torch.Size([1, 14, 1])
action scaled by temperature: tensor([[215]], device='cuda:0')
action picked by argmax: tensor([202], device='cuda:0')
tensor([[202, 215, 239, 192,  76,  68,  55, 144,  41, 123]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
177         1      203       4       178
488         2      203       4       216
641         3      203       5        96
1021        4      203       4       203
1259        5      203       5       168
       user_id  item_id  rating  timestep
12526       46      203       4       242
12769       47      203       4       212
12905       48      203       4        75
13327       49      203       5       224
13553       50      203       4       177
average_rating for this rec across 50 users from same group (less noisy) was: 4.26
all_actions shape just before sample torch.Size([1, 15, 1])
action scaled by temperature: tensor([[215]], device='cuda:0')
action picked by argmax: tensor([215], device='cuda:0')
tensor([[215, 202, 192, 144, 250, 239, 212,  48,  55,  68]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
96          1      216       5        97
545         2      216       3       273
668         3      216       4       123
823         4      216       4         5
1103        5      216       5        12
       user_id  item_id  rating  timestep
12524       46      216       3       240
12735       47      216       3       178
12901       48      216       4        71
13359       49      216       4       256
13563       50      216       5       187
average_rating for this rec across 50 users from same group (less noisy) was: 3.64
all_actions shape just before sample torch.Size([1, 16, 1])
action scaled by temperature: tensor([[144]], device='cuda:0')
action picked by argmax: tensor([192], device='cuda:0')
tensor([[192, 108, 144,  76,  68, 202, 215, 214, 207, 209]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
11          1      193       3        12
393         2      193       4       121
628         3      193       5        83
878         4      193       5        60
1325        5      193       4       234
       user_id  item_id  rating  timestep
12327       46      193       3        43
12762       47      193       3       205
12992       48      193       5       162
13129       49      193       5        26
13493       50      193       3       117
average_rating for this rec across 50 users from same group (less noisy) was: 4.14
all_actions shape just before sample torch.Size([1, 17, 1])
action scaled by temperature: tensor([[87]], device='cuda:0')
action picked by argmax: tensor([108], device='cuda:0')
tensor([[108, 192, 144,  76,  68, 215,  75, 214, 207, 202]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
217         1      109       4       218
521         2      109       5       249
808         3      109       4       263
1013        4      109       5       195
1332        5      109       5       241
       user_id  item_id  rating  timestep
12395       46      109       5       111
12654       47      109       5        97
13079       48      109       5       249
13139       49      109       5        36
13588       50      109       5       212
average_rating for this rec across 50 users from same group (less noisy) was: 4.9
all_actions shape just before sample torch.Size([1, 18, 1])
action scaled by temperature: tensor([[144]], device='cuda:0')
action picked by argmax: tensor([144], device='cuda:0')
tensor([[144, 192,  76, 215, 108, 214, 171, 245,  68, 156]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
36          1      145       4        37
299         2      145       4        27
724         3      145       4       179
864         4      145       4        46
1132        5      145       4        41
       user_id  item_id  rating  timestep
12452       46      145       4       168
12749       47      145       4       192
13008       48      145       5       178
13317       49      145       4       214
13442       50      145       3        66
average_rating for this rec across 50 users from same group (less noisy) was: 4.14
all_actions shape just before sample torch.Size([1, 19, 1])
action scaled by temperature: tensor([[232]], device='cuda:0')
action picked by argmax: tensor([232], device='cuda:0')
tensor([[232,  75, 124,  48, 268, 192, 202, 104, 212, 157]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
209         1      233       4       210
448         2      233       4       176
785         3      233       4       240
874         4      233       4        56
1180        5      233       4        89
       user_id  item_id  rating  timestep
12504       46      233       4       220
12773       47      233       5       216
12931       48      233       5       101
13193       49      233       4        90
13555       50      233       3       179
average_rating for this rec across 50 users from same group (less noisy) was: 4.08
all_actions shape just before sample torch.Size([1, 20, 1])
action scaled by temperature: tensor([[75]], device='cuda:0')
action picked by argmax: tensor([75], device='cuda:0')
tensor([[ 75, 232, 136, 124, 265,  48, 221, 202, 180,  29]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
76          1       76       5        77
330         2       76       4        58
571         3       76       3        26
915         4       76       4        97
1167        5       76       4        76
       user_id  item_id  rating  timestep
12440       46       76       3       156
12588       47       76       4        31
12957       48       76       3       127
13325       49       76       5       222
13468       50       76       5        92
average_rating for this rec across 50 users from same group (less noisy) was: 4.04
all_actions shape just before sample torch.Size([1, 21, 1])
action scaled by temperature: tensor([[136]], device='cuda:0')
action picked by argmax: tensor([136], device='cuda:0')
tensor([[136, 219, 104, 152, 101, 192, 199, 215, 250,   5]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
272         1      137       4       273
451         2      137       3       179
595         3      137       5        50
1017        4      137       4       199
1298        5      137       4       207
       user_id  item_id  rating  timestep
12307       46      137       4        23
12565       47      137       4         8
12961       48      137       4       131
13254       49      137       3       151
13529       50      137       4       153
average_rating for this rec across 50 users from same group (less noisy) was: 3.76
all_actions shape just before sample torch.Size([1, 22, 1])
action scaled by temperature: tensor([[85]], device='cuda:0')
action picked by argmax: tensor([85], device='cuda:0')
tensor([[ 85,  45,  21, 193,  10, 129,   4, 152,  54, 232]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
266         1       86       5       267
509         2       86       5       237
777         3       86       5       232
917         4       86       5        99
1121        5       86       4        30
       user_id  item_id  rating  timestep
12506       46       86       5       222
12600       47       86       5        43
13074       48       86       5       244
13362       49       86       5       259
13397       50       86       5        21
average_rating for this rec across 50 users from same group (less noisy) was: 4.58
all_actions shape just before sample torch.Size([1, 23, 1])
action scaled by temperature: tensor([[45]], device='cuda:0')
action picked by argmax: tensor([45], device='cuda:0')
tensor([[ 45,  85,   4,  10, 166, 180, 209,  54,  13, 152]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
139         1       46       5       140
296         2       46       5        24
714         3       46       5       169
973         4       46       3       155
1219        5       46       5       128
       user_id  item_id  rating  timestep
12425       46       46       5       141
12651       47       46       5        94
12862       48       46       4        32
13247       49       46       4       144
13537       50       46       3       161
average_rating for this rec across 50 users from same group (less noisy) was: 4.14
all_actions shape just before sample torch.Size([1, 24, 1])
action scaled by temperature: tensor([[10]], device='cuda:0')
action picked by argmax: tensor([10], device='cuda:0')
tensor([[ 10,  13, 104, 152,  20,  61,   5, 173, 268, 262]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
183         1       11       1       184
302         2       11       4        30
616         3       11       3        71
877         4       11       2        59
1096        5       11       3         5
       user_id  item_id  rating  timestep
12340       46       11       2        56
12829       47       11       1       272
12922       48       11       3        92
13155       49       11       2        52
13410       50       11       2        34
average_rating for this rec across 50 users from same group (less noisy) was: 2.2
all_actions shape just before sample torch.Size([1, 25, 1])
action scaled by temperature: tensor([[254]], device='cuda:0')
action picked by argmax: tensor([254], device='cuda:0')
tensor([[254, 156,   1,  50,  36, 106,  73, 120,  40, 214]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
153         1      255       5       154
544         2      255       5       272
618         3      255       4        73
989         4      255       5       171
1214        5      255       4       123
       user_id  item_id  rating  timestep
12365       46      255       5        81
12724       47      255       4       167
12933       48      255       4       103
13227       49      255       3       124
13601       50      255       3       225
average_rating for this rec across 50 users from same group (less noisy) was: 4.5
all_actions shape just before sample torch.Size([1, 26, 1])
action scaled by temperature: tensor([[262]], device='cuda:0')
action picked by argmax: tensor([262], device='cuda:0')
tensor([[262, 239, 243, 171, 142, 209, 205,  63, 240, 153]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
230         1      263       5       231
515         2      263       4       243
589         3      263       4        44
977         4      263       4       159
1146        5      263       5        55
       user_id  item_id  rating  timestep
12402       46      263       4       118
12797       47      263       5       240
12947       48      263       4       117
13225       49      263       3       122
13463       50      263       5        87
average_rating for this rec across 50 users from same group (less noisy) was: 4.34
all_actions shape just before sample torch.Size([1, 27, 1])
action scaled by temperature: tensor([[171]], device='cuda:0')
action picked by argmax: tensor([171], device='cuda:0')
tensor([[171, 142, 209,  29, 153, 195,  36,  85,  92, 188]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
6           1      172       4         7
376         2      172       4       104
568         3      172       3        23
964         4      172       4       146
1252        5      172       4       161
       user_id  item_id  rating  timestep
12301       46      172       3        17
12572       47      172       4        15
13077       48      172       4       247
13163       49      172       4        60
13546       50      172       3       170
average_rating for this rec across 50 users from same group (less noisy) was: 4.08
all_actions shape just before sample torch.Size([1, 28, 1])
action scaled by temperature: tensor([[29]], device='cuda:0')
action picked by argmax: tensor([29], device='cuda:0')
tensor([[ 29,  92, 142, 209, 171, 236, 153,  94,  31, 195]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
196         1       30       2       197
462         2       30       2       190
683         3       30       2       138
832         4       30       3        14
1277        5       30       3       186
       user_id  item_id  rating  timestep
12298       46       30       3        14
12786       47       30       4       229
13049       48       30       3       219
13167       49       30       5        64
13545       50       30       5       169
average_rating for this rec across 50 users from same group (less noisy) was: 3.2
all_actions shape just before sample torch.Size([1, 29, 1])
action scaled by temperature: tensor([[92]], device='cuda:0')
action picked by argmax: tensor([92], device='cuda:0')
tensor([[ 92,  29, 236, 209, 189, 142, 171,  94, 153, 134]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
240         1       93       5       241
512         2       93       5       240
614         3       93       4        69
881         4       93       5        63
1326        5       93       5       235
       user_id  item_id  rating  timestep
12349       46       93       5        65
12787       47       93       5       230
12886       48       93       5        56
13259       49       93       5       156
13386       50       93       4        10
average_rating for this rec across 50 users from same group (less noisy) was: 4.58
all_actions shape just before sample torch.Size([1, 30, 1])
action scaled by temperature: tensor([[92]], device='cuda:0')
action picked by argmax: tensor([92], device='cuda:0')
tensor([[ 92, 236,  29, 209, 134,  94, 221, 144, 153, 126]], device='cuda:0')
Just recommended 30 new items to 50 users from group 1 and the total rating was 121.82000000000002
train_loss is: 1.8312128695178793
action scaled by temperature: tensor([[87]], device='cuda:0')
action picked by argmax: tensor([227], device='cuda:0')
tensor([[227,  40, 265, 167,  10, 247, 211, 205, 158,  52]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
205         1      228       4       206
490         2      228       3       218
663         3      228       3       118
1070        4      228       2       252
1271        5      228       3       180
       user_id  item_id  rating  timestep
12329       46      228       4        45
12703       47      228       3       146
12879       48      228       5        49
13111       49      228       2         8
13530       50      228       4       154
average_rating for this rec across 50 users from same group (less noisy) was: 3.34
all_actions shape just before sample torch.Size([1, 1, 1])
action scaled by temperature: tensor([[29]], device='cuda:0')
action picked by argmax: tensor([254], device='cuda:0')
tensor([[254, 171, 162, 205, 100, 153, 107,  29,  32, 156]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
153         1      255       5       154
544         2      255       5       272
618         3      255       4        73
989         4      255       5       171
1214        5      255       4       123
       user_id  item_id  rating  timestep
12365       46      255       5        81
12724       47      255       4       167
12933       48      255       4       103
13227       49      255       3       124
13601       50      255       3       225
average_rating for this rec across 50 users from same group (less noisy) was: 4.5
all_actions shape just before sample torch.Size([1, 2, 1])
action scaled by temperature: tensor([[101]], device='cuda:0')
action picked by argmax: tensor([102], device='cuda:0')
tensor([[102, 170,  29, 243, 137, 107, 153, 251,  79,  75]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
248         1      103       5       249
398         2      103       4       126
585         3      103       5        40
1009        4      103       5       191
1127        5      103       5        36
       user_id  item_id  rating  timestep
12388       46      103       5       104
12771       47      103       5       214
12958       48      103       5       128
13158       49      103       5        55
13411       50      103       4        35
average_rating for this rec across 50 users from same group (less noisy) was: 4.64
all_actions shape just before sample torch.Size([1, 3, 1])
action scaled by temperature: tensor([[171]], device='cuda:0')
action picked by argmax: tensor([171], device='cuda:0')
tensor([[171,  11,  59,  84,  98,  88, 190, 100,  24, 205]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
6           1      172       4         7
376         2      172       4       104
568         3      172       3        23
964         4      172       4       146
1252        5      172       4       161
       user_id  item_id  rating  timestep
12301       46      172       3        17
12572       47      172       4        15
13077       48      172       4       247
13163       49      172       4        60
13546       50      172       3       170
average_rating for this rec across 50 users from same group (less noisy) was: 4.08
all_actions shape just before sample torch.Size([1, 4, 1])
action scaled by temperature: tensor([[105]], device='cuda:0')
action picked by argmax: tensor([105], device='cuda:0')
tensor([[105, 237, 246,   1, 109, 164,  10, 221,   0, 177]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
151         1      106       4       152
453         2      106       4       181
605         3      106       5        60
1071        4      106       2       253
1228        5      106       3       137
       user_id  item_id  rating  timestep
12389       46      106       4       105
12808       47      106       4       251
12996       48      106       4       166
13279       49      106       4       176
13559       50      106       5       183
average_rating for this rec across 50 users from same group (less noisy) was: 4.14
all_actions shape just before sample torch.Size([1, 5, 1])
action scaled by temperature: tensor([[237]], device='cuda:0')
action picked by argmax: tensor([237], device='cuda:0')
tensor([[237, 109, 105, 175, 246, 171, 221,  24,  89, 164]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
228         1      238       4       229
475         2      238       3       203
719         3      238       3       174
860         4      238       5        42
1166        5      238       5        75
       user_id  item_id  rating  timestep
12462       46      238       3       178
12618       47      238       4        61
13000       48      238       5       170
13192       49      238       3        89
13431       50      238       5        55
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 6, 1])
action scaled by temperature: tensor([[237]], device='cuda:0')
action picked by argmax: tensor([109], device='cuda:0')
tensor([[109, 237, 175, 105, 221,  89, 217,  84, 171, 164]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
132         1      110       4       133
472         2      110       5       200
687         3      110       5       142
910         4      110       5        92
1217        5      110       4       126
       user_id  item_id  rating  timestep
12408       46      110       5       124
12729       47      110       5       172
12956       48      110       5       126
13369       49      110       5       266
13458       50      110       5        82
average_rating for this rec across 50 users from same group (less noisy) was: 4.66
all_actions shape just before sample torch.Size([1, 7, 1])
action scaled by temperature: tensor([[94]], device='cuda:0')
action picked by argmax: tensor([94], device='cuda:0')
tensor([[ 94, 236, 109,  97, 142,  16, 237, 172, 141,  25]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
162         1       95       3       163
474         2       95       5       202
762         3       95       5       217
978         4       95       4       160
1355        5       95       3       264
       user_id  item_id  rating  timestep
12350       46       95       3        66
12800       47       95       4       243
12918       48       95       4        88
13240       49       95       4       137
13581       50       95       5       205
average_rating for this rec across 50 users from same group (less noisy) was: 3.76
all_actions shape just before sample torch.Size([1, 8, 1])
action scaled by temperature: tensor([[81]], device='cuda:0')
action picked by argmax: tensor([81], device='cuda:0')
tensor([[ 81, 208, 171, 189, 165,   9, 235, 267, 225,  25]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
68          1       82       5        69
540         2       82       5       268
688         3       82       4       143
963         4       82       5       145
1140        5       82       4        49
       user_id  item_id  rating  timestep
12345       46       82       4        61
12570       47       82       4        13
12926       48       82       5        96
13162       49       82       4        59
13379       50       82       4         3
average_rating for this rec across 50 users from same group (less noisy) was: 4.44
all_actions shape just before sample torch.Size([1, 9, 1])
action scaled by temperature: tensor([[139]], device='cuda:0')
action picked by argmax: tensor([139], device='cuda:0')
tensor([[139, 268, 127, 232,  45, 255,  56, 250,  23, 264]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
175         1      140       4       176
290         2      140       4        18
659         3      140       3       114
1005        4      140       4       187
1179        5      140       5        88
       user_id  item_id  rating  timestep
12482       46      140       3       198
12778       47      140       4       221
13043       48      140       5       213
13285       49      140       4       182
13604       50      140       5       228
average_rating for this rec across 50 users from same group (less noisy) was: 4.16
all_actions shape just before sample torch.Size([1, 10, 1])
action scaled by temperature: tensor([[127]], device='cuda:0')
action picked by argmax: tensor([268], device='cuda:0')
tensor([[268, 127, 139, 106,  45, 166, 228,  43,  56, 183]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
146         1      269       5       147
338         2      269       4        66
695         3      269       5       150
1049        4      269       5       231
1295        5      269       4       204
       user_id  item_id  rating  timestep
12474       46      269       4       190
12685       47      269       5       128
13091       48      269       4       261
13338       49      269       4       235
13558       50      269       5       182
average_rating for this rec across 50 users from same group (less noisy) was: 4.12
all_actions shape just before sample torch.Size([1, 11, 1])
action scaled by temperature: tensor([[127]], device='cuda:0')
action picked by argmax: tensor([127], device='cuda:0')
tensor([[127, 268, 106, 139,  45,  23,  13, 228, 110, 169]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
261         1      128       4       262
297         2      128       5        25
682         3      128       4       137
869         4      128       3        51
1358        5      128       4       267
       user_id  item_id  rating  timestep
12541       46      128       4       257
12674       47      128       3       117
12840       48      128       4        10
13344       49      128       5       241
13619       50      128       4       243
average_rating for this rec across 50 users from same group (less noisy) was: 4.08
all_actions shape just before sample torch.Size([1, 12, 1])
action scaled by temperature: tensor([[106]], device='cuda:0')
action picked by argmax: tensor([106], device='cuda:0')
tensor([[106, 183, 155, 110,  95, 111, 245, 127, 268,  42]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
173         1      107       4       174
382         2      107       4       110
769         3      107       4       224
995         4      107       5       177
1261        5      107       4       170
       user_id  item_id  rating  timestep
12344       46      107       3        60
12657       47      107       4       100
12939       48      107       5       109
13284       49      107       3       181
13531       50      107       4       155
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 13, 1])
action scaled by temperature: tensor([[51]], device='cuda:0')
action picked by argmax: tensor([51], device='cuda:0')
tensor([[ 51,  70, 159, 169, 110,  55, 127, 204, 111,  42]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
206         1       52       4       207
379         2       52       4       107
570         3       52       5        25
844         4       52       4        26
1208        5       52       4       117
       user_id  item_id  rating  timestep
12557       46       52       4       273
12712       47       52       5       155
12944       48       52       4       114
13107       49       52       4         4
13387       50       52       4        11
average_rating for this rec across 50 users from same group (less noisy) was: 4.18
all_actions shape just before sample torch.Size([1, 14, 1])
action scaled by temperature: tensor([[70]], device='cuda:0')
action picked by argmax: tensor([70], device='cuda:0')
tensor([[ 70,  51, 101, 269,  10, 110, 200, 159,  45,  49]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
79          1       71       4        80
435         2       71       4       163
621         3       71       4        76
954         4       71       5       136
1223        5       71       4       132
       user_id  item_id  rating  timestep
12485       46       71       3       201
12744       47       71       4       187
12832       48       71       4         2
13187       49       71       4        84
13540       50       71       5       164
average_rating for this rec across 50 users from same group (less noisy) was: 4.04
all_actions shape just before sample torch.Size([1, 15, 1])
action scaled by temperature: tensor([[193]], device='cuda:0')
action picked by argmax: tensor([193], device='cuda:0')
tensor([[193,  88, 208, 137, 265, 180, 204,  52,   3,  35]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
15          1      194       3        16
423         2      194       5       151
569         3      194       2        24
971         4      194       3       153
1099        5      194       5         8
       user_id  item_id  rating  timestep
12512       46      194       4       228
12663       47      194       3       106
13083       48      194       3       253
13117       49      194       3        14
13489       50      194       2       113
average_rating for this rec across 50 users from same group (less noisy) was: 3.58
all_actions shape just before sample torch.Size([1, 16, 1])
action scaled by temperature: tensor([[88]], device='cuda:0')
action picked by argmax: tensor([88], device='cuda:0')
tensor([[ 88, 193, 266, 137,   3, 180, 204,  12,  35, 265]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
163         1       89       5       164
411         2       89       3       139
725         3       89       3       180
848         4       89       3        30
1215        5       89       3       124
       user_id  item_id  rating  timestep
12396       46       89       3       112
12581       47       89       4        24
12979       48       89       3       149
13286       49       89       2       183
13503       50       89       3       127
average_rating for this rec across 50 users from same group (less noisy) was: 3.38
all_actions shape just before sample torch.Size([1, 17, 1])
action scaled by temperature: tensor([[137]], device='cuda:0')
action picked by argmax: tensor([137], device='cuda:0')
tensor([[137, 193,   3,  88, 266, 265,  35, 264,  27, 270]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
197         1      138       4       198
542         2      138       4       270
636         3      138       5        91
926         4      138       4       108
1195        5      138       5       104
       user_id  item_id  rating  timestep
12538       46      138       4       254
12596       47      138       4        39
13053       48      138       4       223
13354       49      138       5       251
13519       50      138       5       143
average_rating for this rec across 50 users from same group (less noisy) was: 4.36
all_actions shape just before sample torch.Size([1, 18, 1])
action scaled by temperature: tensor([[31]], device='cuda:0')
action picked by argmax: tensor([31], device='cuda:0')
tensor([[ 31, 270, 203,  38, 178,  27, 137, 188, 204, 202]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
207         1       32       4       208
505         2       32       4       233
813         3       32       5       268
833         4       32       5        15
1309        5       32       4       218
       user_id  item_id  rating  timestep
12338       46       32       3        54
12783       47       32       3       226
12917       48       32       5        87
13318       49       32       4       215
13390       50       32       3        14
average_rating for this rec across 50 users from same group (less noisy) was: 4.1
all_actions shape just before sample torch.Size([1, 19, 1])
action scaled by temperature: tensor([[270]], device='cuda:0')
action picked by argmax: tensor([270], device='cuda:0')
tensor([[270,  31, 203, 119, 118, 178,  77, 235, 126, 188]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
262         1      271       4       263
532         2      271       3       260
735         3      271       4       190
958         4      271       5       140
1147        5      271       4        56
       user_id  item_id  rating  timestep
12379       46      271       4        95
12758       47      271       3       201
13055       48      271       4       225
13305       49      271       4       202
13429       50      271       4        53
average_rating for this rec across 50 users from same group (less noisy) was: 4.2
all_actions shape just before sample torch.Size([1, 20, 1])
action scaled by temperature: tensor([[203]], device='cuda:0')
action picked by argmax: tensor([203], device='cuda:0')
tensor([[203, 270,  31,  32,  35, 178,  77, 137, 148,  64]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
63          1      204       3        64
400         2      204       3       128
755         3      204       3       210
1045        4      204       4       227
1220        5      204       3       129
       user_id  item_id  rating  timestep
12398       46      204       4       114
12571       47      204       5        14
12977       48      204       3       147
13282       49      204       4       179
13547       50      204       4       171
average_rating for this rec across 50 users from same group (less noisy) was: 3.52
all_actions shape just before sample torch.Size([1, 21, 1])
action scaled by temperature: tensor([[234]], device='cuda:0')
action picked by argmax: tensor([32], device='cuda:0')
tensor([[ 32, 234,  64, 135, 178, 270, 177, 255, 256,  99]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
117         1       33       3       118
463         2       33       2       191
738         3       33       2       193
837         4       33       5        19
1267        5       33       3       176
       user_id  item_id  rating  timestep
12454       46       33       4       170
12590       47       33       4        33
12848       48       33       4        18
13360       49       33       4       257
13418       50       33       5        42
average_rating for this rec across 50 users from same group (less noisy) was: 3.6
all_actions shape just before sample torch.Size([1, 22, 1])
action scaled by temperature: tensor([[234]], device='cuda:0')
action picked by argmax: tensor([234], device='cuda:0')
tensor([[234,  32,  64, 135, 123,  60, 255, 196,  99, 178]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
233         1      235       3       234
468         2      235       4       196
662         3      235       4       117
927         4      235       3       109
1185        5      235       4        94
       user_id  item_id  rating  timestep
12305       46      235       3        21
12679       47      235       2       122
12895       48      235       4        65
13238       49      235       5       135
13642       50      235       5       266
average_rating for this rec across 50 users from same group (less noisy) was: 3.78
all_actions shape just before sample torch.Size([1, 23, 1])
action scaled by temperature: tensor([[272]], device='cuda:0')
action picked by argmax: tensor([272], device='cuda:0')
tensor([[272, 269, 196, 240,  93, 194, 135,  97,  28,  83]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
232         1      273       5       233
334         2      273       5        62
694         3      273       4       149
994         4      273       5       176
1131        5      273       5        40
       user_id  item_id  rating  timestep
12539       46      273       4       255
12788       47      273       5       231
12951       48      273       5       121
13264       49      273       5       161
13408       50      273       5        32
average_rating for this rec across 50 users from same group (less noisy) was: 4.5
all_actions shape just before sample torch.Size([1, 24, 1])
action scaled by temperature: tensor([[269]], device='cuda:0')
action picked by argmax: tensor([269], device='cuda:0')
tensor([[269, 272, 196, 128,  30, 142,  83,  97, 240, 194]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
164         1      270       5       165
417         2      270       4       145
772         3      270       5       227
863         4      270       5        45
1211        5      270       5       120
       user_id  item_id  rating  timestep
12341       46      270       4        57
12626       47      270       4        69
12885       48      270       3        55
13182       49      270       4        79
13453       50      270       4        77
average_rating for this rec across 50 users from same group (less noisy) was: 4.28
all_actions shape just before sample torch.Size([1, 25, 1])
action scaled by temperature: tensor([[196]], device='cuda:0')
action picked by argmax: tensor([196], device='cuda:0')
tensor([[196, 128, 203, 269, 272, 266, 223, 174, 121, 146]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
98          1      197       3        99
369         2      197       4        97
729         3      197       3       184
867         4      197       5        49
1109        5      197       4        18
       user_id  item_id  rating  timestep
12311       46      197       2        27
12645       47      197       4        88
13014       48      197       3       184
13119       49      197       1        16
13636       50      197       3       260
average_rating for this rec across 50 users from same group (less noisy) was: 3.28
all_actions shape just before sample torch.Size([1, 26, 1])
action scaled by temperature: tensor([[128]], device='cuda:0')
action picked by argmax: tensor([128], device='cuda:0')
tensor([[128, 196, 266, 203, 121,  64, 188,   9, 174, 223]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
34          1      129       5        35
497         2      129       4       225
716         3      129       5       171
873         4      129       5        55
1317        5      129       5       226
       user_id  item_id  rating  timestep
12468       46      129       4       184
12708       47      129       5       151
12857       48      129       4        27
13141       49      129       5        38
13498       50      129       5       122
average_rating for this rec across 50 users from same group (less noisy) was: 4.3
all_actions shape just before sample torch.Size([1, 27, 1])
action scaled by temperature: tensor([[266]], device='cuda:0')
action picked by argmax: tensor([266], device='cuda:0')
tensor([[266,   9, 128,  64, 196, 121, 203, 130, 117, 194]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
71          1      267       5        72
328         2      267       5        56
672         3      267       5       127
1022        4      267       5       204
1335        5      267       5       244
       user_id  item_id  rating  timestep
12387       46      267       5       103
12633       47      267       4        76
13003       48      267       5       173
13204       49      267       5       101
13626       50      267       5       250
average_rating for this rec across 50 users from same group (less noisy) was: 4.78
all_actions shape just before sample torch.Size([1, 28, 1])
action scaled by temperature: tensor([[9]], device='cuda:0')
action picked by argmax: tensor([9], device='cuda:0')
tensor([[  9, 203, 233, 196,  60,  64, 117,  72, 128, 266]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
256         1       10       5       257
308         2       10       5        36
626         3       10       4        81
1055        4       10       4       237
1193        5       10       5       102
       user_id  item_id  rating  timestep
12521       46       10       5       237
12698       47       10       5       141
12982       48       10       4       152
13245       49       10       5       142
13461       50       10       4        85
average_rating for this rec across 50 users from same group (less noisy) was: 4.56
all_actions shape just before sample torch.Size([1, 29, 1])
action scaled by temperature: tensor([[117]], device='cuda:0')
action picked by argmax: tensor([117], device='cuda:0')
tensor([[117, 233,   9, 255, 196,  60, 179, 203, 266,  72]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
70          1      118       4        71
404         2      118       4       132
643         3      118       5        98
1000        4      118       5       182
1302        5      118       4       211
       user_id  item_id  rating  timestep
12489       46      118       4       205
12576       47      118       4        19
12923       48      118       4        93
13374       49      118       3       271
13566       50      118       4       190
average_rating for this rec across 50 users from same group (less noisy) was: 4.3
all_actions shape just before sample torch.Size([1, 30, 1])
action scaled by temperature: tensor([[233]], device='cuda:0')
action picked by argmax: tensor([233], device='cuda:0')
tensor([[233,  60, 117,   9,   8, 181,  61,  77, 196, 180]], device='cuda:0')
Just recommended 30 new items to 50 users from group 1 and the total rating was 122.77999999999999
train_loss is: 1.5377702914416518
action scaled by temperature: tensor([[205]], device='cuda:0')
action picked by argmax: tensor([227], device='cuda:0')
tensor([[227,  52, 109,  39, 211, 125,  51, 147, 186,  95]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
205         1      228       4       206
490         2      228       3       218
663         3      228       3       118
1070        4      228       2       252
1271        5      228       3       180
       user_id  item_id  rating  timestep
12329       46      228       4        45
12703       47      228       3       146
12879       48      228       5        49
13111       49      228       2         8
13530       50      228       4       154
average_rating for this rec across 50 users from same group (less noisy) was: 3.34
all_actions shape just before sample torch.Size([1, 1, 1])
action scaled by temperature: tensor([[10]], device='cuda:0')
action picked by argmax: tensor([254], device='cuda:0')
tensor([[254, 171, 162, 107, 205, 172, 223,  50, 100,  85]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
153         1      255       5       154
544         2      255       5       272
618         3      255       4        73
989         4      255       5       171
1214        5      255       4       123
       user_id  item_id  rating  timestep
12365       46      255       5        81
12724       47      255       4       167
12933       48      255       4       103
13227       49      255       3       124
13601       50      255       3       225
average_rating for this rec across 50 users from same group (less noisy) was: 4.5
all_actions shape just before sample torch.Size([1, 2, 1])
action scaled by temperature: tensor([[218]], device='cuda:0')
action picked by argmax: tensor([102], device='cuda:0')
tensor([[102, 170,  29, 107, 153, 137, 251, 262,  75, 243]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
248         1      103       5       249
398         2      103       4       126
585         3      103       5        40
1009        4      103       5       191
1127        5      103       5        36
       user_id  item_id  rating  timestep
12388       46      103       5       104
12771       47      103       5       214
12958       48      103       5       128
13158       49      103       5        55
13411       50      103       4        35
average_rating for this rec across 50 users from same group (less noisy) was: 4.64
all_actions shape just before sample torch.Size([1, 3, 1])
action scaled by temperature: tensor([[171]], device='cuda:0')
action picked by argmax: tensor([171], device='cuda:0')
tensor([[171,  11,  84,  59, 190,  98, 100,  88,  24,  65]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
6           1      172       4         7
376         2      172       4       104
568         3      172       3        23
964         4      172       4       146
1252        5      172       4       161
       user_id  item_id  rating  timestep
12301       46      172       3        17
12572       47      172       4        15
13077       48      172       4       247
13163       49      172       4        60
13546       50      172       3       170
average_rating for this rec across 50 users from same group (less noisy) was: 4.08
all_actions shape just before sample torch.Size([1, 4, 1])
action scaled by temperature: tensor([[105]], device='cuda:0')
action picked by argmax: tensor([105], device='cuda:0')
tensor([[105, 237,   1, 221, 177,  10,  47, 246, 217,  62]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
151         1      106       4       152
453         2      106       4       181
605         3      106       5        60
1071        4      106       2       253
1228        5      106       3       137
       user_id  item_id  rating  timestep
12389       46      106       4       105
12808       47      106       4       251
12996       48      106       4       166
13279       49      106       4       176
13559       50      106       5       183
average_rating for this rec across 50 users from same group (less noisy) was: 4.14
all_actions shape just before sample torch.Size([1, 5, 1])
action scaled by temperature: tensor([[237]], device='cuda:0')
action picked by argmax: tensor([237], device='cuda:0')
tensor([[237, 175, 105, 109, 221,   1,  89, 195,  62, 171]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
228         1      238       4       229
475         2      238       3       203
719         3      238       3       174
860         4      238       5        42
1166        5      238       5        75
       user_id  item_id  rating  timestep
12462       46      238       3       178
12618       47      238       4        61
13000       48      238       5       170
13192       49      238       3        89
13431       50      238       5        55
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 6, 1])
action scaled by temperature: tensor([[237]], device='cuda:0')
action picked by argmax: tensor([237], device='cuda:0')
tensor([[237, 109, 175, 221,  89, 217, 190, 105, 195, 177]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
228         1      238       4       229
475         2      238       3       203
719         3      238       3       174
860         4      238       5        42
1166        5      238       5        75
       user_id  item_id  rating  timestep
12462       46      238       3       178
12618       47      238       4        61
13000       48      238       5       170
13192       49      238       3        89
13431       50      238       5        55
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 7, 1])
action scaled by temperature: tensor([[109]], device='cuda:0')
action picked by argmax: tensor([109], device='cuda:0')
tensor([[109,  31, 237, 175, 194, 236, 221, 190,  29, 129]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
132         1      110       4       133
472         2      110       5       200
687         3      110       5       142
910         4      110       5        92
1217        5      110       4       126
       user_id  item_id  rating  timestep
12408       46      110       5       124
12729       47      110       5       172
12956       48      110       5       126
13369       49      110       5       266
13458       50      110       5        82
average_rating for this rec across 50 users from same group (less noisy) was: 4.66
all_actions shape just before sample torch.Size([1, 8, 1])
action scaled by temperature: tensor([[94]], device='cuda:0')
action picked by argmax: tensor([94], device='cuda:0')
tensor([[ 94, 236, 141, 142,  25,  97, 120, 108, 218,   2]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
162         1       95       3       163
474         2       95       5       202
762         3       95       5       217
978         4       95       4       160
1355        5       95       3       264
       user_id  item_id  rating  timestep
12350       46       95       3        66
12800       47       95       4       243
12918       48       95       4        88
13240       49       95       4       137
13581       50       95       5       205
average_rating for this rec across 50 users from same group (less noisy) was: 3.76
all_actions shape just before sample torch.Size([1, 9, 1])
action scaled by temperature: tensor([[81]], device='cuda:0')
action picked by argmax: tensor([81], device='cuda:0')
tensor([[ 81, 225, 189, 208, 207, 267,  90, 155,   2,   0]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
68          1       82       5        69
540         2       82       5       268
688         3       82       4       143
963         4       82       5       145
1140        5       82       4        49
       user_id  item_id  rating  timestep
12345       46       82       4        61
12570       47       82       4        13
12926       48       82       5        96
13162       49       82       4        59
13379       50       82       4         3
average_rating for this rec across 50 users from same group (less noisy) was: 4.44
all_actions shape just before sample torch.Size([1, 10, 1])
action scaled by temperature: tensor([[139]], device='cuda:0')
action picked by argmax: tensor([139], device='cuda:0')
tensor([[139, 268, 127, 232,  45,  56, 250, 255, 128, 133]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
175         1      140       4       176
290         2      140       4        18
659         3      140       3       114
1005        4      140       4       187
1179        5      140       5        88
       user_id  item_id  rating  timestep
12482       46      140       3       198
12778       47      140       4       221
13043       48      140       5       213
13285       49      140       4       182
13604       50      140       5       228
average_rating for this rec across 50 users from same group (less noisy) was: 4.16
all_actions shape just before sample torch.Size([1, 11, 1])
action scaled by temperature: tensor([[268]], device='cuda:0')
action picked by argmax: tensor([268], device='cuda:0')
tensor([[268, 127, 139, 106, 128,  58, 138, 186, 166, 169]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
146         1      269       5       147
338         2      269       4        66
695         3      269       5       150
1049        4      269       5       231
1295        5      269       4       204
       user_id  item_id  rating  timestep
12474       46      269       4       190
12685       47      269       5       128
13091       48      269       4       261
13338       49      269       4       235
13558       50      269       5       182
average_rating for this rec across 50 users from same group (less noisy) was: 4.12
all_actions shape just before sample torch.Size([1, 12, 1])
action scaled by temperature: tensor([[127]], device='cuda:0')
action picked by argmax: tensor([127], device='cuda:0')
tensor([[127, 106, 268, 139,  51,  13,  45,  58, 111, 138]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
261         1      128       4       262
297         2      128       5        25
682         3      128       4       137
869         4      128       3        51
1358        5      128       4       267
       user_id  item_id  rating  timestep
12541       46      128       4       257
12674       47      128       3       117
12840       48      128       4        10
13344       49      128       5       241
13619       50      128       4       243
average_rating for this rec across 50 users from same group (less noisy) was: 4.08
all_actions shape just before sample torch.Size([1, 13, 1])
action scaled by temperature: tensor([[106]], device='cuda:0')
action picked by argmax: tensor([106], device='cuda:0')
tensor([[106, 110, 127, 183, 245,  70, 268,  51, 155,  42]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
173         1      107       4       174
382         2      107       4       110
769         3      107       4       224
995         4      107       5       177
1261        5      107       4       170
       user_id  item_id  rating  timestep
12344       46      107       3        60
12657       47      107       4       100
12939       48      107       5       109
13284       49      107       3       181
13531       50      107       4       155
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 14, 1])
action scaled by temperature: tensor([[51]], device='cuda:0')
action picked by argmax: tensor([51], device='cuda:0')
tensor([[ 51,  70, 159, 110,  42,  10, 106, 169, 101, 111]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
206         1       52       4       207
379         2       52       4       107
570         3       52       5        25
844         4       52       4        26
1208        5       52       4       117
       user_id  item_id  rating  timestep
12557       46       52       4       273
12712       47       52       5       155
12944       48       52       4       114
13107       49       52       4         4
13387       50       52       4        11
average_rating for this rec across 50 users from same group (less noisy) was: 4.18
all_actions shape just before sample torch.Size([1, 15, 1])
action scaled by temperature: tensor([[70]], device='cuda:0')
action picked by argmax: tensor([70], device='cuda:0')
tensor([[ 70,  51, 101,  10, 269,  49, 240, 200,  45, 110]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
79          1       71       4        80
435         2       71       4       163
621         3       71       4        76
954         4       71       5       136
1223        5       71       4       132
       user_id  item_id  rating  timestep
12485       46       71       3       201
12744       47       71       4       187
12832       48       71       4         2
13187       49       71       4        84
13540       50       71       5       164
average_rating for this rec across 50 users from same group (less noisy) was: 4.04
all_actions shape just before sample torch.Size([1, 16, 1])
action scaled by temperature: tensor([[193]], device='cuda:0')
action picked by argmax: tensor([193], device='cuda:0')
tensor([[193,  88, 137,   3, 265, 208, 119,  12,  48, 266]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
15          1      194       3        16
423         2      194       5       151
569         3      194       2        24
971         4      194       3       153
1099        5      194       5         8
       user_id  item_id  rating  timestep
12512       46      194       4       228
12663       47      194       3       106
13083       48      194       3       253
13117       49      194       3        14
13489       50      194       2       113
average_rating for this rec across 50 users from same group (less noisy) was: 3.58
all_actions shape just before sample torch.Size([1, 17, 1])
action scaled by temperature: tensor([[88]], device='cuda:0')
action picked by argmax: tensor([88], device='cuda:0')
tensor([[ 88, 193, 266, 137,   3, 119,  12, 265,  35, 239]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
163         1       89       5       164
411         2       89       3       139
725         3       89       3       180
848         4       89       3        30
1215        5       89       3       124
       user_id  item_id  rating  timestep
12396       46       89       3       112
12581       47       89       4        24
12979       48       89       3       149
13286       49       89       2       183
13503       50       89       3       127
average_rating for this rec across 50 users from same group (less noisy) was: 3.38
all_actions shape just before sample torch.Size([1, 18, 1])
action scaled by temperature: tensor([[137]], device='cuda:0')
action picked by argmax: tensor([137], device='cuda:0')
tensor([[137, 193,  88,   3, 178,  31, 266, 202,  27, 203]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
197         1      138       4       198
542         2      138       4       270
636         3      138       5        91
926         4      138       4       108
1195        5      138       5       104
       user_id  item_id  rating  timestep
12538       46      138       4       254
12596       47      138       4        39
13053       48      138       4       223
13354       49      138       5       251
13519       50      138       5       143
average_rating for this rec across 50 users from same group (less noisy) was: 4.36
all_actions shape just before sample torch.Size([1, 19, 1])
action scaled by temperature: tensor([[31]], device='cuda:0')
action picked by argmax: tensor([31], device='cuda:0')
tensor([[ 31, 270,  38, 155, 203,  32, 178, 132, 186,  27]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
207         1       32       4       208
505         2       32       4       233
813         3       32       5       268
833         4       32       5        15
1309        5       32       4       218
       user_id  item_id  rating  timestep
12338       46       32       3        54
12783       47       32       3       226
12917       48       32       5        87
13318       49       32       4       215
13390       50       32       3        14
average_rating for this rec across 50 users from same group (less noisy) was: 4.1
all_actions shape just before sample torch.Size([1, 20, 1])
action scaled by temperature: tensor([[270]], device='cuda:0')
action picked by argmax: tensor([270], device='cuda:0')
tensor([[270,  31, 203, 155, 119,  77, 186, 244, 126, 135]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
262         1      271       4       263
532         2      271       3       260
735         3      271       4       190
958         4      271       5       140
1147        5      271       4        56
       user_id  item_id  rating  timestep
12379       46      271       4        95
12758       47      271       3       201
13055       48      271       4       225
13305       49      271       4       202
13429       50      271       4        53
average_rating for this rec across 50 users from same group (less noisy) was: 4.2
all_actions shape just before sample torch.Size([1, 21, 1])
action scaled by temperature: tensor([[203]], device='cuda:0')
action picked by argmax: tensor([203], device='cuda:0')
tensor([[203,  32, 270,  31,  35, 204, 135, 148,  77, 155]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
63          1      204       3        64
400         2      204       3       128
755         3      204       3       210
1045        4      204       4       227
1220        5      204       3       129
       user_id  item_id  rating  timestep
12398       46      204       4       114
12571       47      204       5        14
12977       48      204       3       147
13282       49      204       4       179
13547       50      204       4       171
average_rating for this rec across 50 users from same group (less noisy) was: 3.52
all_actions shape just before sample torch.Size([1, 22, 1])
action scaled by temperature: tensor([[32]], device='cuda:0')
action picked by argmax: tensor([32], device='cuda:0')
tensor([[ 32, 234, 135,  64, 178, 256, 204, 255,  42,  60]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
117         1       33       3       118
463         2       33       2       191
738         3       33       2       193
837         4       33       5        19
1267        5       33       3       176
       user_id  item_id  rating  timestep
12454       46       33       4       170
12590       47       33       4        33
12848       48       33       4        18
13360       49       33       4       257
13418       50       33       5        42
average_rating for this rec across 50 users from same group (less noisy) was: 3.6
all_actions shape just before sample torch.Size([1, 23, 1])
action scaled by temperature: tensor([[234]], device='cuda:0')
action picked by argmax: tensor([234], device='cuda:0')
tensor([[234,  32, 123, 135,  64, 204,  51, 268,  10,  42]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
233         1      235       3       234
468         2      235       4       196
662         3      235       4       117
927         4      235       3       109
1185        5      235       4        94
       user_id  item_id  rating  timestep
12305       46      235       3        21
12679       47      235       2       122
12895       48      235       4        65
13238       49      235       5       135
13642       50      235       5       266
average_rating for this rec across 50 users from same group (less noisy) was: 3.78
all_actions shape just before sample torch.Size([1, 24, 1])
action scaled by temperature: tensor([[272]], device='cuda:0')
action picked by argmax: tensor([272], device='cuda:0')
tensor([[272, 269, 196,  93, 240, 194,  28, 135,  97,  83]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
232         1      273       5       233
334         2      273       5        62
694         3      273       4       149
994         4      273       5       176
1131        5      273       5        40
       user_id  item_id  rating  timestep
12539       46      273       4       255
12788       47      273       5       231
12951       48      273       5       121
13264       49      273       5       161
13408       50      273       5        32
average_rating for this rec across 50 users from same group (less noisy) was: 4.5
all_actions shape just before sample torch.Size([1, 25, 1])
action scaled by temperature: tensor([[269]], device='cuda:0')
action picked by argmax: tensor([269], device='cuda:0')
tensor([[269, 272, 196, 194,  30,  83, 240, 146,  97, 155]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
164         1      270       5       165
417         2      270       4       145
772         3      270       5       227
863         4      270       5        45
1211        5      270       5       120
       user_id  item_id  rating  timestep
12341       46      270       4        57
12626       47      270       4        69
12885       48      270       3        55
13182       49      270       4        79
13453       50      270       4        77
average_rating for this rec across 50 users from same group (less noisy) was: 4.28
all_actions shape just before sample torch.Size([1, 26, 1])
action scaled by temperature: tensor([[196]], device='cuda:0')
action picked by argmax: tensor([196], device='cuda:0')
tensor([[196, 128, 272, 203, 266, 117, 121, 146, 135,  66]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
98          1      197       3        99
369         2      197       4        97
729         3      197       3       184
867         4      197       5        49
1109        5      197       4        18
       user_id  item_id  rating  timestep
12311       46      197       2        27
12645       47      197       4        88
13014       48      197       3       184
13119       49      197       1        16
13636       50      197       3       260
average_rating for this rec across 50 users from same group (less noisy) was: 3.28
all_actions shape just before sample torch.Size([1, 27, 1])
action scaled by temperature: tensor([[128]], device='cuda:0')
action picked by argmax: tensor([128], device='cuda:0')
tensor([[128, 266, 196, 203, 117, 121,   9,  64, 176, 225]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
34          1      129       5        35
497         2      129       4       225
716         3      129       5       171
873         4      129       5        55
1317        5      129       5       226
       user_id  item_id  rating  timestep
12468       46      129       4       184
12708       47      129       5       151
12857       48      129       4        27
13141       49      129       5        38
13498       50      129       5       122
average_rating for this rec across 50 users from same group (less noisy) was: 4.3
all_actions shape just before sample torch.Size([1, 28, 1])
action scaled by temperature: tensor([[266]], device='cuda:0')
action picked by argmax: tensor([266], device='cuda:0')
tensor([[266,   9, 117,  60, 128,  66, 194, 130, 231, 196]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
71          1      267       5        72
328         2      267       5        56
672         3      267       5       127
1022        4      267       5       204
1335        5      267       5       244
       user_id  item_id  rating  timestep
12387       46      267       5       103
12633       47      267       4        76
13003       48      267       5       173
13204       49      267       5       101
13626       50      267       5       250
average_rating for this rec across 50 users from same group (less noisy) was: 4.78
all_actions shape just before sample torch.Size([1, 29, 1])
action scaled by temperature: tensor([[9]], device='cuda:0')
action picked by argmax: tensor([9], device='cuda:0')
tensor([[  9,  60, 117, 233, 196, 203,  72,  13, 255,  61]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
256         1       10       5       257
308         2       10       5        36
626         3       10       4        81
1055        4       10       4       237
1193        5       10       5       102
       user_id  item_id  rating  timestep
12521       46       10       5       237
12698       47       10       5       141
12982       48       10       4       152
13245       49       10       5       142
13461       50       10       4        85
average_rating for this rec across 50 users from same group (less noisy) was: 4.56
all_actions shape just before sample torch.Size([1, 30, 1])
action scaled by temperature: tensor([[233]], device='cuda:0')
action picked by argmax: tensor([117], device='cuda:0')
tensor([[117, 233,  60, 255, 266, 203, 196,   8,  72,   9]], device='cuda:0')
Just recommended 30 new items to 50 users from group 1 and the total rating was 122.53999999999999
train_loss is: 1.4131882729595655
action scaled by temperature: tensor([[106]], device='cuda:0')
action picked by argmax: tensor([227], device='cuda:0')
tensor([[227,  52, 167,  95, 109, 159, 168, 158, 151, 187]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
205         1      228       4       206
490         2      228       3       218
663         3      228       3       118
1070        4      228       2       252
1271        5      228       3       180
       user_id  item_id  rating  timestep
12329       46      228       4        45
12703       47      228       3       146
12879       48      228       5        49
13111       49      228       2         8
13530       50      228       4       154
average_rating for this rec across 50 users from same group (less noisy) was: 3.34
all_actions shape just before sample torch.Size([1, 1, 1])
action scaled by temperature: tensor([[107]], device='cuda:0')
action picked by argmax: tensor([254], device='cuda:0')
tensor([[254, 171, 162, 107,  50, 205,  31,  64, 223,  29]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
153         1      255       5       154
544         2      255       5       272
618         3      255       4        73
989         4      255       5       171
1214        5      255       4       123
       user_id  item_id  rating  timestep
12365       46      255       5        81
12724       47      255       4       167
12933       48      255       4       103
13227       49      255       3       124
13601       50      255       3       225
average_rating for this rec across 50 users from same group (less noisy) was: 4.5
all_actions shape just before sample torch.Size([1, 2, 1])
action scaled by temperature: tensor([[181]], device='cuda:0')
action picked by argmax: tensor([102], device='cuda:0')
tensor([[102, 170,  29, 153, 107,  75, 251, 243, 204,  79]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
248         1      103       5       249
398         2      103       4       126
585         3      103       5        40
1009        4      103       5       191
1127        5      103       5        36
       user_id  item_id  rating  timestep
12388       46      103       5       104
12771       47      103       5       214
12958       48      103       5       128
13158       49      103       5        55
13411       50      103       4        35
average_rating for this rec across 50 users from same group (less noisy) was: 4.64
all_actions shape just before sample torch.Size([1, 3, 1])
action scaled by temperature: tensor([[171]], device='cuda:0')
action picked by argmax: tensor([171], device='cuda:0')
tensor([[171,  11,  84,  59,  24, 175,  65,  88, 190, 134]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
6           1      172       4         7
376         2      172       4       104
568         3      172       3        23
964         4      172       4       146
1252        5      172       4       161
       user_id  item_id  rating  timestep
12301       46      172       3        17
12572       47      172       4        15
13077       48      172       4       247
13163       49      172       4        60
13546       50      172       3       170
average_rating for this rec across 50 users from same group (less noisy) was: 4.08
all_actions shape just before sample torch.Size([1, 4, 1])
action scaled by temperature: tensor([[105]], device='cuda:0')
action picked by argmax: tensor([105], device='cuda:0')
tensor([[105, 237,   1, 221, 177, 246,  62, 144,  47,  10]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
151         1      106       4       152
453         2      106       4       181
605         3      106       5        60
1071        4      106       2       253
1228        5      106       3       137
       user_id  item_id  rating  timestep
12389       46      106       4       105
12808       47      106       4       251
12996       48      106       4       166
13279       49      106       4       176
13559       50      106       5       183
average_rating for this rec across 50 users from same group (less noisy) was: 4.14
all_actions shape just before sample torch.Size([1, 5, 1])
action scaled by temperature: tensor([[237]], device='cuda:0')
action picked by argmax: tensor([237], device='cuda:0')
tensor([[237, 105, 175, 221, 109,  24, 171,  89,  62, 195]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
228         1      238       4       229
475         2      238       3       203
719         3      238       3       174
860         4      238       5        42
1166        5      238       5        75
       user_id  item_id  rating  timestep
12462       46      238       3       178
12618       47      238       4        61
13000       48      238       5       170
13192       49      238       3        89
13431       50      238       5        55
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 6, 1])
action scaled by temperature: tensor([[109]], device='cuda:0')
action picked by argmax: tensor([237], device='cuda:0')
tensor([[237, 109, 221,  89, 175, 105, 195, 217, 203, 177]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
228         1      238       4       229
475         2      238       3       203
719         3      238       3       174
860         4      238       5        42
1166        5      238       5        75
       user_id  item_id  rating  timestep
12462       46      238       3       178
12618       47      238       4        61
13000       48      238       5       170
13192       49      238       3        89
13431       50      238       5        55
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 7, 1])
action scaled by temperature: tensor([[109]], device='cuda:0')
action picked by argmax: tensor([109], device='cuda:0')
tensor([[109,  31, 236, 237, 194, 142, 175, 221,  29, 217]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
132         1      110       4       133
472         2      110       5       200
687         3      110       5       142
910         4      110       5        92
1217        5      110       4       126
       user_id  item_id  rating  timestep
12408       46      110       5       124
12729       47      110       5       172
12956       48      110       5       126
13369       49      110       5       266
13458       50      110       5        82
average_rating for this rec across 50 users from same group (less noisy) was: 4.66
all_actions shape just before sample torch.Size([1, 8, 1])
action scaled by temperature: tensor([[94]], device='cuda:0')
action picked by argmax: tensor([94], device='cuda:0')
tensor([[ 94, 236, 142,  25, 141, 120, 108, 218, 208,  97]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
162         1       95       3       163
474         2       95       5       202
762         3       95       5       217
978         4       95       4       160
1355        5       95       3       264
       user_id  item_id  rating  timestep
12350       46       95       3        66
12800       47       95       4       243
12918       48       95       4        88
13240       49       95       4       137
13581       50       95       5       205
average_rating for this rec across 50 users from same group (less noisy) was: 3.76
all_actions shape just before sample torch.Size([1, 9, 1])
action scaled by temperature: tensor([[81]], device='cuda:0')
action picked by argmax: tensor([81], device='cuda:0')
tensor([[ 81, 225, 207, 194, 189, 208,   0,  90, 155, 267]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
68          1       82       5        69
540         2       82       5       268
688         3       82       4       143
963         4       82       5       145
1140        5       82       4        49
       user_id  item_id  rating  timestep
12345       46       82       4        61
12570       47       82       4        13
12926       48       82       5        96
13162       49       82       4        59
13379       50       82       4         3
average_rating for this rec across 50 users from same group (less noisy) was: 4.44
all_actions shape just before sample torch.Size([1, 10, 1])
action scaled by temperature: tensor([[139]], device='cuda:0')
action picked by argmax: tensor([139], device='cuda:0')
tensor([[139, 268, 127, 232,  45,  56, 128, 264, 250,  23]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
175         1      140       4       176
290         2      140       4        18
659         3      140       3       114
1005        4      140       4       187
1179        5      140       5        88
       user_id  item_id  rating  timestep
12482       46      140       3       198
12778       47      140       4       221
13043       48      140       5       213
13285       49      140       4       182
13604       50      140       5       228
average_rating for this rec across 50 users from same group (less noisy) was: 4.16
all_actions shape just before sample torch.Size([1, 11, 1])
action scaled by temperature: tensor([[268]], device='cuda:0')
action picked by argmax: tensor([268], device='cuda:0')
tensor([[268, 127, 139, 106, 128, 166,  58, 169,  56,  45]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
146         1      269       5       147
338         2      269       4        66
695         3      269       5       150
1049        4      269       5       231
1295        5      269       4       204
       user_id  item_id  rating  timestep
12474       46      269       4       190
12685       47      269       5       128
13091       48      269       4       261
13338       49      269       4       235
13558       50      269       5       182
average_rating for this rec across 50 users from same group (less noisy) was: 4.12
all_actions shape just before sample torch.Size([1, 12, 1])
action scaled by temperature: tensor([[127]], device='cuda:0')
action picked by argmax: tensor([127], device='cuda:0')
tensor([[127, 268, 106,  13, 139,  51,  98,  23,  45, 169]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
261         1      128       4       262
297         2      128       5        25
682         3      128       4       137
869         4      128       3        51
1358        5      128       4       267
       user_id  item_id  rating  timestep
12541       46      128       4       257
12674       47      128       3       117
12840       48      128       4        10
13344       49      128       5       241
13619       50      128       4       243
average_rating for this rec across 50 users from same group (less noisy) was: 4.08
all_actions shape just before sample torch.Size([1, 13, 1])
action scaled by temperature: tensor([[106]], device='cuda:0')
action picked by argmax: tensor([106], device='cuda:0')
tensor([[106, 110, 127,  51, 183, 268, 155, 253,  42,  70]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
173         1      107       4       174
382         2      107       4       110
769         3      107       4       224
995         4      107       5       177
1261        5      107       4       170
       user_id  item_id  rating  timestep
12344       46      107       3        60
12657       47      107       4       100
12939       48      107       5       109
13284       49      107       3       181
13531       50      107       4       155
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 14, 1])
action scaled by temperature: tensor([[51]], device='cuda:0')
action picked by argmax: tensor([51], device='cuda:0')
tensor([[ 51,  70, 169, 111,  10, 159, 110,  42, 101, 180]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
206         1       52       4       207
379         2       52       4       107
570         3       52       5        25
844         4       52       4        26
1208        5       52       4       117
       user_id  item_id  rating  timestep
12557       46       52       4       273
12712       47       52       5       155
12944       48       52       4       114
13107       49       52       4         4
13387       50       52       4        11
average_rating for this rec across 50 users from same group (less noisy) was: 4.18
all_actions shape just before sample torch.Size([1, 15, 1])
action scaled by temperature: tensor([[70]], device='cuda:0')
action picked by argmax: tensor([70], device='cuda:0')
tensor([[ 70,  51, 269, 101,  10, 110,  49,  45, 253, 240]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
79          1       71       4        80
435         2       71       4       163
621         3       71       4        76
954         4       71       5       136
1223        5       71       4       132
       user_id  item_id  rating  timestep
12485       46       71       3       201
12744       47       71       4       187
12832       48       71       4         2
13187       49       71       4        84
13540       50       71       5       164
average_rating for this rec across 50 users from same group (less noisy) was: 4.04
all_actions shape just before sample torch.Size([1, 16, 1])
action scaled by temperature: tensor([[193]], device='cuda:0')
action picked by argmax: tensor([193], device='cuda:0')
tensor([[193,  88, 137, 265, 119,  48, 208,   3, 180,  35]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
15          1      194       3        16
423         2      194       5       151
569         3      194       2        24
971         4      194       3       153
1099        5      194       5         8
       user_id  item_id  rating  timestep
12512       46      194       4       228
12663       47      194       3       106
13083       48      194       3       253
13117       49      194       3        14
13489       50      194       2       113
average_rating for this rec across 50 users from same group (less noisy) was: 3.58
all_actions shape just before sample torch.Size([1, 17, 1])
action scaled by temperature: tensor([[88]], device='cuda:0')
action picked by argmax: tensor([88], device='cuda:0')
tensor([[ 88, 193, 266, 137,   3, 119, 265, 109, 180,  35]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
163         1       89       5       164
411         2       89       3       139
725         3       89       3       180
848         4       89       3        30
1215        5       89       3       124
       user_id  item_id  rating  timestep
12396       46       89       3       112
12581       47       89       4        24
12979       48       89       3       149
13286       49       89       2       183
13503       50       89       3       127
average_rating for this rec across 50 users from same group (less noisy) was: 3.38
all_actions shape just before sample torch.Size([1, 18, 1])
action scaled by temperature: tensor([[137]], device='cuda:0')
action picked by argmax: tensor([137], device='cuda:0')
tensor([[137, 193,  88,   3, 178, 265, 266,  27,  31,  35]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
197         1      138       4       198
542         2      138       4       270
636         3      138       5        91
926         4      138       4       108
1195        5      138       5       104
       user_id  item_id  rating  timestep
12538       46      138       4       254
12596       47      138       4        39
13053       48      138       4       223
13354       49      138       5       251
13519       50      138       5       143
average_rating for this rec across 50 users from same group (less noisy) was: 4.36
all_actions shape just before sample torch.Size([1, 19, 1])
action scaled by temperature: tensor([[31]], device='cuda:0')
action picked by argmax: tensor([31], device='cuda:0')
tensor([[ 31, 203, 270,  38, 178,  96, 155, 266, 244,  81]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
207         1       32       4       208
505         2       32       4       233
813         3       32       5       268
833         4       32       5        15
1309        5       32       4       218
       user_id  item_id  rating  timestep
12338       46       32       3        54
12783       47       32       3       226
12917       48       32       5        87
13318       49       32       4       215
13390       50       32       3        14
average_rating for this rec across 50 users from same group (less noisy) was: 4.1
all_actions shape just before sample torch.Size([1, 20, 1])
action scaled by temperature: tensor([[270]], device='cuda:0')
action picked by argmax: tensor([270], device='cuda:0')
tensor([[270,  31, 203, 155,  77, 235, 119,  91, 244, 178]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
262         1      271       4       263
532         2      271       3       260
735         3      271       4       190
958         4      271       5       140
1147        5      271       4        56
       user_id  item_id  rating  timestep
12379       46      271       4        95
12758       47      271       3       201
13055       48      271       4       225
13305       49      271       4       202
13429       50      271       4        53
average_rating for this rec across 50 users from same group (less noisy) was: 4.2
all_actions shape just before sample torch.Size([1, 21, 1])
action scaled by temperature: tensor([[203]], device='cuda:0')
action picked by argmax: tensor([203], device='cuda:0')
tensor([[203,  32,  31, 270, 204, 135, 148, 266,  77, 155]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
63          1      204       3        64
400         2      204       3       128
755         3      204       3       210
1045        4      204       4       227
1220        5      204       3       129
       user_id  item_id  rating  timestep
12398       46      204       4       114
12571       47      204       5        14
12977       48      204       3       147
13282       49      204       4       179
13547       50      204       4       171
average_rating for this rec across 50 users from same group (less noisy) was: 3.52
all_actions shape just before sample torch.Size([1, 22, 1])
action scaled by temperature: tensor([[32]], device='cuda:0')
action picked by argmax: tensor([32], device='cuda:0')
tensor([[ 32, 234,  64, 135, 178, 204, 255,  42, 256, 257]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
117         1       33       3       118
463         2       33       2       191
738         3       33       2       193
837         4       33       5        19
1267        5       33       3       176
       user_id  item_id  rating  timestep
12454       46       33       4       170
12590       47       33       4        33
12848       48       33       4        18
13360       49       33       4       257
13418       50       33       5        42
average_rating for this rec across 50 users from same group (less noisy) was: 3.6
all_actions shape just before sample torch.Size([1, 23, 1])
action scaled by temperature: tensor([[234]], device='cuda:0')
action picked by argmax: tensor([234], device='cuda:0')
tensor([[234,  32, 123,  64, 135,  99, 268,  42,  51, 204]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
233         1      235       3       234
468         2      235       4       196
662         3      235       4       117
927         4      235       3       109
1185        5      235       4        94
       user_id  item_id  rating  timestep
12305       46      235       3        21
12679       47      235       2       122
12895       48      235       4        65
13238       49      235       5       135
13642       50      235       5       266
average_rating for this rec across 50 users from same group (less noisy) was: 3.78
all_actions shape just before sample torch.Size([1, 24, 1])
action scaled by temperature: tensor([[272]], device='cuda:0')
action picked by argmax: tensor([272], device='cuda:0')
tensor([[272, 269, 196,  28,  93, 194, 240, 135, 257,  50]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
232         1      273       5       233
334         2      273       5        62
694         3      273       4       149
994         4      273       5       176
1131        5      273       5        40
       user_id  item_id  rating  timestep
12539       46      273       4       255
12788       47      273       5       231
12951       48      273       5       121
13264       49      273       5       161
13408       50      273       5        32
average_rating for this rec across 50 users from same group (less noisy) was: 4.5
all_actions shape just before sample torch.Size([1, 25, 1])
action scaled by temperature: tensor([[269]], device='cuda:0')
action picked by argmax: tensor([269], device='cuda:0')
tensor([[269, 272, 196, 194,  83,  72, 240, 146,  30, 128]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
164         1      270       5       165
417         2      270       4       145
772         3      270       5       227
863         4      270       5        45
1211        5      270       5       120
       user_id  item_id  rating  timestep
12341       46      270       4        57
12626       47      270       4        69
12885       48      270       3        55
13182       49      270       4        79
13453       50      270       4        77
average_rating for this rec across 50 users from same group (less noisy) was: 4.28
all_actions shape just before sample torch.Size([1, 26, 1])
action scaled by temperature: tensor([[196]], device='cuda:0')
action picked by argmax: tensor([196], device='cuda:0')
tensor([[196, 128, 272, 203, 121, 266, 269, 223, 135, 117]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
98          1      197       3        99
369         2      197       4        97
729         3      197       3       184
867         4      197       5        49
1109        5      197       4        18
       user_id  item_id  rating  timestep
12311       46      197       2        27
12645       47      197       4        88
13014       48      197       3       184
13119       49      197       1        16
13636       50      197       3       260
average_rating for this rec across 50 users from same group (less noisy) was: 3.28
all_actions shape just before sample torch.Size([1, 27, 1])
action scaled by temperature: tensor([[128]], device='cuda:0')
action picked by argmax: tensor([128], device='cuda:0')
tensor([[128, 196, 266,   9, 203, 121, 117,  64, 225, 233]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
34          1      129       5        35
497         2      129       4       225
716         3      129       5       171
873         4      129       5        55
1317        5      129       5       226
       user_id  item_id  rating  timestep
12468       46      129       4       184
12708       47      129       5       151
12857       48      129       4        27
13141       49      129       5        38
13498       50      129       5       122
average_rating for this rec across 50 users from same group (less noisy) was: 4.3
all_actions shape just before sample torch.Size([1, 28, 1])
action scaled by temperature: tensor([[266]], device='cuda:0')
action picked by argmax: tensor([266], device='cuda:0')
tensor([[266,   9, 117, 130, 128,  66, 194,  60, 196, 261]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
71          1      267       5        72
328         2      267       5        56
672         3      267       5       127
1022        4      267       5       204
1335        5      267       5       244
       user_id  item_id  rating  timestep
12387       46      267       5       103
12633       47      267       4        76
13003       48      267       5       173
13204       49      267       5       101
13626       50      267       5       250
average_rating for this rec across 50 users from same group (less noisy) was: 4.78
all_actions shape just before sample torch.Size([1, 29, 1])
action scaled by temperature: tensor([[9]], device='cuda:0')
action picked by argmax: tensor([9], device='cuda:0')
tensor([[  9,  60, 196, 117, 233,  13, 203,  22, 255,  72]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
256         1       10       5       257
308         2       10       5        36
626         3       10       4        81
1055        4       10       4       237
1193        5       10       5       102
       user_id  item_id  rating  timestep
12521       46       10       5       237
12698       47       10       5       141
12982       48       10       4       152
13245       49       10       5       142
13461       50       10       4        85
average_rating for this rec across 50 users from same group (less noisy) was: 4.56
all_actions shape just before sample torch.Size([1, 30, 1])
action scaled by temperature: tensor([[117]], device='cuda:0')
action picked by argmax: tensor([117], device='cuda:0')
tensor([[117, 233,  60, 255, 196,   9, 179, 162,   8, 266]], device='cuda:0')
Just recommended 30 new items to 50 users from group 1 and the total rating was 122.53999999999999
train_loss is: 1.3546812365588532
action scaled by temperature: tensor([[61]], device='cuda:0')
action picked by argmax: tensor([227], device='cuda:0')
tensor([[227,  52, 117,  95, 109, 247, 187, 167,  13,  40]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
205         1      228       4       206
490         2      228       3       218
663         3      228       3       118
1070        4      228       2       252
1271        5      228       3       180
       user_id  item_id  rating  timestep
12329       46      228       4        45
12703       47      228       3       146
12879       48      228       5        49
13111       49      228       2         8
13530       50      228       4       154
average_rating for this rec across 50 users from same group (less noisy) was: 3.34
all_actions shape just before sample torch.Size([1, 1, 1])
action scaled by temperature: tensor([[231]], device='cuda:0')
action picked by argmax: tensor([254], device='cuda:0')
tensor([[254, 171, 107, 162, 205,  29, 100,  50, 137,  18]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
153         1      255       5       154
544         2      255       5       272
618         3      255       4        73
989         4      255       5       171
1214        5      255       4       123
       user_id  item_id  rating  timestep
12365       46      255       5        81
12724       47      255       4       167
12933       48      255       4       103
13227       49      255       3       124
13601       50      255       3       225
average_rating for this rec across 50 users from same group (less noisy) was: 4.5
all_actions shape just before sample torch.Size([1, 2, 1])
action scaled by temperature: tensor([[190]], device='cuda:0')
action picked by argmax: tensor([102], device='cuda:0')
tensor([[102, 170,  29, 107, 153, 137,  75, 243,  32, 262]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
248         1      103       5       249
398         2      103       4       126
585         3      103       5        40
1009        4      103       5       191
1127        5      103       5        36
       user_id  item_id  rating  timestep
12388       46      103       5       104
12771       47      103       5       214
12958       48      103       5       128
13158       49      103       5        55
13411       50      103       4        35
average_rating for this rec across 50 users from same group (less noisy) was: 4.64
all_actions shape just before sample torch.Size([1, 3, 1])
action scaled by temperature: tensor([[11]], device='cuda:0')
action picked by argmax: tensor([171], device='cuda:0')
tensor([[171,  11,  84,  24,  59, 100, 190,  65, 192,  98]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
6           1      172       4         7
376         2      172       4       104
568         3      172       3        23
964         4      172       4       146
1252        5      172       4       161
       user_id  item_id  rating  timestep
12301       46      172       3        17
12572       47      172       4        15
13077       48      172       4       247
13163       49      172       4        60
13546       50      172       3       170
average_rating for this rec across 50 users from same group (less noisy) was: 4.08
all_actions shape just before sample torch.Size([1, 4, 1])
action scaled by temperature: tensor([[105]], device='cuda:0')
action picked by argmax: tensor([105], device='cuda:0')
tensor([[105, 237,   1, 221, 246, 144, 109,  10, 177,  62]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
151         1      106       4       152
453         2      106       4       181
605         3      106       5        60
1071        4      106       2       253
1228        5      106       3       137
       user_id  item_id  rating  timestep
12389       46      106       4       105
12808       47      106       4       251
12996       48      106       4       166
13279       49      106       4       176
13559       50      106       5       183
average_rating for this rec across 50 users from same group (less noisy) was: 4.14
all_actions shape just before sample torch.Size([1, 5, 1])
action scaled by temperature: tensor([[237]], device='cuda:0')
action picked by argmax: tensor([237], device='cuda:0')
tensor([[237, 109, 105, 175,  24, 195, 221, 217,  89,  62]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
228         1      238       4       229
475         2      238       3       203
719         3      238       3       174
860         4      238       5        42
1166        5      238       5        75
       user_id  item_id  rating  timestep
12462       46      238       3       178
12618       47      238       4        61
13000       48      238       5       170
13192       49      238       3        89
13431       50      238       5        55
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 6, 1])
action scaled by temperature: tensor([[109]], device='cuda:0')
action picked by argmax: tensor([109], device='cuda:0')
tensor([[109, 237, 217, 175, 105, 110,  89, 190, 142, 236]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
132         1      110       4       133
472         2      110       5       200
687         3      110       5       142
910         4      110       5        92
1217        5      110       4       126
       user_id  item_id  rating  timestep
12408       46      110       5       124
12729       47      110       5       172
12956       48      110       5       126
13369       49      110       5       266
13458       50      110       5        82
average_rating for this rec across 50 users from same group (less noisy) was: 4.66
all_actions shape just before sample torch.Size([1, 7, 1])
action scaled by temperature: tensor([[94]], device='cuda:0')
action picked by argmax: tensor([94], device='cuda:0')
tensor([[ 94, 236, 142,  97, 141, 109,  25,  16, 172, 116]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
162         1       95       3       163
474         2       95       5       202
762         3       95       5       217
978         4       95       4       160
1355        5       95       3       264
       user_id  item_id  rating  timestep
12350       46       95       3        66
12800       47       95       4       243
12918       48       95       4        88
13240       49       95       4       137
13581       50       95       5       205
average_rating for this rec across 50 users from same group (less noisy) was: 3.76
all_actions shape just before sample torch.Size([1, 8, 1])
action scaled by temperature: tensor([[81]], device='cuda:0')
action picked by argmax: tensor([81], device='cuda:0')
tensor([[ 81, 207, 208, 225, 189,  25,  26, 267,  76, 194]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
68          1       82       5        69
540         2       82       5       268
688         3       82       4       143
963         4       82       5       145
1140        5       82       4        49
       user_id  item_id  rating  timestep
12345       46       82       4        61
12570       47       82       4        13
12926       48       82       5        96
13162       49       82       4        59
13379       50       82       4         3
average_rating for this rec across 50 users from same group (less noisy) was: 4.44
all_actions shape just before sample torch.Size([1, 9, 1])
action scaled by temperature: tensor([[139]], device='cuda:0')
action picked by argmax: tensor([139], device='cuda:0')
tensor([[139, 268, 127, 232,  45,  23, 250, 147,  56, 128]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
175         1      140       4       176
290         2      140       4        18
659         3      140       3       114
1005        4      140       4       187
1179        5      140       5        88
       user_id  item_id  rating  timestep
12482       46      140       3       198
12778       47      140       4       221
13043       48      140       5       213
13285       49      140       4       182
13604       50      140       5       228
average_rating for this rec across 50 users from same group (less noisy) was: 4.16
all_actions shape just before sample torch.Size([1, 10, 1])
action scaled by temperature: tensor([[268]], device='cuda:0')
action picked by argmax: tensor([268], device='cuda:0')
tensor([[268, 127, 139,  45, 106, 128,  58, 166, 169, 228]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
146         1      269       5       147
338         2      269       4        66
695         3      269       5       150
1049        4      269       5       231
1295        5      269       4       204
       user_id  item_id  rating  timestep
12474       46      269       4       190
12685       47      269       5       128
13091       48      269       4       261
13338       49      269       4       235
13558       50      269       5       182
average_rating for this rec across 50 users from same group (less noisy) was: 4.12
all_actions shape just before sample torch.Size([1, 11, 1])
action scaled by temperature: tensor([[127]], device='cuda:0')
action picked by argmax: tensor([127], device='cuda:0')
tensor([[127, 268, 106, 139,  45,  23,  98, 111,  51, 169]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
261         1      128       4       262
297         2      128       5        25
682         3      128       4       137
869         4      128       3        51
1358        5      128       4       267
       user_id  item_id  rating  timestep
12541       46      128       4       257
12674       47      128       3       117
12840       48      128       4        10
13344       49      128       5       241
13619       50      128       4       243
average_rating for this rec across 50 users from same group (less noisy) was: 4.08
all_actions shape just before sample torch.Size([1, 12, 1])
action scaled by temperature: tensor([[106]], device='cuda:0')
action picked by argmax: tensor([106], device='cuda:0')
tensor([[106, 127, 183, 268, 110,  51, 245,  95, 111, 155]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
173         1      107       4       174
382         2      107       4       110
769         3      107       4       224
995         4      107       5       177
1261        5      107       4       170
       user_id  item_id  rating  timestep
12344       46      107       3        60
12657       47      107       4       100
12939       48      107       5       109
13284       49      107       3       181
13531       50      107       4       155
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 13, 1])
action scaled by temperature: tensor([[51]], device='cuda:0')
action picked by argmax: tensor([51], device='cuda:0')
tensor([[ 51,  70, 169, 127, 159,  55, 204, 111, 268, 110]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
206         1       52       4       207
379         2       52       4       107
570         3       52       5        25
844         4       52       4        26
1208        5       52       4       117
       user_id  item_id  rating  timestep
12557       46       52       4       273
12712       47       52       5       155
12944       48       52       4       114
13107       49       52       4         4
13387       50       52       4        11
average_rating for this rec across 50 users from same group (less noisy) was: 4.18
all_actions shape just before sample torch.Size([1, 14, 1])
action scaled by temperature: tensor([[70]], device='cuda:0')
action picked by argmax: tensor([70], device='cuda:0')
tensor([[ 70,  51, 101, 269,  45, 110,  10, 253, 106,   6]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
79          1       71       4        80
435         2       71       4       163
621         3       71       4        76
954         4       71       5       136
1223        5       71       4       132
       user_id  item_id  rating  timestep
12485       46       71       3       201
12744       47       71       4       187
12832       48       71       4         2
13187       49       71       4        84
13540       50       71       5       164
average_rating for this rec across 50 users from same group (less noisy) was: 4.04
all_actions shape just before sample torch.Size([1, 15, 1])
action scaled by temperature: tensor([[88]], device='cuda:0')
action picked by argmax: tensor([193], device='cuda:0')
tensor([[193,  88, 137,   3, 119, 265, 204,  35,  52, 180]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
15          1      194       3        16
423         2      194       5       151
569         3      194       2        24
971         4      194       3       153
1099        5      194       5         8
       user_id  item_id  rating  timestep
12512       46      194       4       228
12663       47      194       3       106
13083       48      194       3       253
13117       49      194       3        14
13489       50      194       2       113
average_rating for this rec across 50 users from same group (less noisy) was: 3.58
all_actions shape just before sample torch.Size([1, 16, 1])
action scaled by temperature: tensor([[88]], device='cuda:0')
action picked by argmax: tensor([88], device='cuda:0')
tensor([[ 88, 193, 137,   3, 266, 119, 109, 265, 204, 180]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
163         1       89       5       164
411         2       89       3       139
725         3       89       3       180
848         4       89       3        30
1215        5       89       3       124
       user_id  item_id  rating  timestep
12396       46       89       3       112
12581       47       89       4        24
12979       48       89       3       149
13286       49       89       2       183
13503       50       89       3       127
average_rating for this rec across 50 users from same group (less noisy) was: 3.38
all_actions shape just before sample torch.Size([1, 17, 1])
action scaled by temperature: tensor([[137]], device='cuda:0')
action picked by argmax: tensor([137], device='cuda:0')
tensor([[137,   3, 193, 178,  88,  31, 203, 202, 264,  27]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
197         1      138       4       198
542         2      138       4       270
636         3      138       5        91
926         4      138       4       108
1195        5      138       5       104
       user_id  item_id  rating  timestep
12538       46      138       4       254
12596       47      138       4        39
13053       48      138       4       223
13354       49      138       5       251
13519       50      138       5       143
average_rating for this rec across 50 users from same group (less noisy) was: 4.36
all_actions shape just before sample torch.Size([1, 18, 1])
action scaled by temperature: tensor([[31]], device='cuda:0')
action picked by argmax: tensor([31], device='cuda:0')
tensor([[ 31, 203,  38, 270,  81,  96, 178, 204,  27, 132]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
207         1       32       4       208
505         2       32       4       233
813         3       32       5       268
833         4       32       5        15
1309        5       32       4       218
       user_id  item_id  rating  timestep
12338       46       32       3        54
12783       47       32       3       226
12917       48       32       5        87
13318       49       32       4       215
13390       50       32       3        14
average_rating for this rec across 50 users from same group (less noisy) was: 4.1
all_actions shape just before sample torch.Size([1, 19, 1])
action scaled by temperature: tensor([[270]], device='cuda:0')
action picked by argmax: tensor([270], device='cuda:0')
tensor([[270,  31, 203,  77, 126, 155, 119,  81, 244,  91]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
262         1      271       4       263
532         2      271       3       260
735         3      271       4       190
958         4      271       5       140
1147        5      271       4        56
       user_id  item_id  rating  timestep
12379       46      271       4        95
12758       47      271       3       201
13055       48      271       4       225
13305       49      271       4       202
13429       50      271       4        53
average_rating for this rec across 50 users from same group (less noisy) was: 4.2
all_actions shape just before sample torch.Size([1, 20, 1])
action scaled by temperature: tensor([[203]], device='cuda:0')
action picked by argmax: tensor([203], device='cuda:0')
tensor([[203,  32, 148, 204,  77, 137, 135, 223, 270, 266]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
63          1      204       3        64
400         2      204       3       128
755         3      204       3       210
1045        4      204       4       227
1220        5      204       3       129
       user_id  item_id  rating  timestep
12398       46      204       4       114
12571       47      204       5        14
12977       48      204       3       147
13282       49      204       4       179
13547       50      204       4       171
average_rating for this rec across 50 users from same group (less noisy) was: 3.52
all_actions shape just before sample torch.Size([1, 21, 1])
action scaled by temperature: tensor([[32]], device='cuda:0')
action picked by argmax: tensor([32], device='cuda:0')
tensor([[ 32, 234,  64, 135, 204, 255,  42, 137, 256, 185]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
117         1       33       3       118
463         2       33       2       191
738         3       33       2       193
837         4       33       5        19
1267        5       33       3       176
       user_id  item_id  rating  timestep
12454       46       33       4       170
12590       47       33       4        33
12848       48       33       4        18
13360       49       33       4       257
13418       50       33       5        42
average_rating for this rec across 50 users from same group (less noisy) was: 3.6
all_actions shape just before sample torch.Size([1, 22, 1])
action scaled by temperature: tensor([[234]], device='cuda:0')
action picked by argmax: tensor([234], device='cuda:0')
tensor([[234,  32, 123,  64,  99, 204, 135,  42, 223,  69]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
233         1      235       3       234
468         2      235       4       196
662         3      235       4       117
927         4      235       3       109
1185        5      235       4        94
       user_id  item_id  rating  timestep
12305       46      235       3        21
12679       47      235       2       122
12895       48      235       4        65
13238       49      235       5       135
13642       50      235       5       266
average_rating for this rec across 50 users from same group (less noisy) was: 3.78
all_actions shape just before sample torch.Size([1, 23, 1])
action scaled by temperature: tensor([[272]], device='cuda:0')
action picked by argmax: tensor([272], device='cuda:0')
tensor([[272, 269, 196, 240,  93,  28, 135, 194, 234,  97]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
232         1      273       5       233
334         2      273       5        62
694         3      273       4       149
994         4      273       5       176
1131        5      273       5        40
       user_id  item_id  rating  timestep
12539       46      273       4       255
12788       47      273       5       231
12951       48      273       5       121
13264       49      273       5       161
13408       50      273       5        32
average_rating for this rec across 50 users from same group (less noisy) was: 4.5
all_actions shape just before sample torch.Size([1, 24, 1])
action scaled by temperature: tensor([[269]], device='cuda:0')
action picked by argmax: tensor([269], device='cuda:0')
tensor([[269, 196, 272, 240,  97,   3,  30,  83, 234, 194]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
164         1      270       5       165
417         2      270       4       145
772         3      270       5       227
863         4      270       5        45
1211        5      270       5       120
       user_id  item_id  rating  timestep
12341       46      270       4        57
12626       47      270       4        69
12885       48      270       3        55
13182       49      270       4        79
13453       50      270       4        77
average_rating for this rec across 50 users from same group (less noisy) was: 4.28
all_actions shape just before sample torch.Size([1, 25, 1])
action scaled by temperature: tensor([[196]], device='cuda:0')
action picked by argmax: tensor([196], device='cuda:0')
tensor([[196, 128, 266, 203, 121, 223, 272, 135, 117, 174]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
98          1      197       3        99
369         2      197       4        97
729         3      197       3       184
867         4      197       5        49
1109        5      197       4        18
       user_id  item_id  rating  timestep
12311       46      197       2        27
12645       47      197       4        88
13014       48      197       3       184
13119       49      197       1        16
13636       50      197       3       260
average_rating for this rec across 50 users from same group (less noisy) was: 3.28
all_actions shape just before sample torch.Size([1, 26, 1])
action scaled by temperature: tensor([[128]], device='cuda:0')
action picked by argmax: tensor([128], device='cuda:0')
tensor([[128, 266, 196, 117, 121,   9, 203,  64,  71,  59]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
34          1      129       5        35
497         2      129       4       225
716         3      129       5       171
873         4      129       5        55
1317        5      129       5       226
       user_id  item_id  rating  timestep
12468       46      129       4       184
12708       47      129       5       151
12857       48      129       4        27
13141       49      129       5        38
13498       50      129       5       122
average_rating for this rec across 50 users from same group (less noisy) was: 4.3
all_actions shape just before sample torch.Size([1, 27, 1])
action scaled by temperature: tensor([[266]], device='cuda:0')
action picked by argmax: tensor([266], device='cuda:0')
tensor([[266,   9,  66, 194, 117, 130,  90,  42, 229, 261]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
71          1      267       5        72
328         2      267       5        56
672         3      267       5       127
1022        4      267       5       204
1335        5      267       5       244
       user_id  item_id  rating  timestep
12387       46      267       5       103
12633       47      267       4        76
13003       48      267       5       173
13204       49      267       5       101
13626       50      267       5       250
average_rating for this rec across 50 users from same group (less noisy) was: 4.78
all_actions shape just before sample torch.Size([1, 28, 1])
action scaled by temperature: tensor([[9]], device='cuda:0')
action picked by argmax: tensor([9], device='cuda:0')
tensor([[  9, 117,  60, 196, 266, 233,  13,  22,  66, 255]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
256         1       10       5       257
308         2       10       5        36
626         3       10       4        81
1055        4       10       4       237
1193        5       10       5       102
       user_id  item_id  rating  timestep
12521       46       10       5       237
12698       47       10       5       141
12982       48       10       4       152
13245       49       10       5       142
13461       50       10       4        85
average_rating for this rec across 50 users from same group (less noisy) was: 4.56
all_actions shape just before sample torch.Size([1, 29, 1])
action scaled by temperature: tensor([[117]], device='cuda:0')
action picked by argmax: tensor([117], device='cuda:0')
tensor([[117, 233,  60, 196, 179, 266, 255, 162,   9,   8]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
70          1      118       4        71
404         2      118       4       132
643         3      118       5        98
1000        4      118       5       182
1302        5      118       4       211
       user_id  item_id  rating  timestep
12489       46      118       4       205
12576       47      118       4        19
12923       48      118       4        93
13374       49      118       3       271
13566       50      118       4       190
average_rating for this rec across 50 users from same group (less noisy) was: 4.3
all_actions shape just before sample torch.Size([1, 30, 1])
action scaled by temperature: tensor([[233]], device='cuda:0')
action picked by argmax: tensor([233], device='cuda:0')
tensor([[233,  60, 117,   8, 162,  77, 201, 181,  20,  81]], device='cuda:0')
Just recommended 30 new items to 50 users from group 1 and the total rating was 122.77999999999999
train_loss is: 1.3347034481562436
action scaled by temperature: tensor([[156]], device='cuda:0')
action picked by argmax: tensor([14], device='cuda:0')
tensor([[ 14,  39,  35, 100, 227,  52, 109, 159, 225, 161]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
245         1       15       5       246
419         2       15       5       147
685         3       15       5       140
880         4       15       5        62
1234        5       15       3       143
       user_id  item_id  rating  timestep
12325       46       15       4        41
12584       47       15       5        27
13102       48       15       2       272
13313       49       15       5       210
13413       50       15       3        37
average_rating for this rec across 50 users from same group (less noisy) was: 3.8
all_actions shape just before sample torch.Size([1, 1, 1])
action scaled by temperature: tensor([[90]], device='cuda:0')
action picked by argmax: tensor([64], device='cuda:0')
tensor([[ 64,  93, 238, 181, 272, 135, 161,  26, 270,  10]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
144         1       65       5       145
344         2       65       5        72
750         3       65       4       205
903         4       65       4        85
1269        5       65       5       178
       user_id  item_id  rating  timestep
12553       46       65       5       269
12804       47       65       4       247
12988       48       65       4       158
13295       49       65       4       192
13533       50       65       5       157
average_rating for this rec across 50 users from same group (less noisy) was: 4.22
all_actions shape just before sample torch.Size([1, 2, 1])
action scaled by temperature: tensor([[237]], device='cuda:0')
action picked by argmax: tensor([119], device='cuda:0')
tensor([[119,  86, 259, 109, 129,  39,  44,  48, 211, 159]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
138         1      120       5       139
524         2      120       4       252
674         3      120       2       129
957         4      120       2       139
1242        5      120       3       151
       user_id  item_id  rating  timestep
12334       46      120       4        50
12574       47      120       3        17
12876       48      120       5        46
13120       49      120       5        17
13389       50      120       5        13
average_rating for this rec across 50 users from same group (less noisy) was: 3.74
all_actions shape just before sample torch.Size([1, 3, 1])
action scaled by temperature: tensor([[174]], device='cuda:0')
action picked by argmax: tensor([186], device='cuda:0')
tensor([[186,  86, 119, 259,  39, 109,  44, 219, 211, 181]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
29          1      187       4        30
399         2      187       4       127
575         3      187       5        30
829         4      187       5        11
1282        5      187       4       191
       user_id  item_id  rating  timestep
12361       46      187       3        77
12732       47      187       4       175
12952       48      187       5       122
13267       49      187       4       164
13551       50      187       3       175
average_rating for this rec across 50 users from same group (less noisy) was: 3.64
all_actions shape just before sample torch.Size([1, 4, 1])
action scaled by temperature: tensor([[37]], device='cuda:0')
action picked by argmax: tensor([259], device='cuda:0')
tensor([[259,  86, 186,  32,  39,  37, 183, 181, 119, 219]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
241         1      260       5       242
427         2      260       5       155
709         3      260       5       164
906         4      260       3        88
1149        5      260       5        58
       user_id  item_id  rating  timestep
12293       46      260       3         9
12601       47      260       5        44
12960       48      260       4       130
13175       49      260       5        72
13511       50      260       4       135
average_rating for this rec across 50 users from same group (less noisy) was: 4.16
all_actions shape just before sample torch.Size([1, 5, 1])
action scaled by temperature: tensor([[261]], device='cuda:0')
action picked by argmax: tensor([261], device='cuda:0')
tensor([[261,  85,  42, 245,  52, 201, 161,   7, 187, 198]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
188         1      262       5       189
292         2      262       4        20
676         3      262       3       131
914         4      262       3        96
1194        5      262       3       103
       user_id  item_id  rating  timestep
12551       46      262       5       267
12620       47      262       5        63
12953       48      262       5       123
13350       49      262       4       247
13419       50      262       4        43
average_rating for this rec across 50 users from same group (less noisy) was: 4.0
all_actions shape just before sample torch.Size([1, 6, 1])
action scaled by temperature: tensor([[85]], device='cuda:0')
action picked by argmax: tensor([85], device='cuda:0')
tensor([[ 85, 261, 201,   7,  42, 161, 245,  52,  65, 119]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
266         1       86       5       267
509         2       86       5       237
777         3       86       5       232
917         4       86       5        99
1121        5       86       4        30
       user_id  item_id  rating  timestep
12506       46       86       5       222
12600       47       86       5        43
13074       48       86       5       244
13362       49       86       5       259
13397       50       86       5        21
average_rating for this rec across 50 users from same group (less noisy) was: 4.58
all_actions shape just before sample torch.Size([1, 7, 1])
action scaled by temperature: tensor([[201]], device='cuda:0')
action picked by argmax: tensor([201], device='cuda:0')
tensor([[201,  13,  55,  85,   7, 217,  79, 246,  86,  35]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
258         1      202       3       259
510         2      202       3       238
799         3      202       4       254
930         4      202       3       112
1360        5      202       4       269
       user_id  item_id  rating  timestep
12415       46      202       1       131
12676       47      202       4       119
13070       48      202       3       240
13273       49      202       2       170
13643       50      202       3       267
average_rating for this rec across 50 users from same group (less noisy) was: 2.82
all_actions shape just before sample torch.Size([1, 8, 1])
action scaled by temperature: tensor([[110]], device='cuda:0')
action picked by argmax: tensor([110], device='cuda:0')
tensor([[110, 120, 185, 113, 137, 169,  39, 220, 232,  70]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
45          1      111       3        46
436         2      111       4       164
815         3      111       3       270
940         4      111       2       122
1196        5      111       3       105
       user_id  item_id  rating  timestep
12346       46      111       3        62
12636       47      111       4        79
12867       48      111       4        37
13207       49      111       5       104
13617       50      111       3       241
average_rating for this rec across 50 users from same group (less noisy) was: 3.72
all_actions shape just before sample torch.Size([1, 9, 1])
action scaled by temperature: tensor([[71]], device='cuda:0')
action picked by argmax: tensor([71], device='cuda:0')
tensor([[ 71, 150, 261, 119,  58, 163, 105, 100,  41, 264]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
160         1       72       5       161
343         2       72       4        71
807         3       72       4       262
943         4       72       4       125
1141        5       72       4        50
       user_id  item_id  rating  timestep
12332       46       72       4        48
12696       47       72       3       139
12994       48       72       4       164
13136       49       72       5        33
13486       50       72       4       110
average_rating for this rec across 50 users from same group (less noisy) was: 4.0
all_actions shape just before sample torch.Size([1, 10, 1])
action scaled by temperature: tensor([[150]], device='cuda:0')
action picked by argmax: tensor([150], device='cuda:0')
tensor([[150, 119, 261,  71,  41, 118, 264,  74,  65, 187]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
110         1      151       4       111
405         2      151       3       133
700         3      151       4       155
947         4      151       3       129
1285        5      151       4       194
       user_id  item_id  rating  timestep
12315       46      151       4        31
12694       47      151       2       137
13066       48      151       5       236
13161       49      151       2        58
13520       50      151       4       144
average_rating for this rec across 50 users from same group (less noisy) was: 3.64
all_actions shape just before sample torch.Size([1, 11, 1])
action scaled by temperature: tensor([[118]], device='cuda:0')
action picked by argmax: tensor([118], device='cuda:0')
tensor([[118,  70, 150, 154, 144, 252, 187, 119,  46, 268]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
52          1      119       5        53
434         2      119       5       162
593         3      119       5        48
948         4      119       5       130
1173        5      119       5        82
       user_id  item_id  rating  timestep
12399       46      119       5       115
12597       47      119       5        40
12859       48      119       5        29
13287       49      119       5       184
13381       50      119       4         5
average_rating for this rec across 50 users from same group (less noisy) was: 4.8
all_actions shape just before sample torch.Size([1, 12, 1])
action scaled by temperature: tensor([[70]], device='cuda:0')
action picked by argmax: tensor([70], device='cuda:0')
tensor([[ 70, 150, 118, 119,  45, 101, 268, 110,  46, 240]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
79          1       71       4        80
435         2       71       4       163
621         3       71       4        76
954         4       71       5       136
1223        5       71       4       132
       user_id  item_id  rating  timestep
12485       46       71       3       201
12744       47       71       4       187
12832       48       71       4         2
13187       49       71       4        84
13540       50       71       5       164
average_rating for this rec across 50 users from same group (less noisy) was: 4.04
all_actions shape just before sample torch.Size([1, 13, 1])
action scaled by temperature: tensor([[147]], device='cuda:0')
action picked by argmax: tensor([147], device='cuda:0')
tensor([[147, 214,  65,  97, 235, 183,  98, 250, 113,  89]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
246         1      148       5       247
493         2      148       3       221
652         3      148       3       107
961         4      148       4       143
1311        5      148       3       220
       user_id  item_id  rating  timestep
12463       46      148       4       179
12766       47      148       4       209
13010       48      148       4       180
13299       49      148       4       196
13532       50      148       3       156
average_rating for this rec across 50 users from same group (less noisy) was: 3.76
all_actions shape just before sample torch.Size([1, 14, 1])
action scaled by temperature: tensor([[183]], device='cuda:0')
action picked by argmax: tensor([183], device='cuda:0')
tensor([[183, 187,  89, 147,  39,  65, 214, 176, 173, 124]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
21          1      184       4        22
416         2      184       4       144
817         3      184       4       272
966         4      184       4       148
1239        5      184       4       148
       user_id  item_id  rating  timestep
12555       46      184       4       271
12741       47      184       4       184
12929       48      184       3        99
13232       49      184       2       129
13497       50      184       5       121
average_rating for this rec across 50 users from same group (less noisy) was: 3.9
all_actions shape just before sample torch.Size([1, 15, 1])
action scaled by temperature: tensor([[90]], device='cuda:0')
action picked by argmax: tensor([187], device='cuda:0')
tensor([[187,  90, 183, 176,  89,  65,  87, 266,  27, 120]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
14          1      188       4        15
374         2      188       4       102
812         3      188       5       267
970         4      188       4       152
1289        5      188       3       198
       user_id  item_id  rating  timestep
12460       46      188       4       176
12653       47      188       5        96
13044       48      188       4       214
13181       49      188       4        78
13574       50      188       4       198
average_rating for this rec across 50 users from same group (less noisy) was: 3.98
all_actions shape just before sample torch.Size([1, 16, 1])
action scaled by temperature: tensor([[90]], device='cuda:0')
action picked by argmax: tensor([90], device='cuda:0')
tensor([[ 90, 187,  87,  96, 179, 183, 176,  65, 266, 160]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
26          1       91       4        27
452         2       91       4       180
580         3       91       2        35
982         4       91       3       164
1198        5       91       4       107
       user_id  item_id  rating  timestep
12411       46       91       3       127
12568       47       91       4        11
13005       48       91       5       175
13291       49       91       5       188
13603       50       91       5       227
average_rating for this rec across 50 users from same group (less noisy) was: 3.9
all_actions shape just before sample torch.Size([1, 17, 1])
action scaled by temperature: tensor([[253]], device='cuda:0')
action picked by argmax: tensor([253], device='cuda:0')
tensor([[253,  15, 186,  90, 196,   4, 191, 116, 208, 272]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
102         1      254       3       103
293         2      254       4        21
648         3      254       3       103
987         4      254       4       169
1301        5      254       5       210
       user_id  item_id  rating  timestep
12416       46      254       4       132
12624       47      254       4        67
12971       48      254       4       141
13226       49      254       4       123
13624       50      254       5       248
average_rating for this rec across 50 users from same group (less noisy) was: 4.12
all_actions shape just before sample torch.Size([1, 18, 1])
action scaled by temperature: tensor([[68]], device='cuda:0')
action picked by argmax: tensor([68], device='cuda:0')
tensor([[ 68,  90,  51, 103,  49, 264,  53,  26, 238,  76]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
90          1       69       3        91
513         2       69       4       241
665         3       69       4       120
988         4       69       5       170
1117        5       69       4        26
       user_id  item_id  rating  timestep
12451       46       69       4       167
12690       47       69       5       133
12874       48       69       4        44
13224       49       69       4       121
13590       50       69       4       214
average_rating for this rec across 50 users from same group (less noisy) was: 3.92
all_actions shape just before sample torch.Size([1, 19, 1])
action scaled by temperature: tensor([[103]], device='cuda:0')
action picked by argmax: tensor([103], device='cuda:0')
tensor([[103,  68, 184,  36,  53, 231,  90,  86, 109, 252]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
123         1      104       5       124
396         2      104       5       124
753         3      104       5       208
991         4      104       5       173
1229        5      104       5       138
       user_id  item_id  rating  timestep
12543       46      104       5       259
12779       47      104       5       222
13026       48      104       5       196
13172       49      104       5        69
13479       50      104       5       103
average_rating for this rec across 50 users from same group (less noisy) was: 4.78
all_actions shape just before sample torch.Size([1, 20, 1])
action scaled by temperature: tensor([[184]], device='cuda:0')
action picked by argmax: tensor([184], device='cuda:0')
tensor([[184, 103, 231, 180, 203,  51,   5, 156,  86, 247]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
159         1      185       5       160
406         2      185       4       134
647         3      185       5       102
992         4      185       4       174
1240        5      185       4       149
       user_id  item_id  rating  timestep
12373       46      185       5        89
12733       47      185       5       176
13028       48      185       5       198
13148       49      185       3        45
13456       50      185       4        80
average_rating for this rec across 50 users from same group (less noisy) was: 4.56
all_actions shape just before sample torch.Size([1, 21, 1])
action scaled by temperature: tensor([[139]], device='cuda:0')
action picked by argmax: tensor([139], device='cuda:0')
tensor([[139, 135, 120, 242,  35, 110,  68, 248, 132,   5]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
175         1      140       4       176
290         2      140       4        18
659         3      140       3       114
1005        4      140       4       187
1179        5      140       5        88
       user_id  item_id  rating  timestep
12482       46      140       3       198
12778       47      140       4       221
13043       48      140       5       213
13285       49      140       4       182
13604       50      140       5       228
average_rating for this rec across 50 users from same group (less noisy) was: 4.16
all_actions shape just before sample torch.Size([1, 22, 1])
action scaled by temperature: tensor([[135]], device='cuda:0')
action picked by argmax: tensor([135], device='cuda:0')
tensor([[135, 139, 242, 120,   5,  27, 248,  35,  38,  89]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
166         1      136       4       167
401         2      136       4       129
775         3      136       3       230
1007        4      136       3       189
1187        5      136       3        96
       user_id  item_id  rating  timestep
12285       46      136       4         1
12742       47      136       5       185
12835       48      136       5         5
13263       49      136       2       160
13585       50      136       3       209
average_rating for this rec across 50 users from same group (less noisy) was: 3.84
all_actions shape just before sample torch.Size([1, 23, 1])
action scaled by temperature: tensor([[242]], device='cuda:0')
action picked by argmax: tensor([242], device='cuda:0')
tensor([[242, 135,  38,   8,  39, 139,  47, 205,  14, 120]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
236         1      243       4       237
365         2      243       5        93
703         3      243       5       158
1014        4      243       4       196
1106        5      243       5        15
       user_id  item_id  rating  timestep
12544       46      243       4       260
12745       47      243       4       188
13024       48      243       2       194
13154       49      243       3        51
13427       50      243       4        51
average_rating for this rec across 50 users from same group (less noisy) was: 3.8
all_actions shape just before sample torch.Size([1, 24, 1])
action scaled by temperature: tensor([[211]], device='cuda:0')
action picked by argmax: tensor([211], device='cuda:0')
tensor([[211, 120, 150, 252,  39,  52, 163,  20,   8, 185]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
16          1      212       4        17
467         2      212       5       195
562         3      212       5        17
1019        4      212       5       201
1164        5      212       4        73
       user_id  item_id  rating  timestep
12469       46      212       5       185
12820       47      212       5       263
13061       48      212       5       231
13249       49      212       4       146
13422       50      212       5        46
average_rating for this rec across 50 users from same group (less noisy) was: 4.66
all_actions shape just before sample torch.Size([1, 25, 1])
action scaled by temperature: tensor([[120]], device='cuda:0')
action picked by argmax: tensor([120], device='cuda:0')
tensor([[120,  20,  74, 255,  18, 138, 132, 163, 211,  21]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
140         1      121       4       141
340         2      121       4        68
548         3      121       4         3
1028        4      121       4       210
1324        5      121       4       233
       user_id  item_id  rating  timestep
12449       46      121       3       165
12767       47      121       4       210
13025       48      121       4       195
13269       49      121       4       166
13383       50      121       4         7
average_rating for this rec across 50 users from same group (less noisy) was: 4.02
all_actions shape just before sample torch.Size([1, 26, 1])
action scaled by temperature: tensor([[20]], device='cuda:0')
action picked by argmax: tensor([20], device='cuda:0')
tensor([[ 20, 120,  38, 242, 138,  21, 131, 141,  18,   9]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
89          1       21       4        90
287         2       21       5        15
679         3       21       4       134
1029        4       21       5       211
1192        5       21       4       101
       user_id  item_id  rating  timestep
12342       46       21       5        58
12678       47       21       5       121
13067       48       21       5       237
13173       49       21       5        70
13382       50       21       4         6
average_rating for this rec across 50 users from same group (less noisy) was: 4.66
all_actions shape just before sample torch.Size([1, 27, 1])
action scaled by temperature: tensor([[161]], device='cuda:0')
action picked by argmax: tensor([161], device='cuda:0')
tensor([[161, 122,  80,  37,  18, 185, 189, 235, 226, 220]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
43          1      162       5        44
465         2      162       3       193
730         3      162       4       185
1044        4      162       4       226
1294        5      162       4       203
       user_id  item_id  rating  timestep
12438       46      162       4       154
12716       47      162       4       159
13031       48      162       5       201
13132       49      162       4        29
13539       50      162       3       163
average_rating for this rec across 50 users from same group (less noisy) was: 4.26
all_actions shape just before sample torch.Size([1, 28, 1])
action scaled by temperature: tensor([[185]], device='cuda:0')
action picked by argmax: tensor([185], device='cuda:0')
tensor([[185, 161, 131, 189, 122,  31, 140, 182,  18, 231]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
149         1      186       3       150
283         2      186       3        11
635         3      186       2        90
1052        4      186       4       234
1137        5      186       3        46
       user_id  item_id  rating  timestep
12412       46      186       4       128
12689       47      186       2       132
12858       48      186       3        28
13206       49      186       4       103
13612       50      186       3       236
average_rating for this rec across 50 users from same group (less noisy) was: 3.22
all_actions shape just before sample torch.Size([1, 29, 1])
action scaled by temperature: tensor([[131]], device='cuda:0')
action picked by argmax: tensor([131], device='cuda:0')
tensor([[131, 185, 140,  31, 182,  90, 259,  12, 231, 224]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
157         1      132       5       158
519         2      132       4       247
574         3      132       5        29
1061        4      132       3       243
1323        5      132       4       232
       user_id  item_id  rating  timestep
12481       46      132       4       197
12692       47      132       4       135
12997       48      132       4       167
13321       49      132       5       218
13606       50      132       4       230
average_rating for this rec across 50 users from same group (less noisy) was: 4.42
all_actions shape just before sample torch.Size([1, 30, 1])
action scaled by temperature: tensor([[131]], device='cuda:0')
action picked by argmax: tensor([140], device='cuda:0')
tensor([[140, 131, 185,  12,  31, 182,  90, 259,  22, 267]], device='cuda:0')
Just recommended 30 new items to 50 users from group 1 and the total rating was 121.11999999999999
train_loss is: 1.4146205486227932
action scaled by temperature: tensor([[244]], device='cuda:0')
action picked by argmax: tensor([3], device='cuda:0')
tensor([[  3,  88,  14, 151, 186,  95, 125, 103, 247, 145]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
35          1        4       4        36
501         2        4       5       229
680         3        4       5       135
938         4        4       4       120
1201        5        4       5       110
       user_id  item_id  rating  timestep
12530       46        4       5       246
12610       47        4       4        53
13062       48        4       4       232
13214       49        4       4       111
13385       50        4       4         9
average_rating for this rec across 50 users from same group (less noisy) was: 4.6
all_actions shape just before sample torch.Size([1, 1, 1])
action scaled by temperature: tensor([[122]], device='cuda:0')
action picked by argmax: tensor([14], device='cuda:0')
tensor([[ 14, 145,  78, 158,  54,  38, 133, 109,  42, 206]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
245         1       15       5       246
419         2       15       5       147
685         3       15       5       140
880         4       15       5        62
1234        5       15       3       143
       user_id  item_id  rating  timestep
12325       46       15       4        41
12584       47       15       5        27
13102       48       15       2       272
13313       49       15       5       210
13413       50       15       3        37
average_rating for this rec across 50 users from same group (less noisy) was: 3.8
all_actions shape just before sample torch.Size([1, 2, 1])
action scaled by temperature: tensor([[262]], device='cuda:0')
action picked by argmax: tensor([93], device='cuda:0')
tensor([[ 93,  75, 181,  84, 213, 238,  94, 183,   3,  26]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
115         1       94       5       116
391         2       94       5       119
752         3       94       5       207
929         4       94       5       111
1303        5       94       3       212
       user_id  item_id  rating  timestep
12500       46       94       4       216
12695       47       94       4       138
12964       48       94       5       134
13270       49       94       3       167
13589       50       94       4       213
average_rating for this rec across 50 users from same group (less noisy) was: 4.42
all_actions shape just before sample torch.Size([1, 3, 1])
action scaled by temperature: tensor([[229]], device='cuda:0')
action picked by argmax: tensor([182], device='cuda:0')
tensor([[182,  26, 229,   4,  74, 219,  99,  94,   3, 190]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
120         1      183       4       121
286         2      183       3        14
760         3      183       4       215
953         4      183       4       135
1292        5      183       5       201
       user_id  item_id  rating  timestep
12483       46      183       5       199
12707       47      183       4       150
12911       48      183       3        81
13371       49      183       4       268
13473       50      183       4        97
average_rating for this rec across 50 users from same group (less noisy) was: 4.12
all_actions shape just before sample torch.Size([1, 4, 1])
action scaled by temperature: tensor([[19]], device='cuda:0')
action picked by argmax: tensor([95], device='cuda:0')
tensor([[ 95, 238, 245,   6,  19, 186,  97, 168, 178, 187]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
167         1       96       3       168
352         2       96       3        80
654         3       96       5       109
879         4       96       3        61
1136        5       96       3        45
       user_id  item_id  rating  timestep
12407       46       96       3       123
12748       47       96       4       191
12851       48       96       4        21
13222       49       96       5       119
13437       50       96       4        61
average_rating for this rec across 50 users from same group (less noisy) was: 3.9
all_actions shape just before sample torch.Size([1, 5, 1])
action scaled by temperature: tensor([[168]], device='cuda:0')
action picked by argmax: tensor([203], device='cuda:0')
tensor([[203,  64,  81, 168,  83, 113,  36,  45, 238, 259]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
63          1      204       3        64
400         2      204       3       128
755         3      204       3       210
1045        4      204       4       227
1220        5      204       3       129
       user_id  item_id  rating  timestep
12398       46      204       4       114
12571       47      204       5        14
12977       48      204       3       147
13282       49      204       4       179
13547       50      204       4       171
average_rating for this rec across 50 users from same group (less noisy) was: 3.52
all_actions shape just before sample torch.Size([1, 6, 1])
action scaled by temperature: tensor([[113]], device='cuda:0')
action picked by argmax: tensor([197], device='cuda:0')
tensor([[197, 170, 113,  35,  45, 123,  81, 198, 181,  36]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
124         1      198       4       125
499         2      198       3       227
547         3      198       3         2
1072        4      198       3       254
1122        5      198       3        31
       user_id  item_id  rating  timestep
12427       46      198       4       143
12739       47      198       3       182
13054       48      198       4       224
13196       49      198       3        93
13607       50      198       5       231
average_rating for this rec across 50 users from same group (less noisy) was: 3.72
all_actions shape just before sample torch.Size([1, 7, 1])
action scaled by temperature: tensor([[36]], device='cuda:0')
action picked by argmax: tensor([64], device='cuda:0')
tensor([[ 64,  21,  36, 157,  80, 209, 190,  48,  45,   7]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
144         1       65       5       145
344         2       65       5        72
750         3       65       4       205
903         4       65       4        85
1269        5       65       5       178
       user_id  item_id  rating  timestep
12553       46       65       5       269
12804       47       65       4       247
12988       48       65       4       158
13295       49       65       4       192
13533       50       65       5       157
average_rating for this rec across 50 users from same group (less noisy) was: 4.22
all_actions shape just before sample torch.Size([1, 8, 1])
action scaled by temperature: tensor([[86]], device='cuda:0')
action picked by argmax: tensor([42], device='cuda:0')
tensor([[ 42,  33, 261, 134, 208, 148,  85,  86, 206, 204]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
208         1       43       2       209
518         2       43       5       246
577         3       43       5        32
981         4       43       4       163
1203        5       43       4       112
       user_id  item_id  rating  timestep
12510       46       43       3       226
12665       47       43       3       108
12896       48       43       5        66
13195       49       43       4        92
13464       50       43       3        88
average_rating for this rec across 50 users from same group (less noisy) was: 3.86
all_actions shape just before sample torch.Size([1, 9, 1])
action scaled by temperature: tensor([[13]], device='cuda:0')
action picked by argmax: tensor([13], device='cuda:0')
tensor([[ 13, 117, 201,  84, 199, 246, 159, 154, 186,  35]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
265         1       14       5       266
319         2       14       5        47
782         3       14       4       237
1043        4       14       4       225
1336        5       14       5       245
       user_id  item_id  rating  timestep
12497       46       14       4       213
12794       47       14       5       237
13093       48       14       4       263
13293       49       14       5       190
13396       50       14       5        20
average_rating for this rec across 50 users from same group (less noisy) was: 4.64
all_actions shape just before sample torch.Size([1, 10, 1])
action scaled by temperature: tensor([[13]], device='cuda:0')
action picked by argmax: tensor([201], device='cuda:0')
tensor([[201, 202, 159,  13, 158, 123, 162, 186,  64,   7]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
258         1      202       3       259
510         2      202       3       238
799         3      202       4       254
930         4      202       3       112
1360        5      202       4       269
       user_id  item_id  rating  timestep
12415       46      202       1       131
12676       47      202       4       119
13070       48      202       3       240
13273       49      202       2       170
13643       50      202       3       267
average_rating for this rec across 50 users from same group (less noisy) was: 2.82
all_actions shape just before sample torch.Size([1, 11, 1])
action scaled by temperature: tensor([[139]], device='cuda:0')
action picked by argmax: tensor([43], device='cuda:0')
tensor([[ 43,   7,  39, 116, 139,  22, 238, 255, 225,  75]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
267         1       44       4       268
341         2       44       4        69
706         3       44       4       161
939         4       44       4       121
1331        5       44       4       240
       user_id  item_id  rating  timestep
12435       46       44       3       151
12717       47       44       4       160
13103       48       44       3       273
13146       49       44       3        43
13615       50       44       4       239
average_rating for this rec across 50 users from same group (less noisy) was: 3.74
all_actions shape just before sample torch.Size([1, 12, 1])
action scaled by temperature: tensor([[111]], device='cuda:0')
action picked by argmax: tensor([148], device='cuda:0')
tensor([[148, 111,  41, 202, 236, 136, 240,  31,  20, 262]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
222         1      149       2       223
489         2      149       4       217
780         3      149       3       235
836         4      149       3        18
1112        5      149       3        21
       user_id  item_id  rating  timestep
12501       46      149       3       217
12704       47      149       3       147
12841       48      149       4        11
13331       49      149       4       228
13494       50      149       4       118
average_rating for this rec across 50 users from same group (less noisy) was: 3.48
all_actions shape just before sample torch.Size([1, 13, 1])
action scaled by temperature: tensor([[43]], device='cuda:0')
action picked by argmax: tensor([268], device='cuda:0')
tensor([[268, 227, 212,  57,  43, 118,  26, 249, 238, 244]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
146         1      269       5       147
338         2      269       4        66
695         3      269       5       150
1049        4      269       5       231
1295        5      269       4       204
       user_id  item_id  rating  timestep
12474       46      269       4       190
12685       47      269       5       128
13091       48      269       4       261
13338       49      269       4       235
13558       50      269       5       182
average_rating for this rec across 50 users from same group (less noisy) was: 4.12
all_actions shape just before sample torch.Size([1, 14, 1])
action scaled by temperature: tensor([[182]], device='cuda:0')
action picked by argmax: tensor([268], device='cuda:0')
tensor([[268, 182,  47, 227, 255,  26, 212,  57,  36, 240]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
146         1      269       5       147
338         2      269       4        66
695         3      269       5       150
1049        4      269       5       231
1295        5      269       4       204
       user_id  item_id  rating  timestep
12474       46      269       4       190
12685       47      269       5       128
13091       48      269       4       261
13338       49      269       4       235
13558       50      269       5       182
average_rating for this rec across 50 users from same group (less noisy) was: 4.12
all_actions shape just before sample torch.Size([1, 15, 1])
action scaled by temperature: tensor([[268]], device='cuda:0')
action picked by argmax: tensor([36], device='cuda:0')
tensor([[ 36, 268,  47, 189, 182, 240, 212, 244, 238, 227]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
201         1       37       2       202
424         2       37       5       152
565         3       37       4        20
1025        4       37       3       207
1221        5       37       4       130
       user_id  item_id  rating  timestep
12390       46       37       4       106
12575       47       37       4        18
13059       48       37       4       229
13368       49       37       5       265
13436       50       37       3        60
average_rating for this rec across 50 users from same group (less noisy) was: 3.72
all_actions shape just before sample torch.Size([1, 16, 1])
action scaled by temperature: tensor([[203]], device='cuda:0')
action picked by argmax: tensor([148], device='cuda:0')
tensor([[148,  70, 212, 252,  36, 211, 229, 110, 264, 109]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
222         1      149       2       223
489         2      149       4       217
780         3      149       3       235
836         4      149       3        18
1112        5      149       3        21
       user_id  item_id  rating  timestep
12501       46      149       3       217
12704       47      149       3       147
12841       48      149       4        11
13331       49      149       4       228
13494       50      149       4       118
average_rating for this rec across 50 users from same group (less noisy) was: 3.48
all_actions shape just before sample torch.Size([1, 17, 1])
action scaled by temperature: tensor([[244]], device='cuda:0')
action picked by argmax: tensor([43], device='cuda:0')
tensor([[ 43, 244, 268, 199,  36, 186, 227, 255,  75,  82]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
267         1       44       4       268
341         2       44       4        69
706         3       44       4       161
939         4       44       4       121
1331        5       44       4       240
       user_id  item_id  rating  timestep
12435       46       44       3       151
12717       47       44       4       160
13103       48       44       3       273
13146       49       44       3        43
13615       50       44       4       239
average_rating for this rec across 50 users from same group (less noisy) was: 3.74
all_actions shape just before sample torch.Size([1, 18, 1])
action scaled by temperature: tensor([[244]], device='cuda:0')
action picked by argmax: tensor([244], device='cuda:0')
tensor([[244, 186, 132, 227, 150, 252,  54,  58, 214, 157]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
244         1      245       3       245
422         2      245       5       150
710         3      245       4       165
980         4      245       2       162
1313        5      245       4       222
       user_id  item_id  rating  timestep
12529       46      245       2       245
12723       47      245       3       166
12986       48      245       3       156
13133       49      245       4        30
13507       50      245       2       131
average_rating for this rec across 50 users from same group (less noisy) was: 3.48
all_actions shape just before sample torch.Size([1, 19, 1])
action scaled by temperature: tensor([[45]], device='cuda:0')
action picked by argmax: tensor([45], device='cuda:0')
tensor([[ 45,  44, 157,  64, 232, 244,  41, 212,  76,  25]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
139         1       46       5       140
296         2       46       5        24
714         3       46       5       169
973         4       46       3       155
1219        5       46       5       128
       user_id  item_id  rating  timestep
12425       46       46       5       141
12651       47       46       5        94
12862       48       46       4        32
13247       49       46       4       144
13537       50       46       3       161
average_rating for this rec across 50 users from same group (less noisy) was: 4.14
all_actions shape just before sample torch.Size([1, 20, 1])
action scaled by temperature: tensor([[53]], device='cuda:0')
action picked by argmax: tensor([53], device='cuda:0')
tensor([[ 53,  78, 101, 244,  20,  61, 227, 238,  70,  65]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
235         1       54       5       236
536         2       54       4       264
645         3       54       5       100
1050        4       54       4       232
1197        5       54       4       106
       user_id  item_id  rating  timestep
12353       46       54       5        69
12559       47       54       4         2
12978       48       54       4       148
13283       49       54       3       180
13424       50       54       3        48
average_rating for this rec across 50 users from same group (less noisy) was: 3.88
all_actions shape just before sample torch.Size([1, 21, 1])
action scaled by temperature: tensor([[114]], device='cuda:0')
action picked by argmax: tensor([114], device='cuda:0')
tensor([[114,  53, 231, 227, 154, 158,  98,  44,  55, 186]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
172         1      115       4       173
527         2      115       4       255
673         3      115       4       128
1006        4      115       5       188
1251        5      115       5       160
       user_id  item_id  rating  timestep
12546       46      115       4       262
12759       47      115       3       202
12890       48      115       5        60
13135       49      115       5        32
13616       50      115       5       240
average_rating for this rec across 50 users from same group (less noisy) was: 4.2
all_actions shape just before sample torch.Size([1, 22, 1])
action scaled by temperature: tensor([[231]], device='cuda:0')
action picked by argmax: tensor([231], device='cuda:0')
tensor([[231, 267, 154, 114,  53, 227,  63,  76, 158,  98]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
250         1      232       4       251
469         2      232       4       197
557         3      232       4        12
922         4      232       5       104
1265        5      232       5       174
       user_id  item_id  rating  timestep
12299       46      232       5        15
12815       47      232       3       258
12865       48      232       4        35
13142       49      232       5        39
13469       50      232       3        93
average_rating for this rec across 50 users from same group (less noisy) was: 4.38
all_actions shape just before sample torch.Size([1, 23, 1])
action scaled by temperature: tensor([[267]], device='cuda:0')
action picked by argmax: tensor([267], device='cuda:0')
tensor([[267,  63,  76,  98, 231,  53,  55, 114, 223,  80]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
65          1      268       3        66
300         2      268       5        28
748         3      268       2       203
1023        4      268       3       205
1181        5      268       5        90
       user_id  item_id  rating  timestep
12479       46      268       5       195
12730       47      268       5       173
13051       48      268       2       221
13346       49      268       4       243
13556       50      268       3       180
average_rating for this rec across 50 users from same group (less noisy) was: 3.78
all_actions shape just before sample torch.Size([1, 24, 1])
action scaled by temperature: tensor([[63]], device='cuda:0')
action picked by argmax: tensor([63], device='cuda:0')
tensor([[ 63, 267, 231,  76, 219, 241, 250,  55, 238, 209]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
227         1       64       5       228
530         2       64       4       258
781         3       64       4       236
1036        4       64       5       218
1148        5       64       5        57
       user_id  item_id  rating  timestep
12401       46       64       3       117
12630       47       64       3        73
12869       48       64       4        39
13138       49       64       5        35
13605       50       64       4       229
average_rating for this rec across 50 users from same group (less noisy) was: 3.82
all_actions shape just before sample torch.Size([1, 25, 1])
action scaled by temperature: tensor([[209]], device='cuda:0')
action picked by argmax: tensor([209], device='cuda:0')
tensor([[209, 185, 143,  63, 206, 262, 172, 160,  16, 235]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
60          1      210       5        61
336         2      210       4        64
564         3      210       3        19
916         4      210       2        98
1118        5      210       5        27
       user_id  item_id  rating  timestep
12528       46      210       4       244
12569       47      210       4        12
12854       48      210       3        24
13288       49      210       4       185
13535       50      210       5       159
average_rating for this rec across 50 users from same group (less noisy) was: 3.94
all_actions shape just before sample torch.Size([1, 26, 1])
action scaled by temperature: tensor([[242]], device='cuda:0')
action picked by argmax: tensor([242], device='cuda:0')
tensor([[242, 229, 185, 172, 223,  55, 271, 159,  19,  16]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
236         1      243       4       237
365         2      243       5        93
703         3      243       5       158
1014        4      243       4       196
1106        5      243       5        15
       user_id  item_id  rating  timestep
12544       46      243       4       260
12745       47      243       4       188
13024       48      243       2       194
13154       49      243       3        51
13427       50      243       4        51
average_rating for this rec across 50 users from same group (less noisy) was: 3.8
all_actions shape just before sample torch.Size([1, 27, 1])
action scaled by temperature: tensor([[172]], device='cuda:0')
action picked by argmax: tensor([172], device='cuda:0')
tensor([[172,   3,  55, 115, 208,  12, 235, 106, 252,  16]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
42          1      173       5        43
446         2      173       4       174
578         3      173       3        33
932         4      173       5       114
1095        5      173       5         4
       user_id  item_id  rating  timestep
12519       46      173       5       235
12803       47      173       4       246
13015       48      173       5       185
13335       49      173       5       232
13425       50      173       5        49
average_rating for this rec across 50 users from same group (less noisy) was: 4.56
all_actions shape just before sample torch.Size([1, 28, 1])
action scaled by temperature: tensor([[94]], device='cuda:0')
action picked by argmax: tensor([94], device='cuda:0')
tensor([[ 94,  74, 159, 165, 259, 132, 172,  65, 138,  19]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
162         1       95       3       163
474         2       95       5       202
762         3       95       5       217
978         4       95       4       160
1355        5       95       3       264
       user_id  item_id  rating  timestep
12350       46       95       3        66
12800       47       95       4       243
12918       48       95       4        88
13240       49       95       4       137
13581       50       95       5       205
average_rating for this rec across 50 users from same group (less noisy) was: 3.76
all_actions shape just before sample torch.Size([1, 29, 1])
action scaled by temperature: tensor([[74]], device='cuda:0')
action picked by argmax: tensor([74], device='cuda:0')
tensor([[ 74, 233,  91, 189, 132, 194, 138,  26, 252, 128]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
195         1       75       5       196
284         2       75       5        12
737         3       75       5       192
1026        4       75       4       208
1111        5       75       3        20
       user_id  item_id  rating  timestep
12410       46       75       5       126
12652       47       75       3        95
12974       48       75       3       144
13348       49       75       2       245
13573       50       75       4       197
average_rating for this rec across 50 users from same group (less noisy) was: 3.6
all_actions shape just before sample torch.Size([1, 30, 1])
action scaled by temperature: tensor([[233]], device='cuda:0')
action picked by argmax: tensor([233], device='cuda:0')
tensor([[233,  74, 194, 189,  59, 128,  91,  31, 147, 143]], device='cuda:0')
Just recommended 30 new items to 50 users from group 1 and the total rating was 117.35999999999997
train_loss is: 1.4964838664825648
action scaled by temperature: tensor([[87]], device='cuda:0')
action picked by argmax: tensor([260], device='cuda:0')
tensor([[260, 161, 160,  69,  28,  95, 231, 178, 133, 117]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
130         1      261       2       131
508         2      261       4       236
776         3      261       4       231
919         4      261       5       101
1258        5      261       4       167
       user_id  item_id  rating  timestep
12372       46      261       4        88
12822       47      261       5       265
12833       48      261       4         3
13272       49      261       3       169
13392       50      261       4        16
average_rating for this rec across 50 users from same group (less noisy) was: 3.82
all_actions shape just before sample torch.Size([1, 1, 1])
action scaled by temperature: tensor([[13]], device='cuda:0')
action picked by argmax: tensor([158], device='cuda:0')
tensor([[158, 133, 251, 114, 178,   4,  22,  61, 213, 148]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
129         1      159       3       130
480         2      159       3       208
579         3      159       3        34
1057        4      159       3       239
1270        5      159       2       179
       user_id  item_id  rating  timestep
12525       46      159       5       241
12736       47      159       4       179
12973       48      159       5       143
13326       49      159       4       223
13490       50      159       4       114
average_rating for this rec across 50 users from same group (less noisy) was: 3.6
all_actions shape just before sample torch.Size([1, 2, 1])
action scaled by temperature: tensor([[253]], device='cuda:0')
action picked by argmax: tensor([92], device='cuda:0')
tensor([[ 92, 133, 261,  82,  26,  20, 142, 167,  78, 152]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
240         1       93       5       241
512         2       93       5       240
614         3       93       4        69
881         4       93       5        63
1326        5       93       5       235
       user_id  item_id  rating  timestep
12349       46       93       5        65
12787       47       93       5       230
12886       48       93       5        56
13259       49       93       5       156
13386       50       93       4        10
average_rating for this rec across 50 users from same group (less noisy) was: 4.58
all_actions shape just before sample torch.Size([1, 3, 1])
action scaled by temperature: tensor([[82]], device='cuda:0')
action picked by argmax: tensor([261], device='cuda:0')
tensor([[261,  82, 230, 127, 223,  25, 246,  62, 151,  60]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
188         1      262       5       189
292         2      262       4        20
676         3      262       3       131
914         4      262       3        96
1194        5      262       3       103
       user_id  item_id  rating  timestep
12551       46      262       5       267
12620       47      262       5        63
12953       48      262       5       123
13350       49      262       4       247
13419       50      262       4        43
average_rating for this rec across 50 users from same group (less noisy) was: 4.0
all_actions shape just before sample torch.Size([1, 4, 1])
action scaled by temperature: tensor([[263]], device='cuda:0')
action picked by argmax: tensor([145], device='cuda:0')
tensor([[145,  87, 191, 152,  17,  44, 167,  26,  80, 183]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
116         1      146       4       117
318         2      146       4        46
561         3      146       5        16
847         4      146       4        29
1342        5      146       4       251
       user_id  item_id  rating  timestep
12514       46      146       3       230
12777       47      146       3       220
12893       48      146       4        63
13376       49      146       4       273
13510       50      146       4       134
average_rating for this rec across 50 users from same group (less noisy) was: 4.32
all_actions shape just before sample torch.Size([1, 5, 1])
action scaled by temperature: tensor([[250]], device='cuda:0')
action picked by argmax: tensor([55], device='cuda:0')
tensor([[ 55,   6,  17, 109, 240, 250, 206,  44,  35, 217]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
17          1       56       4        18
500         2       56       4       228
617         3       56       3        72
1080        4       56       4       262
1108        5       56       5        17
       user_id  item_id  rating  timestep
12459       46       56       5       175
12782       47       56       4       225
13071       48       56       4       241
13174       49       56       3        71
13516       50       56       5       140
average_rating for this rec across 50 users from same group (less noisy) was: 4.14
all_actions shape just before sample torch.Size([1, 6, 1])
action scaled by temperature: tensor([[196]], device='cuda:0')
action picked by argmax: tensor([196], device='cuda:0')
tensor([[196,  53, 262,  72, 240, 169, 137,  98,  18,  60]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
98          1      197       3        99
369         2      197       4        97
729         3      197       3       184
867         4      197       5        49
1109        5      197       4        18
       user_id  item_id  rating  timestep
12311       46      197       2        27
12645       47      197       4        88
13014       48      197       3       184
13119       49      197       1        16
13636       50      197       3       260
average_rating for this rec across 50 users from same group (less noisy) was: 3.28
all_actions shape just before sample torch.Size([1, 7, 1])
action scaled by temperature: tensor([[240]], device='cuda:0')
action picked by argmax: tensor([240], device='cuda:0')
tensor([[240, 233, 143, 131, 192, 262, 206,  60, 189, 234]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
200         1      241       4       201
397         2      241       5       125
583         3      241       2        38
883         4      241       4        65
1199        5      241       4       108
       user_id  item_id  rating  timestep
12545       46      241       5       261
12770       47      241       3       213
13006       48      241       5       176
13145       49      241       5        42
13557       50      241       3       181
average_rating for this rec across 50 users from same group (less noisy) was: 3.62
all_actions shape just before sample torch.Size([1, 8, 1])
action scaled by temperature: tensor([[233]], device='cuda:0')
action picked by argmax: tensor([233], device='cuda:0')
tensor([[233, 131,  79, 240,  70, 143,  33, 135, 140, 189]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
39          1      234       4        40
543         2      234       4       271
707         3      234       4       162
1083        4      234       2       265
1364        5      234       4       273
       user_id  item_id  rating  timestep
12363       46      234       3        79
12812       47      234       5       255
12943       48      234       3       113
13126       49      234       5        23
13420       50      234       4        44
average_rating for this rec across 50 users from same group (less noisy) was: 4.0
all_actions shape just before sample torch.Size([1, 9, 1])
action scaled by temperature: tensor([[131]], device='cuda:0')
action picked by argmax: tensor([131], device='cuda:0')
tensor([[131, 233,  79, 143, 247,   8, 189,  80, 265, 201]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
157         1      132       5       158
519         2      132       4       247
574         3      132       5        29
1061        4      132       3       243
1323        5      132       4       232
       user_id  item_id  rating  timestep
12481       46      132       4       197
12692       47      132       4       135
12997       48      132       4       167
13321       49      132       5       218
13606       50      132       4       230
average_rating for this rec across 50 users from same group (less noisy) was: 4.42
all_actions shape just before sample torch.Size([1, 10, 1])
action scaled by temperature: tensor([[60]], device='cuda:0')
action picked by argmax: tensor([60], device='cuda:0')
tensor([[ 60,   4, 170, 251,  35,  53, 257, 102, 123,  79]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
107         1       61       5       108
402         2       61       5       130
784         3       61       5       239
904         4       61       5        86
1135        5       61       4        44
       user_id  item_id  rating  timestep
12522       46       61       5       238
12713       47       61       4       156
12883       48       61       3        53
13153       49       61       5        50
13536       50       61       5       160
average_rating for this rec across 50 users from same group (less noisy) was: 4.38
all_actions shape just before sample torch.Size([1, 11, 1])
action scaled by temperature: tensor([[35]], device='cuda:0')
action picked by argmax: tensor([35], device='cuda:0')
tensor([[ 35,  60, 166, 201, 170, 251,   9,  64, 123,   4]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
155         1       36       4       156
356         2       36       4        84
651         3       36       5       106
923         4       36       5       105
1293        5       36       4       202
       user_id  item_id  rating  timestep
12444       46       36       5       160
12705       47       36       5       148
13096       48       36       5       266
13242       49       36       4       139
13488       50       36       4       112
average_rating for this rec across 50 users from same group (less noisy) was: 4.46
all_actions shape just before sample torch.Size([1, 12, 1])
action scaled by temperature: tensor([[9]], device='cuda:0')
action picked by argmax: tensor([9], device='cuda:0')
tensor([[  9, 155,   4,  44,  72, 125,   6,  42,  59, 255]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
256         1       10       5       257
308         2       10       5        36
626         3       10       4        81
1055        4       10       4       237
1193        5       10       5       102
       user_id  item_id  rating  timestep
12521       46       10       5       237
12698       47       10       5       141
12982       48       10       4       152
13245       49       10       5       142
13461       50       10       4        85
average_rating for this rec across 50 users from same group (less noisy) was: 4.56
all_actions shape just before sample torch.Size([1, 13, 1])
action scaled by temperature: tensor([[4]], device='cuda:0')
action picked by argmax: tensor([4], device='cuda:0')
tensor([[  4, 183, 108,  20, 121, 148, 179,  27, 189, 233]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
218         1        5       5       219
370         2        5       5        98
649         3        5       5       104
890         4        5       5        72
1333        5        5       5       242
       user_id  item_id  rating  timestep
12447       46        5       5       163
12790       47        5       5       233
12966       48        5       5       136
13353       49        5       5       250
13491       50        5       5       115
average_rating for this rec across 50 users from same group (less noisy) was: 4.82
all_actions shape just before sample torch.Size([1, 14, 1])
action scaled by temperature: tensor([[20]], device='cuda:0')
action picked by argmax: tensor([20], device='cuda:0')
tensor([[ 20,   4, 228,  46,   6,  59, 183,  49, 179, 112]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
89          1       21       4        90
287         2       21       5        15
679         3       21       4       134
1029        4       21       5       211
1192        5       21       4       101
       user_id  item_id  rating  timestep
12342       46       21       5        58
12678       47       21       5       121
13067       48       21       5       237
13173       49       21       5        70
13382       50       21       4         6
average_rating for this rec across 50 users from same group (less noisy) was: 4.66
all_actions shape just before sample torch.Size([1, 15, 1])
action scaled by temperature: tensor([[192]], device='cuda:0')
action picked by argmax: tensor([192], device='cuda:0')
tensor([[192, 224, 237,  43,  70,  69, 117, 131,  67,  68]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
11          1      193       3        12
393         2      193       4       121
628         3      193       5        83
878         4      193       5        60
1325        5      193       4       234
       user_id  item_id  rating  timestep
12327       46      193       3        43
12762       47      193       3       205
12992       48      193       5       162
13129       49      193       5        26
13493       50      193       3       117
average_rating for this rec across 50 users from same group (less noisy) was: 4.14
all_actions shape just before sample torch.Size([1, 16, 1])
action scaled by temperature: tensor([[224]], device='cuda:0')
action picked by argmax: tensor([224], device='cuda:0')
tensor([[224, 237,  43,  70, 244, 208,  68, 192,  81, 131]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
69          1      225       5        70
355         2      225       4        83
723         3      225       4       178
827         4      225       5         9
1291        5      225       4       200
       user_id  item_id  rating  timestep
12318       46      225       5        34
12629       47      225       4        72
13075       48      225       5       245
13306       49      225       4       203
13477       50      225       4       101
average_rating for this rec across 50 users from same group (less noisy) was: 4.52
all_actions shape just before sample torch.Size([1, 17, 1])
action scaled by temperature: tensor([[43]], device='cuda:0')
action picked by argmax: tensor([43], device='cuda:0')
tensor([[ 43, 237,   0,  70, 131,   8,   6,  68, 117,  44]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
267         1       44       4       268
341         2       44       4        69
706         3       44       4       161
939         4       44       4       121
1331        5       44       4       240
       user_id  item_id  rating  timestep
12435       46       44       3       151
12717       47       44       4       160
13103       48       44       3       273
13146       49       44       3        43
13615       50       44       4       239
average_rating for this rec across 50 users from same group (less noisy) was: 3.74
all_actions shape just before sample torch.Size([1, 18, 1])
action scaled by temperature: tensor([[237]], device='cuda:0')
action picked by argmax: tensor([237], device='cuda:0')
tensor([[237,   0,  43,  68, 175, 253,   6, 155,  70, 111]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
228         1      238       4       229
475         2      238       3       203
719         3      238       3       174
860         4      238       5        42
1166        5      238       5        75
       user_id  item_id  rating  timestep
12462       46      238       3       178
12618       47      238       4        61
13000       48      238       5       170
13192       49      238       3        89
13431       50      238       5        55
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 19, 1])
action scaled by temperature: tensor([[0]], device='cuda:0')
action picked by argmax: tensor([0], device='cuda:0')
tensor([[  0,  43, 237, 117, 111, 227, 213,   8,  68, 206]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
62          1        1       4        63
522         2        1       5       250
671         3        1       4       126
892         4        1       4        74
1204        5        1       5       113
       user_id  item_id  rating  timestep
12375       46        1       5        91
12816       47        1       5       259
13045       48        1       4       215
13375       49        1       5       272
13542       50        1       5       166
average_rating for this rec across 50 users from same group (less noisy) was: 4.66
all_actions shape just before sample torch.Size([1, 20, 1])
action scaled by temperature: tensor([[68]], device='cuda:0')
action picked by argmax: tensor([68], device='cuda:0')
tensor([[ 68,  58, 217,   2, 255,   1, 269, 157, 188, 237]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
90          1       69       3        91
513         2       69       4       241
665         3       69       4       120
988         4       69       5       170
1117        5       69       4        26
       user_id  item_id  rating  timestep
12451       46       69       4       167
12690       47       69       5       133
12874       48       69       4        44
13224       49       69       4       121
13590       50       69       4       214
average_rating for this rec across 50 users from same group (less noisy) was: 3.92
all_actions shape just before sample torch.Size([1, 21, 1])
action scaled by temperature: tensor([[113]], device='cuda:0')
action picked by argmax: tensor([113], device='cuda:0')
tensor([[113,  98,  47, 231, 189,  58,   3, 150, 252, 149]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
109         1      114       4       110
324         2      114       3        52
744         3      114       4       199
920         4      114       5       102
1160        5      114       5        69
       user_id  item_id  rating  timestep
12470       46      114       3       186
12608       47      114       4        51
13034       48      114       4       204
13365       49      114       4       262
13593       50      114       5       217
average_rating for this rec across 50 users from same group (less noisy) was: 4.24
all_actions shape just before sample torch.Size([1, 22, 1])
action scaled by temperature: tensor([[47]], device='cuda:0')
action picked by argmax: tensor([47], device='cuda:0')
tensor([[ 47,  98, 136, 118, 243,  58, 138, 222, 207, 247]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
104         1       48       5       105
471         2       48       5       199
567         3       48       4        22
888         4       48       4        70
1155        5       48       4        64
       user_id  item_id  rating  timestep
12362       46       48       5        78
12710       47       48       4       153
12898       48       48       5        68
13180       49       48       4        77
13648       50       48       4       272
average_rating for this rec across 50 users from same group (less noisy) was: 4.08
all_actions shape just before sample torch.Size([1, 23, 1])
action scaled by temperature: tensor([[98]], device='cuda:0')
action picked by argmax: tensor([98], device='cuda:0')
tensor([[ 98,  47, 118, 214, 207,  79,  16, 138, 243, 247]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
180         1       99       3       181
304         2       99       5        32
607         3       99       4        62
1046        4       99       5       228
1134        5       99       5        43
       user_id  item_id  rating  timestep
12419       46       99       4       135
12560       47       99       4         3
12902       48       99       4        72
13217       49       99       5       114
13518       50       99       5       142
average_rating for this rec across 50 users from same group (less noisy) was: 3.72
all_actions shape just before sample torch.Size([1, 24, 1])
action scaled by temperature: tensor([[174]], device='cuda:0')
action picked by argmax: tensor([174], device='cuda:0')
tensor([[174, 188,  58,  42, 259, 118,  16, 182, 222, 213]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
215         1      175       5       216
403         2      175       3       131
698         3      175       5       153
1024        4      175       5       206
1243        5      175       4       152
       user_id  item_id  rating  timestep
12292       46      175       4         8
12752       47      175       4       195
13084       48      175       5       254
13258       49      175       5       155
13595       50      175       4       219
average_rating for this rec across 50 users from same group (less noisy) was: 4.58
all_actions shape just before sample torch.Size([1, 25, 1])
action scaled by temperature: tensor([[268]], device='cuda:0')
action picked by argmax: tensor([268], device='cuda:0')
tensor([[268, 245, 222, 105,  95,  91, 233, 114, 107, 200]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
146         1      269       5       147
338         2      269       4        66
695         3      269       5       150
1049        4      269       5       231
1295        5      269       4       204
       user_id  item_id  rating  timestep
12474       46      269       4       190
12685       47      269       5       128
13091       48      269       4       261
13338       49      269       4       235
13558       50      269       5       182
average_rating for this rec across 50 users from same group (less noisy) was: 4.12
all_actions shape just before sample torch.Size([1, 26, 1])
action scaled by temperature: tensor([[114]], device='cuda:0')
action picked by argmax: tensor([222], device='cuda:0')
tensor([[222, 114, 245, 203, 268, 205, 107,  25,  24, 244]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
198         1      223       3       199
386         2      223       4       114
640         3      223       5        95
936         4      223       5       118
1310        5      223       4       219
       user_id  item_id  rating  timestep
12409       46      223       5       125
12619       47      223       5        62
12967       48      223       4       137
13372       49      223       5       269
13567       50      223       4       191
average_rating for this rec across 50 users from same group (less noisy) was: 4.54
all_actions shape just before sample torch.Size([1, 27, 1])
action scaled by temperature: tensor([[114]], device='cuda:0')
action picked by argmax: tensor([114], device='cuda:0')
tensor([[114,  24, 146, 222, 111, 245, 198,  45, 244,  95]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
172         1      115       4       173
527         2      115       4       255
673         3      115       4       128
1006        4      115       5       188
1251        5      115       5       160
       user_id  item_id  rating  timestep
12546       46      115       4       262
12759       47      115       3       202
12890       48      115       5        60
13135       49      115       5        32
13616       50      115       5       240
average_rating for this rec across 50 users from same group (less noisy) was: 4.2
all_actions shape just before sample torch.Size([1, 28, 1])
action scaled by temperature: tensor([[146]], device='cuda:0')
action picked by argmax: tensor([146], device='cuda:0')
tensor([[146,  88,  24, 165, 244, 111, 140,  21,   0, 245]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
97          1      147       4        98
492         2      147       4       220
612         3      147       4        67
897         4      147       3        79
1350        5      147       5       259
       user_id  item_id  rating  timestep
12336       46      147       5        52
12647       47      147       4        90
12962       48      147       4       132
13367       49      147       4       264
13443       50      147       5        67
average_rating for this rec across 50 users from same group (less noisy) was: 4.24
all_actions shape just before sample torch.Size([1, 29, 1])
action scaled by temperature: tensor([[166]], device='cuda:0')
action picked by argmax: tensor([166], device='cuda:0')
tensor([[166, 201,  88, 125, 111,  24,  23, 144, 165, 256]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
141         1      167       4       142
539         2      167       5       267
791         3      167       4       246
1054        4      167       4       236
1153        5      167       3        62
       user_id  item_id  rating  timestep
12348       46      167       4        64
12628       47      167       4        71
12941       48      167       5       111
13112       49      167       4         9
13578       50      167       2       202
average_rating for this rec across 50 users from same group (less noisy) was: 4.2
all_actions shape just before sample torch.Size([1, 30, 1])
action scaled by temperature: tensor([[88]], device='cuda:0')
action picked by argmax: tensor([88], device='cuda:0')
tensor([[ 88, 125, 222, 146, 105,  77,  73, 193, 111, 261]], device='cuda:0')
Just recommended 30 new items to 50 users from group 1 and the total rating was 125.62
train_loss is: 1.5080817758220515
action scaled by temperature: tensor([[250]], device='cuda:0')
action picked by argmax: tensor([40], device='cuda:0')
tensor([[ 40,  13,  52,  17,  61,   9,  89,  27,  10, 136]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
66          1       41       4        67
353         2       41       5        81
756         3       41       3       211
1060        4       41       2       242
1343        5       41       3       252
       user_id  item_id  rating  timestep
12376       46       41       3        92
12615       47       41       3        58
12882       48       41       3        52
13156       49       41       5        53
13485       50       41       4       109
average_rating for this rec across 50 users from same group (less noisy) was: 3.66
all_actions shape just before sample torch.Size([1, 1, 1])
action scaled by temperature: tensor([[103]], device='cuda:0')
action picked by argmax: tensor([10], device='cuda:0')
tensor([[ 10, 159, 131, 103, 118,   4, 207, 222, 156,  33]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
183         1       11       1       184
302         2       11       4        30
616         3       11       3        71
877         4       11       2        59
1096        5       11       3         5
       user_id  item_id  rating  timestep
12340       46       11       2        56
12829       47       11       1       272
12922       48       11       3        92
13155       49       11       2        52
13410       50       11       2        34
average_rating for this rec across 50 users from same group (less noisy) was: 2.2
all_actions shape just before sample torch.Size([1, 2, 1])
action scaled by temperature: tensor([[90]], device='cuda:0')
action picked by argmax: tensor([90], device='cuda:0')
tensor([[ 90, 249, 243, 216,  56, 136, 224,  43,  36, 175]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
26          1       91       4        27
452         2       91       4       180
580         3       91       2        35
982         4       91       3       164
1198        5       91       4       107
       user_id  item_id  rating  timestep
12411       46       91       3       127
12568       47       91       4        11
13005       48       91       5       175
13291       49       91       5       188
13603       50       91       5       227
average_rating for this rec across 50 users from same group (less noisy) was: 3.9
all_actions shape just before sample torch.Size([1, 3, 1])
action scaled by temperature: tensor([[191]], device='cuda:0')
action picked by argmax: tensor([191], device='cuda:0')
tensor([[191, 243, 120, 136,  15, 227,  26, 175, 253, 236]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
32          1      192       4        33
537         2      192       4       265
582         3      192       5        37
1010        4      192       5       192
1170        5      192       4        79
       user_id  item_id  rating  timestep
12369       46      192       5        85
12673       47      192       5       116
13020       48      192       5       190
13277       49      192       4       174
13457       50      192       4        81
average_rating for this rec across 50 users from same group (less noisy) was: 4.34
all_actions shape just before sample torch.Size([1, 4, 1])
action scaled by temperature: tensor([[7]], device='cuda:0')
action picked by argmax: tensor([7], device='cuda:0')
tensor([[  7, 101,  67,  48,  87,  88,  73, 167,  75,  20]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
184         1        8       5       185
502         2        8       3       230
778         3        8       5       233
985         4        8       4       167
1354        5        8       5       263
       user_id  item_id  rating  timestep
12503       46        8       4       219
12614       47        8       4        57
13018       48        8       3       188
13337       49        8       3       234
13465       50        8       3        89
average_rating for this rec across 50 users from same group (less noisy) was: 4.08
all_actions shape just before sample torch.Size([1, 5, 1])
action scaled by temperature: tensor([[75]], device='cuda:0')
action picked by argmax: tensor([75], device='cuda:0')
tensor([[ 75, 167,  67,  21, 246,  12,  20, 269, 249,  36]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
76          1       76       5        77
330         2       76       4        58
571         3       76       3        26
915         4       76       4        97
1167        5       76       4        76
       user_id  item_id  rating  timestep
12440       46       76       3       156
12588       47       76       4        31
12957       48       76       3       127
13325       49       76       5       222
13468       50       76       5        92
average_rating for this rec across 50 users from same group (less noisy) was: 4.04
all_actions shape just before sample torch.Size([1, 6, 1])
action scaled by temperature: tensor([[67]], device='cuda:0')
action picked by argmax: tensor([67], device='cuda:0')
tensor([[ 67,  48, 231, 101,   7, 186,  20,  87, 151, 150]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
191         1       68       3       192
351         2       68       2        79
623         3       68       4        78
866         4       68       5        48
1237        5       68       3       146
       user_id  item_id  rating  timestep
12499       46       68       3       215
12639       47       68       5        82
13060       48       68       4       230
13114       49       68       3        11
13452       50       68       5        76
average_rating for this rec across 50 users from same group (less noisy) was: 3.82
all_actions shape just before sample torch.Size([1, 7, 1])
action scaled by temperature: tensor([[178]], device='cuda:0')
action picked by argmax: tensor([38], device='cuda:0')
tensor([[ 38,  36, 178,  84,  81,   2, 262,  30,  93, 101]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
264         1       39       3       265
276         2       39       3         4
670         3       39       2       125
899         4       39       3        81
1171        5       39       4        80
       user_id  item_id  rating  timestep
12532       46       39       3       248
12562       47       39       3         5
13086       48       39       2       256
13210       49       39       3       107
13467       50       39       3        91
average_rating for this rec across 50 users from same group (less noisy) was: 3.04
all_actions shape just before sample torch.Size([1, 8, 1])
action scaled by temperature: tensor([[187]], device='cuda:0')
action picked by argmax: tensor([187], device='cuda:0')
tensor([[187, 178,  17, 146, 101, 246, 186,  29,  87,  26]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
14          1      188       4        15
374         2      188       4       102
812         3      188       5       267
970         4      188       4       152
1289        5      188       3       198
       user_id  item_id  rating  timestep
12460       46      188       4       176
12653       47      188       5        96
13044       48      188       4       214
13181       49      188       4        78
13574       50      188       4       198
average_rating for this rec across 50 users from same group (less noisy) was: 3.98
all_actions shape just before sample torch.Size([1, 9, 1])
action scaled by temperature: tensor([[178]], device='cuda:0')
action picked by argmax: tensor([178], device='cuda:0')
tensor([[178, 101, 187, 210, 186,  93, 183,  32, 256,   7]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
176         1      179       4       177
372         2      179       5       100
551         3      179       5         6
821         4      179       4         3
1183        5      179       4        92
       user_id  item_id  rating  timestep
12511       46      179       4       227
12697       47      179       5       140
12871       48      179       5        41
13208       49      179       5       105
13632       50      179       4       256
average_rating for this rec across 50 users from same group (less noisy) was: 4.48
all_actions shape just before sample torch.Size([1, 10, 1])
action scaled by temperature: tensor([[178]], device='cuda:0')
action picked by argmax: tensor([178], device='cuda:0')
tensor([[178, 236, 187, 206, 113,  17, 256, 183,  29,  73]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
176         1      179       4       177
372         2      179       5       100
551         3      179       5         6
821         4      179       4         3
1183        5      179       4        92
       user_id  item_id  rating  timestep
12511       46      179       4       227
12697       47      179       5       140
12871       48      179       5        41
13208       49      179       5       105
13632       50      179       4       256
average_rating for this rec across 50 users from same group (less noisy) was: 4.48
all_actions shape just before sample torch.Size([1, 11, 1])
action scaled by temperature: tensor([[236]], device='cuda:0')
action picked by argmax: tensor([236], device='cuda:0')
tensor([[236, 256,  17,  43, 183, 160,   1,  73, 206, 192]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
37          1      237       5        38
516         2      237       5       244
734         3      237       5       189
999         4      237       5       181
1227        5      237       5       136
       user_id  item_id  rating  timestep
12448       46      237       5       164
12818       47      237       4       261
12861       48      237       4        31
13105       49      237       5         2
13446       50      237       4        70
average_rating for this rec across 50 users from same group (less noisy) was: 4.66
all_actions shape just before sample torch.Size([1, 12, 1])
action scaled by temperature: tensor([[256]], device='cuda:0')
action picked by argmax: tensor([256], device='cuda:0')
tensor([[256, 183,  43,  83, 195, 236,  16,  77, 147, 263]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
270         1      257       4       271
447         2      257       5       175
696         3      257       5       151
1086        4      257       4       268
1238        5      257       4       147
       user_id  item_id  rating  timestep
12554       46      257       4       270
12564       47      257       4         7
13057       48      257       5       227
13246       49      257       5       143
13460       50      257       5        84
average_rating for this rec across 50 users from same group (less noisy) was: 4.26
all_actions shape just before sample torch.Size([1, 13, 1])
action scaled by temperature: tensor([[183]], device='cuda:0')
action picked by argmax: tensor([183], device='cuda:0')
tensor([[183,  51,  77, 160, 213, 256,  94, 236,  47, 149]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
21          1      184       4        22
416         2      184       4       144
817         3      184       4       272
966         4      184       4       148
1239        5      184       4       148
       user_id  item_id  rating  timestep
12555       46      184       4       271
12741       47      184       4       184
12929       48      184       3        99
13232       49      184       2       129
13497       50      184       5       121
average_rating for this rec across 50 users from same group (less noisy) was: 3.9
all_actions shape just before sample torch.Size([1, 14, 1])
action scaled by temperature: tensor([[51]], device='cuda:0')
action picked by argmax: tensor([51], device='cuda:0')
tensor([[ 51, 182, 183,  77, 236,  83, 264, 213, 229,  57]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
206         1       52       4       207
379         2       52       4       107
570         3       52       5        25
844         4       52       4        26
1208        5       52       4       117
       user_id  item_id  rating  timestep
12557       46       52       4       273
12712       47       52       5       155
12944       48       52       4       114
13107       49       52       4         4
13387       50       52       4        11
average_rating for this rec across 50 users from same group (less noisy) was: 4.18
all_actions shape just before sample torch.Size([1, 15, 1])
action scaled by temperature: tensor([[77]], device='cuda:0')
action picked by argmax: tensor([77], device='cuda:0')
tensor([[ 77, 256, 236,  94, 229, 122,  81, 138,  73, 157]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
252         1       78       5       253
311         2       78       4        39
630         3       78       3        85
1085        4       78       4       267
1321        5       78       4       230
       user_id  item_id  rating  timestep
12290       46       78       3         6
12727       47       78       3       170
12855       48       78       4        25
13256       49       78       4       153
13543       50       78       3       167
average_rating for this rec across 50 users from same group (less noisy) was: 3.74
all_actions shape just before sample torch.Size([1, 16, 1])
action scaled by temperature: tensor([[230]], device='cuda:0')
action picked by argmax: tensor([230], device='cuda:0')
tensor([[230,  91, 138,  81,  39, 256, 104, 107,  67, 145]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
269         1      231       5       270
359         2      231       5        87
633         3      231       4        88
967         4      231       5       149
1184        5      231       4        93
       user_id  item_id  rating  timestep
12505       46      231       5       221
12658       47      231       5       101
12987       48      231       4       157
13341       49      231       5       238
13428       50      231       5        52
average_rating for this rec across 50 users from same group (less noisy) was: 4.6
all_actions shape just before sample torch.Size([1, 17, 1])
action scaled by temperature: tensor([[91]], device='cuda:0')
action picked by argmax: tensor([91], device='cuda:0')
tensor([[ 91,  47, 138, 107,  81,  39, 212, 230, 133, 154]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
114         1       92       5       115
426         2       92       5       154
610         3       92       5        65
955         4       92       5       137
1202        5       92       5       111
       user_id  item_id  rating  timestep
12453       46       92       5       169
12616       47       92       4        59
12924       48       92       5        94
13280       49       92       4       177
13440       50       92       5        64
average_rating for this rec across 50 users from same group (less noisy) was: 4.64
all_actions shape just before sample torch.Size([1, 18, 1])
action scaled by temperature: tensor([[47]], device='cuda:0')
action picked by argmax: tensor([47], device='cuda:0')
tensor([[ 47, 138,  91, 244, 140, 115, 110, 154, 212, 235]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
104         1       48       5       105
471         2       48       5       199
567         3       48       4        22
888         4       48       4        70
1155        5       48       4        64
       user_id  item_id  rating  timestep
12362       46       48       5        78
12710       47       48       4       153
12898       48       48       5        68
13180       49       48       4        77
13648       50       48       4       272
average_rating for this rec across 50 users from same group (less noisy) was: 4.08
all_actions shape just before sample torch.Size([1, 19, 1])
action scaled by temperature: tensor([[138]], device='cuda:0')
action picked by argmax: tensor([138], device='cuda:0')
tensor([[138,  81, 110, 212, 140, 115,  91, 235,  32,  39]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
224         1      139       3       225
317         2      139       4        45
767         3      139       4       222
1084        4      139       4       266
1305        5      139       5       214
       user_id  item_id  rating  timestep
12333       46      139       3        49
12662       47      139       2       105
12900       48      139       3        70
13303       49      139       5       200
13591       50      139       4       215
average_rating for this rec across 50 users from same group (less noisy) was: 4.02
all_actions shape just before sample torch.Size([1, 20, 1])
action scaled by temperature: tensor([[241]], device='cuda:0')
action picked by argmax: tensor([241], device='cuda:0')
tensor([[241, 165,  14,  11,  75, 256, 220,  19,  61,  42]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
210         1      242       5       211
333         2      242       5        61
602         3      242       4        57
975         4      242       2       157
1297        5      242       5       206
       user_id  item_id  rating  timestep
12442       46      242       4       158
12609       47      242       4        52
13081       48      242       5       251
13312       49      242       5       209
13628       50      242       5       252
average_rating for this rec across 50 users from same group (less noisy) was: 4.08
all_actions shape just before sample torch.Size([1, 21, 1])
action scaled by temperature: tensor([[146]], device='cuda:0')
action picked by argmax: tensor([146], device='cuda:0')
tensor([[146, 165,  11, 258,  75, 156, 158,  49, 228,  36]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
97          1      147       4        98
492         2      147       4       220
612         3      147       4        67
897         4      147       3        79
1350        5      147       5       259
       user_id  item_id  rating  timestep
12336       46      147       5        52
12647       47      147       4        90
12962       48      147       4       132
13367       49      147       4       264
13443       50      147       5        67
average_rating for this rec across 50 users from same group (less noisy) was: 4.24
all_actions shape just before sample torch.Size([1, 22, 1])
action scaled by temperature: tensor([[165]], device='cuda:0')
action picked by argmax: tensor([165], device='cuda:0')
tensor([[165, 146,  11, 156,  42, 147, 258, 194, 158,  75]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
92          1      166       5        93
327         2      166       4        55
664         3      166       5       119
1004        4      166       4       186
1172        5      166       4        81
       user_id  item_id  rating  timestep
12428       46      166       5       144
12711       47      166       5       154
12888       48      166       5        58
13340       49      166       3       237
13508       50      166       4       132
average_rating for this rec across 50 users from same group (less noisy) was: 4.34
all_actions shape just before sample torch.Size([1, 23, 1])
action scaled by temperature: tensor([[220]], device='cuda:0')
action picked by argmax: tensor([220], device='cuda:0')
tensor([[220,  20,  16,  11,  12, 257,  42, 228, 194, 169]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
225         1      221       4       226
380         2      221       4       108
549         3      221       4         4
854         4      221       4        36
1188        5      221       5        97
       user_id  item_id  rating  timestep
12421       46      221       3       137
12641       47      221       4        84
13072       48      221       4       242
13351       49      221       5       248
13455       50      221       4        79
average_rating for this rec across 50 users from same group (less noisy) was: 4.16
all_actions shape just before sample torch.Size([1, 24, 1])
action scaled by temperature: tensor([[16]], device='cuda:0')
action picked by argmax: tensor([16], device='cuda:0')
tensor([[ 16,  84, 228, 110, 145, 262,  20, 153, 133, 166]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
212         1       17       3       213
385         2       17       4       113
660         3       17       3       115
942         4       17       2       124
1254        5       17       3       163
       user_id  item_id  rating  timestep
12537       46       17       4       253
12612       47       17       2        55
13052       48       17       4       222
13171       49       17       3        68
13534       50       17       3       158
average_rating for this rec across 50 users from same group (less noisy) was: 3.22
all_actions shape just before sample torch.Size([1, 25, 1])
action scaled by temperature: tensor([[84]], device='cuda:0')
action picked by argmax: tensor([84], device='cuda:0')
tensor([[ 84,  16, 228,  36, 262,  20, 143,  38,  88,  18]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
238         1       85       4       239
289         2       85       5        17
802         3       85       4       257
1069        4       85       5       251
1306        5       85       5       215
       user_id  item_id  rating  timestep
12403       46       85       3       119
12623       47       85       5        66
13082       48       85       4       252
13218       49       85       5       115
13630       50       85       4       254
average_rating for this rec across 50 users from same group (less noisy) was: 3.82
all_actions shape just before sample torch.Size([1, 26, 1])
action scaled by temperature: tensor([[228]], device='cuda:0')
action picked by argmax: tensor([228], device='cuda:0')
tensor([[228, 242, 182, 140,  38, 265, 252,  51, 109,  11]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
10          1      229       5        11
339         2      229       4        67
731         3      229       4       186
831         4      229       4        13
1129        5      229       4        38
       user_id  item_id  rating  timestep
12527       46      229       5       243
12747       47      229       5       190
12891       48      229       4        61
13281       49      229       5       178
13513       50      229       4       137
average_rating for this rec across 50 users from same group (less noisy) was: 4.32
all_actions shape just before sample torch.Size([1, 27, 1])
action scaled by temperature: tensor([[242]], device='cuda:0')
action picked by argmax: tensor([242], device='cuda:0')
tensor([[242, 228,  36, 265,  38,  31,   9, 182, 177,  42]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
236         1      243       4       237
365         2      243       5        93
703         3      243       5       158
1014        4      243       4       196
1106        5      243       5        15
       user_id  item_id  rating  timestep
12544       46      243       4       260
12745       47      243       4       188
13024       48      243       2       194
13154       49      243       3        51
13427       50      243       4        51
average_rating for this rec across 50 users from same group (less noisy) was: 3.8
all_actions shape just before sample torch.Size([1, 28, 1])
action scaled by temperature: tensor([[223]], device='cuda:0')
action picked by argmax: tensor([223], device='cuda:0')
tensor([[223, 230,  42,  83,  31, 235, 118,  91,  98, 241]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
194         1      224       4       195
511         2      224       4       239
726         3      224       5       181
861         4      224       4        43
1145        5      224       5        54
       user_id  item_id  rating  timestep
12371       46      224       5        87
12578       47      224       5        21
12946       48      224       4       116
13334       49      224       5       231
13417       50      224       4        41
average_rating for this rec across 50 users from same group (less noisy) was: 4.4
all_actions shape just before sample torch.Size([1, 29, 1])
action scaled by temperature: tensor([[157]], device='cuda:0')
action picked by argmax: tensor([157], device='cuda:0')
tensor([[157, 223, 234,   7, 230, 178,  69,  63, 241, 254]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
156         1      158       4       157
496         2      158       5       224
798         3      158       4       253
1015        4      158       4       197
1351        5      158       4       260
       user_id  item_id  rating  timestep
12457       46      158       4       173
12809       47      158       5       252
13046       48      158       5       216
13322       49      158       3       219
13399       50      158       5        23
average_rating for this rec across 50 users from same group (less noisy) was: 4.42
all_actions shape just before sample torch.Size([1, 30, 1])
action scaled by temperature: tensor([[261]], device='cuda:0')
action picked by argmax: tensor([261], device='cuda:0')
tensor([[261,   0, 268, 209, 145, 123,  62, 230,  46,  52]], device='cuda:0')
Just recommended 30 new items to 50 users from group 1 and the total rating was 120.89999999999998
train_loss is: 1.4262968900541193
action scaled by temperature: tensor([[167]], device='cuda:0')
action picked by argmax: tensor([27], device='cuda:0')
tensor([[ 27, 148, 209,  71,  19, 158, 180, 222,  10,  26]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
0           1       28       4         1
294         2       28       4        22
736         3       28       5       191
1051        4       28       5       233
1244        5       28       3       153
       user_id  item_id  rating  timestep
12297       46       28       3        13
12763       47       28       4       206
13040       48       28       5       210
13309       49       28       5       206
13583       50       28       5       207
average_rating for this rec across 50 users from same group (less noisy) was: 4.3
all_actions shape just before sample torch.Size([1, 1, 1])
action scaled by temperature: tensor([[93]], device='cuda:0')
action picked by argmax: tensor([209], device='cuda:0')
tensor([[209,  75,  15, 103, 143, 148,  51,   9,  66, 140]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
60          1      210       5        61
336         2      210       4        64
564         3      210       3        19
916         4      210       2        98
1118        5      210       5        27
       user_id  item_id  rating  timestep
12528       46      210       4       244
12569       47      210       4        12
12854       48      210       3        24
13288       49      210       4       185
13535       50      210       5       159
average_rating for this rec across 50 users from same group (less noisy) was: 3.94
all_actions shape just before sample torch.Size([1, 2, 1])
action scaled by temperature: tensor([[119]], device='cuda:0')
action picked by argmax: tensor([71], device='cuda:0')
tensor([[ 71,  33,  52,  82, 272, 235, 252,  16, 134, 156]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
160         1       72       5       161
343         2       72       4        71
807         3       72       4       262
943         4       72       4       125
1141        5       72       4        50
       user_id  item_id  rating  timestep
12332       46       72       4        48
12696       47       72       3       139
12994       48       72       4       164
13136       49       72       5        33
13486       50       72       4       110
average_rating for this rec across 50 users from same group (less noisy) was: 4.0
all_actions shape just before sample torch.Size([1, 3, 1])
action scaled by temperature: tensor([[241]], device='cuda:0')
action picked by argmax: tensor([131], device='cuda:0')
tensor([[131,   6, 120,  46, 207, 215,  12, 260,  77, 137]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
157         1      132       5       158
519         2      132       4       247
574         3      132       5        29
1061        4      132       3       243
1323        5      132       4       232
       user_id  item_id  rating  timestep
12481       46      132       4       197
12692       47      132       4       135
12997       48      132       4       167
13321       49      132       5       218
13606       50      132       4       230
average_rating for this rec across 50 users from same group (less noisy) was: 4.42
all_actions shape just before sample torch.Size([1, 4, 1])
action scaled by temperature: tensor([[12]], device='cuda:0')
action picked by argmax: tensor([6], device='cuda:0')
tensor([[  6, 106, 236,  20,  77,  17,  46, 258, 246, 136]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
82          1        7       4        83
388         2        7       4       116
811         3        7       4       266
990         4        7       4       172
1154        5        7       3        63
       user_id  item_id  rating  timestep
12491       46        7       3       207
12722       47        7       4       165
13002       48        7       5       172
13104       49        7       4         1
13378       50        7       5         2
average_rating for this rec across 50 users from same group (less noisy) was: 3.68
all_actions shape just before sample torch.Size([1, 5, 1])
action scaled by temperature: tensor([[136]], device='cuda:0')
action picked by argmax: tensor([136], device='cuda:0')
tensor([[136, 126, 199, 236, 192, 176,  87,  47, 203, 258]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
272         1      137       4       273
451         2      137       3       179
595         3      137       5        50
1017        4      137       4       199
1298        5      137       4       207
       user_id  item_id  rating  timestep
12307       46      137       4        23
12565       47      137       4         8
12961       48      137       4       131
13254       49      137       3       151
13529       50      137       4       153
average_rating for this rec across 50 users from same group (less noisy) was: 3.76
all_actions shape just before sample torch.Size([1, 6, 1])
action scaled by temperature: tensor([[237]], device='cuda:0')
action picked by argmax: tensor([237], device='cuda:0')
tensor([[237,  80,  67, 200, 190,   6, 267, 203, 126, 241]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
228         1      238       4       229
475         2      238       3       203
719         3      238       3       174
860         4      238       5        42
1166        5      238       5        75
       user_id  item_id  rating  timestep
12462       46      238       3       178
12618       47      238       4        61
13000       48      238       5       170
13192       49      238       3        89
13431       50      238       5        55
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 7, 1])
action scaled by temperature: tensor([[109]], device='cuda:0')
action picked by argmax: tensor([109], device='cuda:0')
tensor([[109, 190,  80, 201, 200, 270, 241,  91,  54, 106]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
132         1      110       4       133
472         2      110       5       200
687         3      110       5       142
910         4      110       5        92
1217        5      110       4       126
       user_id  item_id  rating  timestep
12408       46      110       5       124
12729       47      110       5       172
12956       48      110       5       126
13369       49      110       5       266
13458       50      110       5        82
average_rating for this rec across 50 users from same group (less noisy) was: 4.66
all_actions shape just before sample torch.Size([1, 8, 1])
action scaled by temperature: tensor([[241]], device='cuda:0')
action picked by argmax: tensor([241], device='cuda:0')
tensor([[241,  18, 172, 141, 188, 203, 200, 215,  54,  25]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
210         1      242       5       211
333         2      242       5        61
602         3      242       4        57
975         4      242       2       157
1297        5      242       5       206
       user_id  item_id  rating  timestep
12442       46      242       4       158
12609       47      242       4        52
13081       48      242       5       251
13312       49      242       5       209
13628       50      242       5       252
average_rating for this rec across 50 users from same group (less noisy) was: 4.08
all_actions shape just before sample torch.Size([1, 9, 1])
action scaled by temperature: tensor([[149]], device='cuda:0')
action picked by argmax: tensor([149], device='cuda:0')
tensor([[149, 237, 208,  61, 267, 144,  80,  83, 222, 176]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
59          1      150       4        60
274         2      150       1         2
792         3      150       3       247
952         4      150       4       134
1175        5      150       3        84
       user_id  item_id  rating  timestep
12343       46      150       3        59
12750       47      150       3       193
13050       48      150       2       220
13125       49      150       2        22
13522       50      150       4       146
average_rating for this rec across 50 users from same group (less noisy) was: 3.26
all_actions shape just before sample torch.Size([1, 10, 1])
action scaled by temperature: tensor([[90]], device='cuda:0')
action picked by argmax: tensor([90], device='cuda:0')
tensor([[ 90,  35,  77, 149, 134, 176,  83,  80,  52, 130]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
26          1       91       4        27
452         2       91       4       180
580         3       91       2        35
982         4       91       3       164
1198        5       91       4       107
       user_id  item_id  rating  timestep
12411       46       91       3       127
12568       47       91       4        11
13005       48       91       5       175
13291       49       91       5       188
13603       50       91       5       227
average_rating for this rec across 50 users from same group (less noisy) was: 3.9
all_actions shape just before sample torch.Size([1, 11, 1])
action scaled by temperature: tensor([[69]], device='cuda:0')
action picked by argmax: tensor([69], device='cuda:0')
tensor([[ 69,  97, 204, 230,  40,  27, 136,   1,  96, 111]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
72          1       70       4        73
282         2       70       2        10
591         3       70       5        46
949         4       70       3       131
1329        5       70       3       238
       user_id  item_id  rating  timestep
12414       46       70       5       130
12691       47       70       4       134
12894       48       70       5        64
13323       49       70       5       220
13404       50       70       4        28
average_rating for this rec across 50 users from same group (less noisy) was: 4.08
all_actions shape just before sample torch.Size([1, 12, 1])
action scaled by temperature: tensor([[96]], device='cuda:0')
action picked by argmax: tensor([96], device='cuda:0')
tensor([[ 96,  27,  69,  66,  71, 254,  40, 209, 205, 137]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
46          1       97       5        47
363         2       97       4        91
656         3       97       5       111
1059        4       97       4       241
1138        5       97       5        47
       user_id  item_id  rating  timestep
12431       46       97       5       147
12715       47       97       5       158
12880       48       97       5        50
13198       49       97       5        95
13414       50       97       4        38
average_rating for this rec across 50 users from same group (less noisy) was: 4.5
all_actions shape just before sample torch.Size([1, 13, 1])
action scaled by temperature: tensor([[40]], device='cuda:0')
action picked by argmax: tensor([40], device='cuda:0')
tensor([[ 40,  27, 121, 139, 235,  96, 237, 145,  58,  92]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
66          1       41       4        67
353         2       41       5        81
756         3       41       3       211
1060        4       41       2       242
1343        5       41       3       252
       user_id  item_id  rating  timestep
12376       46       41       3        92
12615       47       41       3        58
12882       48       41       3        52
13156       49       41       5        53
13485       50       41       4       109
average_rating for this rec across 50 users from same group (less noisy) was: 3.66
all_actions shape just before sample torch.Size([1, 14, 1])
action scaled by temperature: tensor([[58]], device='cuda:0')
action picked by argmax: tensor([58], device='cuda:0')
tensor([[ 58, 235,  69,  27, 268,  96, 237, 265,  97, 156]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
40          1       59       4        41
309         2       59       4        37
622         3       59       4        77
1063        4       59       3       245
1144        5       59       4        53
       user_id  item_id  rating  timestep
12484       46       59       4       200
12757       47       59       4       200
12968       48       59       4       138
13243       49       59       4       140
13594       50       59       4       218
average_rating for this rec across 50 users from same group (less noisy) was: 4.16
all_actions shape just before sample torch.Size([1, 15, 1])
action scaled by temperature: tensor([[160]], device='cuda:0')
action picked by argmax: tensor([235], device='cuda:0')
tensor([[235,  58, 109,  69, 268,  88, 139,  27, 201, 250]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
57          1      236       5        58
392         2      236       4       120
770         3      236       4       225
825         4      236       5         7
1151        5      236       4        60
       user_id  item_id  rating  timestep
12321       46      236       3        37
12669       47      236       5       112
12940       48      236       3       110
13113       49      236       4        10
13638       50      236       3       262
average_rating for this rec across 50 users from same group (less noisy) was: 4.26
all_actions shape just before sample torch.Size([1, 16, 1])
action scaled by temperature: tensor([[268]], device='cuda:0')
action picked by argmax: tensor([268], device='cuda:0')
tensor([[268,  58, 139, 120,  97, 235,  99,  96, 205, 133]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
146         1      269       5       147
338         2      269       4        66
695         3      269       5       150
1049        4      269       5       231
1295        5      269       4       204
       user_id  item_id  rating  timestep
12474       46      269       4       190
12685       47      269       5       128
13091       48      269       4       261
13338       49      269       4       235
13558       50      269       5       182
average_rating for this rec across 50 users from same group (less noisy) was: 4.12
all_actions shape just before sample torch.Size([1, 17, 1])
action scaled by temperature: tensor([[120]], device='cuda:0')
action picked by argmax: tensor([120], device='cuda:0')
tensor([[120, 220, 235,  68, 268, 211, 198,  40, 201, 121]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
140         1      121       4       141
340         2      121       4        68
548         3      121       4         3
1028        4      121       4       210
1324        5      121       4       233
       user_id  item_id  rating  timestep
12449       46      121       3       165
12767       47      121       4       210
13025       48      121       4       195
13269       49      121       4       166
13383       50      121       4         7
average_rating for this rec across 50 users from same group (less noisy) was: 4.02
all_actions shape just before sample torch.Size([1, 18, 1])
action scaled by temperature: tensor([[220]], device='cuda:0')
action picked by argmax: tensor([220], device='cuda:0')
tensor([[220,  67, 235, 160, 120, 198,  48, 167,  19, 124]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
225         1      221       4       226
380         2      221       4       108
549         3      221       4         4
854         4      221       4        36
1188        5      221       5        97
       user_id  item_id  rating  timestep
12421       46      221       3       137
12641       47      221       4        84
13072       48      221       4       242
13351       49      221       5       248
13455       50      221       4        79
average_rating for this rec across 50 users from same group (less noisy) was: 4.16
all_actions shape just before sample torch.Size([1, 19, 1])
action scaled by temperature: tensor([[67]], device='cuda:0')
action picked by argmax: tensor([67], device='cuda:0')
tensor([[ 67,  39, 204, 124, 167, 232,  48,  37, 160, 187]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
191         1       68       3       192
351         2       68       2        79
623         3       68       4        78
866         4       68       5        48
1237        5       68       3       146
       user_id  item_id  rating  timestep
12499       46       68       3       215
12639       47       68       5        82
13060       48       68       4       230
13114       49       68       3        11
13452       50       68       5        76
average_rating for this rec across 50 users from same group (less noisy) was: 3.82
all_actions shape just before sample torch.Size([1, 20, 1])
action scaled by temperature: tensor([[133]], device='cuda:0')
action picked by argmax: tensor([133], device='cuda:0')
tensor([[133, 198,  36, 263, 184, 262,  96, 268, 250,  81]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
247         1      134       3       248
412         2      134       4       140
728         3      134       3       183
1048        4      134       4       230
1308        5      134       4       217
       user_id  item_id  rating  timestep
12383       46      134       4        99
12702       47      134       5       145
12872       48      134       4        42
13298       49      134       5       195
13645       50      134       5       269
average_rating for this rec across 50 users from same group (less noisy) was: 4.32
all_actions shape just before sample torch.Size([1, 21, 1])
action scaled by temperature: tensor([[198]], device='cuda:0')
action picked by argmax: tensor([198], device='cuda:0')
tensor([[198,  36, 185, 259, 183, 133, 181, 264, 184,  34]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
154         1      199       4       155
273         2      199       4         1
713         3      199       4       168
843         4      199       3        25
1279        5      199       4       188
       user_id  item_id  rating  timestep
12476       46      199       4       192
12664       47      199       4       107
13090       48      199       5       260
13349       49      199       5       246
13402       50      199       4        26
average_rating for this rec across 50 users from same group (less noisy) was: 4.1
all_actions shape just before sample torch.Size([1, 22, 1])
action scaled by temperature: tensor([[34]], device='cuda:0')
action picked by argmax: tensor([34], device='cuda:0')
tensor([[ 34, 264, 181, 217, 133, 182,  75,   9, 108, 142]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
171         1       35       3       172
523         2       35       4       251
764         3       35       5       219
839         4       35       3        21
1224        5       35       4       133
       user_id  item_id  rating  timestep
12498       46       35       3       214
12701       47       35       4       144
13023       48       35       2       193
13159       49       35       4        56
13622       50       35       4       246
average_rating for this rec across 50 users from same group (less noisy) was: 4.04
all_actions shape just before sample torch.Size([1, 23, 1])
action scaled by temperature: tensor([[254]], device='cuda:0')
action picked by argmax: tensor([254], device='cuda:0')
tensor([[254,  93, 109,  84, 270,   9,   5, 103,  85,  15]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
153         1      255       5       154
544         2      255       5       272
618         3      255       4        73
989         4      255       5       171
1214        5      255       4       123
       user_id  item_id  rating  timestep
12365       46      255       5        81
12724       47      255       4       167
12933       48      255       4       103
13227       49      255       3       124
13601       50      255       3       225
average_rating for this rec across 50 users from same group (less noisy) was: 4.5
all_actions shape just before sample torch.Size([1, 24, 1])
action scaled by temperature: tensor([[155]], device='cuda:0')
action picked by argmax: tensor([155], device='cuda:0')
tensor([[155, 219,  84, 158,  16, 126, 165,  25, 151,  39]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
88          1      156       5        89
478         2      156       3       206
606         3      156       2        61
898         4      156       3        80
1283        5      156       3       192
       user_id  item_id  rating  timestep
12518       46      156       3       234
12830       47      156       5       273
12853       48      156       4        23
13361       49      156       3       258
13438       50      156       4        62
average_rating for this rec across 50 users from same group (less noisy) was: 3.52
all_actions shape just before sample torch.Size([1, 25, 1])
action scaled by temperature: tensor([[219]], device='cuda:0')
action picked by argmax: tensor([219], device='cuda:0')
tensor([[219, 155,  84, 158,  16, 110, 216, 127, 149, 107]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
220         1      220       4       221
495         2      220       5       223
814         3      220       5       269
859         4      220       4        41
1178        5      220       5        87
       user_id  item_id  rating  timestep
12313       46      220       5        29
12606       47      220       4        49
13022       48      220       4       192
13347       49      220       4       244
13521       50      220       5       145
average_rating for this rec across 50 users from same group (less noisy) was: 4.4
all_actions shape just before sample torch.Size([1, 26, 1])
action scaled by temperature: tensor([[84]], device='cuda:0')
action picked by argmax: tensor([84], device='cuda:0')
tensor([[ 84,  25, 158, 155, 236,  38, 199,  13, 107, 248]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
238         1       85       4       239
289         2       85       5        17
802         3       85       4       257
1069        4       85       5       251
1306        5       85       5       215
       user_id  item_id  rating  timestep
12403       46       85       3       119
12623       47       85       5        66
13082       48       85       4       252
13218       49       85       5       115
13630       50       85       4       254
average_rating for this rec across 50 users from same group (less noisy) was: 3.82
all_actions shape just before sample torch.Size([1, 27, 1])
action scaled by temperature: tensor([[25]], device='cuda:0')
action picked by argmax: tensor([25], device='cuda:0')
tensor([[ 25, 158,  84, 155,  55, 236,  38, 248,  22,  58]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
134         1       26       4       135
413         2       26       3       141
576         3       26       5        31
1087        4       26       5       269
1287        5       26       3       196
       user_id  item_id  rating  timestep
12487       46       26       5       203
12611       47       26       5        54
12983       48       26       5       153
13149       49       26       5        46
13625       50       26       4       249
average_rating for this rec across 50 users from same group (less noisy) was: 4.36
all_actions shape just before sample torch.Size([1, 28, 1])
action scaled by temperature: tensor([[55]], device='cuda:0')
action picked by argmax: tensor([55], device='cuda:0')
tensor([[ 55, 236, 158,  25, 219,  16, 126, 127, 186,  38]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
17          1       56       4        18
500         2       56       4       228
617         3       56       3        72
1080        4       56       4       262
1108        5       56       5        17
       user_id  item_id  rating  timestep
12459       46       56       5       175
12782       47       56       4       225
13071       48       56       4       241
13174       49       56       3        71
13516       50       56       5       140
average_rating for this rec across 50 users from same group (less noisy) was: 4.14
all_actions shape just before sample torch.Size([1, 29, 1])
action scaled by temperature: tensor([[158]], device='cuda:0')
action picked by argmax: tensor([158], device='cuda:0')
tensor([[158, 186,  84, 126, 181,  53, 231,  38, 149,  25]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
129         1      159       3       130
480         2      159       3       208
579         3      159       3        34
1057        4      159       3       239
1270        5      159       2       179
       user_id  item_id  rating  timestep
12525       46      159       5       241
12736       47      159       4       179
12973       48      159       5       143
13326       49      159       4       223
13490       50      159       4       114
average_rating for this rec across 50 users from same group (less noisy) was: 3.6
all_actions shape just before sample torch.Size([1, 30, 1])
action scaled by temperature: tensor([[78]], device='cuda:0')
action picked by argmax: tensor([78], device='cuda:0')
tensor([[ 78,  84, 248, 102, 199,   8,   9, 196, 167, 228]], device='cuda:0')
Just recommended 30 new items to 50 users from group 1 and the total rating was 121.63999999999999
train_loss is: 1.2623871194717546
action scaled by temperature: tensor([[223]], device='cuda:0')
action picked by argmax: tensor([28], device='cuda:0')
tensor([[ 28,  85, 129, 160, 137, 227, 237, 187, 178,  40]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
189         1       29       4       190
450         2       29       3       178
625         3       29       2        80
908         4       29       4        90
1359        5       29       3       268
       user_id  item_id  rating  timestep
12424       46       29       3       140
12661       47       29       4       104
12989       48       29       4       159
13239       49       29       3       136
13445       50       29       3        69
average_rating for this rec across 50 users from same group (less noisy) was: 3.58
all_actions shape just before sample torch.Size([1, 1, 1])
action scaled by temperature: tensor([[79]], device='cuda:0')
action picked by argmax: tensor([79], device='cuda:0')
tensor([[ 79,  29, 223,  61, 215, 172,  26, 135, 111, 178]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
8           1       80       5         9
329         2       80       2        57
692         3       80       4       147
822         4       80       4         4
1139        5       80       4        48
       user_id  item_id  rating  timestep
12426       46       80       5       142
12655       47       80       4        98
12995       48       80       3       165
13236       49       80       4       133
13550       50       80       5       174
average_rating for this rec across 50 users from same group (less noisy) was: 4.14
all_actions shape just before sample torch.Size([1, 2, 1])
action scaled by temperature: tensor([[214]], device='cuda:0')
action picked by argmax: tensor([94], device='cuda:0')
tensor([[ 94,  37,  56, 211,  64,  40,  29,  36, 228, 102]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
162         1       95       3       163
474         2       95       5       202
762         3       95       5       217
978         4       95       4       160
1355        5       95       3       264
       user_id  item_id  rating  timestep
12350       46       95       3        66
12800       47       95       4       243
12918       48       95       4        88
13240       49       95       4       137
13581       50       95       5       205
average_rating for this rec across 50 users from same group (less noisy) was: 3.76
all_actions shape just before sample torch.Size([1, 3, 1])
action scaled by temperature: tensor([[271]], device='cuda:0')
action picked by argmax: tensor([271], device='cuda:0')
tensor([[271, 199,  86,  73, 179, 156,  56,  64,   0, 228]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
257         1      272       5       258
321         2      272       4        49
560         3      272       2        15
924         4      272       4       106
1104        5      272       4        13
       user_id  item_id  rating  timestep
12319       46      272       4        35
12604       47      272       2        47
12959       48      272       3       129
13108       49      272       5         5
13600       50      272       2       224
average_rating for this rec across 50 users from same group (less noisy) was: 3.64
all_actions shape just before sample torch.Size([1, 4, 1])
action scaled by temperature: tensor([[85]], device='cuda:0')
action picked by argmax: tensor([196], device='cuda:0')
tensor([[196,  85, 250, 160, 253,  52, 203, 271, 121,  72]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
98          1      197       3        99
369         2      197       4        97
729         3      197       3       184
867         4      197       5        49
1109        5      197       4        18
       user_id  item_id  rating  timestep
12311       46      197       2        27
12645       47      197       4        88
13014       48      197       3       184
13119       49      197       1        16
13636       50      197       3       260
average_rating for this rec across 50 users from same group (less noisy) was: 3.28
all_actions shape just before sample torch.Size([1, 5, 1])
action scaled by temperature: tensor([[85]], device='cuda:0')
action picked by argmax: tensor([85], device='cuda:0')
tensor([[ 85, 250, 183, 196, 160, 266,   6, 161,  78,  52]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
266         1       86       5       267
509         2       86       5       237
777         3       86       5       232
917         4       86       5        99
1121        5       86       4        30
       user_id  item_id  rating  timestep
12506       46       86       5       222
12600       47       86       5        43
13074       48       86       5       244
13362       49       86       5       259
13397       50       86       5        21
average_rating for this rec across 50 users from same group (less noisy) was: 4.58
all_actions shape just before sample torch.Size([1, 6, 1])
action scaled by temperature: tensor([[152]], device='cuda:0')
action picked by argmax: tensor([152], device='cuda:0')
tensor([[152,  56,   6, 161, 259, 111,  29, 127, 130, 120]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
27          1      153       4        28
428         2      153       1       156
586         3      153       3        41
884         4      153       5        66
1288        5      153       5       197
       user_id  item_id  rating  timestep
12423       46      153       3       139
12632       47      153       4        75
12955       48      153       3       125
13197       49      153       4        94
13405       50      153       4        29
average_rating for this rec across 50 users from same group (less noisy) was: 3.58
all_actions shape just before sample torch.Size([1, 7, 1])
action scaled by temperature: tensor([[56]], device='cuda:0')
action picked by argmax: tensor([56], device='cuda:0')
tensor([[ 56, 207, 187, 133, 219,  57,  24, 106,  73, 264]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
136         1       57       3       137
486         2       57       3       214
624         3       57       5        79
937         4       57       5       119
1128        5       57       5        37
       user_id  item_id  rating  timestep
12472       46       57       5       188
12796       47       57       5       239
12920       48       57       3        90
13311       49       57       3       208
13416       50       57       4        40
average_rating for this rec across 50 users from same group (less noisy) was: 4.14
all_actions shape just before sample torch.Size([1, 8, 1])
action scaled by temperature: tensor([[133]], device='cuda:0')
action picked by argmax: tensor([133], device='cuda:0')
tensor([[133,  74, 210, 165,  24, 214, 269,  88, 250,  46]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
247         1      134       3       248
412         2      134       4       140
728         3      134       3       183
1048        4      134       4       230
1308        5      134       4       217
       user_id  item_id  rating  timestep
12383       46      134       4        99
12702       47      134       5       145
12872       48      134       4        42
13298       49      134       5       195
13645       50      134       5       269
average_rating for this rec across 50 users from same group (less noisy) was: 4.32
all_actions shape just before sample torch.Size([1, 9, 1])
action scaled by temperature: tensor([[88]], device='cuda:0')
action picked by argmax: tensor([88], device='cuda:0')
tensor([[ 88,  25, 176, 245, 165, 172, 116,  53,  67, 153]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
163         1       89       5       164
411         2       89       3       139
725         3       89       3       180
848         4       89       3        30
1215        5       89       3       124
       user_id  item_id  rating  timestep
12396       46       89       3       112
12581       47       89       4        24
12979       48       89       3       149
13286       49       89       2       183
13503       50       89       3       127
average_rating for this rec across 50 users from same group (less noisy) was: 3.38
all_actions shape just before sample torch.Size([1, 10, 1])
action scaled by temperature: tensor([[174]], device='cuda:0')
action picked by argmax: tensor([174], device='cuda:0')
tensor([[174, 224, 203, 133,  57, 259, 120, 187,  20,  88]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
215         1      175       5       216
403         2      175       3       131
698         3      175       5       153
1024        4      175       5       206
1243        5      175       4       152
       user_id  item_id  rating  timestep
12292       46      175       4         8
12752       47      175       4       195
13084       48      175       5       254
13258       49      175       5       155
13595       50      175       4       219
average_rating for this rec across 50 users from same group (less noisy) was: 4.58
all_actions shape just before sample torch.Size([1, 11, 1])
action scaled by temperature: tensor([[171]], device='cuda:0')
action picked by argmax: tensor([171], device='cuda:0')
tensor([[171, 212, 218,  39, 203, 150,  25,  21,  52,  38]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
6           1      172       4         7
376         2      172       4       104
568         3      172       3        23
964         4      172       4       146
1252        5      172       4       161
       user_id  item_id  rating  timestep
12301       46      172       3        17
12572       47      172       4        15
13077       48      172       4       247
13163       49      172       4        60
13546       50      172       3       170
average_rating for this rec across 50 users from same group (less noisy) was: 4.08
all_actions shape just before sample torch.Size([1, 12, 1])
action scaled by temperature: tensor([[150]], device='cuda:0')
action picked by argmax: tensor([150], device='cuda:0')
tensor([[150,  25, 169, 203, 110,  55, 119, 148, 171,  15]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
110         1      151       4       111
405         2      151       3       133
700         3      151       4       155
947         4      151       3       129
1285        5      151       4       194
       user_id  item_id  rating  timestep
12315       46      151       4        31
12694       47      151       2       137
13066       48      151       5       236
13161       49      151       2        58
13520       50      151       4       144
average_rating for this rec across 50 users from same group (less noisy) was: 3.64
all_actions shape just before sample torch.Size([1, 13, 1])
action scaled by temperature: tensor([[203]], device='cuda:0')
action picked by argmax: tensor([203], device='cuda:0')
tensor([[203,  55, 208,  34, 150, 169, 191,  25, 105, 128]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
63          1      204       3        64
400         2      204       3       128
755         3      204       3       210
1045        4      204       4       227
1220        5      204       3       129
       user_id  item_id  rating  timestep
12398       46      204       4       114
12571       47      204       5        14
12977       48      204       3       147
13282       49      204       4       179
13547       50      204       4       171
average_rating for this rec across 50 users from same group (less noisy) was: 3.52
all_actions shape just before sample torch.Size([1, 14, 1])
action scaled by temperature: tensor([[244]], device='cuda:0')
action picked by argmax: tensor([244], device='cuda:0')
tensor([[244, 110,  31, 171,  50, 169,  21,  74, 255, 212]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
244         1      245       3       245
422         2      245       5       150
710         3      245       4       165
980         4      245       2       162
1313        5      245       4       222
       user_id  item_id  rating  timestep
12529       46      245       2       245
12723       47      245       3       166
12986       48      245       3       156
13133       49      245       4        30
13507       50      245       2       131
average_rating for this rec across 50 users from same group (less noisy) was: 3.48
all_actions shape just before sample torch.Size([1, 15, 1])
action scaled by temperature: tensor([[50]], device='cuda:0')
action picked by argmax: tensor([50], device='cuda:0')
tensor([[ 50, 110, 244, 126,  42,  39, 220,  31, 231, 212]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
234         1       51       4       235
498         2       51       3       226
789         3       51       4       244
1040        4       51       4       222
1226        5       51       4       135
       user_id  item_id  rating  timestep
12330       46       51       3        46
12720       47       51       5       163
12981       48       51       3       151
13110       49       51       5         7
13618       50       51       4       242
average_rating for this rec across 50 users from same group (less noisy) was: 3.86
all_actions shape just before sample torch.Size([1, 16, 1])
action scaled by temperature: tensor([[110]], device='cuda:0')
action picked by argmax: tensor([110], device='cuda:0')
tensor([[110, 244, 231,  50,  39,  60,  20, 252,  51, 226]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
45          1      111       3        46
436         2      111       4       164
815         3      111       3       270
940         4      111       2       122
1196        5      111       3       105
       user_id  item_id  rating  timestep
12346       46      111       3        62
12636       47      111       4        79
12867       48      111       4        37
13207       49      111       5       104
13617       50      111       3       241
average_rating for this rec across 50 users from same group (less noisy) was: 3.72
all_actions shape just before sample torch.Size([1, 17, 1])
action scaled by temperature: tensor([[242]], device='cuda:0')
action picked by argmax: tensor([242], device='cuda:0')
tensor([[242, 265,  51, 231, 256,  76, 227,  60, 258, 160]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
236         1      243       4       237
365         2      243       5        93
703         3      243       5       158
1014        4      243       4       196
1106        5      243       5        15
       user_id  item_id  rating  timestep
12544       46      243       4       260
12745       47      243       4       188
13024       48      243       2       194
13154       49      243       3        51
13427       50      243       4        51
average_rating for this rec across 50 users from same group (less noisy) was: 3.8
all_actions shape just before sample torch.Size([1, 18, 1])
action scaled by temperature: tensor([[265]], device='cuda:0')
action picked by argmax: tensor([265], device='cuda:0')
tensor([[265, 242, 252, 235,  14, 189, 208, 269,  73, 206]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
81          1      266       3        82
342         2      266       3        70
793         3      266       4       248
901         4      266       3        83
1113        5      266       4        22
       user_id  item_id  rating  timestep
12394       46      266       5       110
12827       47      266       2       270
12927       48      266       5        97
13151       49      266       4        48
13393       50      266       5        17
average_rating for this rec across 50 users from same group (less noisy) was: 3.82
all_actions shape just before sample torch.Size([1, 19, 1])
action scaled by temperature: tensor([[154]], device='cuda:0')
action picked by argmax: tensor([154], device='cuda:0')
tensor([[154, 255, 233, 214, 180,  73, 106,  51,  69,  59]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
249         1      155       5       250
345         2      155       2        73
697         3      155       4       152
819         4      155       4         1
1100        5      155       3         9
       user_id  item_id  rating  timestep
12437       46      155       2       153
12774       47      155       4       217
13033       48      155       3       203
13343       49      155       4       240
13482       50      155       3       106
average_rating for this rec across 50 users from same group (less noisy) was: 3.44
all_actions shape just before sample torch.Size([1, 20, 1])
action scaled by temperature: tensor([[214]], device='cuda:0')
action picked by argmax: tensor([214], device='cuda:0')
tensor([[214, 244,  61,  47, 233,  69,  83, 154, 180, 235]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
51          1      215       4        52
503         2      215       4       231
773         3      215       5       228
1002        4      215       4       184
1312        5      215       5       221
       user_id  item_id  rating  timestep
12436       46      215       3       152
12637       47      215       4        80
12844       48      215       4        14
13199       49      215       4        96
13475       50      215       4        99
average_rating for this rec across 50 users from same group (less noisy) was: 4.08
all_actions shape just before sample torch.Size([1, 21, 1])
action scaled by temperature: tensor([[61]], device='cuda:0')
action picked by argmax: tensor([61], device='cuda:0')
tensor([[ 61, 233, 183, 244, 255, 247, 180, 258,  93,  38]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
30          1       62       5        31
312         2       62       4        40
601         3       62       5        56
972         4       62       5       154
1216        5       62       4       125
       user_id  item_id  rating  timestep
12507       46       62       5       223
12631       47       62       5        74
12897       48       62       5        67
13296       49       62       4       193
13527       50       62       5       151
average_rating for this rec across 50 users from same group (less noisy) was: 4.76
all_actions shape just before sample torch.Size([1, 22, 1])
action scaled by temperature: tensor([[155]], device='cuda:0')
action picked by argmax: tensor([155], device='cuda:0')
tensor([[155, 211, 178, 254, 184,  17, 216,  61, 111, 247]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
88          1      156       5        89
478         2      156       3       206
606         3      156       2        61
898         4      156       3        80
1283        5      156       3       192
       user_id  item_id  rating  timestep
12518       46      156       3       234
12830       47      156       5       273
12853       48      156       4        23
13361       49      156       3       258
13438       50      156       4        62
average_rating for this rec across 50 users from same group (less noisy) was: 3.52
all_actions shape just before sample torch.Size([1, 23, 1])
action scaled by temperature: tensor([[178]], device='cuda:0')
action picked by argmax: tensor([178], device='cuda:0')
tensor([[178, 247, 137,  14, 161, 107,  52,  54,  91, 106]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
176         1      179       4       177
372         2      179       5       100
551         3      179       5         6
821         4      179       4         3
1183        5      179       4        92
       user_id  item_id  rating  timestep
12511       46      179       4       227
12697       47      179       5       140
12871       48      179       5        41
13208       49      179       5       105
13632       50      179       4       256
average_rating for this rec across 50 users from same group (less noisy) was: 4.48
all_actions shape just before sample torch.Size([1, 24, 1])
action scaled by temperature: tensor([[107]], device='cuda:0')
action picked by argmax: tensor([107], device='cuda:0')
tensor([[107, 254, 139, 155, 178,   6, 111,  77,  83, 174]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
137         1      108       4       138
320         2      108       5        48
555         3      108       5        10
1033        4      108       4       215
1304        5      108       4       213
       user_id  item_id  rating  timestep
12385       46      108       5       101
12814       47      108       4       257
12864       48      108       5        34
13276       49      108       4       173
13592       50      108       5       216
average_rating for this rec across 50 users from same group (less noisy) was: 4.4
all_actions shape just before sample torch.Size([1, 25, 1])
action scaled by temperature: tensor([[254]], device='cuda:0')
action picked by argmax: tensor([254], device='cuda:0')
tensor([[254,  93, 139, 155, 243,  77, 137,  43, 245, 259]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
153         1      255       5       154
544         2      255       5       272
618         3      255       4        73
989         4      255       5       171
1214        5      255       4       123
       user_id  item_id  rating  timestep
12365       46      255       5        81
12724       47      255       4       167
12933       48      255       4       103
13227       49      255       3       124
13601       50      255       3       225
average_rating for this rec across 50 users from same group (less noisy) was: 4.5
all_actions shape just before sample torch.Size([1, 26, 1])
action scaled by temperature: tensor([[243]], device='cuda:0')
action picked by argmax: tensor([243], device='cuda:0')
tensor([[243, 113, 120, 204, 114, 162, 110, 254, 216,  18]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
105         1      244       3       106
335         2      244       4        63
627         3      244       4        82
838         4      244       4        20
1190        5      244       4        99
       user_id  item_id  rating  timestep
12314       46      244       3        30
12617       47      244       4        60
12887       48      244       3        57
13301       49      244       4       198
13579       50      244       3       203
average_rating for this rec across 50 users from same group (less noisy) was: 3.76
all_actions shape just before sample torch.Size([1, 27, 1])
action scaled by temperature: tensor([[113]], device='cuda:0')
action picked by argmax: tensor([113], device='cuda:0')
tensor([[113, 162,  65,  98,  95, 243, 254, 149, 183, 200]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
109         1      114       4       110
324         2      114       3        52
744         3      114       4       199
920         4      114       5       102
1160        5      114       5        69
       user_id  item_id  rating  timestep
12470       46      114       3       186
12608       47      114       4        51
13034       48      114       4       204
13365       49      114       4       262
13593       50      114       5       217
average_rating for this rec across 50 users from same group (less noisy) was: 4.24
all_actions shape just before sample torch.Size([1, 28, 1])
action scaled by temperature: tensor([[65]], device='cuda:0')
action picked by argmax: tensor([65], device='cuda:0')
tensor([[ 65, 170, 261, 217,  82, 216, 231,  15, 136,  98]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
2           1       66       3         3
375         2       66       4       103
809         3       66       4       264
868         4       66       5        50
1281        5       66       5       190
       user_id  item_id  rating  timestep
12455       46       66       4       171
12648       47       66       4        91
12850       48       66       4        20
13268       49       66       4       165
13634       50       66       5       258
average_rating for this rec across 50 users from same group (less noisy) was: 4.08
all_actions shape just before sample torch.Size([1, 29, 1])
action scaled by temperature: tensor([[156]], device='cuda:0')
action picked by argmax: tensor([156], device='cuda:0')
tensor([[156, 160, 166,  93,  83,  47, 120, 181,   9,   1]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
150         1      157       4       151
541         2      157       4       269
705         3      157       3       160
976         4      157       3       158
1105        5      157       4        14
       user_id  item_id  rating  timestep
12378       46      157       4        94
12726       47      157       4       169
12842       48      157       5        12
13320       49      157       3       217
13614       50      157       4       238
average_rating for this rec across 50 users from same group (less noisy) was: 3.96
all_actions shape just before sample torch.Size([1, 30, 1])
action scaled by temperature: tensor([[190]], device='cuda:0')
action picked by argmax: tensor([190], device='cuda:0')
tensor([[190,  57, 169,   3,  25, 206, 152, 223, 156,  75]], device='cuda:0')
Just recommended 30 new items to 50 users from group 1 and the total rating was 118.11999999999999
train_loss is: 1.0656952144892793
action scaled by temperature: tensor([[233]], device='cuda:0')
action picked by argmax: tensor([227], device='cuda:0')
tensor([[227,  40, 211,  13, 129,  24,  52, 265,  54, 228]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
205         1      228       4       206
490         2      228       3       218
663         3      228       3       118
1070        4      228       2       252
1271        5      228       3       180
       user_id  item_id  rating  timestep
12329       46      228       4        45
12703       47      228       3       146
12879       48      228       5        49
13111       49      228       2         8
13530       50      228       4       154
average_rating for this rec across 50 users from same group (less noisy) was: 3.34
all_actions shape just before sample torch.Size([1, 1, 1])
action scaled by temperature: tensor([[23]], device='cuda:0')
action picked by argmax: tensor([254], device='cuda:0')
tensor([[254, 107,  18, 100, 125, 223, 156, 109,  39, 179]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
153         1      255       5       154
544         2      255       5       272
618         3      255       4        73
989         4      255       5       171
1214        5      255       4       123
       user_id  item_id  rating  timestep
12365       46      255       5        81
12724       47      255       4       167
12933       48      255       4       103
13227       49      255       3       124
13601       50      255       3       225
average_rating for this rec across 50 users from same group (less noisy) was: 4.5
all_actions shape just before sample torch.Size([1, 2, 1])
action scaled by temperature: tensor([[229]], device='cuda:0')
action picked by argmax: tensor([126], device='cuda:0')
tensor([[126, 102, 262,  75, 196,  78,  94,   0,  29, 100]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
259         1      127       4       260
517         2      127       5       245
774         3      127       5       229
913         4      127       5        95
1260        5      127       5       169
       user_id  item_id  rating  timestep
12492       46      127       4       208
12802       47      127       5       245
12991       48      127       4       161
13261       49      127       5       158
13448       50      127       5        72
average_rating for this rec across 50 users from same group (less noisy) was: 4.66
all_actions shape just before sample torch.Size([1, 3, 1])
action scaled by temperature: tensor([[100]], device='cuda:0')
action picked by argmax: tensor([100], device='cuda:0')
tensor([[100, 117, 231,  23, 272,  60,  30, 203, 233,  58]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
5           1      101       3         6
322         2      101       4        50
763         3      101       2       218
946         4      101       5       128
1161        5      101       4        70
       user_id  item_id  rating  timestep
12556       46      101       3       272
12579       47      101       4        22
12877       48      101       5        47
13370       49      101       3       267
13597       50      101       5       221
average_rating for this rec across 50 users from same group (less noisy) was: 3.72
all_actions shape just before sample torch.Size([1, 4, 1])
action scaled by temperature: tensor([[59]], device='cuda:0')
action picked by argmax: tensor([59], device='cuda:0')
tensor([[ 59, 199, 158, 194,  77,  57,  71,  30, 103, 224]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
58          1       60       5        59
460         2       60       4       188
689         3       60       4       144
1018        4       60       4       200
1262        5       60       4       171
       user_id  item_id  rating  timestep
12461       46       60       3       177
12587       47       60       3        30
12868       48       60       2        38
13178       49       60       5        75
13649       50       60       3       273
average_rating for this rec across 50 users from same group (less noisy) was: 3.82
all_actions shape just before sample torch.Size([1, 5, 1])
action scaled by temperature: tensor([[148]], device='cuda:0')
action picked by argmax: tensor([148], device='cuda:0')
tensor([[148,  80,  11, 227, 103, 215, 247, 192,  57, 182]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
222         1      149       2       223
489         2      149       4       217
780         3      149       3       235
836         4      149       3        18
1112        5      149       3        21
       user_id  item_id  rating  timestep
12501       46      149       3       217
12704       47      149       3       147
12841       48      149       4        11
13331       49      149       4       228
13494       50      149       4       118
average_rating for this rec across 50 users from same group (less noisy) was: 3.48
all_actions shape just before sample torch.Size([1, 6, 1])
action scaled by temperature: tensor([[182]], device='cuda:0')
action picked by argmax: tensor([182], device='cuda:0')
tensor([[182,  68,  80,  70,  84, 267,  97,  35, 192, 122]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
120         1      183       4       121
286         2      183       3        14
760         3      183       4       215
953         4      183       4       135
1292        5      183       5       201
       user_id  item_id  rating  timestep
12483       46      183       5       199
12707       47      183       4       150
12911       48      183       3        81
13371       49      183       4       268
13473       50      183       4        97
average_rating for this rec across 50 users from same group (less noisy) was: 4.12
all_actions shape just before sample torch.Size([1, 7, 1])
action scaled by temperature: tensor([[177]], device='cuda:0')
action picked by argmax: tensor([177], device='cuda:0')
tensor([[177, 237,  36, 263, 194, 163, 158, 164, 103, 186]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
12          1      178       4        13
535         2      178       4       263
717         3      178       5       172
1062        4      178       4       244
1150        5      178       4        59
       user_id  item_id  rating  timestep
12323       46      178       3        39
12760       47      178       5       203
12878       48      178       4        48
13355       49      178       5       252
13620       50      178       4       244
average_rating for this rec across 50 users from same group (less noisy) was: 4.22
all_actions shape just before sample torch.Size([1, 8, 1])
action scaled by temperature: tensor([[150]], device='cuda:0')
action picked by argmax: tensor([150], device='cuda:0')
tensor([[150, 161, 244,  14, 175,  75, 168,  28, 140,  71]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
110         1      151       4       111
405         2      151       3       133
700         3      151       4       155
947         4      151       3       129
1285        5      151       4       194
       user_id  item_id  rating  timestep
12315       46      151       4        31
12694       47      151       2       137
13066       48      151       5       236
13161       49      151       2        58
13520       50      151       4       144
average_rating for this rec across 50 users from same group (less noisy) was: 3.64
all_actions shape just before sample torch.Size([1, 9, 1])
action scaled by temperature: tensor([[14]], device='cuda:0')
action picked by argmax: tensor([14], device='cuda:0')
tensor([[ 14, 244, 103, 126, 258,  75, 200, 140,  22,  73]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
245         1       15       5       246
419         2       15       5       147
685         3       15       5       140
880         4       15       5        62
1234        5       15       3       143
       user_id  item_id  rating  timestep
12325       46       15       4        41
12584       47       15       5        27
13102       48       15       2       272
13313       49       15       5       210
13413       50       15       3        37
average_rating for this rec across 50 users from same group (less noisy) was: 3.8
all_actions shape just before sample torch.Size([1, 10, 1])
action scaled by temperature: tensor([[103]], device='cuda:0')
action picked by argmax: tensor([103], device='cuda:0')
tensor([[103, 130, 160,  10, 141, 147,  93, 143, 146,  16]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
123         1      104       5       124
396         2      104       5       124
753         3      104       5       208
991         4      104       5       173
1229        5      104       5       138
       user_id  item_id  rating  timestep
12543       46      104       5       259
12779       47      104       5       222
13026       48      104       5       196
13172       49      104       5        69
13479       50      104       5       103
average_rating for this rec across 50 users from same group (less noisy) was: 4.78
all_actions shape just before sample torch.Size([1, 11, 1])
action scaled by temperature: tensor([[147]], device='cuda:0')
action picked by argmax: tensor([147], device='cuda:0')
tensor([[147, 180, 206,  26,  83,  37, 144, 141, 267, 146]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
246         1      148       5       247
493         2      148       3       221
652         3      148       3       107
961         4      148       4       143
1311        5      148       3       220
       user_id  item_id  rating  timestep
12463       46      148       4       179
12766       47      148       4       209
13010       48      148       4       180
13299       49      148       4       196
13532       50      148       3       156
average_rating for this rec across 50 users from same group (less noisy) was: 3.76
all_actions shape just before sample torch.Size([1, 12, 1])
action scaled by temperature: tensor([[267]], device='cuda:0')
action picked by argmax: tensor([267], device='cuda:0')
tensor([[267,  51, 147,  22,  37, 176, 209, 160, 251, 157]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
65          1      268       3        66
300         2      268       5        28
748         3      268       2       203
1023        4      268       3       205
1181        5      268       5        90
       user_id  item_id  rating  timestep
12479       46      268       5       195
12730       47      268       5       173
13051       48      268       2       221
13346       49      268       4       243
13556       50      268       3       180
average_rating for this rec across 50 users from same group (less noisy) was: 3.78
all_actions shape just before sample torch.Size([1, 13, 1])
action scaled by temperature: tensor([[37]], device='cuda:0')
action picked by argmax: tensor([37], device='cuda:0')
tensor([[ 37, 176, 208,  22,  71, 215,  99, 235,  53, 125]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
118         1       38       3       119
455         2       38       2       183
757         3       38       5       212
856         4       38       4        38
1253        5       38       5       162
       user_id  item_id  rating  timestep
12320       46       38       2        36
12622       47       38       3        65
13068       48       38       3       238
13336       49       38       3       233
13466       50       38       5        90
average_rating for this rec across 50 users from same group (less noisy) was: 3.36
all_actions shape just before sample torch.Size([1, 14, 1])
action scaled by temperature: tensor([[22]], device='cuda:0')
action picked by argmax: tensor([22], device='cuda:0')
tensor([[ 22,  71,  90, 263, 215, 236,  51, 176, 209, 158]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
190         1       23       4       191
420         2       23       3       148
642         3       23       4        97
900         4       23       3        82
1125        5       23       5        34
       user_id  item_id  rating  timestep
12326       46       23       3        42
12754       47       23       5       197
13092       48       23       5       262
13190       49       23       2        87
13481       50       23       4       105
average_rating for this rec across 50 users from same group (less noisy) was: 3.82
all_actions shape just before sample torch.Size([1, 15, 1])
action scaled by temperature: tensor([[71]], device='cuda:0')
action picked by argmax: tensor([71], device='cuda:0')
tensor([[ 71, 215,  22, 158, 263,  18, 101, 271, 176,  52]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
160         1       72       5       161
343         2       72       4        71
807         3       72       4       262
943         4       72       4       125
1141        5       72       4        50
       user_id  item_id  rating  timestep
12332       46       72       4        48
12696       47       72       3       139
12994       48       72       4       164
13136       49       72       5        33
13486       50       72       4       110
average_rating for this rec across 50 users from same group (less noisy) was: 4.0
all_actions shape just before sample torch.Size([1, 16, 1])
action scaled by temperature: tensor([[120]], device='cuda:0')
action picked by argmax: tensor([120], device='cuda:0')
tensor([[120, 215, 203, 160, 152, 111, 176, 137,  37, 241]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
140         1      121       4       141
340         2      121       4        68
548         3      121       4         3
1028        4      121       4       210
1324        5      121       4       233
       user_id  item_id  rating  timestep
12449       46      121       3       165
12767       47      121       4       210
13025       48      121       4       195
13269       49      121       4       166
13383       50      121       4         7
average_rating for this rec across 50 users from same group (less noisy) was: 4.02
all_actions shape just before sample torch.Size([1, 17, 1])
action scaled by temperature: tensor([[62]], device='cuda:0')
action picked by argmax: tensor([62], device='cuda:0')
tensor([[ 62, 121, 232, 255, 151, 139,  67,  57, 258, 124]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
221         1       63       5       222
458         2       63       4       186
619         3       63       3        74
1089        4       63       4       271
1340        5       63       3       249
       user_id  item_id  rating  timestep
12354       46       63       4        70
12650       47       63       3        93
12903       48       63       3        73
13166       49       63       3        63
13459       50       63       3        83
average_rating for this rec across 50 users from same group (less noisy) was: 3.72
all_actions shape just before sample torch.Size([1, 18, 1])
action scaled by temperature: tensor([[44]], device='cuda:0')
action picked by argmax: tensor([44], device='cuda:0')
tensor([[ 44,  90, 104, 125,  58,   6, 195, 215, 230,  71]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
223         1       45       4       224
337         2       45       4        65
608         3       45       3        63
931         4       45       3       113
1241        5       45       4       150
       user_id  item_id  rating  timestep
12328       46       45       4        44
12737       47       45       4       180
13058       48       45       3       228
13244       49       45       4       141
13631       50       45       3       255
average_rating for this rec across 50 users from same group (less noisy) was: 3.84
all_actions shape just before sample torch.Size([1, 19, 1])
action scaled by temperature: tensor([[90]], device='cuda:0')
action picked by argmax: tensor([90], device='cuda:0')
tensor([[ 90, 125, 215, 157,  40,  33,  52,  22,  70, 205]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
26          1       91       4        27
452         2       91       4       180
580         3       91       2        35
982         4       91       3       164
1198        5       91       4       107
       user_id  item_id  rating  timestep
12411       46       91       3       127
12568       47       91       4        11
13005       48       91       5       175
13291       49       91       5       188
13603       50       91       5       227
average_rating for this rec across 50 users from same group (less noisy) was: 3.9
all_actions shape just before sample torch.Size([1, 20, 1])
action scaled by temperature: tensor([[27]], device='cuda:0')
action picked by argmax: tensor([27], device='cuda:0')
tensor([[ 27, 205,  69,  14, 209, 234,  77, 108,  73, 261]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
0           1       28       4         1
294         2       28       4        22
736         3       28       5       191
1051        4       28       5       233
1244        5       28       3       153
       user_id  item_id  rating  timestep
12297       46       28       3        13
12763       47       28       4       206
13040       48       28       5       210
13309       49       28       5       206
13583       50       28       5       207
average_rating for this rec across 50 users from same group (less noisy) was: 4.3
all_actions shape just before sample torch.Size([1, 21, 1])
action scaled by temperature: tensor([[234]], device='cuda:0')
action picked by argmax: tensor([234], device='cuda:0')
tensor([[234, 185, 139, 205, 184, 204, 195, 232, 136, 160]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
233         1      235       3       234
468         2      235       4       196
662         3      235       4       117
927         4      235       3       109
1185        5      235       4        94
       user_id  item_id  rating  timestep
12305       46      235       3        21
12679       47      235       2       122
12895       48      235       4        65
13238       49      235       5       135
13642       50      235       5       266
average_rating for this rec across 50 users from same group (less noisy) was: 3.78
all_actions shape just before sample torch.Size([1, 22, 1])
action scaled by temperature: tensor([[114]], device='cuda:0')
action picked by argmax: tensor([114], device='cuda:0')
tensor([[114, 125, 205,  25, 103, 105,  71, 153, 133, 258]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
172         1      115       4       173
527         2      115       4       255
673         3      115       4       128
1006        4      115       5       188
1251        5      115       5       160
       user_id  item_id  rating  timestep
12546       46      115       4       262
12759       47      115       3       202
12890       48      115       5        60
13135       49      115       5        32
13616       50      115       5       240
average_rating for this rec across 50 users from same group (less noisy) was: 4.2
all_actions shape just before sample torch.Size([1, 23, 1])
action scaled by temperature: tensor([[125]], device='cuda:0')
action picked by argmax: tensor([125], device='cuda:0')
tensor([[125, 162,   6, 114, 223, 112, 193, 205, 129, 128]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
204         1      126       5       205
367         2      126       3        95
594         3      126       3        49
1031        4      126       2       213
1200        5      126       3       109
       user_id  item_id  rating  timestep
12366       46      126       3        82
12598       47      126       3        41
13012       48      126       3       182
13223       49      126       4       120
13647       50      126       4       271
average_rating for this rec across 50 users from same group (less noisy) was: 3.32
all_actions shape just before sample torch.Size([1, 24, 1])
action scaled by temperature: tensor([[205]], device='cuda:0')
action picked by argmax: tensor([205], device='cuda:0')
tensor([[205, 119, 135,  25, 204, 272, 101, 221, 201,  68]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
199         1      206       3       200
408         2      206       4       136
800         3      206       4       255
935         4      206       3       117
1159        5      206       4        68
       user_id  item_id  rating  timestep
12540       46      206       3       256
12585       47      206       4        28
12935       48      206       3       105
13364       49      206       5       261
13505       50      206       3       129
average_rating for this rec across 50 users from same group (less noisy) was: 4.16
all_actions shape just before sample torch.Size([1, 25, 1])
action scaled by temperature: tensor([[248]], device='cuda:0')
action picked by argmax: tensor([248], device='cuda:0')
tensor([[248, 101, 202, 135,  20, 205,  60,  63,  16,  71]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
113         1      249       5       114
445         2      249       5       173
590         3      249       4        45
1075        4      249       4       257
1115        5      249       5        24
       user_id  item_id  rating  timestep
12502       46      249       5       218
12627       47      249       5        70
13065       48      249       4       235
13191       49      249       5        88
13541       50      249       5       165
average_rating for this rec across 50 users from same group (less noisy) was: 4.7
all_actions shape just before sample torch.Size([1, 26, 1])
action scaled by temperature: tensor([[171]], device='cuda:0')
action picked by argmax: tensor([171], device='cuda:0')
tensor([[171,  20, 259, 205, 226, 200,  63, 159, 170, 269]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
6           1      172       4         7
376         2      172       4       104
568         3      172       3        23
964         4      172       4       146
1252        5      172       4       161
       user_id  item_id  rating  timestep
12301       46      172       3        17
12572       47      172       4        15
13077       48      172       4       247
13163       49      172       4        60
13546       50      172       3       170
average_rating for this rec across 50 users from same group (less noisy) was: 4.08
all_actions shape just before sample torch.Size([1, 27, 1])
action scaled by temperature: tensor([[159]], device='cuda:0')
action picked by argmax: tensor([159], device='cuda:0')
tensor([[159, 202, 135, 138,  74, 120, 119, 249,  93,  20]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
48          1      160       3        49
514         2      160       4       242
790         3      160       3       245
849         4      160       3        31
1264        5      160       4       173
       user_id  item_id  rating  timestep
12473       46      160       5       189
12595       47      160       3        38
13099       48      160       4       269
13202       49      160       2        99
13526       50      160       3       150
average_rating for this rec across 50 users from same group (less noisy) was: 3.56
all_actions shape just before sample torch.Size([1, 28, 1])
action scaled by temperature: tensor([[20]], device='cuda:0')
action picked by argmax: tensor([20], device='cuda:0')
tensor([[ 20,  83, 149, 130,  55,  50,  78, 146, 214, 237]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
89          1       21       4        90
287         2       21       5        15
679         3       21       4       134
1029        4       21       5       211
1192        5       21       4       101
       user_id  item_id  rating  timestep
12342       46       21       5        58
12678       47       21       5       121
13067       48       21       5       237
13173       49       21       5        70
13382       50       21       4         6
average_rating for this rec across 50 users from same group (less noisy) was: 4.66
all_actions shape just before sample torch.Size([1, 29, 1])
action scaled by temperature: tensor([[16]], device='cuda:0')
action picked by argmax: tensor([16], device='cuda:0')
tensor([[ 16, 110, 226,  80,  60, 256,  71, 126, 234, 248]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
212         1       17       3       213
385         2       17       4       113
660         3       17       3       115
942         4       17       2       124
1254        5       17       3       163
       user_id  item_id  rating  timestep
12537       46       17       4       253
12612       47       17       2        55
13052       48       17       4       222
13171       49       17       3        68
13534       50       17       3       158
average_rating for this rec across 50 users from same group (less noisy) was: 3.22
all_actions shape just before sample torch.Size([1, 30, 1])
action scaled by temperature: tensor([[110]], device='cuda:0')
action picked by argmax: tensor([110], device='cuda:0')
tensor([[110,  80, 234, 241, 249, 162,  93, 150,  21, 140]], device='cuda:0')
Just recommended 30 new items to 50 users from group 1 and the total rating was 118.25999999999999
train_loss is: 0.8789091474933711
action scaled by temperature: tensor([[101]], device='cuda:0')
action picked by argmax: tensor([156], device='cuda:0')
tensor([[156,  99, 231, 165,  24,  56, 160,  26, 109, 205]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
150         1      157       4       151
541         2      157       4       269
705         3      157       3       160
976         4      157       3       158
1105        5      157       4        14
       user_id  item_id  rating  timestep
12378       46      157       4        94
12726       47      157       4       169
12842       48      157       5        12
13320       49      157       3       217
13614       50      157       4       238
average_rating for this rec across 50 users from same group (less noisy) was: 3.96
all_actions shape just before sample torch.Size([1, 1, 1])
action scaled by temperature: tensor([[127]], device='cuda:0')
action picked by argmax: tensor([136], device='cuda:0')
tensor([[136,  16,  55,  56, 190, 159, 134, 261, 153, 180]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
272         1      137       4       273
451         2      137       3       179
595         3      137       5        50
1017        4      137       4       199
1298        5      137       4       207
       user_id  item_id  rating  timestep
12307       46      137       4        23
12565       47      137       4         8
12961       48      137       4       131
13254       49      137       3       151
13529       50      137       4       153
average_rating for this rec across 50 users from same group (less noisy) was: 3.76
all_actions shape just before sample torch.Size([1, 2, 1])
action scaled by temperature: tensor([[43]], device='cuda:0')
action picked by argmax: tensor([43], device='cuda:0')
tensor([[ 43, 214,  19, 190, 208,  93,  81, 137, 117, 161]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
267         1       44       4       268
341         2       44       4        69
706         3       44       4       161
939         4       44       4       121
1331        5       44       4       240
       user_id  item_id  rating  timestep
12435       46       44       3       151
12717       47       44       4       160
13103       48       44       3       273
13146       49       44       3        43
13615       50       44       4       239
average_rating for this rec across 50 users from same group (less noisy) was: 3.74
all_actions shape just before sample torch.Size([1, 3, 1])
action scaled by temperature: tensor([[107]], device='cuda:0')
action picked by argmax: tensor([52], device='cuda:0')
tensor([[ 52,  21, 235, 147,  54, 250, 180,  93, 118,  64]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
125         1       53       4       126
456         2       53       5       184
677         3       53       3       132
858         4       53       3        40
1177        5       53       5        86
       user_id  item_id  rating  timestep
12439       46       53       3       155
12677       47       53       4       120
12975       48       53       4       145
13213       49       53       5       110
13474       50       53       3        98
average_rating for this rec across 50 users from same group (less noisy) was: 3.94
all_actions shape just before sample torch.Size([1, 4, 1])
action scaled by temperature: tensor([[202]], device='cuda:0')
action picked by argmax: tensor([202], device='cuda:0')
tensor([[202,  21, 207, 155, 143, 135,  13, 180, 129, 165]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
177         1      203       4       178
488         2      203       4       216
641         3      203       5        96
1021        4      203       4       203
1259        5      203       5       168
       user_id  item_id  rating  timestep
12526       46      203       4       242
12769       47      203       4       212
12905       48      203       4        75
13327       49      203       5       224
13553       50      203       4       177
average_rating for this rec across 50 users from same group (less noisy) was: 4.26
all_actions shape just before sample torch.Size([1, 5, 1])
action scaled by temperature: tensor([[180]], device='cuda:0')
action picked by argmax: tensor([180], device='cuda:0')
tensor([[180, 183, 114, 118, 103, 265, 241, 239, 135, 147]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
73          1      181       5        74
326         2      181       4        54
708         3      181       5       163
934         4      181       4       116
1231        5      181       5       140
       user_id  item_id  rating  timestep
12317       46      181       4        33
12688       47      181       5       131
13048       48      181       5       218
13131       49      181       5        28
13517       50      181       5       141
average_rating for this rec across 50 users from same group (less noisy) was: 4.68
all_actions shape just before sample torch.Size([1, 6, 1])
action scaled by temperature: tensor([[241]], device='cuda:0')
action picked by argmax: tensor([241], device='cuda:0')
tensor([[241, 183,  59,  36,  33, 180, 143,   4, 238,  71]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
210         1      242       5       211
333         2      242       5        61
602         3      242       4        57
975         4      242       2       157
1297        5      242       5       206
       user_id  item_id  rating  timestep
12442       46      242       4       158
12609       47      242       4        52
13081       48      242       5       251
13312       49      242       5       209
13628       50      242       5       252
average_rating for this rec across 50 users from same group (less noisy) was: 4.08
all_actions shape just before sample torch.Size([1, 7, 1])
action scaled by temperature: tensor([[4]], device='cuda:0')
action picked by argmax: tensor([4], device='cuda:0')
tensor([[  4, 118,  97,  59, 213, 119,  52,  85,  48, 149]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
218         1        5       5       219
370         2        5       5        98
649         3        5       5       104
890         4        5       5        72
1333        5        5       5       242
       user_id  item_id  rating  timestep
12447       46        5       5       163
12790       47        5       5       233
12966       48        5       5       136
13353       49        5       5       250
13491       50        5       5       115
average_rating for this rec across 50 users from same group (less noisy) was: 4.82
all_actions shape just before sample torch.Size([1, 8, 1])
action scaled by temperature: tensor([[231]], device='cuda:0')
action picked by argmax: tensor([231], device='cuda:0')
tensor([[231,   7, 205,   4,  58, 225,  67, 234, 160, 198]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
250         1      232       4       251
469         2      232       4       197
557         3      232       4        12
922         4      232       5       104
1265        5      232       5       174
       user_id  item_id  rating  timestep
12299       46      232       5        15
12815       47      232       3       258
12865       48      232       4        35
13142       49      232       5        39
13469       50      232       3        93
average_rating for this rec across 50 users from same group (less noisy) was: 4.38
all_actions shape just before sample torch.Size([1, 9, 1])
action scaled by temperature: tensor([[165]], device='cuda:0')
action picked by argmax: tensor([165], device='cuda:0')
tensor([[165, 217,  67, 124, 229, 135,  39,  29,  16, 198]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
92          1      166       5        93
327         2      166       4        55
664         3      166       5       119
1004        4      166       4       186
1172        5      166       4        81
       user_id  item_id  rating  timestep
12428       46      166       5       144
12711       47      166       5       154
12888       48      166       5        58
13340       49      166       3       237
13508       50      166       4       132
average_rating for this rec across 50 users from same group (less noisy) was: 4.34
all_actions shape just before sample torch.Size([1, 10, 1])
action scaled by temperature: tensor([[83]], device='cuda:0')
action picked by argmax: tensor([83], device='cuda:0')
tensor([[ 83,  56, 217, 133, 125, 264, 213, 261, 198, 119]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
255         1       84       3       256
303         2       84       5        31
754         3       84       4       209
850         4       84       4        32
1230        5       84       5       139
       user_id  item_id  rating  timestep
12517       46       84       4       233
12799       47       84       5       242
12936       48       84       5       106
13329       49       84       5       226
13635       50       84       4       259
average_rating for this rec across 50 users from same group (less noisy) was: 4.2
all_actions shape just before sample torch.Size([1, 11, 1])
action scaled by temperature: tensor([[125]], device='cuda:0')
action picked by argmax: tensor([125], device='cuda:0')
tensor([[125,  40, 217,  97,  68,  53, 229,  35,  64, 133]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
204         1      126       5       205
367         2      126       3        95
594         3      126       3        49
1031        4      126       2       213
1200        5      126       3       109
       user_id  item_id  rating  timestep
12366       46      126       3        82
12598       47      126       3        41
13012       48      126       3       182
13223       49      126       4       120
13647       50      126       4       271
average_rating for this rec across 50 users from same group (less noisy) was: 3.32
all_actions shape just before sample torch.Size([1, 12, 1])
action scaled by temperature: tensor([[168]], device='cuda:0')
action picked by argmax: tensor([168], device='cuda:0')
tensor([[168, 157,  53, 264, 202, 246, 150,  19, 214, 204]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
119         1      169       5       120
483         2      169       5       211
559         3      169       5        14
886         4      169       5        68
1273        5      169       4       182
       user_id  item_id  rating  timestep
12488       46      169       4       204
12558       47      169       5         1
13080       48      169       4       250
13150       49      169       4        47
13492       50      169       4       116
average_rating for this rec across 50 users from same group (less noisy) was: 4.72
all_actions shape just before sample torch.Size([1, 13, 1])
action scaled by temperature: tensor([[157]], device='cuda:0')
action picked by argmax: tensor([157], device='cuda:0')
tensor([[157, 264, 137,  66,  76,  19, 246, 202,  87,  15]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
156         1      158       4       157
496         2      158       5       224
798         3      158       4       253
1015        4      158       4       197
1351        5      158       4       260
       user_id  item_id  rating  timestep
12457       46      158       4       173
12809       47      158       5       252
13046       48      158       5       216
13322       49      158       3       219
13399       50      158       5        23
average_rating for this rec across 50 users from same group (less noisy) was: 4.42
all_actions shape just before sample torch.Size([1, 14, 1])
action scaled by temperature: tensor([[71]], device='cuda:0')
action picked by argmax: tensor([71], device='cuda:0')
tensor([[ 71, 137,  52, 228, 264, 245, 198, 231,  66,  36]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
160         1       72       5       161
343         2       72       4        71
807         3       72       4       262
943         4       72       4       125
1141        5       72       4        50
       user_id  item_id  rating  timestep
12332       46       72       4        48
12696       47       72       3       139
12994       48       72       4       164
13136       49       72       5        33
13486       50       72       4       110
average_rating for this rec across 50 users from same group (less noisy) was: 4.0
all_actions shape just before sample torch.Size([1, 15, 1])
action scaled by temperature: tensor([[264]], device='cuda:0')
action picked by argmax: tensor([264], device='cuda:0')
tensor([[264, 137,  71, 167,  16,  85, 148,  47, 133,  97]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
44          1      265       4        45
487         2      265       5       215
787         3      265       5       242
1078        4      265       3       260
1314        5      265       5       223
       user_id  item_id  rating  timestep
12475       46      265       3       191
12666       47      265       3       109
12847       48      265       4        17
13201       49      265       4        98
13560       50      265       5       184
average_rating for this rec across 50 users from same group (less noisy) was: 3.64
all_actions shape just before sample torch.Size([1, 16, 1])
action scaled by temperature: tensor([[137]], device='cuda:0')
action picked by argmax: tensor([137], device='cuda:0')
tensor([[137, 226, 167, 154,  97,  72, 133,  81, 235,  27]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
197         1      138       4       198
542         2      138       4       270
636         3      138       5        91
926         4      138       4       108
1195        5      138       5       104
       user_id  item_id  rating  timestep
12538       46      138       4       254
12596       47      138       4        39
13053       48      138       4       223
13354       49      138       5       251
13519       50      138       5       143
average_rating for this rec across 50 users from same group (less noisy) was: 4.36
all_actions shape just before sample torch.Size([1, 17, 1])
action scaled by temperature: tensor([[112]], device='cuda:0')
action picked by argmax: tensor([112], device='cuda:0')
tensor([[112, 133, 167, 102, 202,  85,  66, 199,  29, 272]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
229         1      113       5       230
305         2      113       3        33
611         3      113       3        66
1032        4      113       5       214
1356        5      113       4       265
       user_id  item_id  rating  timestep
12513       46      113       5       229
12828       47      113       3       271
12843       48      113       1        13
13169       49      113       4        66
13472       50      113       4        96
average_rating for this rec across 50 users from same group (less noisy) was: 3.62
all_actions shape just before sample torch.Size([1, 18, 1])
action scaled by temperature: tensor([[97]], device='cuda:0')
action picked by argmax: tensor([97], device='cuda:0')
tensor([[ 97, 137, 167,  32,  99,  44, 186,  10,  67, 257]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
174         1       98       4       175
414         2       98       4       142
681         3       98       2       136
941         4       98       3       123
1120        5       98       3        29
       user_id  item_id  rating  timestep
12465       46       98       4       181
12789       47       98       3       232
13078       48       98       4       248
13292       49       98       4       189
13565       50       98       4       189
average_rating for this rec across 50 users from same group (less noisy) was: 3.52
all_actions shape just before sample torch.Size([1, 19, 1])
action scaled by temperature: tensor([[19]], device='cuda:0')
action picked by argmax: tensor([19], device='cuda:0')
tensor([[ 19, 172,  97,  58, 180,  25, 133,  67, 245, 190]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
216         1       20       5       217
314         2       20       4        42
634         3       20       5        89
956         4       20       5       138
1316        5       20       3       225
       user_id  item_id  rating  timestep
12535       46       20       5       251
12580       47       20       5        23
12889       48       20       5        59
13188       49       20       4        85
13439       50       20       4        63
average_rating for this rec across 50 users from same group (less noisy) was: 4.56
all_actions shape just before sample torch.Size([1, 20, 1])
action scaled by temperature: tensor([[58]], device='cuda:0')
action picked by argmax: tensor([58], device='cuda:0')
tensor([[ 58, 188, 244, 177, 237, 257, 123, 172,  19, 271]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
40          1       59       4        41
309         2       59       4        37
622         3       59       4        77
1063        4       59       3       245
1144        5       59       4        53
       user_id  item_id  rating  timestep
12484       46       59       4       200
12757       47       59       4       200
12968       48       59       4       138
13243       49       59       4       140
13594       50       59       4       218
average_rating for this rec across 50 users from same group (less noisy) was: 4.16
all_actions shape just before sample torch.Size([1, 21, 1])
action scaled by temperature: tensor([[237]], device='cuda:0')
action picked by argmax: tensor([237], device='cuda:0')
tensor([[237,  66,  58, 188,  82,   2, 261, 266, 244, 133]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
228         1      238       4       229
475         2      238       3       203
719         3      238       3       174
860         4      238       5        42
1166        5      238       5        75
       user_id  item_id  rating  timestep
12462       46      238       3       178
12618       47      238       4        61
13000       48      238       5       170
13192       49      238       3        89
13431       50      238       5        55
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 22, 1])
action scaled by temperature: tensor([[66]], device='cuda:0')
action picked by argmax: tensor([66], device='cuda:0')
tensor([[ 66,   2, 117, 140, 143, 142,  58, 217,  47, 167]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
158         1       67       4       159
457         2       67       4       185
650         3       67       4       105
1076        4       67       5       258
1322        5       67       5       231
       user_id  item_id  rating  timestep
12304       46       67       5        20
12644       47       67       3        87
12846       48       67       5        16
13233       49       67       4       130
13407       50       67       3        31
average_rating for this rec across 50 users from same group (less noisy) was: 3.94
all_actions shape just before sample torch.Size([1, 23, 1])
action scaled by temperature: tensor([[47]], device='cuda:0')
action picked by argmax: tensor([47], device='cuda:0')
tensor([[ 47,  14, 143,   2, 237, 245,  66, 153, 266, 133]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
104         1       48       5       105
471         2       48       5       199
567         3       48       4        22
888         4       48       4        70
1155        5       48       4        64
       user_id  item_id  rating  timestep
12362       46       48       5        78
12710       47       48       4       153
12898       48       48       5        68
13180       49       48       4        77
13648       50       48       4       272
average_rating for this rec across 50 users from same group (less noisy) was: 4.08
all_actions shape just before sample torch.Size([1, 24, 1])
action scaled by temperature: tensor([[213]], device='cuda:0')
action picked by argmax: tensor([213], device='cuda:0')
tensor([[213,  66, 222, 198, 252, 167,  79,  14, 218,  83]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
20          1      214       4        21
346         2      214       4        74
771         3      214       5       226
830         4      214       4        12
1348        5      214       4       257
       user_id  item_id  rating  timestep
12303       46      214       5        19
12776       47      214       5       219
12942       48      214       3       112
13250       49      214       3       147
13409       50      214       5        33
average_rating for this rec across 50 users from same group (less noisy) was: 4.12
all_actions shape just before sample torch.Size([1, 25, 1])
action scaled by temperature: tensor([[198]], device='cuda:0')
action picked by argmax: tensor([198], device='cuda:0')
tensor([[198,  72, 123,   9,  79, 264,   2, 212,  66,  25]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
154         1      199       4       155
273         2      199       4         1
713         3      199       4       168
843         4      199       3        25
1279        5      199       4       188
       user_id  item_id  rating  timestep
12476       46      199       4       192
12664       47      199       4       107
13090       48      199       5       260
13349       49      199       5       246
13402       50      199       4        26
average_rating for this rec across 50 users from same group (less noisy) was: 4.1
all_actions shape just before sample torch.Size([1, 26, 1])
action scaled by temperature: tensor([[15]], device='cuda:0')
action picked by argmax: tensor([15], device='cuda:0')
tensor([[ 15,  59, 117, 142, 261, 198, 134,   2, 218, 133]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
152         1       16       4       153
280         2       16       4         8
592         3       16       5        47
840         4       16       4        22
1318        5       16       4       227
       user_id  item_id  rating  timestep
12368       46       16       4        84
12646       47       16       4        89
13001       48       16       4       171
13274       49       16       5       171
13435       50       16       3        59
average_rating for this rec across 50 users from same group (less noisy) was: 4.12
all_actions shape just before sample torch.Size([1, 27, 1])
action scaled by temperature: tensor([[30]], device='cuda:0')
action picked by argmax: tensor([30], device='cuda:0')
tensor([[ 30, 151, 133, 115, 159,   3, 165, 160, 142, 117]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
31          1       31       4        32
538         2       31       4       266
740         3       31       4       195
1053        4       31       5       235
1186        5       31       5        95
       user_id  item_id  rating  timestep
12404       46       31       5       120
12738       47       31       5       181
12892       48       31       5        62
13137       49       31       5        34
13462       50       31       4        86
average_rating for this rec across 50 users from same group (less noisy) was: 4.8
all_actions shape just before sample torch.Size([1, 28, 1])
action scaled by temperature: tensor([[3]], device='cuda:0')
action picked by argmax: tensor([3], device='cuda:0')
tensor([[  3,  14, 257, 127, 225,  76, 201, 196,  99, 217]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
35          1        4       4        36
501         2        4       5       229
680         3        4       5       135
938         4        4       4       120
1201        5        4       5       110
       user_id  item_id  rating  timestep
12530       46        4       5       246
12610       47        4       4        53
13062       48        4       4       232
13214       49        4       4       111
13385       50        4       4         9
average_rating for this rec across 50 users from same group (less noisy) was: 4.6
all_actions shape just before sample torch.Size([1, 29, 1])
action scaled by temperature: tensor([[95]], device='cuda:0')
action picked by argmax: tensor([95], device='cuda:0')
tensor([[ 95,  14,  15, 225, 213,  73,  42, 251, 184, 115]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
167         1       96       3       168
352         2       96       3        80
654         3       96       5       109
879         4       96       3        61
1136        5       96       3        45
       user_id  item_id  rating  timestep
12407       46       96       3       123
12748       47       96       4       191
12851       48       96       4        21
13222       49       96       5       119
13437       50       96       4        61
average_rating for this rec across 50 users from same group (less noisy) was: 3.9
all_actions shape just before sample torch.Size([1, 30, 1])
action scaled by temperature: tensor([[53]], device='cuda:0')
action picked by argmax: tensor([53], device='cuda:0')
tensor([[ 53, 157,  65,  70, 200, 148, 103,  73, 158,  14]], device='cuda:0')
Just recommended 30 new items to 50 users from group 1 and the total rating was 124.2
train_loss is: 0.7272320400634312
action scaled by temperature: tensor([[261]], device='cuda:0')
action picked by argmax: tensor([24], device='cuda:0')
tensor([[ 24,  30, 180, 120, 222, 117, 205, 199, 185, 109]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
50          1       25       5        51
277         2       25       4         5
749         3       25       4       204
1042        4       25       5       224
1232        5       25       5       141
       user_id  item_id  rating  timestep
12295       46       25       5        11
12795       47       25       4       238
13004       48       25       5       174
13315       49       25       4       212
13403       50       25       4        27
average_rating for this rec across 50 users from same group (less noisy) was: 4.68
all_actions shape just before sample torch.Size([1, 1, 1])
action scaled by temperature: tensor([[10]], device='cuda:0')
action picked by argmax: tensor([252], device='cuda:0')
tensor([[252, 128, 264, 134, 120, 210,  19, 158, 159,  11]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
53          1      253       5        54
325         2      253       5        53
761         3      253       5       216
1068        4      253       5       250
1176        5      253       5        85
       user_id  item_id  rating  timestep
12446       46      253       5       162
12791       47      253       5       234
13019       48      253       5       189
13220       49      253       5       117
13580       50      253       5       204
average_rating for this rec across 50 users from same group (less noisy) was: 4.7
all_actions shape just before sample torch.Size([1, 2, 1])
action scaled by temperature: tensor([[177]], device='cuda:0')
action picked by argmax: tensor([97], device='cuda:0')
tensor([[ 97,  32, 189,  37, 177, 122, 260,  73, 202, 144]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
174         1       98       4       175
414         2       98       4       142
681         3       98       2       136
941         4       98       3       123
1120        5       98       3        29
       user_id  item_id  rating  timestep
12465       46       98       4       181
12789       47       98       3       232
13078       48       98       4       248
13292       49       98       4       189
13565       50       98       4       189
average_rating for this rec across 50 users from same group (less noisy) was: 3.52
all_actions shape just before sample torch.Size([1, 3, 1])
action scaled by temperature: tensor([[106]], device='cuda:0')
action picked by argmax: tensor([177], device='cuda:0')
tensor([[177, 260, 271, 106,  32, 122, 154,  97, 137, 221]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
12          1      178       4        13
535         2      178       4       263
717         3      178       5       172
1062        4      178       4       244
1150        5      178       4        59
       user_id  item_id  rating  timestep
12323       46      178       3        39
12760       47      178       5       203
12878       48      178       4        48
13355       49      178       5       252
13620       50      178       4       244
average_rating for this rec across 50 users from same group (less noisy) was: 4.22
all_actions shape just before sample torch.Size([1, 4, 1])
action scaled by temperature: tensor([[75]], device='cuda:0')
action picked by argmax: tensor([75], device='cuda:0')
tensor([[ 75, 272, 143,  33,  91,   5, 219, 182, 103, 140]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
76          1       76       5        77
330         2       76       4        58
571         3       76       3        26
915         4       76       4        97
1167        5       76       4        76
       user_id  item_id  rating  timestep
12440       46       76       3       156
12588       47       76       4        31
12957       48       76       3       127
13325       49       76       5       222
13468       50       76       5        92
average_rating for this rec across 50 users from same group (less noisy) was: 4.04
all_actions shape just before sample torch.Size([1, 5, 1])
action scaled by temperature: tensor([[205]], device='cuda:0')
action picked by argmax: tensor([205], device='cuda:0')
tensor([[205,   5,   0, 102, 185, 131,  33,  74, 235,  12]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
199         1      206       3       200
408         2      206       4       136
800         3      206       4       255
935         4      206       3       117
1159        5      206       4        68
       user_id  item_id  rating  timestep
12540       46      206       3       256
12585       47      206       4        28
12935       48      206       3       105
13364       49      206       5       261
13505       50      206       3       129
average_rating for this rec across 50 users from same group (less noisy) was: 4.16
all_actions shape just before sample torch.Size([1, 6, 1])
action scaled by temperature: tensor([[5]], device='cuda:0')
action picked by argmax: tensor([5], device='cuda:0')
tensor([[  5, 163, 200,  86,   0,  54, 251, 168,  62,  32]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
133         1        6       5       134
431         2        6       5       159
655         3        6       5       110
968         4        6       4       150
1206        5        6       3       115
       user_id  item_id  rating  timestep
12316       46        6       5        32
12746       47        6       3       189
13036       48        6       4       206
13216       49        6       5       113
13602       50        6       5       226
average_rating for this rec across 50 users from same group (less noisy) was: 4.02
all_actions shape just before sample torch.Size([1, 7, 1])
action scaled by temperature: tensor([[0]], device='cuda:0')
action picked by argmax: tensor([0], device='cuda:0')
tensor([[  0,   5, 102,  24, 163, 205,  62, 219, 184, 255]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
62          1        1       4        63
522         2        1       5       250
671         3        1       4       126
892         4        1       4        74
1204        5        1       5       113
       user_id  item_id  rating  timestep
12375       46        1       5        91
12816       47        1       5       259
13045       48        1       4       215
13375       49        1       5       272
13542       50        1       5       166
average_rating for this rec across 50 users from same group (less noisy) was: 4.66
all_actions shape just before sample torch.Size([1, 8, 1])
action scaled by temperature: tensor([[255]], device='cuda:0')
action picked by argmax: tensor([255], device='cuda:0')
tensor([[255, 228,  75,  14, 237,  92, 152,  66, 153, 154]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
85          1      256       2        86
409         2      256       4       137
693         3      256       4       148
889         4      256       5        71
1191        5      256       5       100
       user_id  item_id  rating  timestep
12509       46      256       4       225
12728       47      256       4       171
12993       48      256       5       163
13128       49      256       5        25
13480       50      256       4       104
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 9, 1])
action scaled by temperature: tensor([[140]], device='cuda:0')
action picked by argmax: tensor([140], device='cuda:0')
tensor([[140,  57, 115,  14, 163, 162, 244, 228,  31,  91]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
251         1      141       3       252
306         2      141       5        34
794         3      141       5       249
1064        4      141       1       246
1339        5      141       4       248
       user_id  item_id  rating  timestep
12480       46      141       3       196
12668       47      141       4       111
12998       48      141       4       168
13234       49      141       5       131
13406       50      141       4        30
average_rating for this rec across 50 users from same group (less noisy) was: 3.82
all_actions shape just before sample torch.Size([1, 10, 1])
action scaled by temperature: tensor([[12]], device='cuda:0')
action picked by argmax: tensor([12], device='cuda:0')
tensor([[ 12,  72,  90, 222, 208, 236, 153, 243,  62, 221]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
192         1       13       4       193
315         2       13       5        43
733         3       13       3       188
1066        4       13       5       248
1346        5       13       5       255
       user_id  item_id  rating  timestep
12377       46       13       4        93
12821       47       13       4       264
12916       48       13       5        86
13235       49       13       5       132
13449       50       13       4        73
average_rating for this rec across 50 users from same group (less noisy) was: 4.54
all_actions shape just before sample torch.Size([1, 11, 1])
action scaled by temperature: tensor([[222]], device='cuda:0')
action picked by argmax: tensor([222], device='cuda:0')
tensor([[222, 151, 220, 133,  57, 256, 172,  27, 261,  89]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
198         1      223       3       199
386         2      223       4       114
640         3      223       5        95
936         4      223       5       118
1310        5      223       4       219
       user_id  item_id  rating  timestep
12409       46      223       5       125
12619       47      223       5        62
12967       48      223       4       137
13372       49      223       5       269
13567       50      223       4       191
average_rating for this rec across 50 users from same group (less noisy) was: 4.54
all_actions shape just before sample torch.Size([1, 12, 1])
action scaled by temperature: tensor([[151]], device='cuda:0')
action picked by argmax: tensor([151], device='cuda:0')
tensor([[151,  96, 111,  94, 220,  97,  57, 101, 163, 157]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
25          1      152       5        26
301         2      152       4        29
721         3      152       4       176
882         4      152       5        64
1248        5      152       5       157
       user_id  item_id  rating  timestep
12467       46      152       4       183
12793       47      152       3       236
12904       48      152       5        74
13212       49      152       5       109
13470       50      152       4        94
average_rating for this rec across 50 users from same group (less noisy) was: 4.34
all_actions shape just before sample torch.Size([1, 13, 1])
action scaled by temperature: tensor([[157]], device='cuda:0')
action picked by argmax: tensor([157], device='cuda:0')
tensor([[157,  99,  22,  52, 201, 216,  32,   0, 230,   8]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
156         1      158       4       157
496         2      158       5       224
798         3      158       4       253
1015        4      158       4       197
1351        5      158       4       260
       user_id  item_id  rating  timestep
12457       46      158       4       173
12809       47      158       5       252
13046       48      158       5       216
13322       49      158       3       219
13399       50      158       5        23
average_rating for this rec across 50 users from same group (less noisy) was: 4.42
all_actions shape just before sample torch.Size([1, 14, 1])
action scaled by temperature: tensor([[234]], device='cuda:0')
action picked by argmax: tensor([234], device='cuda:0')
tensor([[234,  57,  97,  96, 263, 201, 268, 219, 229, 272]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
233         1      235       3       234
468         2      235       4       196
662         3      235       4       117
927         4      235       3       109
1185        5      235       4        94
       user_id  item_id  rating  timestep
12305       46      235       3        21
12679       47      235       2       122
12895       48      235       4        65
13238       49      235       5       135
13642       50      235       5       266
average_rating for this rec across 50 users from same group (less noisy) was: 3.78
all_actions shape just before sample torch.Size([1, 15, 1])
action scaled by temperature: tensor([[152]], device='cuda:0')
action picked by argmax: tensor([152], device='cuda:0')
tensor([[152, 177, 132, 163, 122, 201,  10, 180,  88, 105]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
27          1      153       4        28
428         2      153       1       156
586         3      153       3        41
884         4      153       5        66
1288        5      153       5       197
       user_id  item_id  rating  timestep
12423       46      153       3       139
12632       47      153       4        75
12955       48      153       3       125
13197       49      153       4        94
13405       50      153       4        29
average_rating for this rec across 50 users from same group (less noisy) was: 3.58
all_actions shape just before sample torch.Size([1, 16, 1])
action scaled by temperature: tensor([[163]], device='cuda:0')
action picked by argmax: tensor([163], device='cuda:0')
tensor([[163, 177, 167, 122,  42, 269,  71, 151, 217, 214]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
33          1      164       4        34
378         2      164       3       106
701         3      164       5       156
893         4      164       4        75
1338        5      164       4       247
       user_id  item_id  rating  timestep
12418       46      164       5       134
12718       47      164       4       161
13069       48      164       5       239
13265       49      164       4       162
13576       50      164       4       200
average_rating for this rec across 50 users from same group (less noisy) was: 4.46
all_actions shape just before sample torch.Size([1, 17, 1])
action scaled by temperature: tensor([[177]], device='cuda:0')
action picked by argmax: tensor([177], device='cuda:0')
tensor([[177, 217, 122,  39,  71, 263, 219, 161, 244,   5]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
12          1      178       4        13
535         2      178       4       263
717         3      178       5       172
1062        4      178       4       244
1150        5      178       4        59
       user_id  item_id  rating  timestep
12323       46      178       3        39
12760       47      178       5       203
12878       48      178       4        48
13355       49      178       5       252
13620       50      178       4       244
average_rating for this rec across 50 users from same group (less noisy) was: 4.22
all_actions shape just before sample torch.Size([1, 18, 1])
action scaled by temperature: tensor([[122]], device='cuda:0')
action picked by argmax: tensor([122], device='cuda:0')
tensor([[122,  36,  42,  64, 257, 201,   5,  57, 217, 265]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
260         1      123       5       261
437         2      123       5       165
653         3      123       5       108
1037        4      123       3       219
1341        5      123       3       250
       user_id  item_id  rating  timestep
12287       46      123       4         3
12764       47      123       5       207
12932       48      123       3       102
13330       49      123       5       227
13629       50      123       5       253
average_rating for this rec across 50 users from same group (less noisy) was: 4.04
all_actions shape just before sample torch.Size([1, 19, 1])
action scaled by temperature: tensor([[80]], device='cuda:0')
action picked by argmax: tensor([80], device='cuda:0')
tensor([[ 80, 152, 261,  97,  42, 201, 119,  83, 166, 184]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
9           1       81       5        10
441         2       81       5       169
675         3       81       5       130
909         4       81       5        91
1344        5       81       5       253
       user_id  item_id  rating  timestep
12478       46       81       4       194
12586       47       81       5        29
13087       48       81       5       257
13352       49       81       5       249
13450       50       81       5        74
average_rating for this rec across 50 users from same group (less noisy) was: 4.56
all_actions shape just before sample torch.Size([1, 20, 1])
action scaled by temperature: tensor([[119]], device='cuda:0')
action picked by argmax: tensor([119], device='cuda:0')
tensor([[119, 205,  80, 268, 138,  46,   5, 123,  28, 144]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
138         1      120       5       139
524         2      120       4       252
674         3      120       2       129
957         4      120       2       139
1242        5      120       3       151
       user_id  item_id  rating  timestep
12334       46      120       4        50
12574       47      120       3        17
12876       48      120       5        46
13120       49      120       5        17
13389       50      120       5        13
average_rating for this rec across 50 users from same group (less noisy) was: 3.74
all_actions shape just before sample torch.Size([1, 21, 1])
action scaled by temperature: tensor([[19]], device='cuda:0')
action picked by argmax: tensor([19], device='cuda:0')
tensor([[ 19, 152, 119,  46, 255, 242, 205,  17, 148, 126]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
216         1       20       5       217
314         2       20       4        42
634         3       20       5        89
956         4       20       5       138
1316        5       20       3       225
       user_id  item_id  rating  timestep
12535       46       20       5       251
12580       47       20       5        23
12889       48       20       5        59
13188       49       20       4        85
13439       50       20       4        63
average_rating for this rec across 50 users from same group (less noisy) was: 4.56
all_actions shape just before sample torch.Size([1, 22, 1])
action scaled by temperature: tensor([[90]], device='cuda:0')
action picked by argmax: tensor([90], device='cuda:0')
tensor([[ 90,  80, 156, 123,  97, 152,  47, 231, 245, 164]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
26          1       91       4        27
452         2       91       4       180
580         3       91       2        35
982         4       91       3       164
1198        5       91       4       107
       user_id  item_id  rating  timestep
12411       46       91       3       127
12568       47       91       4        11
13005       48       91       5       175
13291       49       91       5       188
13603       50       91       5       227
average_rating for this rec across 50 users from same group (less noisy) was: 3.9
all_actions shape just before sample torch.Size([1, 23, 1])
action scaled by temperature: tensor([[261]], device='cuda:0')
action picked by argmax: tensor([261], device='cuda:0')
tensor([[261, 233,  97, 150, 186,  40,  41, 133, 165, 184]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
188         1      262       5       189
292         2      262       4        20
676         3      262       3       131
914         4      262       3        96
1194        5      262       3       103
       user_id  item_id  rating  timestep
12551       46      262       5       267
12620       47      262       5        63
12953       48      262       5       123
13350       49      262       4       247
13419       50      262       4        43
average_rating for this rec across 50 users from same group (less noisy) was: 4.0
all_actions shape just before sample torch.Size([1, 24, 1])
action scaled by temperature: tensor([[233]], device='cuda:0')
action picked by argmax: tensor([233], device='cuda:0')
tensor([[233,  41, 261, 222, 165,  29, 186,  72,  19, 184]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
39          1      234       4        40
543         2      234       4       271
707         3      234       4       162
1083        4      234       2       265
1364        5      234       4       273
       user_id  item_id  rating  timestep
12363       46      234       3        79
12812       47      234       5       255
12943       48      234       3       113
13126       49      234       5        23
13420       50      234       4        44
average_rating for this rec across 50 users from same group (less noisy) was: 4.0
all_actions shape just before sample torch.Size([1, 25, 1])
action scaled by temperature: tensor([[165]], device='cuda:0')
action picked by argmax: tensor([165], device='cuda:0')
tensor([[165, 205,   7, 185,  90,  63, 234, 198, 141, 139]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
92          1      166       5        93
327         2      166       4        55
664         3      166       5       119
1004        4      166       4       186
1172        5      166       4        81
       user_id  item_id  rating  timestep
12428       46      166       5       144
12711       47      166       5       154
12888       48      166       5        58
13340       49      166       3       237
13508       50      166       4       132
average_rating for this rec across 50 users from same group (less noisy) was: 4.34
all_actions shape just before sample torch.Size([1, 26, 1])
action scaled by temperature: tensor([[6]], device='cuda:0')
action picked by argmax: tensor([6], device='cuda:0')
tensor([[  6,  68,  83, 211, 184, 133,  93, 141, 264, 119]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
82          1        7       4        83
388         2        7       4       116
811         3        7       4       266
990         4        7       4       172
1154        5        7       3        63
       user_id  item_id  rating  timestep
12491       46        7       3       207
12722       47        7       4       165
13002       48        7       5       172
13104       49        7       4         1
13378       50        7       5         2
average_rating for this rec across 50 users from same group (less noisy) was: 3.68
all_actions shape just before sample torch.Size([1, 27, 1])
action scaled by temperature: tensor([[53]], device='cuda:0')
action picked by argmax: tensor([53], device='cuda:0')
tensor([[ 53, 168, 141, 182, 202, 264,  68, 125, 237, 102]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
235         1       54       5       236
536         2       54       4       264
645         3       54       5       100
1050        4       54       4       232
1197        5       54       4       106
       user_id  item_id  rating  timestep
12353       46       54       5        69
12559       47       54       4         2
12978       48       54       4       148
13283       49       54       3       180
13424       50       54       3        48
average_rating for this rec across 50 users from same group (less noisy) was: 3.88
all_actions shape just before sample torch.Size([1, 28, 1])
action scaled by temperature: tensor([[47]], device='cuda:0')
action picked by argmax: tensor([47], device='cuda:0')
tensor([[ 47, 265, 160, 120,  19, 141,  98, 233,  83, 125]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
104         1       48       5       105
471         2       48       5       199
567         3       48       4        22
888         4       48       4        70
1155        5       48       4        64
       user_id  item_id  rating  timestep
12362       46       48       5        78
12710       47       48       4       153
12898       48       48       5        68
13180       49       48       4        77
13648       50       48       4       272
average_rating for this rec across 50 users from same group (less noisy) was: 4.08
all_actions shape just before sample torch.Size([1, 29, 1])
action scaled by temperature: tensor([[265]], device='cuda:0')
action picked by argmax: tensor([265], device='cuda:0')
tensor([[265,  47, 160,  38, 120,  35, 240, 205,  88, 218]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
81          1      266       3        82
342         2      266       3        70
793         3      266       4       248
901         4      266       3        83
1113        5      266       4        22
       user_id  item_id  rating  timestep
12394       46      266       5       110
12827       47      266       2       270
12927       48      266       5        97
13151       49      266       4        48
13393       50      266       5        17
average_rating for this rec across 50 users from same group (less noisy) was: 3.82
all_actions shape just before sample torch.Size([1, 30, 1])
action scaled by temperature: tensor([[141]], device='cuda:0')
action picked by argmax: tensor([141], device='cuda:0')
tensor([[141, 263,  41, 165, 133, 270, 267,   3,  77, 261]], device='cuda:0')
Just recommended 30 new items to 50 users from group 1 and the total rating was 124.36
train_loss is: 0.6217641454853423
action scaled by temperature: tensor([[15]], device='cuda:0')
action picked by argmax: tensor([54], device='cuda:0')
tensor([[ 54, 160,  39,  37,  10, 237, 129, 265, 227,  40]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
95          1       55       4        96
316         2       55       4        44
718         3       55       5       173
1034        4       55       5       216
1274        5       55       4       183
       user_id  item_id  rating  timestep
12450       46       55       3       166
12817       47       55       3       260
13041       48       55       4       211
13121       49       55       3        18
13504       50       55       3       128
average_rating for this rec across 50 users from same group (less noisy) was: 3.88
all_actions shape just before sample torch.Size([1, 1, 1])
action scaled by temperature: tensor([[257]], device='cuda:0')
action picked by argmax: tensor([250], device='cuda:0')
tensor([[250,   4,  93, 235, 190, 143, 254,  26, 110,  15]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
22          1      251       5        23
442         2      251       4       170
691         3      251       3       146
846         4      251       3        28
1092        5      251       4         1
       user_id  item_id  rating  timestep
12533       46      251       5       249
12709       47      251       5       152
13094       48      251       4       264
13262       49      251       2       159
13395       50      251       4        19
average_rating for this rec across 50 users from same group (less noisy) was: 3.88
all_actions shape just before sample torch.Size([1, 2, 1])
action scaled by temperature: tensor([[23]], device='cuda:0')
action picked by argmax: tensor([93], device='cuda:0')
tensor([[ 93,  23, 208,  51, 144, 204, 108, 146, 256, 141]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
115         1       94       5       116
391         2       94       5       119
752         3       94       5       207
929         4       94       5       111
1303        5       94       3       212
       user_id  item_id  rating  timestep
12500       46       94       4       216
12695       47       94       4       138
12964       48       94       5       134
13270       49       94       3       167
13589       50       94       4       213
average_rating for this rec across 50 users from same group (less noisy) was: 4.42
all_actions shape just before sample torch.Size([1, 3, 1])
action scaled by temperature: tensor([[76]], device='cuda:0')
action picked by argmax: tensor([76], device='cuda:0')
tensor([[ 76, 142,  94, 149, 227, 128, 196, 253, 169, 250]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
243         1       77       5       244
432         2       77       5       160
743         3       77       5       198
835         4       77       4        17
1233        5       77       4       142
       user_id  item_id  rating  timestep
12393       46       77       3       109
12719       47       77       4       162
13098       48       77       5       268
13143       49       77       4        40
13500       50       77       3       124
average_rating for this rec across 50 users from same group (less noisy) was: 3.96
all_actions shape just before sample torch.Size([1, 4, 1])
action scaled by temperature: tensor([[123]], device='cuda:0')
action picked by argmax: tensor([123], device='cuda:0')
tensor([[123, 149, 229,  86, 253, 169,  70, 230, 213,  80]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
178         1      124       5       179
430         2      124       3       158
600         3      124       4        55
826         4      124       5         8
1098        5      124       4         7
       user_id  item_id  rating  timestep
12550       46      124       3       266
12607       47      124       5        50
12899       48      124       4        69
13176       49      124       3        73
13398       50      124       5        22
average_rating for this rec across 50 users from same group (less noisy) was: 4.44
all_actions shape just before sample torch.Size([1, 5, 1])
action scaled by temperature: tensor([[206]], device='cuda:0')
action picked by argmax: tensor([206], device='cuda:0')
tensor([[206, 170,   8,  49, 259, 192, 163,   4,   0, 167]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
56          1      207       5        57
362         2      207       4        90
657         3      207       4       112
834         4      207       5        16
1156        5      207       5        65
       user_id  item_id  rating  timestep
12324       46      207       5        40
12751       47      207       3       194
12949       48      207       5       119
13307       49      207       5       204
13412       50      207       4        36
average_rating for this rec across 50 users from same group (less noisy) was: 4.24
all_actions shape just before sample torch.Size([1, 6, 1])
action scaled by temperature: tensor([[169]], device='cuda:0')
action picked by argmax: tensor([169], device='cuda:0')
tensor([[169, 269, 245, 230, 166, 255,  68,  21,  47, 212]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
126         1      170       5       127
429         2      170       5       157
722         3      170       4       177
983         4      170       5       165
1126        5      170       4        35
       user_id  item_id  rating  timestep
12490       46      170       4       206
12602       47      170       4        45
13027       48      170       5       197
13304       49      170       5       201
13599       50      170       5       223
average_rating for this rec across 50 users from same group (less noisy) was: 4.54
all_actions shape just before sample torch.Size([1, 7, 1])
action scaled by temperature: tensor([[116]], device='cuda:0')
action picked by argmax: tensor([116], device='cuda:0')
tensor([[116, 179,  88, 113, 225, 145, 163,   8,  84,  14]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
111         1      117       4       112
476         2      117       1       204
727         3      117       1       182
1058        4      117       2       240
1280        5      117       2       189
       user_id  item_id  rating  timestep
12364       46      117       1        80
12780       47      117       4       223
12950       48      117       4       120
13106       49      117       2         3
13568       50      117       5       192
average_rating for this rec across 50 users from same group (less noisy) was: 2.64
all_actions shape just before sample torch.Size([1, 8, 1])
action scaled by temperature: tensor([[111]], device='cuda:0')
action picked by argmax: tensor([111], device='cuda:0')
tensor([[111, 172, 166, 168, 247, 102,  79, 116, 242, 202]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
271         1      112       4       272
479         2      112       5       207
553         3      112       5         8
1041        4      112       5       223
1094        5      112       5         3
       user_id  item_id  rating  timestep
12382       46      112       5        98
12566       47      112       5         9
12954       48      112       4       124
13319       49      112       4       216
13388       50      112       5        12
average_rating for this rec across 50 users from same group (less noisy) was: 4.7
all_actions shape just before sample torch.Size([1, 9, 1])
action scaled by temperature: tensor([[253]], device='cuda:0')
action picked by argmax: tensor([253], device='cuda:0')
tensor([[253, 251,   0,  81,  70,  34, 102, 225, 262,  79]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
102         1      254       3       103
293         2      254       4        21
648         3      254       3       103
987         4      254       4       169
1301        5      254       5       210
       user_id  item_id  rating  timestep
12416       46      254       4       132
12624       47      254       4        67
12971       48      254       4       141
13226       49      254       4       123
13624       50      254       5       248
average_rating for this rec across 50 users from same group (less noisy) was: 4.12
all_actions shape just before sample torch.Size([1, 10, 1])
action scaled by temperature: tensor([[51]], device='cuda:0')
action picked by argmax: tensor([51], device='cuda:0')
tensor([[ 51, 170, 182, 125,  68, 230, 240, 202, 158,  90]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
206         1       52       4       207
379         2       52       4       107
570         3       52       5        25
844         4       52       4        26
1208        5       52       4       117
       user_id  item_id  rating  timestep
12557       46       52       4       273
12712       47       52       5       155
12944       48       52       4       114
13107       49       52       4         4
13387       50       52       4        11
average_rating for this rec across 50 users from same group (less noisy) was: 4.18
all_actions shape just before sample torch.Size([1, 11, 1])
action scaled by temperature: tensor([[125]], device='cuda:0')
action picked by argmax: tensor([125], device='cuda:0')
tensor([[125, 109,  53, 117,  51, 155, 184,  34,  70, 203]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
204         1      126       5       205
367         2      126       3        95
594         3      126       3        49
1031        4      126       2       213
1200        5      126       3       109
       user_id  item_id  rating  timestep
12366       46      126       3        82
12598       47      126       3        41
13012       48      126       3       182
13223       49      126       4       120
13647       50      126       4       271
average_rating for this rec across 50 users from same group (less noisy) was: 3.32
all_actions shape just before sample torch.Size([1, 12, 1])
action scaled by temperature: tensor([[110]], device='cuda:0')
action picked by argmax: tensor([110], device='cuda:0')
tensor([[110, 126, 182,  73, 205, 246, 149,  42, 145,  68]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
45          1      111       3        46
436         2      111       4       164
815         3      111       3       270
940         4      111       2       122
1196        5      111       3       105
       user_id  item_id  rating  timestep
12346       46      111       3        62
12636       47      111       4        79
12867       48      111       4        37
13207       49      111       5       104
13617       50      111       3       241
average_rating for this rec across 50 users from same group (less noisy) was: 3.72
all_actions shape just before sample torch.Size([1, 13, 1])
action scaled by temperature: tensor([[73]], device='cuda:0')
action picked by argmax: tensor([73], device='cuda:0')
tensor([[ 73,  17, 248, 157, 145,   1, 128, 110, 191,  89]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
94          1       74       4        95
484         2       74       4       212
810         3       74       4       265
933         4       74       5       115
1209        5       74       4       118
       user_id  item_id  rating  timestep
12430       46       74       4       146
12806       47       74       4       249
12873       48       74       4        43
13237       49       74       3       134
13524       50       74       4       148
average_rating for this rec across 50 users from same group (less noisy) was: 3.88
all_actions shape just before sample torch.Size([1, 14, 1])
action scaled by temperature: tensor([[89]], device='cuda:0')
action picked by argmax: tensor([89], device='cuda:0')
tensor([[ 89, 157,  30,  73, 149,  17, 269, 213, 198, 110]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
108         1       90       4       109
482         2       90       4       210
751         3       90       4       206
1056        4       90       4       238
1114        5       90       4        23
       user_id  item_id  rating  timestep
12495       46       90       5       211
12823       47       90       4       266
13100       48       90       4       270
13366       49       90       4       263
13641       50       90       4       265
average_rating for this rec across 50 users from same group (less noisy) was: 3.88
all_actions shape just before sample torch.Size([1, 15, 1])
action scaled by temperature: tensor([[30]], device='cuda:0')
action picked by argmax: tensor([30], device='cuda:0')
tensor([[ 30, 149, 196,  89,  48, 145, 110,  63,  71,  66]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
31          1       31       4        32
538         2       31       4       266
740         3       31       4       195
1053        4       31       5       235
1186        5       31       5        95
       user_id  item_id  rating  timestep
12404       46       31       5       120
12738       47       31       5       181
12892       48       31       5        62
13137       49       31       5        34
13462       50       31       4        86
average_rating for this rec across 50 users from same group (less noisy) was: 4.8
all_actions shape just before sample torch.Size([1, 16, 1])
action scaled by temperature: tensor([[149]], device='cuda:0')
action picked by argmax: tensor([149], device='cuda:0')
tensor([[149,  24, 248, 202,  79, 217, 142,  20,  93,  73]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
59          1      150       4        60
274         2      150       1         2
792         3      150       3       247
952         4      150       4       134
1175        5      150       3        84
       user_id  item_id  rating  timestep
12343       46      150       3        59
12750       47      150       3       193
13050       48      150       2       220
13125       49      150       2        22
13522       50      150       4       146
average_rating for this rec across 50 users from same group (less noisy) was: 3.26
all_actions shape just before sample torch.Size([1, 17, 1])
action scaled by temperature: tensor([[142]], device='cuda:0')
action picked by argmax: tensor([142], device='cuda:0')
tensor([[142, 248,  64, 149,  26,   4,  79,  91, 145,  73]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
142         1      143       3       143
323         2      143       4        51
572         3      143       3        27
824         4      143       4         6
1327        5      143       5       236
       user_id  item_id  rating  timestep
12405       46      143       5       121
12687       47      143       5       130
13063       48      143       4       233
13260       49      143       4       157
13561       50      143       5       185
average_rating for this rec across 50 users from same group (less noisy) was: 4.18
all_actions shape just before sample torch.Size([1, 18, 1])
action scaled by temperature: tensor([[91]], device='cuda:0')
action picked by argmax: tensor([91], device='cuda:0')
tensor([[ 91, 186,  38, 248, 158, 160, 239, 270, 271, 236]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
114         1       92       5       115
426         2       92       5       154
610         3       92       5        65
955         4       92       5       137
1202        5       92       5       111
       user_id  item_id  rating  timestep
12453       46       92       5       169
12616       47       92       4        59
12924       48       92       5        94
13280       49       92       4       177
13440       50       92       5        64
average_rating for this rec across 50 users from same group (less noisy) was: 4.64
all_actions shape just before sample torch.Size([1, 19, 1])
action scaled by temperature: tensor([[248]], device='cuda:0')
action picked by argmax: tensor([248], device='cuda:0')
tensor([[248,  71, 205,  38, 149, 213,  14, 190, 196, 221]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
113         1      249       5       114
445         2      249       5       173
590         3      249       4        45
1075        4      249       4       257
1115        5      249       5        24
       user_id  item_id  rating  timestep
12502       46      249       5       218
12627       47      249       5        70
13065       48      249       4       235
13191       49      249       5        88
13541       50      249       5       165
average_rating for this rec across 50 users from same group (less noisy) was: 4.7
all_actions shape just before sample torch.Size([1, 20, 1])
action scaled by temperature: tensor([[38]], device='cuda:0')
action picked by argmax: tensor([38], device='cuda:0')
tensor([[ 38,  91, 150, 244, 113, 116, 186, 205, 175, 271]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
264         1       39       3       265
276         2       39       3         4
670         3       39       2       125
899         4       39       3        81
1171        5       39       4        80
       user_id  item_id  rating  timestep
12532       46       39       3       248
12562       47       39       3         5
13086       48       39       2       256
13210       49       39       3       107
13467       50       39       3        91
average_rating for this rec across 50 users from same group (less noisy) was: 3.04
all_actions shape just before sample torch.Size([1, 21, 1])
action scaled by temperature: tensor([[119]], device='cuda:0')
action picked by argmax: tensor([119], device='cuda:0')
tensor([[119,  22, 248, 205, 151,  23, 272,  39, 102, 232]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
138         1      120       5       139
524         2      120       4       252
674         3      120       2       129
957         4      120       2       139
1242        5      120       3       151
       user_id  item_id  rating  timestep
12334       46      120       4        50
12574       47      120       3        17
12876       48      120       5        46
13120       49      120       5        17
13389       50      120       5        13
average_rating for this rec across 50 users from same group (less noisy) was: 3.74
all_actions shape just before sample torch.Size([1, 22, 1])
action scaled by temperature: tensor([[63]], device='cuda:0')
action picked by argmax: tensor([63], device='cuda:0')
tensor([[ 63, 202,  19, 164, 161, 168, 270, 195,  25,  50]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
227         1       64       5       228
530         2       64       4       258
781         3       64       4       236
1036        4       64       5       218
1148        5       64       5        57
       user_id  item_id  rating  timestep
12401       46       64       3       117
12630       47       64       3        73
12869       48       64       4        39
13138       49       64       5        35
13605       50       64       4       229
average_rating for this rec across 50 users from same group (less noisy) was: 3.82
all_actions shape just before sample torch.Size([1, 23, 1])
action scaled by temperature: tensor([[238]], device='cuda:0')
action picked by argmax: tensor([238], device='cuda:0')
tensor([[238,  62,  49, 106, 250, 217, 159,   3, 141,  68]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
91          1      239       5        92
481         2      239       4       209
596         3      239       5        51
962         4      239       5       144
1362        5      239       5       271
       user_id  item_id  rating  timestep
12486       46      239       5       202
12613       47      239       4        56
13047       48      239       4       217
13194       49      239       4        91
13525       50      239       5       149
average_rating for this rec across 50 users from same group (less noisy) was: 4.58
all_actions shape just before sample torch.Size([1, 24, 1])
action scaled by temperature: tensor([[62]], device='cuda:0')
action picked by argmax: tensor([62], device='cuda:0')
tensor([[ 62, 102, 106,  75, 229, 173,  91, 100, 156, 153]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
221         1       63       5       222
458         2       63       4       186
619         3       63       3        74
1089        4       63       4       271
1340        5       63       3       249
       user_id  item_id  rating  timestep
12354       46       63       4        70
12650       47       63       3        93
12903       48       63       3        73
13166       49       63       3        63
13459       50       63       3        83
average_rating for this rec across 50 users from same group (less noisy) was: 3.72
all_actions shape just before sample torch.Size([1, 25, 1])
action scaled by temperature: tensor([[106]], device='cuda:0')
action picked by argmax: tensor([106], device='cuda:0')
tensor([[106, 271,  44,  58, 238,   2, 265, 242, 115,  38]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
173         1      107       4       174
382         2      107       4       110
769         3      107       4       224
995         4      107       5       177
1261        5      107       4       170
       user_id  item_id  rating  timestep
12344       46      107       3        60
12657       47      107       4       100
12939       48      107       5       109
13284       49      107       3       181
13531       50      107       4       155
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 26, 1])
action scaled by temperature: tensor([[241]], device='cuda:0')
action picked by argmax: tensor([241], device='cuda:0')
tensor([[241, 231, 153,  64, 132, 136,  71, 106, 131, 190]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
210         1      242       5       211
333         2      242       5        61
602         3      242       4        57
975         4      242       2       157
1297        5      242       5       206
       user_id  item_id  rating  timestep
12442       46      242       4       158
12609       47      242       4        52
13081       48      242       5       251
13312       49      242       5       209
13628       50      242       5       252
average_rating for this rec across 50 users from same group (less noisy) was: 4.08
all_actions shape just before sample torch.Size([1, 27, 1])
action scaled by temperature: tensor([[125]], device='cuda:0')
action picked by argmax: tensor([125], device='cuda:0')
tensor([[125,  33, 234,  82, 143, 149, 253,  90,  68, 258]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
204         1      126       5       205
367         2      126       3        95
594         3      126       3        49
1031        4      126       2       213
1200        5      126       3       109
       user_id  item_id  rating  timestep
12366       46      126       3        82
12598       47      126       3        41
13012       48      126       3       182
13223       49      126       4       120
13647       50      126       4       271
average_rating for this rec across 50 users from same group (less noisy) was: 3.32
all_actions shape just before sample torch.Size([1, 28, 1])
action scaled by temperature: tensor([[68]], device='cuda:0')
action picked by argmax: tensor([68], device='cuda:0')
tensor([[ 68,  24, 159,  30,  65, 149, 191, 237, 250,  26]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
90          1       69       3        91
513         2       69       4       241
665         3       69       4       120
988         4       69       5       170
1117        5       69       4        26
       user_id  item_id  rating  timestep
12451       46       69       4       167
12690       47       69       5       133
12874       48       69       4        44
13224       49       69       4       121
13590       50       69       4       214
average_rating for this rec across 50 users from same group (less noisy) was: 3.92
all_actions shape just before sample torch.Size([1, 29, 1])
action scaled by temperature: tensor([[33]], device='cuda:0')
action picked by argmax: tensor([33], device='cuda:0')
tensor([[ 33,  36, 143,   5,  32, 150,  44, 248,  46, 163]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
18          1       34       3        19
529         2       34       5       257
804         3       34       4       259
1077        4       34       5       259
1250        5       34       4       159
       user_id  item_id  rating  timestep
12531       46       34       4       247
12656       47       34       5        99
12863       48       34       5        33
13215       49       34       3       112
13384       50       34       4         8
average_rating for this rec across 50 users from same group (less noisy) was: 4.18
all_actions shape just before sample torch.Size([1, 30, 1])
action scaled by temperature: tensor([[212]], device='cuda:0')
action picked by argmax: tensor([212], device='cuda:0')
tensor([[212,   9,  46, 143, 207, 248,  27, 251, 133,   5]], device='cuda:0')
Just recommended 30 new items to 50 users from group 1 and the total rating was 119.84
train_loss is: 0.5834186379223654
action scaled by temperature: tensor([[11]], device='cuda:0')
action picked by argmax: tensor([227], device='cuda:0')
tensor([[227,  61, 109,  28,  75, 169, 187,  83,  30, 265]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
205         1      228       4       206
490         2      228       3       218
663         3      228       3       118
1070        4      228       2       252
1271        5      228       3       180
       user_id  item_id  rating  timestep
12329       46      228       4        45
12703       47      228       3       146
12879       48      228       5        49
13111       49      228       2         8
13530       50      228       4       154
average_rating for this rec across 50 users from same group (less noisy) was: 3.34
all_actions shape just before sample torch.Size([1, 1, 1])
action scaled by temperature: tensor([[105]], device='cuda:0')
action picked by argmax: tensor([254], device='cuda:0')
tensor([[254, 143,  39, 109, 100, 139,  18, 233, 175, 107]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
153         1      255       5       154
544         2      255       5       272
618         3      255       4        73
989         4      255       5       171
1214        5      255       4       123
       user_id  item_id  rating  timestep
12365       46      255       5        81
12724       47      255       4       167
12933       48      255       4       103
13227       49      255       3       124
13601       50      255       3       225
average_rating for this rec across 50 users from same group (less noisy) was: 4.5
all_actions shape just before sample torch.Size([1, 2, 1])
action scaled by temperature: tensor([[102]], device='cuda:0')
action picked by argmax: tensor([75], device='cuda:0')
tensor([[ 75, 102, 262,  78,  94, 126,  29, 100, 153, 140]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
76          1       76       5        77
330         2       76       4        58
571         3       76       3        26
915         4       76       4        97
1167        5       76       4        76
       user_id  item_id  rating  timestep
12440       46       76       3       156
12588       47       76       4        31
12957       48       76       3       127
13325       49       76       5       222
13468       50       76       5        92
average_rating for this rec across 50 users from same group (less noisy) was: 4.04
all_actions shape just before sample torch.Size([1, 3, 1])
action scaled by temperature: tensor([[101]], device='cuda:0')
action picked by argmax: tensor([101], device='cuda:0')
tensor([[101,  56,  63, 266, 114, 127,  89, 110,  23, 248]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
103         1      102       4       104
377         2      102       4       105
581         3      102       3        36
1082        4      102       5       264
1107        5      102       4        16
       user_id  item_id  rating  timestep
12374       46      102       5        90
12638       47      102       5        81
12875       48      102       5        45
13115       49      102       5        12
13571       50      102       4       195
average_rating for this rec across 50 users from same group (less noisy) was: 4.1
all_actions shape just before sample torch.Size([1, 4, 1])
action scaled by temperature: tensor([[50]], device='cuda:0')
action picked by argmax: tensor([50], device='cuda:0')
tensor([[ 50, 101,  89, 127, 250, 262,  55,  84, 266, 138]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
234         1       51       4       235
498         2       51       3       226
789         3       51       4       244
1040        4       51       4       222
1226        5       51       4       135
       user_id  item_id  rating  timestep
12330       46       51       3        46
12720       47       51       5       163
12981       48       51       3       151
13110       49       51       5         7
13618       50       51       4       242
average_rating for this rec across 50 users from same group (less noisy) was: 3.86
all_actions shape just before sample torch.Size([1, 5, 1])
action scaled by temperature: tensor([[175]], device='cuda:0')
action picked by argmax: tensor([175], device='cuda:0')
tensor([[175, 171,  61, 186,  35,  85, 237, 244,  84,  78]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
263         1      176       4       264
313         2      176       5        41
598         3      176       4        53
921         4      176       5       103
1152        5      176       4        61
       user_id  item_id  rating  timestep
12422       46      176       3       138
12593       47      176       4        36
12990       48      176       4       160
13373       49      176       3       270
13441       50      176       4        65
average_rating for this rec across 50 users from same group (less noisy) was: 4.24
all_actions shape just before sample torch.Size([1, 6, 1])
action scaled by temperature: tensor([[61]], device='cuda:0')
action picked by argmax: tensor([61], device='cuda:0')
tensor([[ 61, 129, 193, 175, 138, 182,  85, 126,   1,  18]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
30          1       62       5        31
312         2       62       4        40
601         3       62       5        56
972         4       62       5       154
1216        5       62       4       125
       user_id  item_id  rating  timestep
12507       46       62       5       223
12631       47       62       5        74
12897       48       62       5        67
13296       49       62       4       193
13527       50       62       5       151
average_rating for this rec across 50 users from same group (less noisy) was: 4.76
all_actions shape just before sample torch.Size([1, 7, 1])
action scaled by temperature: tensor([[1]], device='cuda:0')
action picked by argmax: tensor([1], device='cuda:0')
tensor([[  1, 231,  61, 138, 246,  30, 113, 134, 182,  28]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
41          1        2       5        42
443         2        2       5       171
788         3        2       5       243
891         4        2       4        73
1097        5        2       5         6
       user_id  item_id  rating  timestep
12508       46        2       5       224
12785       47        2       4       228
13021       48        2       5       191
13124       49        2       5        21
13637       50        2       5       261
average_rating for this rec across 50 users from same group (less noisy) was: 4.72
all_actions shape just before sample torch.Size([1, 8, 1])
action scaled by temperature: tensor([[180]], device='cuda:0')
action picked by argmax: tensor([180], device='cuda:0')
tensor([[180,  28,  97, 184, 138, 201,  25, 155, 145, 135]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
73          1      181       5        74
326         2      181       4        54
708         3      181       5       163
934         4      181       4       116
1231        5      181       5       140
       user_id  item_id  rating  timestep
12317       46      181       4        33
12688       47      181       5       131
13048       48      181       5       218
13131       49      181       5        28
13517       50      181       5       141
average_rating for this rec across 50 users from same group (less noisy) was: 4.68
all_actions shape just before sample torch.Size([1, 9, 1])
action scaled by temperature: tensor([[97]], device='cuda:0')
action picked by argmax: tensor([97], device='cuda:0')
tensor([[ 97,  99, 116,  11, 155, 232, 109, 184, 106,  96]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
174         1       98       4       175
414         2       98       4       142
681         3       98       2       136
941         4       98       3       123
1120        5       98       3        29
       user_id  item_id  rating  timestep
12465       46       98       4       181
12789       47       98       3       232
13078       48       98       4       248
13292       49       98       4       189
13565       50       98       4       189
average_rating for this rec across 50 users from same group (less noisy) was: 3.52
all_actions shape just before sample torch.Size([1, 10, 1])
action scaled by temperature: tensor([[235]], device='cuda:0')
action picked by argmax: tensor([235], device='cuda:0')
tensor([[235, 245,  99, 112, 175, 223, 138, 140, 109, 155]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
57          1      236       5        58
392         2      236       4       120
770         3      236       4       225
825         4      236       5         7
1151        5      236       4        60
       user_id  item_id  rating  timestep
12321       46      236       3        37
12669       47      236       5       112
12940       48      236       3       110
13113       49      236       4        10
13638       50      236       3       262
average_rating for this rec across 50 users from same group (less noisy) was: 4.26
all_actions shape just before sample torch.Size([1, 11, 1])
action scaled by temperature: tensor([[109]], device='cuda:0')
action picked by argmax: tensor([109], device='cuda:0')
tensor([[109,  97,  39,  14, 232,  99, 255,  98, 115,  28]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
132         1      110       4       133
472         2      110       5       200
687         3      110       5       142
910         4      110       5        92
1217        5      110       4       126
       user_id  item_id  rating  timestep
12408       46      110       5       124
12729       47      110       5       172
12956       48      110       5       126
13369       49      110       5       266
13458       50      110       5        82
average_rating for this rec across 50 users from same group (less noisy) was: 4.66
all_actions shape just before sample torch.Size([1, 12, 1])
action scaled by temperature: tensor([[169]], device='cuda:0')
action picked by argmax: tensor([169], device='cuda:0')
tensor([[169, 173,  51, 147, 127, 175,  28, 180, 259, 232]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
126         1      170       5       127
429         2      170       5       157
722         3      170       4       177
983         4      170       5       165
1126        5      170       4        35
       user_id  item_id  rating  timestep
12490       46      170       4       206
12602       47      170       4        45
13027       48      170       5       197
13304       49      170       5       201
13599       50      170       5       223
average_rating for this rec across 50 users from same group (less noisy) was: 4.54
all_actions shape just before sample torch.Size([1, 13, 1])
action scaled by temperature: tensor([[147]], device='cuda:0')
action picked by argmax: tensor([147], device='cuda:0')
tensor([[147, 127,  14,  83,  13,  42,  64, 213, 152, 194]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
246         1      148       5       247
493         2      148       3       221
652         3      148       3       107
961         4      148       4       143
1311        5      148       3       220
       user_id  item_id  rating  timestep
12463       46      148       4       179
12766       47      148       4       209
13010       48      148       4       180
13299       49      148       4       196
13532       50      148       3       156
average_rating for this rec across 50 users from same group (less noisy) was: 3.76
all_actions shape just before sample torch.Size([1, 14, 1])
action scaled by temperature: tensor([[127]], device='cuda:0')
action picked by argmax: tensor([127], device='cuda:0')
tensor([[127, 244,  83, 147,  26,  82, 241, 120, 237, 193]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
261         1      128       4       262
297         2      128       5        25
682         3      128       4       137
869         4      128       3        51
1358        5      128       4       267
       user_id  item_id  rating  timestep
12541       46      128       4       257
12674       47      128       3       117
12840       48      128       4        10
13344       49      128       5       241
13619       50      128       4       243
average_rating for this rec across 50 users from same group (less noisy) was: 4.08
all_actions shape just before sample torch.Size([1, 15, 1])
action scaled by temperature: tensor([[152]], device='cuda:0')
action picked by argmax: tensor([152], device='cuda:0')
tensor([[152, 111, 195, 209,  74,  10, 272,  83, 106, 142]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
27          1      153       4        28
428         2      153       1       156
586         3      153       3        41
884         4      153       5        66
1288        5      153       5       197
       user_id  item_id  rating  timestep
12423       46      153       3       139
12632       47      153       4        75
12955       48      153       3       125
13197       49      153       4        94
13405       50      153       4        29
average_rating for this rec across 50 users from same group (less noisy) was: 3.58
all_actions shape just before sample torch.Size([1, 16, 1])
action scaled by temperature: tensor([[111]], device='cuda:0')
action picked by argmax: tensor([111], device='cuda:0')
tensor([[111, 152,  13,  10, 213, 169, 269, 106,  74,  88]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
271         1      112       4       272
479         2      112       5       207
553         3      112       5         8
1041        4      112       5       223
1094        5      112       5         3
       user_id  item_id  rating  timestep
12382       46      112       5        98
12566       47      112       5         9
12954       48      112       4       124
13319       49      112       4       216
13388       50      112       5        12
average_rating for this rec across 50 users from same group (less noisy) was: 4.7
all_actions shape just before sample torch.Size([1, 17, 1])
action scaled by temperature: tensor([[13]], device='cuda:0')
action picked by argmax: tensor([13], device='cuda:0')
tensor([[ 13,  72, 117, 171,  84, 240,  41, 111, 152, 205]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
265         1       14       5       266
319         2       14       5        47
782         3       14       4       237
1043        4       14       4       225
1336        5       14       5       245
       user_id  item_id  rating  timestep
12497       46       14       4       213
12794       47       14       5       237
13093       48       14       4       263
13293       49       14       5       190
13396       50       14       5        20
average_rating for this rec across 50 users from same group (less noisy) was: 4.64
all_actions shape just before sample torch.Size([1, 18, 1])
action scaled by temperature: tensor([[92]], device='cuda:0')
action picked by argmax: tensor([92], device='cuda:0')
tensor([[ 92, 170,  41,  50, 154, 198, 236,  34, 160, 190]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
240         1       93       5       241
512         2       93       5       240
614         3       93       4        69
881         4       93       5        63
1326        5       93       5       235
       user_id  item_id  rating  timestep
12349       46       93       5        65
12787       47       93       5       230
12886       48       93       5        56
13259       49       93       5       156
13386       50       93       4        10
average_rating for this rec across 50 users from same group (less noisy) was: 4.58
all_actions shape just before sample torch.Size([1, 19, 1])
action scaled by temperature: tensor([[34]], device='cuda:0')
action picked by argmax: tensor([34], device='cuda:0')
tensor([[ 34, 195,  40, 203, 272, 236,  85, 115,  53, 148]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
171         1       35       3       172
523         2       35       4       251
764         3       35       5       219
839         4       35       3        21
1224        5       35       4       133
       user_id  item_id  rating  timestep
12498       46       35       3       214
12701       47       35       4       144
13023       48       35       2       193
13159       49       35       4        56
13622       50       35       4       246
average_rating for this rec across 50 users from same group (less noisy) was: 4.04
all_actions shape just before sample torch.Size([1, 20, 1])
action scaled by temperature: tensor([[130]], device='cuda:0')
action picked by argmax: tensor([130], device='cuda:0')
tensor([[130, 189,  55,   9,  22, 101,  24, 185, 260,  65]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
179         1      131       4       180
394         2      131       4       122
702         3      131       4       157
984         4      131       4       166
1272        5      131       3       181
       user_id  item_id  rating  timestep
12300       46      131       4        16
12775       47      131       5       218
12907       48      131       4        77
13164       49      131       4        61
13528       50      131       4       152
average_rating for this rec across 50 users from same group (less noisy) was: 3.92
all_actions shape just before sample torch.Size([1, 21, 1])
action scaled by temperature: tensor([[9]], device='cuda:0')
action picked by argmax: tensor([9], device='cuda:0')
tensor([[  9,  55, 110,  50, 231, 121, 169, 108, 130, 226]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
256         1       10       5       257
308         2       10       5        36
626         3       10       4        81
1055        4       10       4       237
1193        5       10       5       102
       user_id  item_id  rating  timestep
12521       46       10       5       237
12698       47       10       5       141
12982       48       10       4       152
13245       49       10       5       142
13461       50       10       4        85
average_rating for this rec across 50 users from same group (less noisy) was: 4.56
all_actions shape just before sample torch.Size([1, 22, 1])
action scaled by temperature: tensor([[121]], device='cuda:0')
action picked by argmax: tensor([121], device='cuda:0')
tensor([[121,  55, 226, 231, 110, 233,  25,  83,  58,  27]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
226         1      122       4       227
525         2      122       5       253
746         3      122       5       201
951         4      122       5       133
1363        5      122       5       272
       user_id  item_id  rating  timestep
12294       46      122       5        10
12700       47      122       4       143
13035       48      122       5       205
13302       49      122       5       199
13610       50      122       5       234
average_rating for this rec across 50 users from same group (less noisy) was: 4.84
all_actions shape just before sample torch.Size([1, 23, 1])
action scaled by temperature: tensor([[231]], device='cuda:0')
action picked by argmax: tensor([231], device='cuda:0')
tensor([[231, 110, 226, 107,  42, 116, 253, 233,  27, 193]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
250         1      232       4       251
469         2      232       4       197
557         3      232       4        12
922         4      232       5       104
1265        5      232       5       174
       user_id  item_id  rating  timestep
12299       46      232       5        15
12815       47      232       3       258
12865       48      232       4        35
13142       49      232       5        39
13469       50      232       3        93
average_rating for this rec across 50 users from same group (less noisy) was: 4.38
all_actions shape just before sample torch.Size([1, 24, 1])
action scaled by temperature: tensor([[107]], device='cuda:0')
action picked by argmax: tensor([107], device='cuda:0')
tensor([[107, 222,  58, 133,  24,  16, 231, 113, 180, 201]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
137         1      108       4       138
320         2      108       5        48
555         3      108       5        10
1033        4      108       4       215
1304        5      108       4       213
       user_id  item_id  rating  timestep
12385       46      108       5       101
12814       47      108       4       257
12864       48      108       5        34
13276       49      108       4       173
13592       50      108       5       216
average_rating for this rec across 50 users from same group (less noisy) was: 4.4
all_actions shape just before sample torch.Size([1, 25, 1])
action scaled by temperature: tensor([[191]], device='cuda:0')
action picked by argmax: tensor([191], device='cuda:0')
tensor([[191, 105, 141,  63, 127,  68, 266, 234,  84, 156]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
32          1      192       4        33
537         2      192       4       265
582         3      192       5        37
1010        4      192       5       192
1170        5      192       4        79
       user_id  item_id  rating  timestep
12369       46      192       5        85
12673       47      192       5       116
13020       48      192       5       190
13277       49      192       4       174
13457       50      192       4        81
average_rating for this rec across 50 users from same group (less noisy) was: 4.34
all_actions shape just before sample torch.Size([1, 26, 1])
action scaled by temperature: tensor([[141]], device='cuda:0')
action picked by argmax: tensor([141], device='cuda:0')
tensor([[141, 188,  88, 127, 191, 248, 220,  39, 227,  14]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
1           1      142       4         2
459         2      142       5       187
818         3      142       4       273
1091        4      142       5       273
1169        5      142       4        78
       user_id  item_id  rating  timestep
12356       46      142       5        72
12768       47      142       5       211
13009       48      142       4       179
13205       49      142       5       102
13514       50      142       5       138
average_rating for this rec across 50 users from same group (less noisy) was: 4.72
all_actions shape just before sample torch.Size([1, 27, 1])
action scaled by temperature: tensor([[243]], device='cuda:0')
action picked by argmax: tensor([243], device='cuda:0')
tensor([[243, 262,   0, 231, 138,  55, 269, 156, 113,  61]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
105         1      244       3       106
335         2      244       4        63
627         3      244       4        82
838         4      244       4        20
1190        5      244       4        99
       user_id  item_id  rating  timestep
12314       46      244       3        30
12617       47      244       4        60
12887       48      244       3        57
13301       49      244       4       198
13579       50      244       3       203
average_rating for this rec across 50 users from same group (less noisy) was: 3.76
all_actions shape just before sample torch.Size([1, 28, 1])
action scaled by temperature: tensor([[156]], device='cuda:0')
action picked by argmax: tensor([156], device='cuda:0')
tensor([[156,  61, 113,  29, 265,  27, 248, 127, 243, 138]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
150         1      157       4       151
541         2      157       4       269
705         3      157       3       160
976         4      157       3       158
1105        5      157       4        14
       user_id  item_id  rating  timestep
12378       46      157       4        94
12726       47      157       4       169
12842       48      157       5        12
13320       49      157       3       217
13614       50      157       4       238
average_rating for this rec across 50 users from same group (less noisy) was: 3.96
all_actions shape just before sample torch.Size([1, 29, 1])
action scaled by temperature: tensor([[180]], device='cuda:0')
action picked by argmax: tensor([180], device='cuda:0')
tensor([[180, 153,  80,  93, 254,  44, 114,  68, 216,  64]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
73          1      181       5        74
326         2      181       4        54
708         3      181       5       163
934         4      181       4       116
1231        5      181       5       140
       user_id  item_id  rating  timestep
12317       46      181       4        33
12688       47      181       5       131
13048       48      181       5       218
13131       49      181       5        28
13517       50      181       5       141
average_rating for this rec across 50 users from same group (less noisy) was: 4.68
all_actions shape just before sample torch.Size([1, 30, 1])
action scaled by temperature: tensor([[153]], device='cuda:0')
action picked by argmax: tensor([153], device='cuda:0')
tensor([[153,  14, 161, 189, 142,  29, 217, 262,  50,  91]], device='cuda:0')
Just recommended 30 new items to 50 users from group 1 and the total rating was 128.16
train_losses: [5.614692313486039, 5.60392835042248, 5.5952024198558235, 5.572816123701122, 5.544280947071233, 5.52362474458947, 5.504104307253066, 5.482213309910744, 5.439589953313679, 5.322082541304637, 5.020728575040216, 4.364032933701119, 3.524766882804975, 2.8096437454223633, 2.2657256572758224, 1.8312128695178793, 1.5377702914416518, 1.4131882729595655, 1.3546812365588532, 1.3347034481562436, 1.4146205486227932, 1.4964838664825648, 1.5080817758220515, 1.4262968900541193, 1.2623871194717546, 1.0656952144892793, 0.8789091474933711, 0.7272320400634312, 0.6217641454853423, 0.5834186379223654]
rewards_per_epoch: [125.99999999999994, 123.84000000000002, 93.20000000000003, 114.96, 115.94000000000001, 121.98, 118.80000000000004, 123.96000000000002, 116.55999999999997, 125.66, 111.44000000000005, 115.16000000000003, 123.87999999999997, 122.53999999999999, 121.82000000000002, 122.77999999999999, 122.53999999999999, 122.53999999999999, 122.77999999999999, 121.11999999999999, 117.35999999999997, 125.62, 120.89999999999998, 121.63999999999999, 118.11999999999999, 118.25999999999999, 124.2, 124.36, 119.84, 128.16]
30 64 6 8 128 data/goodreads_eval_20pc_constant_state.tsv 14080 0.0048 True 256 30
