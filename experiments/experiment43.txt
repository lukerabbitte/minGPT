train_loss is: 5.612226200974695
action scaled by temperature: tensor([[111]], device='cuda:0')
action picked by argmax: tensor([227], device='cuda:0')
tensor([[227, 109,  75, 205, 237, 211, 268,  39, 163, 223]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
205         1      228       4       206
490         2      228       3       218
663         3      228       3       118
1070        4      228       2       252
1271        5      228       3       180
       user_id  item_id  rating  timestep
12329       46      228       4        45
12703       47      228       3       146
12879       48      228       5        49
13111       49      228       2         8
13530       50      228       4       154
average_rating for this rec across 50 users from same group (less noisy) was: 3.34
all_actions shape just before sample torch.Size([1, 1, 1])
action scaled by temperature: tensor([[105]], device='cuda:0')
action picked by argmax: tensor([227], device='cuda:0')
tensor([[227,  75, 211, 205, 223,  39, 109,  37, 237, 268]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
205         1      228       4       206
490         2      228       3       218
663         3      228       3       118
1070        4      228       2       252
1271        5      228       3       180
       user_id  item_id  rating  timestep
12329       46      228       4        45
12703       47      228       3       146
12879       48      228       5        49
13111       49      228       2         8
13530       50      228       4       154
average_rating for this rec across 50 users from same group (less noisy) was: 3.34
all_actions shape just before sample torch.Size([1, 2, 1])
action scaled by temperature: tensor([[197]], device='cuda:0')
action picked by argmax: tensor([227], device='cuda:0')
tensor([[227,  75, 211, 205, 223, 109,  39, 237,  37, 268]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
205         1      228       4       206
490         2      228       3       218
663         3      228       3       118
1070        4      228       2       252
1271        5      228       3       180
       user_id  item_id  rating  timestep
12329       46      228       4        45
12703       47      228       3       146
12879       48      228       5        49
13111       49      228       2         8
13530       50      228       4       154
average_rating for this rec across 50 users from same group (less noisy) was: 3.34
all_actions shape just before sample torch.Size([1, 3, 1])
action scaled by temperature: tensor([[44]], device='cuda:0')
action picked by argmax: tensor([227], device='cuda:0')
tensor([[227,  75, 211, 205, 223,  39, 109,  37, 237, 196]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
205         1      228       4       206
490         2      228       3       218
663         3      228       3       118
1070        4      228       2       252
1271        5      228       3       180
       user_id  item_id  rating  timestep
12329       46      228       4        45
12703       47      228       3       146
12879       48      228       5        49
13111       49      228       2         8
13530       50      228       4       154
average_rating for this rec across 50 users from same group (less noisy) was: 3.34
all_actions shape just before sample torch.Size([1, 4, 1])
action scaled by temperature: tensor([[147]], device='cuda:0')
action picked by argmax: tensor([227], device='cuda:0')
tensor([[227,  75, 211, 109, 205, 237,  39, 268, 223, 163]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
205         1      228       4       206
490         2      228       3       218
663         3      228       3       118
1070        4      228       2       252
1271        5      228       3       180
       user_id  item_id  rating  timestep
12329       46      228       4        45
12703       47      228       3       146
12879       48      228       5        49
13111       49      228       2         8
13530       50      228       4       154
average_rating for this rec across 50 users from same group (less noisy) was: 3.34
all_actions shape just before sample torch.Size([1, 5, 1])
action scaled by temperature: tensor([[87]], device='cuda:0')
action picked by argmax: tensor([227], device='cuda:0')
tensor([[227,  75, 211, 205, 109,  39, 223, 237, 268,  37]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
205         1      228       4       206
490         2      228       3       218
663         3      228       3       118
1070        4      228       2       252
1271        5      228       3       180
       user_id  item_id  rating  timestep
12329       46      228       4        45
12703       47      228       3       146
12879       48      228       5        49
13111       49      228       2         8
13530       50      228       4       154
average_rating for this rec across 50 users from same group (less noisy) was: 3.34
all_actions shape just before sample torch.Size([1, 6, 1])
action scaled by temperature: tensor([[254]], device='cuda:0')
action picked by argmax: tensor([227], device='cuda:0')
tensor([[227,  75, 211, 205, 223,  39, 109,  37, 237, 196]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
205         1      228       4       206
490         2      228       3       218
663         3      228       3       118
1070        4      228       2       252
1271        5      228       3       180
       user_id  item_id  rating  timestep
12329       46      228       4        45
12703       47      228       3       146
12879       48      228       5        49
13111       49      228       2         8
13530       50      228       4       154
average_rating for this rec across 50 users from same group (less noisy) was: 3.34
all_actions shape just before sample torch.Size([1, 7, 1])
action scaled by temperature: tensor([[112]], device='cuda:0')
action picked by argmax: tensor([227], device='cuda:0')
tensor([[227,  75, 211, 205, 109, 223,  39, 237,  37, 268]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
205         1      228       4       206
490         2      228       3       218
663         3      228       3       118
1070        4      228       2       252
1271        5      228       3       180
       user_id  item_id  rating  timestep
12329       46      228       4        45
12703       47      228       3       146
12879       48      228       5        49
13111       49      228       2         8
13530       50      228       4       154
average_rating for this rec across 50 users from same group (less noisy) was: 3.34
all_actions shape just before sample torch.Size([1, 8, 1])
action scaled by temperature: tensor([[186]], device='cuda:0')
action picked by argmax: tensor([227], device='cuda:0')
tensor([[227,  75, 211, 205, 109, 237,  39, 268, 223, 163]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
205         1      228       4       206
490         2      228       3       218
663         3      228       3       118
1070        4      228       2       252
1271        5      228       3       180
       user_id  item_id  rating  timestep
12329       46      228       4        45
12703       47      228       3       146
12879       48      228       5        49
13111       49      228       2         8
13530       50      228       4       154
average_rating for this rec across 50 users from same group (less noisy) was: 3.34
all_actions shape just before sample torch.Size([1, 9, 1])
action scaled by temperature: tensor([[145]], device='cuda:0')
action picked by argmax: tensor([227], device='cuda:0')
tensor([[227,  75, 211, 205, 223, 109,  39, 237,  37, 268]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
205         1      228       4       206
490         2      228       3       218
663         3      228       3       118
1070        4      228       2       252
1271        5      228       3       180
       user_id  item_id  rating  timestep
12329       46      228       4        45
12703       47      228       3       146
12879       48      228       5        49
13111       49      228       2         8
13530       50      228       4       154
average_rating for this rec across 50 users from same group (less noisy) was: 3.34
all_actions shape just before sample torch.Size([1, 10, 1])
action scaled by temperature: tensor([[78]], device='cuda:0')
action picked by argmax: tensor([227], device='cuda:0')
tensor([[227,  75, 211, 205, 109, 223,  39, 237,  37, 268]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
205         1      228       4       206
490         2      228       3       218
663         3      228       3       118
1070        4      228       2       252
1271        5      228       3       180
       user_id  item_id  rating  timestep
12329       46      228       4        45
12703       47      228       3       146
12879       48      228       5        49
13111       49      228       2         8
13530       50      228       4       154
average_rating for this rec across 50 users from same group (less noisy) was: 3.34
all_actions shape just before sample torch.Size([1, 11, 1])
action scaled by temperature: tensor([[255]], device='cuda:0')
action picked by argmax: tensor([227], device='cuda:0')
tensor([[227,  75, 211, 205, 223,  39, 109,  37, 237, 196]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
205         1      228       4       206
490         2      228       3       218
663         3      228       3       118
1070        4      228       2       252
1271        5      228       3       180
       user_id  item_id  rating  timestep
12329       46      228       4        45
12703       47      228       3       146
12879       48      228       5        49
13111       49      228       2         8
13530       50      228       4       154
average_rating for this rec across 50 users from same group (less noisy) was: 3.34
all_actions shape just before sample torch.Size([1, 12, 1])
action scaled by temperature: tensor([[179]], device='cuda:0')
action picked by argmax: tensor([75], device='cuda:0')
tensor([[ 75, 227, 211, 223, 205,  39, 109,  37, 237, 196]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
76          1       76       5        77
330         2       76       4        58
571         3       76       3        26
915         4       76       4        97
1167        5       76       4        76
       user_id  item_id  rating  timestep
12440       46       76       3       156
12588       47       76       4        31
12957       48       76       3       127
13325       49       76       5       222
13468       50       76       5        92
average_rating for this rec across 50 users from same group (less noisy) was: 4.04
all_actions shape just before sample torch.Size([1, 13, 1])
action scaled by temperature: tensor([[102]], device='cuda:0')
action picked by argmax: tensor([227], device='cuda:0')
tensor([[227, 109,  75, 205, 237, 211, 268,  39, 163,  30]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
205         1      228       4       206
490         2      228       3       218
663         3      228       3       118
1070        4      228       2       252
1271        5      228       3       180
       user_id  item_id  rating  timestep
12329       46      228       4        45
12703       47      228       3       146
12879       48      228       5        49
13111       49      228       2         8
13530       50      228       4       154
average_rating for this rec across 50 users from same group (less noisy) was: 3.34
all_actions shape just before sample torch.Size([1, 14, 1])
action scaled by temperature: tensor([[152]], device='cuda:0')
action picked by argmax: tensor([227], device='cuda:0')
tensor([[227,  75, 211, 205, 223,  39, 109,  37, 237, 196]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
205         1      228       4       206
490         2      228       3       218
663         3      228       3       118
1070        4      228       2       252
1271        5      228       3       180
       user_id  item_id  rating  timestep
12329       46      228       4        45
12703       47      228       3       146
12879       48      228       5        49
13111       49      228       2         8
13530       50      228       4       154
average_rating for this rec across 50 users from same group (less noisy) was: 3.34
all_actions shape just before sample torch.Size([1, 15, 1])
action scaled by temperature: tensor([[151]], device='cuda:0')
action picked by argmax: tensor([211], device='cuda:0')
tensor([[211,  75, 227, 223, 205,  39, 109,  37, 196, 161]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
16          1      212       4        17
467         2      212       5       195
562         3      212       5        17
1019        4      212       5       201
1164        5      212       4        73
       user_id  item_id  rating  timestep
12469       46      212       5       185
12820       47      212       5       263
13061       48      212       5       231
13249       49      212       4       146
13422       50      212       5        46
average_rating for this rec across 50 users from same group (less noisy) was: 4.66
all_actions shape just before sample torch.Size([1, 16, 1])
action scaled by temperature: tensor([[92]], device='cuda:0')
action picked by argmax: tensor([227], device='cuda:0')
tensor([[227,  75, 211, 205, 109, 223,  39, 237,  37, 268]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
205         1      228       4       206
490         2      228       3       218
663         3      228       3       118
1070        4      228       2       252
1271        5      228       3       180
       user_id  item_id  rating  timestep
12329       46      228       4        45
12703       47      228       3       146
12879       48      228       5        49
13111       49      228       2         8
13530       50      228       4       154
average_rating for this rec across 50 users from same group (less noisy) was: 3.34
all_actions shape just before sample torch.Size([1, 17, 1])
action scaled by temperature: tensor([[197]], device='cuda:0')
action picked by argmax: tensor([75], device='cuda:0')
tensor([[ 75, 211, 227, 223,  39, 205, 109,  37, 196, 251]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
76          1       76       5        77
330         2       76       4        58
571         3       76       3        26
915         4       76       4        97
1167        5       76       4        76
       user_id  item_id  rating  timestep
12440       46       76       3       156
12588       47       76       4        31
12957       48       76       3       127
13325       49       76       5       222
13468       50       76       5        92
average_rating for this rec across 50 users from same group (less noisy) was: 4.04
all_actions shape just before sample torch.Size([1, 18, 1])
action scaled by temperature: tensor([[107]], device='cuda:0')
action picked by argmax: tensor([75], device='cuda:0')
tensor([[ 75, 211, 227, 223,  39, 205, 109,  37, 196, 251]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
76          1       76       5        77
330         2       76       4        58
571         3       76       3        26
915         4       76       4        97
1167        5       76       4        76
       user_id  item_id  rating  timestep
12440       46       76       3       156
12588       47       76       4        31
12957       48       76       3       127
13325       49       76       5       222
13468       50       76       5        92
average_rating for this rec across 50 users from same group (less noisy) was: 4.04
all_actions shape just before sample torch.Size([1, 19, 1])
action scaled by temperature: tensor([[119]], device='cuda:0')
action picked by argmax: tensor([75], device='cuda:0')
tensor([[ 75, 211, 227, 223,  39, 205,  37, 109, 196, 251]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
76          1       76       5        77
330         2       76       4        58
571         3       76       3        26
915         4       76       4        97
1167        5       76       4        76
       user_id  item_id  rating  timestep
12440       46       76       3       156
12588       47       76       4        31
12957       48       76       3       127
13325       49       76       5       222
13468       50       76       5        92
average_rating for this rec across 50 users from same group (less noisy) was: 4.04
all_actions shape just before sample torch.Size([1, 20, 1])
action scaled by temperature: tensor([[18]], device='cuda:0')
action picked by argmax: tensor([75], device='cuda:0')
tensor([[ 75, 211, 227, 223,  39, 205, 109,  37, 196, 251]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
76          1       76       5        77
330         2       76       4        58
571         3       76       3        26
915         4       76       4        97
1167        5       76       4        76
       user_id  item_id  rating  timestep
12440       46       76       3       156
12588       47       76       4        31
12957       48       76       3       127
13325       49       76       5       222
13468       50       76       5        92
average_rating for this rec across 50 users from same group (less noisy) was: 4.04
all_actions shape just before sample torch.Size([1, 21, 1])
action scaled by temperature: tensor([[245]], device='cuda:0')
action picked by argmax: tensor([75], device='cuda:0')
tensor([[ 75, 211, 227, 223,  39, 205,  37, 109, 196, 251]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
76          1       76       5        77
330         2       76       4        58
571         3       76       3        26
915         4       76       4        97
1167        5       76       4        76
       user_id  item_id  rating  timestep
12440       46       76       3       156
12588       47       76       4        31
12957       48       76       3       127
13325       49       76       5       222
13468       50       76       5        92
average_rating for this rec across 50 users from same group (less noisy) was: 4.04
all_actions shape just before sample torch.Size([1, 22, 1])
action scaled by temperature: tensor([[250]], device='cuda:0')
action picked by argmax: tensor([227], device='cuda:0')
tensor([[227,  75, 211, 205, 109, 223,  39, 237, 268,  37]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
205         1      228       4       206
490         2      228       3       218
663         3      228       3       118
1070        4      228       2       252
1271        5      228       3       180
       user_id  item_id  rating  timestep
12329       46      228       4        45
12703       47      228       3       146
12879       48      228       5        49
13111       49      228       2         8
13530       50      228       4       154
average_rating for this rec across 50 users from same group (less noisy) was: 3.34
all_actions shape just before sample torch.Size([1, 23, 1])
action scaled by temperature: tensor([[13]], device='cuda:0')
action picked by argmax: tensor([75], device='cuda:0')
tensor([[ 75, 211, 227, 223,  39, 205, 109,  37, 196, 251]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
76          1       76       5        77
330         2       76       4        58
571         3       76       3        26
915         4       76       4        97
1167        5       76       4        76
       user_id  item_id  rating  timestep
12440       46       76       3       156
12588       47       76       4        31
12957       48       76       3       127
13325       49       76       5       222
13468       50       76       5        92
average_rating for this rec across 50 users from same group (less noisy) was: 4.04
all_actions shape just before sample torch.Size([1, 24, 1])
action scaled by temperature: tensor([[230]], device='cuda:0')
action picked by argmax: tensor([75], device='cuda:0')
tensor([[ 75, 211, 227, 223,  39, 205, 109,  37, 196, 251]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
76          1       76       5        77
330         2       76       4        58
571         3       76       3        26
915         4       76       4        97
1167        5       76       4        76
       user_id  item_id  rating  timestep
12440       46       76       3       156
12588       47       76       4        31
12957       48       76       3       127
13325       49       76       5       222
13468       50       76       5        92
average_rating for this rec across 50 users from same group (less noisy) was: 4.04
all_actions shape just before sample torch.Size([1, 25, 1])
action scaled by temperature: tensor([[155]], device='cuda:0')
action picked by argmax: tensor([75], device='cuda:0')
tensor([[ 75, 227, 211, 223, 205,  39, 109,  37, 237, 196]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
76          1       76       5        77
330         2       76       4        58
571         3       76       3        26
915         4       76       4        97
1167        5       76       4        76
       user_id  item_id  rating  timestep
12440       46       76       3       156
12588       47       76       4        31
12957       48       76       3       127
13325       49       76       5       222
13468       50       76       5        92
average_rating for this rec across 50 users from same group (less noisy) was: 4.04
all_actions shape just before sample torch.Size([1, 26, 1])
action scaled by temperature: tensor([[161]], device='cuda:0')
action picked by argmax: tensor([75], device='cuda:0')
tensor([[ 75, 211, 227, 223,  39, 205,  37, 109, 251, 196]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
76          1       76       5        77
330         2       76       4        58
571         3       76       3        26
915         4       76       4        97
1167        5       76       4        76
       user_id  item_id  rating  timestep
12440       46       76       3       156
12588       47       76       4        31
12957       48       76       3       127
13325       49       76       5       222
13468       50       76       5        92
average_rating for this rec across 50 users from same group (less noisy) was: 4.04
all_actions shape just before sample torch.Size([1, 27, 1])
action scaled by temperature: tensor([[134]], device='cuda:0')
action picked by argmax: tensor([227], device='cuda:0')
tensor([[227,  75, 109, 205, 211, 237, 268,  39, 163, 223]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
205         1      228       4       206
490         2      228       3       218
663         3      228       3       118
1070        4      228       2       252
1271        5      228       3       180
       user_id  item_id  rating  timestep
12329       46      228       4        45
12703       47      228       3       146
12879       48      228       5        49
13111       49      228       2         8
13530       50      228       4       154
average_rating for this rec across 50 users from same group (less noisy) was: 3.34
all_actions shape just before sample torch.Size([1, 28, 1])
action scaled by temperature: tensor([[173]], device='cuda:0')
action picked by argmax: tensor([75], device='cuda:0')
tensor([[ 75, 227, 211, 223, 205,  39, 109,  37, 237, 196]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
76          1       76       5        77
330         2       76       4        58
571         3       76       3        26
915         4       76       4        97
1167        5       76       4        76
       user_id  item_id  rating  timestep
12440       46       76       3       156
12588       47       76       4        31
12957       48       76       3       127
13325       49       76       5       222
13468       50       76       5        92
average_rating for this rec across 50 users from same group (less noisy) was: 4.04
all_actions shape just before sample torch.Size([1, 29, 1])
action scaled by temperature: tensor([[244]], device='cuda:0')
action picked by argmax: tensor([75], device='cuda:0')
tensor([[ 75, 211, 227, 223,  39, 205, 109,  37, 196, 251]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
76          1       76       5        77
330         2       76       4        58
571         3       76       3        26
915         4       76       4        97
1167        5       76       4        76
       user_id  item_id  rating  timestep
12440       46       76       3       156
12588       47       76       4        31
12957       48       76       3       127
13325       49       76       5       222
13468       50       76       5        92
average_rating for this rec across 50 users from same group (less noisy) was: 4.04
all_actions shape just before sample torch.Size([1, 30, 1])
action scaled by temperature: tensor([[171]], device='cuda:0')
action picked by argmax: tensor([75], device='cuda:0')
tensor([[ 75, 211, 227, 223,  39, 205,  37, 251, 109, 196]], device='cuda:0')
Just recommended 30 new items to 50 users from group 1 and the total rating was 109.92000000000006
train_loss is: 5.59168387330286
action scaled by temperature: tensor([[255]], device='cuda:0')
action picked by argmax: tensor([76], device='cuda:0')
tensor([[ 76, 231, 227, 268,   4, 211,  22,  37,  38, 180]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
243         1       77       5       244
432         2       77       5       160
743         3       77       5       198
835         4       77       4        17
1233        5       77       4       142
       user_id  item_id  rating  timestep
12393       46       77       3       109
12719       47       77       4       162
13098       48       77       5       268
13143       49       77       4        40
13500       50       77       3       124
average_rating for this rec across 50 users from same group (less noisy) was: 3.96
all_actions shape just before sample torch.Size([1, 1, 1])
action scaled by temperature: tensor([[12]], device='cuda:0')
action picked by argmax: tensor([157], device='cuda:0')
tensor([[157, 120, 167, 104, 237, 247, 154,  55,  97, 114]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
156         1      158       4       157
496         2      158       5       224
798         3      158       4       253
1015        4      158       4       197
1351        5      158       4       260
       user_id  item_id  rating  timestep
12457       46      158       4       173
12809       47      158       5       252
13046       48      158       5       216
13322       49      158       3       219
13399       50      158       5        23
average_rating for this rec across 50 users from same group (less noisy) was: 4.42
all_actions shape just before sample torch.Size([1, 2, 1])
action scaled by temperature: tensor([[134]], device='cuda:0')
action picked by argmax: tensor([157], device='cuda:0')
tensor([[157, 237, 120, 167, 104, 154, 247, 244,  83, 114]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
156         1      158       4       157
496         2      158       5       224
798         3      158       4       253
1015        4      158       4       197
1351        5      158       4       260
       user_id  item_id  rating  timestep
12457       46      158       4       173
12809       47      158       5       252
13046       48      158       5       216
13322       49      158       3       219
13399       50      158       5        23
average_rating for this rec across 50 users from same group (less noisy) was: 4.42
all_actions shape just before sample torch.Size([1, 3, 1])
action scaled by temperature: tensor([[26]], device='cuda:0')
action picked by argmax: tensor([157], device='cuda:0')
tensor([[157, 120, 167, 237, 104, 247, 154, 244, 114,  97]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
156         1      158       4       157
496         2      158       5       224
798         3      158       4       253
1015        4      158       4       197
1351        5      158       4       260
       user_id  item_id  rating  timestep
12457       46      158       4       173
12809       47      158       5       252
13046       48      158       5       216
13322       49      158       3       219
13399       50      158       5        23
average_rating for this rec across 50 users from same group (less noisy) was: 4.42
all_actions shape just before sample torch.Size([1, 4, 1])
action scaled by temperature: tensor([[143]], device='cuda:0')
action picked by argmax: tensor([157], device='cuda:0')
tensor([[157, 167, 237, 120, 104, 154, 247, 244,  83,  97]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
156         1      158       4       157
496         2      158       5       224
798         3      158       4       253
1015        4      158       4       197
1351        5      158       4       260
       user_id  item_id  rating  timestep
12457       46      158       4       173
12809       47      158       5       252
13046       48      158       5       216
13322       49      158       3       219
13399       50      158       5        23
average_rating for this rec across 50 users from same group (less noisy) was: 4.42
all_actions shape just before sample torch.Size([1, 5, 1])
action scaled by temperature: tensor([[221]], device='cuda:0')
action picked by argmax: tensor([157], device='cuda:0')
tensor([[157, 237, 120, 167, 247, 104, 154, 114, 178, 235]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
156         1      158       4       157
496         2      158       5       224
798         3      158       4       253
1015        4      158       4       197
1351        5      158       4       260
       user_id  item_id  rating  timestep
12457       46      158       4       173
12809       47      158       5       252
13046       48      158       5       216
13322       49      158       3       219
13399       50      158       5        23
average_rating for this rec across 50 users from same group (less noisy) was: 4.42
all_actions shape just before sample torch.Size([1, 6, 1])
action scaled by temperature: tensor([[222]], device='cuda:0')
action picked by argmax: tensor([157], device='cuda:0')
tensor([[157, 237, 167, 120, 154, 104, 247, 244,  83,  97]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
156         1      158       4       157
496         2      158       5       224
798         3      158       4       253
1015        4      158       4       197
1351        5      158       4       260
       user_id  item_id  rating  timestep
12457       46      158       4       173
12809       47      158       5       252
13046       48      158       5       216
13322       49      158       3       219
13399       50      158       5        23
average_rating for this rec across 50 users from same group (less noisy) was: 4.42
all_actions shape just before sample torch.Size([1, 7, 1])
action scaled by temperature: tensor([[265]], device='cuda:0')
action picked by argmax: tensor([157], device='cuda:0')
tensor([[157, 237, 114, 178, 120, 235, 247, 167, 197, 244]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
156         1      158       4       157
496         2      158       5       224
798         3      158       4       253
1015        4      158       4       197
1351        5      158       4       260
       user_id  item_id  rating  timestep
12457       46      158       4       173
12809       47      158       5       252
13046       48      158       5       216
13322       49      158       3       219
13399       50      158       5        23
average_rating for this rec across 50 users from same group (less noisy) was: 4.42
all_actions shape just before sample torch.Size([1, 8, 1])
action scaled by temperature: tensor([[28]], device='cuda:0')
action picked by argmax: tensor([157], device='cuda:0')
tensor([[157, 178, 114, 237, 235, 120, 247, 197, 167,  83]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
156         1      158       4       157
496         2      158       5       224
798         3      158       4       253
1015        4      158       4       197
1351        5      158       4       260
       user_id  item_id  rating  timestep
12457       46      158       4       173
12809       47      158       5       252
13046       48      158       5       216
13322       49      158       3       219
13399       50      158       5        23
average_rating for this rec across 50 users from same group (less noisy) was: 4.42
all_actions shape just before sample torch.Size([1, 9, 1])
action scaled by temperature: tensor([[102]], device='cuda:0')
action picked by argmax: tensor([157], device='cuda:0')
tensor([[157, 237, 120, 167, 247, 154, 244, 178, 104, 235]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
156         1      158       4       157
496         2      158       5       224
798         3      158       4       253
1015        4      158       4       197
1351        5      158       4       260
       user_id  item_id  rating  timestep
12457       46      158       4       173
12809       47      158       5       252
13046       48      158       5       216
13322       49      158       3       219
13399       50      158       5        23
average_rating for this rec across 50 users from same group (less noisy) was: 4.42
all_actions shape just before sample torch.Size([1, 10, 1])
action scaled by temperature: tensor([[222]], device='cuda:0')
action picked by argmax: tensor([157], device='cuda:0')
tensor([[157, 237, 167, 120, 154, 104, 244, 247,  83,  30]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
156         1      158       4       157
496         2      158       5       224
798         3      158       4       253
1015        4      158       4       197
1351        5      158       4       260
       user_id  item_id  rating  timestep
12457       46      158       4       173
12809       47      158       5       252
13046       48      158       5       216
13322       49      158       3       219
13399       50      158       5        23
average_rating for this rec across 50 users from same group (less noisy) was: 4.42
all_actions shape just before sample torch.Size([1, 11, 1])
action scaled by temperature: tensor([[169]], device='cuda:0')
action picked by argmax: tensor([244], device='cuda:0')
tensor([[244, 237, 178, 235, 107,  40,  30, 105,   0, 157]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
244         1      245       3       245
422         2      245       5       150
710         3      245       4       165
980         4      245       2       162
1313        5      245       4       222
       user_id  item_id  rating  timestep
12529       46      245       2       245
12723       47      245       3       166
12986       48      245       3       156
13133       49      245       4        30
13507       50      245       2       131
average_rating for this rec across 50 users from same group (less noisy) was: 3.48
all_actions shape just before sample torch.Size([1, 12, 1])
action scaled by temperature: tensor([[55]], device='cuda:0')
action picked by argmax: tensor([237], device='cuda:0')
tensor([[237, 244, 178, 235, 157, 247, 114, 154,  30, 105]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
228         1      238       4       229
475         2      238       3       203
719         3      238       3       174
860         4      238       5        42
1166        5      238       5        75
       user_id  item_id  rating  timestep
12462       46      238       3       178
12618       47      238       4        61
13000       48      238       5       170
13192       49      238       3        89
13431       50      238       5        55
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 13, 1])
action scaled by temperature: tensor([[100]], device='cuda:0')
action picked by argmax: tensor([76], device='cuda:0')
tensor([[ 76,   4, 263, 227, 169,  22,  37, 160,  39, 268]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
243         1       77       5       244
432         2       77       5       160
743         3       77       5       198
835         4       77       4        17
1233        5       77       4       142
       user_id  item_id  rating  timestep
12393       46       77       3       109
12719       47       77       4       162
13098       48       77       5       268
13143       49       77       4        40
13500       50       77       3       124
average_rating for this rec across 50 users from same group (less noisy) was: 3.96
all_actions shape just before sample torch.Size([1, 14, 1])
action scaled by temperature: tensor([[126]], device='cuda:0')
action picked by argmax: tensor([167], device='cuda:0')
tensor([[167, 157, 104, 120, 237, 154, 202, 247,  55,  83]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
38          1      168       5        39
418         2      168       3       146
699         3      168       4       154
928         4      168       5       110
1133        5      168       5        42
       user_id  item_id  rating  timestep
12493       46      168       3       209
12781       47      168       4       224
12921       48      168       3        91
13219       49      168       5       116
13564       50      168       4       188
average_rating for this rec across 50 users from same group (less noisy) was: 4.08
all_actions shape just before sample torch.Size([1, 15, 1])
action scaled by temperature: tensor([[112]], device='cuda:0')
action picked by argmax: tensor([157], device='cuda:0')
tensor([[157, 237, 120, 167, 244, 154, 247, 104, 235, 178]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
156         1      158       4       157
496         2      158       5       224
798         3      158       4       253
1015        4      158       4       197
1351        5      158       4       260
       user_id  item_id  rating  timestep
12457       46      158       4       173
12809       47      158       5       252
13046       48      158       5       216
13322       49      158       3       219
13399       50      158       5        23
average_rating for this rec across 50 users from same group (less noisy) was: 4.42
all_actions shape just before sample torch.Size([1, 16, 1])
action scaled by temperature: tensor([[93]], device='cuda:0')
action picked by argmax: tensor([167], device='cuda:0')
tensor([[167, 157, 104, 120, 237, 154, 247, 202,  83,  55]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
38          1      168       5        39
418         2      168       3       146
699         3      168       4       154
928         4      168       5       110
1133        5      168       5        42
       user_id  item_id  rating  timestep
12493       46      168       3       209
12781       47      168       4       224
12921       48      168       3        91
13219       49      168       5       116
13564       50      168       4       188
average_rating for this rec across 50 users from same group (less noisy) was: 4.08
all_actions shape just before sample torch.Size([1, 17, 1])
action scaled by temperature: tensor([[208]], device='cuda:0')
action picked by argmax: tensor([237], device='cuda:0')
tensor([[237, 157, 244, 167, 154, 120, 104, 247,  30,  97]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
228         1      238       4       229
475         2      238       3       203
719         3      238       3       174
860         4      238       5        42
1166        5      238       5        75
       user_id  item_id  rating  timestep
12462       46      238       3       178
12618       47      238       4        61
13000       48      238       5       170
13192       49      238       3        89
13431       50      238       5        55
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 18, 1])
action scaled by temperature: tensor([[262]], device='cuda:0')
action picked by argmax: tensor([107], device='cuda:0')
tensor([[107,  39, 155, 268,  76, 237,  37,  40,   0,  98]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
137         1      108       4       138
320         2      108       5        48
555         3      108       5        10
1033        4      108       4       215
1304        5      108       4       213
       user_id  item_id  rating  timestep
12385       46      108       5       101
12814       47      108       4       257
12864       48      108       5        34
13276       49      108       4       173
13592       50      108       5       216
average_rating for this rec across 50 users from same group (less noisy) was: 4.4
all_actions shape just before sample torch.Size([1, 19, 1])
action scaled by temperature: tensor([[138]], device='cuda:0')
action picked by argmax: tensor([107], device='cuda:0')
tensor([[107,  39, 155,  76,  40, 268, 237,  37,  98, 233]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
137         1      108       4       138
320         2      108       5        48
555         3      108       5        10
1033        4      108       4       215
1304        5      108       4       213
       user_id  item_id  rating  timestep
12385       46      108       5       101
12814       47      108       4       257
12864       48      108       5        34
13276       49      108       4       173
13592       50      108       5       216
average_rating for this rec across 50 users from same group (less noisy) was: 4.4
all_actions shape just before sample torch.Size([1, 20, 1])
action scaled by temperature: tensor([[134]], device='cuda:0')
action picked by argmax: tensor([39], device='cuda:0')
tensor([[ 39, 107,  76, 268, 155,  37,  98, 237,  40,   0]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
101         1       40       5       102
275         2       40       5         3
550         3       40       4         5
1065        4       40       5       247
1189        5       40       5        98
       user_id  item_id  rating  timestep
12542       46       40       5       258
12805       47       40       5       248
12866       48       40       5        36
13122       49       40       5        19
13587       50       40       4       211
average_rating for this rec across 50 users from same group (less noisy) was: 4.68
all_actions shape just before sample torch.Size([1, 21, 1])
action scaled by temperature: tensor([[264]], device='cuda:0')
action picked by argmax: tensor([107], device='cuda:0')
tensor([[107,  39,  76, 155, 268,  37,  98, 233,  40, 227]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
137         1      108       4       138
320         2      108       5        48
555         3      108       5        10
1033        4      108       4       215
1304        5      108       4       213
       user_id  item_id  rating  timestep
12385       46      108       5       101
12814       47      108       4       257
12864       48      108       5        34
13276       49      108       4       173
13592       50      108       5       216
average_rating for this rec across 50 users from same group (less noisy) was: 4.4
all_actions shape just before sample torch.Size([1, 22, 1])
action scaled by temperature: tensor([[157]], device='cuda:0')
action picked by argmax: tensor([76], device='cuda:0')
tensor([[ 76,   4, 227, 169, 133, 263,  22, 165, 233,  39]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
243         1       77       5       244
432         2       77       5       160
743         3       77       5       198
835         4       77       4        17
1233        5       77       4       142
       user_id  item_id  rating  timestep
12393       46       77       3       109
12719       47       77       4       162
13098       48       77       5       268
13143       49       77       4        40
13500       50       77       3       124
average_rating for this rec across 50 users from same group (less noisy) was: 3.96
all_actions shape just before sample torch.Size([1, 23, 1])
action scaled by temperature: tensor([[56]], device='cuda:0')
action picked by argmax: tensor([167], device='cuda:0')
tensor([[167, 157, 104, 120, 237, 154, 202, 247,  83, 227]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
38          1      168       5        39
418         2      168       3       146
699         3      168       4       154
928         4      168       5       110
1133        5      168       5        42
       user_id  item_id  rating  timestep
12493       46      168       3       209
12781       47      168       4       224
12921       48      168       3        91
13219       49      168       5       116
13564       50      168       4       188
average_rating for this rec across 50 users from same group (less noisy) was: 4.08
all_actions shape just before sample torch.Size([1, 24, 1])
action scaled by temperature: tensor([[31]], device='cuda:0')
action picked by argmax: tensor([167], device='cuda:0')
tensor([[167, 237, 157, 104, 154, 120, 202,  83, 227, 247]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
38          1      168       5        39
418         2      168       3       146
699         3      168       4       154
928         4      168       5       110
1133        5      168       5        42
       user_id  item_id  rating  timestep
12493       46      168       3       209
12781       47      168       4       224
12921       48      168       3        91
13219       49      168       5       116
13564       50      168       4       188
average_rating for this rec across 50 users from same group (less noisy) was: 4.08
all_actions shape just before sample torch.Size([1, 25, 1])
action scaled by temperature: tensor([[227]], device='cuda:0')
action picked by argmax: tensor([237], device='cuda:0')
tensor([[237, 167, 157, 154, 120, 247, 104,  30,  83, 244]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
228         1      238       4       229
475         2      238       3       203
719         3      238       3       174
860         4      238       5        42
1166        5      238       5        75
       user_id  item_id  rating  timestep
12462       46      238       3       178
12618       47      238       4        61
13000       48      238       5       170
13192       49      238       3        89
13431       50      238       5        55
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 26, 1])
action scaled by temperature: tensor([[22]], device='cuda:0')
action picked by argmax: tensor([244], device='cuda:0')
tensor([[244, 237, 178,  30, 235,  40, 105, 112, 154, 157]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
244         1      245       3       245
422         2      245       5       150
710         3      245       4       165
980         4      245       2       162
1313        5      245       4       222
       user_id  item_id  rating  timestep
12529       46      245       2       245
12723       47      245       3       166
12986       48      245       3       156
13133       49      245       4        30
13507       50      245       2       131
average_rating for this rec across 50 users from same group (less noisy) was: 3.48
all_actions shape just before sample torch.Size([1, 27, 1])
action scaled by temperature: tensor([[163]], device='cuda:0')
action picked by argmax: tensor([244], device='cuda:0')
tensor([[244, 237, 178, 235,  40, 105, 107, 157, 114,  30]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
244         1      245       3       245
422         2      245       5       150
710         3      245       4       165
980         4      245       2       162
1313        5      245       4       222
       user_id  item_id  rating  timestep
12529       46      245       2       245
12723       47      245       3       166
12986       48      245       3       156
13133       49      245       4        30
13507       50      245       2       131
average_rating for this rec across 50 users from same group (less noisy) was: 3.48
all_actions shape just before sample torch.Size([1, 28, 1])
action scaled by temperature: tensor([[165]], device='cuda:0')
action picked by argmax: tensor([244], device='cuda:0')
tensor([[244, 237,  30, 178,  40, 107, 105, 112, 235,   0]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
244         1      245       3       245
422         2      245       5       150
710         3      245       4       165
980         4      245       2       162
1313        5      245       4       222
       user_id  item_id  rating  timestep
12529       46      245       2       245
12723       47      245       3       166
12986       48      245       3       156
13133       49      245       4        30
13507       50      245       2       131
average_rating for this rec across 50 users from same group (less noisy) was: 3.48
all_actions shape just before sample torch.Size([1, 29, 1])
action scaled by temperature: tensor([[98]], device='cuda:0')
action picked by argmax: tensor([237], device='cuda:0')
tensor([[237, 244, 178, 235,  40,  30, 105, 107, 157, 114]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
228         1      238       4       229
475         2      238       3       203
719         3      238       3       174
860         4      238       5        42
1166        5      238       5        75
       user_id  item_id  rating  timestep
12462       46      238       3       178
12618       47      238       4        61
13000       48      238       5       170
13192       49      238       3        89
13431       50      238       5        55
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 30, 1])
action scaled by temperature: tensor([[246]], device='cuda:0')
action picked by argmax: tensor([237], device='cuda:0')
tensor([[237, 244,  30, 178, 154, 157,  40, 112, 246, 105]], device='cuda:0')
Just recommended 30 new items to 50 users from group 1 and the total rating was 124.86000000000004
train_loss is: 5.548368201408212
action scaled by temperature: tensor([[75]], device='cuda:0')
action picked by argmax: tensor([205], device='cuda:0')
tensor([[205, 231, 237, 246, 101,  75,  76,  37,  30,  28]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
199         1      206       3       200
408         2      206       4       136
800         3      206       4       255
935         4      206       3       117
1159        5      206       4        68
       user_id  item_id  rating  timestep
12540       46      206       3       256
12585       47      206       4        28
12935       48      206       3       105
13364       49      206       5       261
13505       50      206       3       129
average_rating for this rec across 50 users from same group (less noisy) was: 4.16
all_actions shape just before sample torch.Size([1, 1, 1])
action scaled by temperature: tensor([[202]], device='cuda:0')
action picked by argmax: tensor([205], device='cuda:0')
tensor([[205, 231,  37,  75,  10, 237,  76, 196, 101, 227]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
199         1      206       3       200
408         2      206       4       136
800         3      206       4       255
935         4      206       3       117
1159        5      206       4        68
       user_id  item_id  rating  timestep
12540       46      206       3       256
12585       47      206       4        28
12935       48      206       3       105
13364       49      206       5       261
13505       50      206       3       129
average_rating for this rec across 50 users from same group (less noisy) was: 4.16
all_actions shape just before sample torch.Size([1, 2, 1])
action scaled by temperature: tensor([[27]], device='cuda:0')
action picked by argmax: tensor([193], device='cuda:0')
tensor([[193,  37,  76, 231,  10, 237, 205, 250, 158, 227]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
15          1      194       3        16
423         2      194       5       151
569         3      194       2        24
971         4      194       3       153
1099        5      194       5         8
       user_id  item_id  rating  timestep
12512       46      194       4       228
12663       47      194       3       106
13083       48      194       3       253
13117       49      194       3        14
13489       50      194       2       113
average_rating for this rec across 50 users from same group (less noisy) was: 3.58
all_actions shape just before sample torch.Size([1, 3, 1])
action scaled by temperature: tensor([[101]], device='cuda:0')
action picked by argmax: tensor([205], device='cuda:0')
tensor([[205, 231,  10,  76, 227,  37,  75, 193, 196, 237]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
199         1      206       3       200
408         2      206       4       136
800         3      206       4       255
935         4      206       3       117
1159        5      206       4        68
       user_id  item_id  rating  timestep
12540       46      206       3       256
12585       47      206       4        28
12935       48      206       3       105
13364       49      206       5       261
13505       50      206       3       129
average_rating for this rec across 50 users from same group (less noisy) was: 4.16
all_actions shape just before sample torch.Size([1, 4, 1])
action scaled by temperature: tensor([[145]], device='cuda:0')
action picked by argmax: tensor([193], device='cuda:0')
tensor([[193, 237,  76,  37,  10, 205, 231,  98, 227, 250]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
15          1      194       3        16
423         2      194       5       151
569         3      194       2        24
971         4      194       3       153
1099        5      194       5         8
       user_id  item_id  rating  timestep
12512       46      194       4       228
12663       47      194       3       106
13083       48      194       3       253
13117       49      194       3        14
13489       50      194       2       113
average_rating for this rec across 50 users from same group (less noisy) was: 3.58
all_actions shape just before sample torch.Size([1, 5, 1])
action scaled by temperature: tensor([[171]], device='cuda:0')
action picked by argmax: tensor([10], device='cuda:0')
tensor([[ 10, 231, 205,  75,  37,  76, 193, 227, 257, 237]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
183         1       11       1       184
302         2       11       4        30
616         3       11       3        71
877         4       11       2        59
1096        5       11       3         5
       user_id  item_id  rating  timestep
12340       46       11       2        56
12829       47       11       1       272
12922       48       11       3        92
13155       49       11       2        52
13410       50       11       2        34
average_rating for this rec across 50 users from same group (less noisy) was: 2.2
all_actions shape just before sample torch.Size([1, 6, 1])
action scaled by temperature: tensor([[219]], device='cuda:0')
action picked by argmax: tensor([39], device='cuda:0')
tensor([[ 39, 183,  37, 268, 107,  47, 110, 237,  36,  40]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
101         1       40       5       102
275         2       40       5         3
550         3       40       4         5
1065        4       40       5       247
1189        5       40       5        98
       user_id  item_id  rating  timestep
12542       46       40       5       258
12805       47       40       5       248
12866       48       40       5        36
13122       49       40       5        19
13587       50       40       4       211
average_rating for this rec across 50 users from same group (less noisy) was: 4.68
all_actions shape just before sample torch.Size([1, 7, 1])
action scaled by temperature: tensor([[14]], device='cuda:0')
action picked by argmax: tensor([237], device='cuda:0')
tensor([[237,  39,  37, 268,  76, 107,  98, 183,  40, 205]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
228         1      238       4       229
475         2      238       3       203
719         3      238       3       174
860         4      238       5        42
1166        5      238       5        75
       user_id  item_id  rating  timestep
12462       46      238       3       178
12618       47      238       4        61
13000       48      238       5       170
13192       49      238       3        89
13431       50      238       5        55
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 8, 1])
action scaled by temperature: tensor([[271]], device='cuda:0')
action picked by argmax: tensor([32], device='cuda:0')
tensor([[ 32, 263, 133,   4,  29, 218,  10,  15, 266, 227]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
117         1       33       3       118
463         2       33       2       191
738         3       33       2       193
837         4       33       5        19
1267        5       33       3       176
       user_id  item_id  rating  timestep
12454       46       33       4       170
12590       47       33       4        33
12848       48       33       4        18
13360       49       33       4       257
13418       50       33       5        42
average_rating for this rec across 50 users from same group (less noisy) was: 3.6
all_actions shape just before sample torch.Size([1, 9, 1])
action scaled by temperature: tensor([[109]], device='cuda:0')
action picked by argmax: tensor([120], device='cuda:0')
tensor([[120, 157, 244, 105, 235, 272, 112,  88, 170, 197]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
140         1      121       4       141
340         2      121       4        68
548         3      121       4         3
1028        4      121       4       210
1324        5      121       4       233
       user_id  item_id  rating  timestep
12449       46      121       3       165
12767       47      121       4       210
13025       48      121       4       195
13269       49      121       4       166
13383       50      121       4         7
average_rating for this rec across 50 users from same group (less noisy) was: 4.02
all_actions shape just before sample torch.Size([1, 10, 1])
action scaled by temperature: tensor([[108]], device='cuda:0')
action picked by argmax: tensor([234], device='cuda:0')
tensor([[234, 193, 237, 184, 211, 163,  37, 160, 268,  76]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
233         1      235       3       234
468         2      235       4       196
662         3      235       4       117
927         4      235       3       109
1185        5      235       4        94
       user_id  item_id  rating  timestep
12305       46      235       3        21
12679       47      235       2       122
12895       48      235       4        65
13238       49      235       5       135
13642       50      235       5       266
average_rating for this rec across 50 users from same group (less noisy) was: 3.78
all_actions shape just before sample torch.Size([1, 11, 1])
action scaled by temperature: tensor([[218]], device='cuda:0')
action picked by argmax: tensor([263], device='cuda:0')
tensor([[263,   4, 218, 108, 226, 165, 133,  93, 207,  35]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
24          1      264       4        25
491         2      264       3       219
715         3      264       3       170
1039        4      264       5       221
1334        5      264       4       243
       user_id  item_id  rating  timestep
12302       46      264       5        18
12567       47      264       4        10
12976       48      264       4       146
13241       49      264       4       138
13515       50      264       5       139
average_rating for this rec across 50 users from same group (less noisy) was: 4.42
all_actions shape just before sample torch.Size([1, 12, 1])
action scaled by temperature: tensor([[150]], device='cuda:0')
action picked by argmax: tensor([263], device='cuda:0')
tensor([[263,   4, 218, 165, 108, 133, 226,  32, 207, 227]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
24          1      264       4        25
491         2      264       3       219
715         3      264       3       170
1039        4      264       5       221
1334        5      264       4       243
       user_id  item_id  rating  timestep
12302       46      264       5        18
12567       47      264       4        10
12976       48      264       4       146
13241       49      264       4       138
13515       50      264       5       139
average_rating for this rec across 50 users from same group (less noisy) was: 4.42
all_actions shape just before sample torch.Size([1, 13, 1])
action scaled by temperature: tensor([[258]], device='cuda:0')
action picked by argmax: tensor([263], device='cuda:0')
tensor([[263,   4, 218, 108, 226, 165, 227, 163, 133,  32]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
24          1      264       4        25
491         2      264       3       219
715         3      264       3       170
1039        4      264       5       221
1334        5      264       4       243
       user_id  item_id  rating  timestep
12302       46      264       5        18
12567       47      264       4        10
12976       48      264       4       146
13241       49      264       4       138
13515       50      264       5       139
average_rating for this rec across 50 users from same group (less noisy) was: 4.42
all_actions shape just before sample torch.Size([1, 14, 1])
action scaled by temperature: tensor([[189]], device='cuda:0')
action picked by argmax: tensor([263], device='cuda:0')
tensor([[263,   4, 218, 108,  32, 133, 165, 226, 227,  29]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
24          1      264       4        25
491         2      264       3       219
715         3      264       3       170
1039        4      264       5       221
1334        5      264       4       243
       user_id  item_id  rating  timestep
12302       46      264       5        18
12567       47      264       4        10
12976       48      264       4       146
13241       49      264       4       138
13515       50      264       5       139
average_rating for this rec across 50 users from same group (less noisy) was: 4.42
all_actions shape just before sample torch.Size([1, 15, 1])
action scaled by temperature: tensor([[188]], device='cuda:0')
action picked by argmax: tensor([263], device='cuda:0')
tensor([[263,  32, 108,   4, 218, 133, 227,  29, 193,  15]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
24          1      264       4        25
491         2      264       3       219
715         3      264       3       170
1039        4      264       5       221
1334        5      264       4       243
       user_id  item_id  rating  timestep
12302       46      264       5        18
12567       47      264       4        10
12976       48      264       4       146
13241       49      264       4       138
13515       50      264       5       139
average_rating for this rec across 50 users from same group (less noisy) was: 4.42
all_actions shape just before sample torch.Size([1, 16, 1])
action scaled by temperature: tensor([[228]], device='cuda:0')
action picked by argmax: tensor([32], device='cuda:0')
tensor([[ 32, 193, 160, 263, 231,  29, 133, 180, 108, 227]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
117         1       33       3       118
463         2       33       2       191
738         3       33       2       193
837         4       33       5        19
1267        5       33       3       176
       user_id  item_id  rating  timestep
12454       46       33       4       170
12590       47       33       4        33
12848       48       33       4        18
13360       49       33       4       257
13418       50       33       5        42
average_rating for this rec across 50 users from same group (less noisy) was: 3.6
all_actions shape just before sample torch.Size([1, 17, 1])
action scaled by temperature: tensor([[147]], device='cuda:0')
action picked by argmax: tensor([120], device='cuda:0')
tensor([[120, 157, 235, 211, 114, 244, 272, 178, 105, 197]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
140         1      121       4       141
340         2      121       4        68
548         3      121       4         3
1028        4      121       4       210
1324        5      121       4       233
       user_id  item_id  rating  timestep
12449       46      121       3       165
12767       47      121       4       210
13025       48      121       4       195
13269       49      121       4       166
13383       50      121       4         7
average_rating for this rec across 50 users from same group (less noisy) was: 4.02
all_actions shape just before sample torch.Size([1, 18, 1])
action scaled by temperature: tensor([[205]], device='cuda:0')
action picked by argmax: tensor([263], device='cuda:0')
tensor([[263, 211, 160, 234, 207, 163, 237, 231, 110, 268]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
24          1      264       4        25
491         2      264       3       219
715         3      264       3       170
1039        4      264       5       221
1334        5      264       4       243
       user_id  item_id  rating  timestep
12302       46      264       5        18
12567       47      264       4        10
12976       48      264       4       146
13241       49      264       4       138
13515       50      264       5       139
average_rating for this rec across 50 users from same group (less noisy) was: 4.42
all_actions shape just before sample torch.Size([1, 19, 1])
action scaled by temperature: tensor([[237]], device='cuda:0')
action picked by argmax: tensor([211], device='cuda:0')
tensor([[211, 237, 268, 160, 263, 110, 183, 207,  37, 163]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
16          1      212       4        17
467         2      212       5       195
562         3      212       5        17
1019        4      212       5       201
1164        5      212       4        73
       user_id  item_id  rating  timestep
12469       46      212       5       185
12820       47      212       5       263
13061       48      212       5       231
13249       49      212       4       146
13422       50      212       5        46
average_rating for this rec across 50 users from same group (less noisy) was: 4.66
all_actions shape just before sample torch.Size([1, 20, 1])
action scaled by temperature: tensor([[264]], device='cuda:0')
action picked by argmax: tensor([211], device='cuda:0')
tensor([[211, 263, 207, 110, 268, 183, 237, 234, 160,  39]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
16          1      212       4        17
467         2      212       5       195
562         3      212       5        17
1019        4      212       5       201
1164        5      212       4        73
       user_id  item_id  rating  timestep
12469       46      212       5       185
12820       47      212       5       263
13061       48      212       5       231
13249       49      212       4       146
13422       50      212       5        46
average_rating for this rec across 50 users from same group (less noisy) was: 4.66
all_actions shape just before sample torch.Size([1, 21, 1])
action scaled by temperature: tensor([[47]], device='cuda:0')
action picked by argmax: tensor([110], device='cuda:0')
tensor([[110, 183, 211, 263, 207,  38, 268,   4, 237, 163]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
45          1      111       3        46
436         2      111       4       164
815         3      111       3       270
940         4      111       2       122
1196        5      111       3       105
       user_id  item_id  rating  timestep
12346       46      111       3        62
12636       47      111       4        79
12867       48      111       4        37
13207       49      111       5       104
13617       50      111       3       241
average_rating for this rec across 50 users from same group (less noisy) was: 3.72
all_actions shape just before sample torch.Size([1, 22, 1])
action scaled by temperature: tensor([[18]], device='cuda:0')
action picked by argmax: tensor([263], device='cuda:0')
tensor([[263,   4, 110, 183, 207, 211,  38, 163, 268, 231]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
24          1      264       4        25
491         2      264       3       219
715         3      264       3       170
1039        4      264       5       221
1334        5      264       4       243
       user_id  item_id  rating  timestep
12302       46      264       5        18
12567       47      264       4        10
12976       48      264       4       146
13241       49      264       4       138
13515       50      264       5       139
average_rating for this rec across 50 users from same group (less noisy) was: 4.42
all_actions shape just before sample torch.Size([1, 23, 1])
action scaled by temperature: tensor([[251]], device='cuda:0')
action picked by argmax: tensor([263], device='cuda:0')
tensor([[263,   4, 108, 218, 207, 226, 163,  22, 110, 160]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
24          1      264       4        25
491         2      264       3       219
715         3      264       3       170
1039        4      264       5       221
1334        5      264       4       243
       user_id  item_id  rating  timestep
12302       46      264       5        18
12567       47      264       4        10
12976       48      264       4       146
13241       49      264       4       138
13515       50      264       5       139
average_rating for this rec across 50 users from same group (less noisy) was: 4.42
all_actions shape just before sample torch.Size([1, 24, 1])
action scaled by temperature: tensor([[252]], device='cuda:0')
action picked by argmax: tensor([263], device='cuda:0')
tensor([[263,  32,   4, 218,  29, 108, 133, 165, 160,  15]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
24          1      264       4        25
491         2      264       3       219
715         3      264       3       170
1039        4      264       5       221
1334        5      264       4       243
       user_id  item_id  rating  timestep
12302       46      264       5        18
12567       47      264       4        10
12976       48      264       4       146
13241       49      264       4       138
13515       50      264       5       139
average_rating for this rec across 50 users from same group (less noisy) was: 4.42
all_actions shape just before sample torch.Size([1, 25, 1])
action scaled by temperature: tensor([[109]], device='cuda:0')
action picked by argmax: tensor([32], device='cuda:0')
tensor([[ 32, 193,  29, 160, 263, 180, 158,  10, 133, 231]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
117         1       33       3       118
463         2       33       2       191
738         3       33       2       193
837         4       33       5        19
1267        5       33       3       176
       user_id  item_id  rating  timestep
12454       46       33       4       170
12590       47       33       4        33
12848       48       33       4        18
13360       49       33       4       257
13418       50       33       5        42
average_rating for this rec across 50 users from same group (less noisy) was: 3.6
all_actions shape just before sample torch.Size([1, 26, 1])
action scaled by temperature: tensor([[63]], device='cuda:0')
action picked by argmax: tensor([120], device='cuda:0')
tensor([[120, 157, 235, 170, 211, 272, 244, 114, 104, 105]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
140         1      121       4       141
340         2      121       4        68
548         3      121       4         3
1028        4      121       4       210
1324        5      121       4       233
       user_id  item_id  rating  timestep
12449       46      121       3       165
12767       47      121       4       210
13025       48      121       4       195
13269       49      121       4       166
13383       50      121       4         7
average_rating for this rec across 50 users from same group (less noisy) was: 4.02
all_actions shape just before sample torch.Size([1, 27, 1])
action scaled by temperature: tensor([[97]], device='cuda:0')
action picked by argmax: tensor([211], device='cuda:0')
tensor([[211, 157, 183, 237,  41, 160, 268,  37, 231, 110]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
16          1      212       4        17
467         2      212       5       195
562         3      212       5        17
1019        4      212       5       201
1164        5      212       4        73
       user_id  item_id  rating  timestep
12469       46      212       5       185
12820       47      212       5       263
13061       48      212       5       231
13249       49      212       4       146
13422       50      212       5        46
average_rating for this rec across 50 users from same group (less noisy) was: 4.66
all_actions shape just before sample torch.Size([1, 28, 1])
action scaled by temperature: tensor([[200]], device='cuda:0')
action picked by argmax: tensor([211], device='cuda:0')
tensor([[211, 157, 237, 160,  41, 264, 268,  37, 235, 183]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
16          1      212       4        17
467         2      212       5       195
562         3      212       5        17
1019        4      212       5       201
1164        5      212       4        73
       user_id  item_id  rating  timestep
12469       46      212       5       185
12820       47      212       5       263
13061       48      212       5       231
13249       49      212       4       146
13422       50      212       5        46
average_rating for this rec across 50 users from same group (less noisy) was: 4.66
all_actions shape just before sample torch.Size([1, 29, 1])
action scaled by temperature: tensor([[267]], device='cuda:0')
action picked by argmax: tensor([211], device='cuda:0')
tensor([[211, 110, 183,  41, 207, 160, 268, 231,  38, 237]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
16          1      212       4        17
467         2      212       5       195
562         3      212       5        17
1019        4      212       5       201
1164        5      212       4        73
       user_id  item_id  rating  timestep
12469       46      212       5       185
12820       47      212       5       263
13061       48      212       5       231
13249       49      212       4       146
13422       50      212       5        46
average_rating for this rec across 50 users from same group (less noisy) was: 4.66
all_actions shape just before sample torch.Size([1, 30, 1])
action scaled by temperature: tensor([[109]], device='cuda:0')
action picked by argmax: tensor([235], device='cuda:0')
tensor([[235, 211, 157, 264, 215,  52,  88, 185, 237, 187]], device='cuda:0')
Just recommended 30 new items to 50 users from group 1 and the total rating was 124.01999999999998
train_loss is: 5.4558416719306
action scaled by temperature: tensor([[110]], device='cuda:0')
action picked by argmax: tensor([205], device='cuda:0')
tensor([[205, 260,  83, 237,  30, 157, 246, 268, 231, 197]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
199         1      206       3       200
408         2      206       4       136
800         3      206       4       255
935         4      206       3       117
1159        5      206       4        68
       user_id  item_id  rating  timestep
12540       46      206       3       256
12585       47      206       4        28
12935       48      206       3       105
13364       49      206       5       261
13505       50      206       3       129
average_rating for this rec across 50 users from same group (less noisy) was: 4.16
all_actions shape just before sample torch.Size([1, 1, 1])
action scaled by temperature: tensor([[215]], device='cuda:0')
action picked by argmax: tensor([85], device='cuda:0')
tensor([[ 85, 266,   5, 250, 193,   9, 260,  75,  37, 158]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
266         1       86       5       267
509         2       86       5       237
777         3       86       5       232
917         4       86       5        99
1121        5       86       4        30
       user_id  item_id  rating  timestep
12506       46       86       5       222
12600       47       86       5        43
13074       48       86       5       244
13362       49       86       5       259
13397       50       86       5        21
average_rating for this rec across 50 users from same group (less noisy) was: 4.58
all_actions shape just before sample torch.Size([1, 2, 1])
action scaled by temperature: tensor([[96]], device='cuda:0')
action picked by argmax: tensor([193], device='cuda:0')
tensor([[193, 158,  85,  37, 149, 250,   9, 201,   5, 231]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
15          1      194       3        16
423         2      194       5       151
569         3      194       2        24
971         4      194       3       153
1099        5      194       5         8
       user_id  item_id  rating  timestep
12512       46      194       4       228
12663       47      194       3       106
13083       48      194       3       253
13117       49      194       3        14
13489       50      194       2       113
average_rating for this rec across 50 users from same group (less noisy) was: 3.58
all_actions shape just before sample torch.Size([1, 3, 1])
action scaled by temperature: tensor([[33]], device='cuda:0')
action picked by argmax: tensor([193], device='cuda:0')
tensor([[193,  85, 158,   9,  37, 250, 149, 231, 180,  10]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
15          1      194       3        16
423         2      194       5       151
569         3      194       2        24
971         4      194       3       153
1099        5      194       5         8
       user_id  item_id  rating  timestep
12512       46      194       4       228
12663       47      194       3       106
13083       48      194       3       253
13117       49      194       3        14
13489       50      194       2       113
average_rating for this rec across 50 users from same group (less noisy) was: 3.58
all_actions shape just before sample torch.Size([1, 4, 1])
action scaled by temperature: tensor([[43]], device='cuda:0')
action picked by argmax: tensor([149], device='cuda:0')
tensor([[149,  37, 193, 231, 158,  85,   9, 250, 199, 257]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
59          1      150       4        60
274         2      150       1         2
792         3      150       3       247
952         4      150       4       134
1175        5      150       3        84
       user_id  item_id  rating  timestep
12343       46      150       3        59
12750       47      150       3       193
13050       48      150       2       220
13125       49      150       2        22
13522       50      150       4       146
average_rating for this rec across 50 users from same group (less noisy) was: 3.26
all_actions shape just before sample torch.Size([1, 5, 1])
action scaled by temperature: tensor([[1]], device='cuda:0')
action picked by argmax: tensor([231], device='cuda:0')
tensor([[231, 193, 149,  37,  98, 250,  85, 158, 257, 180]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
250         1      232       4       251
469         2      232       4       197
557         3      232       4        12
922         4      232       5       104
1265        5      232       5       174
       user_id  item_id  rating  timestep
12299       46      232       5        15
12815       47      232       3       258
12865       48      232       4        35
13142       49      232       5        39
13469       50      232       3        93
average_rating for this rec across 50 users from same group (less noisy) was: 4.38
all_actions shape just before sample torch.Size([1, 6, 1])
action scaled by temperature: tensor([[145]], device='cuda:0')
action picked by argmax: tensor([149], device='cuda:0')
tensor([[149, 158,  37, 193, 231,  85, 201, 199,   9, 250]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
59          1      150       4        60
274         2      150       1         2
792         3      150       3       247
952         4      150       4       134
1175        5      150       3        84
       user_id  item_id  rating  timestep
12343       46      150       3        59
12750       47      150       3       193
13050       48      150       2       220
13125       49      150       2        22
13522       50      150       4       146
average_rating for this rec across 50 users from same group (less noisy) was: 3.26
all_actions shape just before sample torch.Size([1, 7, 1])
action scaled by temperature: tensor([[5]], device='cuda:0')
action picked by argmax: tensor([231], device='cuda:0')
tensor([[231,  85, 180, 193,  98, 250, 205, 200, 254,   5]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
250         1      232       4       251
469         2      232       4       197
557         3      232       4        12
922         4      232       5       104
1265        5      232       5       174
       user_id  item_id  rating  timestep
12299       46      232       5        15
12815       47      232       3       258
12865       48      232       4        35
13142       49      232       5        39
13469       50      232       3        93
average_rating for this rec across 50 users from same group (less noisy) was: 4.38
all_actions shape just before sample torch.Size([1, 8, 1])
action scaled by temperature: tensor([[141]], device='cuda:0')
action picked by argmax: tensor([85], device='cuda:0')
tensor([[ 85, 231,   5,  18, 254, 200, 266, 193, 260, 250]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
266         1       86       5       267
509         2       86       5       237
777         3       86       5       232
917         4       86       5        99
1121        5       86       4        30
       user_id  item_id  rating  timestep
12506       46       86       5       222
12600       47       86       5        43
13074       48       86       5       244
13362       49       86       5       259
13397       50       86       5        21
average_rating for this rec across 50 users from same group (less noisy) was: 4.58
all_actions shape just before sample torch.Size([1, 9, 1])
action scaled by temperature: tensor([[95]], device='cuda:0')
action picked by argmax: tensor([196], device='cuda:0')
tensor([[196, 231, 101, 149, 160, 158, 201, 213, 181, 193]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
98          1      197       3        99
369         2      197       4        97
729         3      197       3       184
867         4      197       5        49
1109        5      197       4        18
       user_id  item_id  rating  timestep
12311       46      197       2        27
12645       47      197       4        88
13014       48      197       3       184
13119       49      197       1        16
13636       50      197       3       260
average_rating for this rec across 50 users from same group (less noisy) was: 3.28
all_actions shape just before sample torch.Size([1, 10, 1])
action scaled by temperature: tensor([[16]], device='cuda:0')
action picked by argmax: tensor([32], device='cuda:0')
tensor([[ 32,  15, 160,  29, 180, 158,  10, 201, 219, 149]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
117         1       33       3       118
463         2       33       2       191
738         3       33       2       193
837         4       33       5        19
1267        5       33       3       176
       user_id  item_id  rating  timestep
12454       46       33       4       170
12590       47       33       4        33
12848       48       33       4        18
13360       49       33       4       257
13418       50       33       5        42
average_rating for this rec across 50 users from same group (less noisy) was: 3.6
all_actions shape just before sample torch.Size([1, 11, 1])
action scaled by temperature: tensor([[64]], device='cuda:0')
action picked by argmax: tensor([38], device='cuda:0')
tensor([[ 38,  19, 183,  83,  35, 110, 111,  47, 223, 267]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
264         1       39       3       265
276         2       39       3         4
670         3       39       2       125
899         4       39       3        81
1171        5       39       4        80
       user_id  item_id  rating  timestep
12532       46       39       3       248
12562       47       39       3         5
13086       48       39       2       256
13210       49       39       3       107
13467       50       39       3        91
average_rating for this rec across 50 users from same group (less noisy) was: 3.04
all_actions shape just before sample torch.Size([1, 12, 1])
action scaled by temperature: tensor([[133]], device='cuda:0')
action picked by argmax: tensor([38], device='cuda:0')
tensor([[ 38, 183,  35, 110, 223,  19, 111,  83,  81, 218]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
264         1       39       3       265
276         2       39       3         4
670         3       39       2       125
899         4       39       3        81
1171        5       39       4        80
       user_id  item_id  rating  timestep
12532       46       39       3       248
12562       47       39       3         5
13086       48       39       2       256
13210       49       39       3       107
13467       50       39       3        91
average_rating for this rec across 50 users from same group (less noisy) was: 3.04
all_actions shape just before sample torch.Size([1, 13, 1])
action scaled by temperature: tensor([[30]], device='cuda:0')
action picked by argmax: tensor([38], device='cuda:0')
tensor([[ 38, 183, 110,  35, 223, 218,  19, 111,  81,  83]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
264         1       39       3       265
276         2       39       3         4
670         3       39       2       125
899         4       39       3        81
1171        5       39       4        80
       user_id  item_id  rating  timestep
12532       46       39       3       248
12562       47       39       3         5
13086       48       39       2       256
13210       49       39       3       107
13467       50       39       3        91
average_rating for this rec across 50 users from same group (less noisy) was: 3.04
all_actions shape just before sample torch.Size([1, 14, 1])
action scaled by temperature: tensor([[114]], device='cuda:0')
action picked by argmax: tensor([38], device='cuda:0')
tensor([[ 38, 183,  35, 110, 223, 218, 231, 111,  81,  36]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
264         1       39       3       265
276         2       39       3         4
670         3       39       2       125
899         4       39       3        81
1171        5       39       4        80
       user_id  item_id  rating  timestep
12532       46       39       3       248
12562       47       39       3         5
13086       48       39       2       256
13210       49       39       3       107
13467       50       39       3        91
average_rating for this rec across 50 users from same group (less noisy) was: 3.04
all_actions shape just before sample torch.Size([1, 15, 1])
action scaled by temperature: tensor([[129]], device='cuda:0')
action picked by argmax: tensor([38], device='cuda:0')
tensor([[ 38, 183,  35, 110, 223, 218, 231, 111, 100,  36]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
264         1       39       3       265
276         2       39       3         4
670         3       39       2       125
899         4       39       3        81
1171        5       39       4        80
       user_id  item_id  rating  timestep
12532       46       39       3       248
12562       47       39       3         5
13086       48       39       2       256
13210       49       39       3       107
13467       50       39       3        91
average_rating for this rec across 50 users from same group (less noisy) was: 3.04
all_actions shape just before sample torch.Size([1, 16, 1])
action scaled by temperature: tensor([[191]], device='cuda:0')
action picked by argmax: tensor([38], device='cuda:0')
tensor([[ 38,  35, 183, 110, 223, 218, 231,  36, 100, 111]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
264         1       39       3       265
276         2       39       3         4
670         3       39       2       125
899         4       39       3        81
1171        5       39       4        80
       user_id  item_id  rating  timestep
12532       46       39       3       248
12562       47       39       3         5
13086       48       39       2       256
13210       49       39       3       107
13467       50       39       3        91
average_rating for this rec across 50 users from same group (less noisy) was: 3.04
all_actions shape just before sample torch.Size([1, 17, 1])
action scaled by temperature: tensor([[123]], device='cuda:0')
action picked by argmax: tensor([38], device='cuda:0')
tensor([[ 38, 183,  35, 110, 223,  36, 218, 231,  44, 220]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
264         1       39       3       265
276         2       39       3         4
670         3       39       2       125
899         4       39       3        81
1171        5       39       4        80
       user_id  item_id  rating  timestep
12532       46       39       3       248
12562       47       39       3         5
13086       48       39       2       256
13210       49       39       3       107
13467       50       39       3        91
average_rating for this rec across 50 users from same group (less noisy) was: 3.04
all_actions shape just before sample torch.Size([1, 18, 1])
action scaled by temperature: tensor([[242]], device='cuda:0')
action picked by argmax: tensor([38], device='cuda:0')
tensor([[ 38, 183,  19, 220,  44, 223,  39,  35,  36,  47]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
264         1       39       3       265
276         2       39       3         4
670         3       39       2       125
899         4       39       3        81
1171        5       39       4        80
       user_id  item_id  rating  timestep
12532       46       39       3       248
12562       47       39       3         5
13086       48       39       2       256
13210       49       39       3       107
13467       50       39       3        91
average_rating for this rec across 50 users from same group (less noisy) was: 3.04
all_actions shape just before sample torch.Size([1, 19, 1])
action scaled by temperature: tensor([[167]], device='cuda:0')
action picked by argmax: tensor([38], device='cuda:0')
tensor([[ 38, 183,  19,  39,  44, 223,  35, 220,  36,  47]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
264         1       39       3       265
276         2       39       3         4
670         3       39       2       125
899         4       39       3        81
1171        5       39       4        80
       user_id  item_id  rating  timestep
12532       46       39       3       248
12562       47       39       3         5
13086       48       39       2       256
13210       49       39       3       107
13467       50       39       3        91
average_rating for this rec across 50 users from same group (less noisy) was: 3.04
all_actions shape just before sample torch.Size([1, 20, 1])
action scaled by temperature: tensor([[170]], device='cuda:0')
action picked by argmax: tensor([38], device='cuda:0')
tensor([[ 38, 183,  19,  39,  47, 207,  44, 110, 220,  36]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
264         1       39       3       265
276         2       39       3         4
670         3       39       2       125
899         4       39       3        81
1171        5       39       4        80
       user_id  item_id  rating  timestep
12532       46       39       3       248
12562       47       39       3         5
13086       48       39       2       256
13210       49       39       3       107
13467       50       39       3        91
average_rating for this rec across 50 users from same group (less noisy) was: 3.04
all_actions shape just before sample torch.Size([1, 21, 1])
action scaled by temperature: tensor([[132]], device='cuda:0')
action picked by argmax: tensor([38], device='cuda:0')
tensor([[ 38, 207,  19,  39,  47, 220, 183, 110, 231,  44]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
264         1       39       3       265
276         2       39       3         4
670         3       39       2       125
899         4       39       3        81
1171        5       39       4        80
       user_id  item_id  rating  timestep
12532       46       39       3       248
12562       47       39       3         5
13086       48       39       2       256
13210       49       39       3       107
13467       50       39       3        91
average_rating for this rec across 50 users from same group (less noisy) was: 3.04
all_actions shape just before sample torch.Size([1, 22, 1])
action scaled by temperature: tensor([[90]], device='cuda:0')
action picked by argmax: tensor([231], device='cuda:0')
tensor([[231, 207,  38,  47,  81,  88, 215,  19, 220, 184]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
250         1      232       4       251
469         2      232       4       197
557         3      232       4        12
922         4      232       5       104
1265        5      232       5       174
       user_id  item_id  rating  timestep
12299       46      232       5        15
12815       47      232       3       258
12865       48      232       4        35
13142       49      232       5        39
13469       50      232       3        93
average_rating for this rec across 50 users from same group (less noisy) was: 4.38
all_actions shape just before sample torch.Size([1, 23, 1])
action scaled by temperature: tensor([[133]], device='cuda:0')
action picked by argmax: tensor([231], device='cuda:0')
tensor([[231,  38, 207, 235,  81,  47,  48, 215,  37, 102]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
250         1      232       4       251
469         2      232       4       197
557         3      232       4        12
922         4      232       5       104
1265        5      232       5       174
       user_id  item_id  rating  timestep
12299       46      232       5        15
12815       47      232       3       258
12865       48      232       4        35
13142       49      232       5        39
13469       50      232       3        93
average_rating for this rec across 50 users from same group (less noisy) was: 4.38
all_actions shape just before sample torch.Size([1, 24, 1])
action scaled by temperature: tensor([[215]], device='cuda:0')
action picked by argmax: tensor([38], device='cuda:0')
tensor([[ 38, 231, 207,  47,  81, 235,  48, 215, 110, 220]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
264         1       39       3       265
276         2       39       3         4
670         3       39       2       125
899         4       39       3        81
1171        5       39       4        80
       user_id  item_id  rating  timestep
12532       46       39       3       248
12562       47       39       3         5
13086       48       39       2       256
13210       49       39       3       107
13467       50       39       3        91
average_rating for this rec across 50 users from same group (less noisy) was: 3.04
all_actions shape just before sample torch.Size([1, 25, 1])
action scaled by temperature: tensor([[149]], device='cuda:0')
action picked by argmax: tensor([231], device='cuda:0')
tensor([[231,  38, 235,  48, 170, 215, 120,  37,  88, 199]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
250         1      232       4       251
469         2      232       4       197
557         3      232       4        12
922         4      232       5       104
1265        5      232       5       174
       user_id  item_id  rating  timestep
12299       46      232       5        15
12815       47      232       3       258
12865       48      232       4        35
13142       49      232       5        39
13469       50      232       3        93
average_rating for this rec across 50 users from same group (less noisy) was: 4.38
all_actions shape just before sample torch.Size([1, 26, 1])
action scaled by temperature: tensor([[121]], device='cuda:0')
action picked by argmax: tensor([231], device='cuda:0')
tensor([[231,  38, 120, 170, 215, 235,  48, 167,  88, 185]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
250         1      232       4       251
469         2      232       4       197
557         3      232       4        12
922         4      232       5       104
1265        5      232       5       174
       user_id  item_id  rating  timestep
12299       46      232       5        15
12815       47      232       3       258
12865       48      232       4        35
13142       49      232       5        39
13469       50      232       3        93
average_rating for this rec across 50 users from same group (less noisy) was: 4.38
all_actions shape just before sample torch.Size([1, 27, 1])
action scaled by temperature: tensor([[170]], device='cuda:0')
action picked by argmax: tensor([231], device='cuda:0')
tensor([[231,  38, 120, 215, 170, 235,  48,  88, 102, 167]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
250         1      232       4       251
469         2      232       4       197
557         3      232       4        12
922         4      232       5       104
1265        5      232       5       174
       user_id  item_id  rating  timestep
12299       46      232       5        15
12815       47      232       3       258
12865       48      232       4        35
13142       49      232       5        39
13469       50      232       3        93
average_rating for this rec across 50 users from same group (less noisy) was: 4.38
all_actions shape just before sample torch.Size([1, 28, 1])
action scaled by temperature: tensor([[46]], device='cuda:0')
action picked by argmax: tensor([231], device='cuda:0')
tensor([[231,  38, 215, 120, 235,  48, 170,  88, 102, 186]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
250         1      232       4       251
469         2      232       4       197
557         3      232       4        12
922         4      232       5       104
1265        5      232       5       174
       user_id  item_id  rating  timestep
12299       46      232       5        15
12815       47      232       3       258
12865       48      232       4        35
13142       49      232       5        39
13469       50      232       3        93
average_rating for this rec across 50 users from same group (less noisy) was: 4.38
all_actions shape just before sample torch.Size([1, 29, 1])
action scaled by temperature: tensor([[79]], device='cuda:0')
action picked by argmax: tensor([231], device='cuda:0')
tensor([[231,  38, 120, 167, 170, 215, 235, 186,  87,  41]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
250         1      232       4       251
469         2      232       4       197
557         3      232       4        12
922         4      232       5       104
1265        5      232       5       174
       user_id  item_id  rating  timestep
12299       46      232       5        15
12815       47      232       3       258
12865       48      232       4        35
13142       49      232       5        39
13469       50      232       3        93
average_rating for this rec across 50 users from same group (less noisy) was: 4.38
all_actions shape just before sample torch.Size([1, 30, 1])
action scaled by temperature: tensor([[214]], device='cuda:0')
action picked by argmax: tensor([231], device='cuda:0')
tensor([[231,  38, 120, 170, 167, 235,  41, 186,  97,  87]], device='cuda:0')
Just recommended 30 new items to 50 users from group 1 and the total rating was 109.77999999999999
train_loss is: 5.347176379809096
action scaled by temperature: tensor([[181]], device='cuda:0')
action picked by argmax: tensor([246], device='cuda:0')
tensor([[246, 268, 205,  30, 260,  83, 266, 202, 144,  10]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
185         1      247       4       186
384         2      247       4       112
620         3      247       5        75
986         4      247       5       168
1337        5      247       4       246
       user_id  item_id  rating  timestep
12355       46      247       4        71
12740       47      247       4       183
12928       48      247       5        98
13339       49      247       3       236
13639       50      247       4       263
average_rating for this rec across 50 users from same group (less noisy) was: 4.12
all_actions shape just before sample torch.Size([1, 1, 1])
action scaled by temperature: tensor([[128]], device='cuda:0')
action picked by argmax: tensor([246], device='cuda:0')
tensor([[246, 268, 205,  30, 231, 260,  83, 200, 227, 202]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
185         1      247       4       186
384         2      247       4       112
620         3      247       5        75
986         4      247       5       168
1337        5      247       4       246
       user_id  item_id  rating  timestep
12355       46      247       4        71
12740       47      247       4       183
12928       48      247       5        98
13339       49      247       3       236
13639       50      247       4       263
average_rating for this rec across 50 users from same group (less noisy) was: 4.12
all_actions shape just before sample torch.Size([1, 2, 1])
action scaled by temperature: tensor([[6]], device='cuda:0')
action picked by argmax: tensor([246], device='cuda:0')
tensor([[246, 205, 268,  30, 231, 260, 202,  83, 200, 227]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
185         1      247       4       186
384         2      247       4       112
620         3      247       5        75
986         4      247       5       168
1337        5      247       4       246
       user_id  item_id  rating  timestep
12355       46      247       4        71
12740       47      247       4       183
12928       48      247       5        98
13339       49      247       3       236
13639       50      247       4       263
average_rating for this rec across 50 users from same group (less noisy) was: 4.12
all_actions shape just before sample torch.Size([1, 3, 1])
action scaled by temperature: tensor([[235]], device='cuda:0')
action picked by argmax: tensor([246], device='cuda:0')
tensor([[246, 205, 268,  30, 231, 260, 200, 227, 202,  83]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
185         1      247       4       186
384         2      247       4       112
620         3      247       5        75
986         4      247       5       168
1337        5      247       4       246
       user_id  item_id  rating  timestep
12355       46      247       4        71
12740       47      247       4       183
12928       48      247       5        98
13339       49      247       3       236
13639       50      247       4       263
average_rating for this rec across 50 users from same group (less noisy) was: 4.12
all_actions shape just before sample torch.Size([1, 4, 1])
action scaled by temperature: tensor([[91]], device='cuda:0')
action picked by argmax: tensor([246], device='cuda:0')
tensor([[246, 205, 268,  30, 231, 227,  83, 260, 200, 202]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
185         1      247       4       186
384         2      247       4       112
620         3      247       5        75
986         4      247       5       168
1337        5      247       4       246
       user_id  item_id  rating  timestep
12355       46      247       4        71
12740       47      247       4       183
12928       48      247       5        98
13339       49      247       3       236
13639       50      247       4       263
average_rating for this rec across 50 users from same group (less noisy) was: 4.12
all_actions shape just before sample torch.Size([1, 5, 1])
action scaled by temperature: tensor([[17]], device='cuda:0')
action picked by argmax: tensor([246], device='cuda:0')
tensor([[246, 205, 268,  30, 231, 260,  83, 227, 200, 202]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
185         1      247       4       186
384         2      247       4       112
620         3      247       5        75
986         4      247       5       168
1337        5      247       4       246
       user_id  item_id  rating  timestep
12355       46      247       4        71
12740       47      247       4       183
12928       48      247       5        98
13339       49      247       3       236
13639       50      247       4       263
average_rating for this rec across 50 users from same group (less noisy) was: 4.12
all_actions shape just before sample torch.Size([1, 6, 1])
action scaled by temperature: tensor([[36]], device='cuda:0')
action picked by argmax: tensor([246], device='cuda:0')
tensor([[246, 205, 268, 260, 227, 231,  30, 200,  83, 137]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
185         1      247       4       186
384         2      247       4       112
620         3      247       5        75
986         4      247       5       168
1337        5      247       4       246
       user_id  item_id  rating  timestep
12355       46      247       4        71
12740       47      247       4       183
12928       48      247       5        98
13339       49      247       3       236
13639       50      247       4       263
average_rating for this rec across 50 users from same group (less noisy) was: 4.12
all_actions shape just before sample torch.Size([1, 7, 1])
action scaled by temperature: tensor([[199]], device='cuda:0')
action picked by argmax: tensor([246], device='cuda:0')
tensor([[246, 205, 268,  30, 231, 260, 202, 227, 200, 137]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
185         1      247       4       186
384         2      247       4       112
620         3      247       5        75
986         4      247       5       168
1337        5      247       4       246
       user_id  item_id  rating  timestep
12355       46      247       4        71
12740       47      247       4       183
12928       48      247       5        98
13339       49      247       3       236
13639       50      247       4       263
average_rating for this rec across 50 users from same group (less noisy) was: 4.12
all_actions shape just before sample torch.Size([1, 8, 1])
action scaled by temperature: tensor([[98]], device='cuda:0')
action picked by argmax: tensor([246], device='cuda:0')
tensor([[246, 205, 268,  30, 260, 231, 227, 200, 202, 101]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
185         1      247       4       186
384         2      247       4       112
620         3      247       5        75
986         4      247       5       168
1337        5      247       4       246
       user_id  item_id  rating  timestep
12355       46      247       4        71
12740       47      247       4       183
12928       48      247       5        98
13339       49      247       3       236
13639       50      247       4       263
average_rating for this rec across 50 users from same group (less noisy) was: 4.12
all_actions shape just before sample torch.Size([1, 9, 1])
action scaled by temperature: tensor([[83]], device='cuda:0')
action picked by argmax: tensor([246], device='cuda:0')
tensor([[246, 205, 268, 260,  30, 231, 227, 200, 202, 101]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
185         1      247       4       186
384         2      247       4       112
620         3      247       5        75
986         4      247       5       168
1337        5      247       4       246
       user_id  item_id  rating  timestep
12355       46      247       4        71
12740       47      247       4       183
12928       48      247       5        98
13339       49      247       3       236
13639       50      247       4       263
average_rating for this rec across 50 users from same group (less noisy) was: 4.12
all_actions shape just before sample torch.Size([1, 10, 1])
action scaled by temperature: tensor([[105]], device='cuda:0')
action picked by argmax: tensor([246], device='cuda:0')
tensor([[246, 205, 268, 227, 260,  30, 231, 200, 180,  83]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
185         1      247       4       186
384         2      247       4       112
620         3      247       5        75
986         4      247       5       168
1337        5      247       4       246
       user_id  item_id  rating  timestep
12355       46      247       4        71
12740       47      247       4       183
12928       48      247       5        98
13339       49      247       3       236
13639       50      247       4       263
average_rating for this rec across 50 users from same group (less noisy) was: 4.12
all_actions shape just before sample torch.Size([1, 11, 1])
action scaled by temperature: tensor([[158]], device='cuda:0')
action picked by argmax: tensor([268], device='cuda:0')
tensor([[268, 246, 205, 227, 260,  30, 231,  83, 200, 237]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
146         1      269       5       147
338         2      269       4        66
695         3      269       5       150
1049        4      269       5       231
1295        5      269       4       204
       user_id  item_id  rating  timestep
12474       46      269       4       190
12685       47      269       5       128
13091       48      269       4       261
13338       49      269       4       235
13558       50      269       5       182
average_rating for this rec across 50 users from same group (less noisy) was: 4.12
all_actions shape just before sample torch.Size([1, 12, 1])
action scaled by temperature: tensor([[148]], device='cuda:0')
action picked by argmax: tensor([157], device='cuda:0')
tensor([[157, 102, 244,  83,  56, 105, 185, 262, 235, 272]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
156         1      158       4       157
496         2      158       5       224
798         3      158       4       253
1015        4      158       4       197
1351        5      158       4       260
       user_id  item_id  rating  timestep
12457       46      158       4       173
12809       47      158       5       252
13046       48      158       5       216
13322       49      158       3       219
13399       50      158       5        23
average_rating for this rec across 50 users from same group (less noisy) was: 4.42
all_actions shape just before sample torch.Size([1, 13, 1])
action scaled by temperature: tensor([[102]], device='cuda:0')
action picked by argmax: tensor([105], device='cuda:0')
tensor([[105, 244, 185, 102, 262,  83, 126, 235, 157, 203]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
151         1      106       4       152
453         2      106       4       181
605         3      106       5        60
1071        4      106       2       253
1228        5      106       3       137
       user_id  item_id  rating  timestep
12389       46      106       4       105
12808       47      106       4       251
12996       48      106       4       166
13279       49      106       4       176
13559       50      106       5       183
average_rating for this rec across 50 users from same group (less noisy) was: 4.14
all_actions shape just before sample torch.Size([1, 14, 1])
action scaled by temperature: tensor([[72]], device='cuda:0')
action picked by argmax: tensor([185], device='cuda:0')
tensor([[185, 235, 112, 105,  12, 107,  99, 224,  97, 170]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
149         1      186       3       150
283         2      186       3        11
635         3      186       2        90
1052        4      186       4       234
1137        5      186       3        46
       user_id  item_id  rating  timestep
12412       46      186       4       128
12689       47      186       2       132
12858       48      186       3        28
13206       49      186       4       103
13612       50      186       3       236
average_rating for this rec across 50 users from same group (less noisy) was: 3.22
all_actions shape just before sample torch.Size([1, 15, 1])
action scaled by temperature: tensor([[234]], device='cuda:0')
action picked by argmax: tensor([99], device='cuda:0')
tensor([[ 99,  54, 235,   0, 271, 179,  81, 143,  74, 250]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
181         1      100       5       182
298         2      100       4        26
779         3      100       5       234
902         4      100       5        84
1101        5      100       5        10
       user_id  item_id  rating  timestep
12367       46      100       5        83
12682       47      100       5       125
13064       48      100       5       234
13324       49      100       5       221
13421       50      100       4        45
average_rating for this rec across 50 users from same group (less noisy) was: 4.78
all_actions shape just before sample torch.Size([1, 16, 1])
action scaled by temperature: tensor([[270]], device='cuda:0')
action picked by argmax: tensor([99], device='cuda:0')
tensor([[ 99,  54, 271, 179,  81,   0, 143, 235, 250,  80]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
181         1      100       5       182
298         2      100       4        26
779         3      100       5       234
902         4      100       5        84
1101        5      100       5        10
       user_id  item_id  rating  timestep
12367       46      100       5        83
12682       47      100       5       125
13064       48      100       5       234
13324       49      100       5       221
13421       50      100       4        45
average_rating for this rec across 50 users from same group (less noisy) was: 4.78
all_actions shape just before sample torch.Size([1, 17, 1])
action scaled by temperature: tensor([[180]], device='cuda:0')
action picked by argmax: tensor([54], device='cuda:0')
tensor([[ 54,  99, 179, 271,   0, 250,  81, 143, 235,  74]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
95          1       55       4        96
316         2       55       4        44
718         3       55       5       173
1034        4       55       5       216
1274        5       55       4       183
       user_id  item_id  rating  timestep
12450       46       55       3       166
12817       47       55       3       260
13041       48       55       4       211
13121       49       55       3        18
13504       50       55       3       128
average_rating for this rec across 50 users from same group (less noisy) was: 3.88
all_actions shape just before sample torch.Size([1, 18, 1])
action scaled by temperature: tensor([[179]], device='cuda:0')
action picked by argmax: tensor([54], device='cuda:0')
tensor([[ 54,  99, 179, 271,  81, 143,   0, 250, 235, 123]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
95          1       55       4        96
316         2       55       4        44
718         3       55       5       173
1034        4       55       5       216
1274        5       55       4       183
       user_id  item_id  rating  timestep
12450       46       55       3       166
12817       47       55       3       260
13041       48       55       4       211
13121       49       55       3        18
13504       50       55       3       128
average_rating for this rec across 50 users from same group (less noisy) was: 3.88
all_actions shape just before sample torch.Size([1, 19, 1])
action scaled by temperature: tensor([[78]], device='cuda:0')
action picked by argmax: tensor([54], device='cuda:0')
tensor([[ 54,  99, 179, 250, 271,   0, 143,  81,  80, 123]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
95          1       55       4        96
316         2       55       4        44
718         3       55       5       173
1034        4       55       5       216
1274        5       55       4       183
       user_id  item_id  rating  timestep
12450       46       55       3       166
12817       47       55       3       260
13041       48       55       4       211
13121       49       55       3        18
13504       50       55       3       128
average_rating for this rec across 50 users from same group (less noisy) was: 3.88
all_actions shape just before sample torch.Size([1, 20, 1])
action scaled by temperature: tensor([[178]], device='cuda:0')
action picked by argmax: tensor([54], device='cuda:0')
tensor([[ 54,  99, 271, 179,  81,   0, 235,  80,  74, 211]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
95          1       55       4        96
316         2       55       4        44
718         3       55       5       173
1034        4       55       5       216
1274        5       55       4       183
       user_id  item_id  rating  timestep
12450       46       55       3       166
12817       47       55       3       260
13041       48       55       4       211
13121       49       55       3        18
13504       50       55       3       128
average_rating for this rec across 50 users from same group (less noisy) was: 3.88
all_actions shape just before sample torch.Size([1, 21, 1])
action scaled by temperature: tensor([[105]], device='cuda:0')
action picked by argmax: tensor([54], device='cuda:0')
tensor([[ 54,  99, 271, 179,   0, 250,  81,  80, 143, 123]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
95          1       55       4        96
316         2       55       4        44
718         3       55       5       173
1034        4       55       5       216
1274        5       55       4       183
       user_id  item_id  rating  timestep
12450       46       55       3       166
12817       47       55       3       260
13041       48       55       4       211
13121       49       55       3        18
13504       50       55       3       128
average_rating for this rec across 50 users from same group (less noisy) was: 3.88
all_actions shape just before sample torch.Size([1, 22, 1])
action scaled by temperature: tensor([[66]], device='cuda:0')
action picked by argmax: tensor([54], device='cuda:0')
tensor([[ 54,  99, 271, 179,  81,  80,   0, 123, 143, 235]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
95          1       55       4        96
316         2       55       4        44
718         3       55       5       173
1034        4       55       5       216
1274        5       55       4       183
       user_id  item_id  rating  timestep
12450       46       55       3       166
12817       47       55       3       260
13041       48       55       4       211
13121       49       55       3        18
13504       50       55       3       128
average_rating for this rec across 50 users from same group (less noisy) was: 3.88
all_actions shape just before sample torch.Size([1, 23, 1])
action scaled by temperature: tensor([[226]], device='cuda:0')
action picked by argmax: tensor([54], device='cuda:0')
tensor([[ 54,  99, 271, 179,  81,  80,   0, 235, 123, 211]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
95          1       55       4        96
316         2       55       4        44
718         3       55       5       173
1034        4       55       5       216
1274        5       55       4       183
       user_id  item_id  rating  timestep
12450       46       55       3       166
12817       47       55       3       260
13041       48       55       4       211
13121       49       55       3        18
13504       50       55       3       128
average_rating for this rec across 50 users from same group (less noisy) was: 3.88
all_actions shape just before sample torch.Size([1, 24, 1])
action scaled by temperature: tensor([[110]], device='cuda:0')
action picked by argmax: tensor([54], device='cuda:0')
tensor([[ 54,  99, 179, 271, 250,  81,   0,  80,  96, 123]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
95          1       55       4        96
316         2       55       4        44
718         3       55       5       173
1034        4       55       5       216
1274        5       55       4       183
       user_id  item_id  rating  timestep
12450       46       55       3       166
12817       47       55       3       260
13041       48       55       4       211
13121       49       55       3        18
13504       50       55       3       128
average_rating for this rec across 50 users from same group (less noisy) was: 3.88
all_actions shape just before sample torch.Size([1, 25, 1])
action scaled by temperature: tensor([[169]], device='cuda:0')
action picked by argmax: tensor([54], device='cuda:0')
tensor([[ 54,  99, 179,  81,  96, 271,   0,  80, 211, 234]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
95          1       55       4        96
316         2       55       4        44
718         3       55       5       173
1034        4       55       5       216
1274        5       55       4       183
       user_id  item_id  rating  timestep
12450       46       55       3       166
12817       47       55       3       260
13041       48       55       4       211
13121       49       55       3        18
13504       50       55       3       128
average_rating for this rec across 50 users from same group (less noisy) was: 3.88
all_actions shape just before sample torch.Size([1, 26, 1])
action scaled by temperature: tensor([[203]], device='cuda:0')
action picked by argmax: tensor([99], device='cuda:0')
tensor([[ 99, 179,  96,  81,  54, 234, 263, 250,  80, 168]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
181         1      100       5       182
298         2      100       4        26
779         3      100       5       234
902         4      100       5        84
1101        5      100       5        10
       user_id  item_id  rating  timestep
12367       46      100       5        83
12682       47      100       5       125
13064       48      100       5       234
13324       49      100       5       221
13421       50      100       4        45
average_rating for this rec across 50 users from same group (less noisy) was: 4.78
all_actions shape just before sample torch.Size([1, 27, 1])
action scaled by temperature: tensor([[29]], device='cuda:0')
action picked by argmax: tensor([263], device='cuda:0')
tensor([[263, 232, 187, 207, 267,  81,  39,  35, 218,  90]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
24          1      264       4        25
491         2      264       3       219
715         3      264       3       170
1039        4      264       5       221
1334        5      264       4       243
       user_id  item_id  rating  timestep
12302       46      264       5        18
12567       47      264       4        10
12976       48      264       4       146
13241       49      264       4       138
13515       50      264       5       139
average_rating for this rec across 50 users from same group (less noisy) was: 4.42
all_actions shape just before sample torch.Size([1, 28, 1])
action scaled by temperature: tensor([[180]], device='cuda:0')
action picked by argmax: tensor([180], device='cuda:0')
tensor([[180, 219,  96,  84,  32,  75,  15, 160,  29,  10]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
73          1      181       5        74
326         2      181       4        54
708         3      181       5       163
934         4      181       4       116
1231        5      181       5       140
       user_id  item_id  rating  timestep
12317       46      181       4        33
12688       47      181       5       131
13048       48      181       5       218
13131       49      181       5        28
13517       50      181       5       141
average_rating for this rec across 50 users from same group (less noisy) was: 4.68
all_actions shape just before sample torch.Size([1, 29, 1])
action scaled by temperature: tensor([[79]], device='cuda:0')
action picked by argmax: tensor([250], device='cuda:0')
tensor([[250, 164,  24, 143,  85,  13, 216, 182, 149,  68]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
22          1      251       5        23
442         2      251       4       170
691         3      251       3       146
846         4      251       3        28
1092        5      251       4         1
       user_id  item_id  rating  timestep
12533       46      251       5       249
12709       47      251       5       152
13094       48      251       4       264
13262       49      251       2       159
13395       50      251       4        19
average_rating for this rec across 50 users from same group (less noisy) was: 3.88
all_actions shape just before sample torch.Size([1, 30, 1])
action scaled by temperature: tensor([[162]], device='cuda:0')
action picked by argmax: tensor([250], device='cuda:0')
tensor([[250, 164, 143,  24,  13,  85, 182,  91,  68,  74]], device='cuda:0')
Just recommended 30 new items to 50 users from group 1 and the total rating was 123.45999999999995
train_loss is: 5.272738347859143
action scaled by temperature: tensor([[158]], device='cuda:0')
action picked by argmax: tensor([268], device='cuda:0')
tensor([[268, 260, 246, 205,  10,  30, 231,  83, 266, 144]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
146         1      269       5       147
338         2      269       4        66
695         3      269       5       150
1049        4      269       5       231
1295        5      269       4       204
       user_id  item_id  rating  timestep
12474       46      269       4       190
12685       47      269       5       128
13091       48      269       4       261
13338       49      269       4       235
13558       50      269       5       182
average_rating for this rec across 50 users from same group (less noisy) was: 4.12
all_actions shape just before sample torch.Size([1, 1, 1])
action scaled by temperature: tensor([[21]], device='cuda:0')
action picked by argmax: tensor([83], device='cuda:0')
tensor([[ 83, 157,  47, 178, 267,  19,  56, 186, 162,  21]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
255         1       84       3       256
303         2       84       5        31
754         3       84       4       209
850         4       84       4        32
1230        5       84       5       139
       user_id  item_id  rating  timestep
12517       46       84       4       233
12799       47       84       5       242
12936       48       84       5       106
13329       49       84       5       226
13635       50       84       4       259
average_rating for this rec across 50 users from same group (less noisy) was: 4.2
all_actions shape just before sample torch.Size([1, 2, 1])
action scaled by temperature: tensor([[197]], device='cuda:0')
action picked by argmax: tensor([35], device='cuda:0')
tensor([[ 35, 232,  83, 183,   4, 218, 169,  17, 263, 111]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
155         1       36       4       156
356         2       36       4        84
651         3       36       5       106
923         4       36       5       105
1293        5       36       4       202
       user_id  item_id  rating  timestep
12444       46       36       5       160
12705       47       36       5       148
13096       48       36       5       266
13242       49       36       4       139
13488       50       36       4       112
average_rating for this rec across 50 users from same group (less noisy) was: 4.46
all_actions shape just before sample torch.Size([1, 3, 1])
action scaled by temperature: tensor([[36]], device='cuda:0')
action picked by argmax: tensor([263], device='cuda:0')
tensor([[263,  35,  39, 207, 169, 133,   4, 233,  37,  83]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
24          1      264       4        25
491         2      264       3       219
715         3      264       3       170
1039        4      264       5       221
1334        5      264       4       243
       user_id  item_id  rating  timestep
12302       46      264       5        18
12567       47      264       4        10
12976       48      264       4       146
13241       49      264       4       138
13515       50      264       5       139
average_rating for this rec across 50 users from same group (less noisy) was: 4.42
all_actions shape just before sample torch.Size([1, 4, 1])
action scaled by temperature: tensor([[11]], device='cuda:0')
action picked by argmax: tensor([180], device='cuda:0')
tensor([[180,  75,  32, 146, 201,  37,  13,  15,  85,  10]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
73          1      181       5        74
326         2      181       4        54
708         3      181       5       163
934         4      181       4       116
1231        5      181       5       140
       user_id  item_id  rating  timestep
12317       46      181       4        33
12688       47      181       5       131
13048       48      181       5       218
13131       49      181       5        28
13517       50      181       5       141
average_rating for this rec across 50 users from same group (less noisy) was: 4.68
all_actions shape just before sample torch.Size([1, 5, 1])
action scaled by temperature: tensor([[123]], device='cuda:0')
action picked by argmax: tensor([27], device='cuda:0')
tensor([[ 27,  24, 250,  91,  68,  85,   9,  54, 193,  13]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
0           1       28       4         1
294         2       28       4        22
736         3       28       5       191
1051        4       28       5       233
1244        5       28       3       153
       user_id  item_id  rating  timestep
12297       46       28       3        13
12763       47       28       4       206
13040       48       28       5       210
13309       49       28       5       206
13583       50       28       5       207
average_rating for this rec across 50 users from same group (less noisy) was: 4.3
all_actions shape just before sample torch.Size([1, 6, 1])
action scaled by temperature: tensor([[20]], device='cuda:0')
action picked by argmax: tensor([250], device='cuda:0')
tensor([[250,  91,  85,  24,  27,  68,   9,  13, 182,  18]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
22          1      251       5        23
442         2      251       4       170
691         3      251       3       146
846         4      251       3        28
1092        5      251       4         1
       user_id  item_id  rating  timestep
12533       46      251       5       249
12709       47      251       5       152
13094       48      251       4       264
13262       49      251       2       159
13395       50      251       4        19
average_rating for this rec across 50 users from same group (less noisy) was: 3.88
all_actions shape just before sample torch.Size([1, 7, 1])
action scaled by temperature: tensor([[165]], device='cuda:0')
action picked by argmax: tensor([250], device='cuda:0')
tensor([[250,  85,  91,  24,  68,  27,   9,  13, 182, 268]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
22          1      251       5        23
442         2      251       4       170
691         3      251       3       146
846         4      251       3        28
1092        5      251       4         1
       user_id  item_id  rating  timestep
12533       46      251       5       249
12709       47      251       5       152
13094       48      251       4       264
13262       49      251       2       159
13395       50      251       4        19
average_rating for this rec across 50 users from same group (less noisy) was: 3.88
all_actions shape just before sample torch.Size([1, 8, 1])
action scaled by temperature: tensor([[60]], device='cuda:0')
action picked by argmax: tensor([250], device='cuda:0')
tensor([[250,  91,  24,  85,  68, 182,  27,  18,  13,   9]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
22          1      251       5        23
442         2      251       4       170
691         3      251       3       146
846         4      251       3        28
1092        5      251       4         1
       user_id  item_id  rating  timestep
12533       46      251       5       249
12709       47      251       5       152
13094       48      251       4       264
13262       49      251       2       159
13395       50      251       4        19
average_rating for this rec across 50 users from same group (less noisy) was: 3.88
all_actions shape just before sample torch.Size([1, 9, 1])
action scaled by temperature: tensor([[167]], device='cuda:0')
action picked by argmax: tensor([250], device='cuda:0')
tensor([[250,  91,  24,  85,  68, 182,  27, 268,   9,  18]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
22          1      251       5        23
442         2      251       4       170
691         3      251       3       146
846         4      251       3        28
1092        5      251       4         1
       user_id  item_id  rating  timestep
12533       46      251       5       249
12709       47      251       5       152
13094       48      251       4       264
13262       49      251       2       159
13395       50      251       4        19
average_rating for this rec across 50 users from same group (less noisy) was: 3.88
all_actions shape just before sample torch.Size([1, 10, 1])
action scaled by temperature: tensor([[172]], device='cuda:0')
action picked by argmax: tensor([250], device='cuda:0')
tensor([[250,  91,  24, 182,  85,  68,  18, 268,  27,  54]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
22          1      251       5        23
442         2      251       4       170
691         3      251       3       146
846         4      251       3        28
1092        5      251       4         1
       user_id  item_id  rating  timestep
12533       46      251       5       249
12709       47      251       5       152
13094       48      251       4       264
13262       49      251       2       159
13395       50      251       4        19
average_rating for this rec across 50 users from same group (less noisy) was: 3.88
all_actions shape just before sample torch.Size([1, 11, 1])
action scaled by temperature: tensor([[255]], device='cuda:0')
action picked by argmax: tensor([250], device='cuda:0')
tensor([[250,  91, 182,  24,  85,  68,  18,  54, 268,  27]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
22          1      251       5        23
442         2      251       4       170
691         3      251       3       146
846         4      251       3        28
1092        5      251       4         1
       user_id  item_id  rating  timestep
12533       46      251       5       249
12709       47      251       5       152
13094       48      251       4       264
13262       49      251       2       159
13395       50      251       4        19
average_rating for this rec across 50 users from same group (less noisy) was: 3.88
all_actions shape just before sample torch.Size([1, 12, 1])
action scaled by temperature: tensor([[213]], device='cuda:0')
action picked by argmax: tensor([250], device='cuda:0')
tensor([[250, 182,  91,  85,  24,  68,  27,  18,  54,  80]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
22          1      251       5        23
442         2      251       4       170
691         3      251       3       146
846         4      251       3        28
1092        5      251       4         1
       user_id  item_id  rating  timestep
12533       46      251       5       249
12709       47      251       5       152
13094       48      251       4       264
13262       49      251       2       159
13395       50      251       4        19
average_rating for this rec across 50 users from same group (less noisy) was: 3.88
all_actions shape just before sample torch.Size([1, 13, 1])
action scaled by temperature: tensor([[100]], device='cuda:0')
action picked by argmax: tensor([250], device='cuda:0')
tensor([[250,  91, 182,  24,  68,  27, 268,  85,  54, 149]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
22          1      251       5        23
442         2      251       4       170
691         3      251       3       146
846         4      251       3        28
1092        5      251       4         1
       user_id  item_id  rating  timestep
12533       46      251       5       249
12709       47      251       5       152
13094       48      251       4       264
13262       49      251       2       159
13395       50      251       4        19
average_rating for this rec across 50 users from same group (less noisy) was: 3.88
all_actions shape just before sample torch.Size([1, 14, 1])
action scaled by temperature: tensor([[182]], device='cuda:0')
action picked by argmax: tensor([250], device='cuda:0')
tensor([[250, 182,  91,  24,  68,  85,  54,  27, 268,  18]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
22          1      251       5        23
442         2      251       4       170
691         3      251       3       146
846         4      251       3        28
1092        5      251       4         1
       user_id  item_id  rating  timestep
12533       46      251       5       249
12709       47      251       5       152
13094       48      251       4       264
13262       49      251       2       159
13395       50      251       4        19
average_rating for this rec across 50 users from same group (less noisy) was: 3.88
all_actions shape just before sample torch.Size([1, 15, 1])
action scaled by temperature: tensor([[155]], device='cuda:0')
action picked by argmax: tensor([250], device='cuda:0')
tensor([[250,  91, 182,  24,  68, 268,  85,  54,  18,  27]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
22          1      251       5        23
442         2      251       4       170
691         3      251       3       146
846         4      251       3        28
1092        5      251       4         1
       user_id  item_id  rating  timestep
12533       46      251       5       249
12709       47      251       5       152
13094       48      251       4       264
13262       49      251       2       159
13395       50      251       4        19
average_rating for this rec across 50 users from same group (less noisy) was: 3.88
all_actions shape just before sample torch.Size([1, 16, 1])
action scaled by temperature: tensor([[66]], device='cuda:0')
action picked by argmax: tensor([250], device='cuda:0')
tensor([[250, 182,  91,  24,  68,  54,  85,  18, 268, 189]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
22          1      251       5        23
442         2      251       4       170
691         3      251       3       146
846         4      251       3        28
1092        5      251       4         1
       user_id  item_id  rating  timestep
12533       46      251       5       249
12709       47      251       5       152
13094       48      251       4       264
13262       49      251       2       159
13395       50      251       4        19
average_rating for this rec across 50 users from same group (less noisy) was: 3.88
all_actions shape just before sample torch.Size([1, 17, 1])
action scaled by temperature: tensor([[201]], device='cuda:0')
action picked by argmax: tensor([250], device='cuda:0')
tensor([[250, 182,  91,  24,  68,  85,  27, 268,  54, 189]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
22          1      251       5        23
442         2      251       4       170
691         3      251       3       146
846         4      251       3        28
1092        5      251       4         1
       user_id  item_id  rating  timestep
12533       46      251       5       249
12709       47      251       5       152
13094       48      251       4       264
13262       49      251       2       159
13395       50      251       4        19
average_rating for this rec across 50 users from same group (less noisy) was: 3.88
all_actions shape just before sample torch.Size([1, 18, 1])
action scaled by temperature: tensor([[19]], device='cuda:0')
action picked by argmax: tensor([250], device='cuda:0')
tensor([[250, 182,  91,  24,  68,  85,  54,  27, 268, 189]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
22          1      251       5        23
442         2      251       4       170
691         3      251       3       146
846         4      251       3        28
1092        5      251       4         1
       user_id  item_id  rating  timestep
12533       46      251       5       249
12709       47      251       5       152
13094       48      251       4       264
13262       49      251       2       159
13395       50      251       4        19
average_rating for this rec across 50 users from same group (less noisy) was: 3.88
all_actions shape just before sample torch.Size([1, 19, 1])
action scaled by temperature: tensor([[115]], device='cuda:0')
action picked by argmax: tensor([250], device='cuda:0')
tensor([[250, 182, 144,  91,  27,  24, 143,  54, 189, 268]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
22          1      251       5        23
442         2      251       4       170
691         3      251       3       146
846         4      251       3        28
1092        5      251       4         1
       user_id  item_id  rating  timestep
12533       46      251       5       249
12709       47      251       5       152
13094       48      251       4       264
13262       49      251       2       159
13395       50      251       4        19
average_rating for this rec across 50 users from same group (less noisy) was: 3.88
all_actions shape just before sample torch.Size([1, 20, 1])
action scaled by temperature: tensor([[263]], device='cuda:0')
action picked by argmax: tensor([144], device='cuda:0')
tensor([[144, 250,  27,  91, 182, 157, 143, 197, 107, 231]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
36          1      145       4        37
299         2      145       4        27
724         3      145       4       179
864         4      145       4        46
1132        5      145       4        41
       user_id  item_id  rating  timestep
12452       46      145       4       168
12749       47      145       4       192
13008       48      145       5       178
13317       49      145       4       214
13442       50      145       3        66
average_rating for this rec across 50 users from same group (less noisy) was: 4.14
all_actions shape just before sample torch.Size([1, 21, 1])
action scaled by temperature: tensor([[258]], device='cuda:0')
action picked by argmax: tensor([254], device='cuda:0')
tensor([[254, 183, 250, 144,  66,  91, 136, 233,   5,  36]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
153         1      255       5       154
544         2      255       5       272
618         3      255       4        73
989         4      255       5       171
1214        5      255       4       123
       user_id  item_id  rating  timestep
12365       46      255       5        81
12724       47      255       4       167
12933       48      255       4       103
13227       49      255       3       124
13601       50      255       3       225
average_rating for this rec across 50 users from same group (less noisy) was: 4.5
all_actions shape just before sample torch.Size([1, 22, 1])
action scaled by temperature: tensor([[182]], device='cuda:0')
action picked by argmax: tensor([272], device='cuda:0')
tensor([[272, 182, 140, 123, 210,  73,  21, 224, 186, 249]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
232         1      273       5       233
334         2      273       5        62
694         3      273       4       149
994         4      273       5       176
1131        5      273       5        40
       user_id  item_id  rating  timestep
12539       46      273       4       255
12788       47      273       5       231
12951       48      273       5       121
13264       49      273       5       161
13408       50      273       5        32
average_rating for this rec across 50 users from same group (less noisy) was: 4.5
all_actions shape just before sample torch.Size([1, 23, 1])
action scaled by temperature: tensor([[233]], device='cuda:0')
action picked by argmax: tensor([231], device='cuda:0')
tensor([[231, 149,  88,  84, 227, 101, 245, 123, 199,  11]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
250         1      232       4       251
469         2      232       4       197
557         3      232       4        12
922         4      232       5       104
1265        5      232       5       174
       user_id  item_id  rating  timestep
12299       46      232       5        15
12815       47      232       3       258
12865       48      232       4        35
13142       49      232       5        39
13469       50      232       3        93
average_rating for this rec across 50 users from same group (less noisy) was: 4.38
all_actions shape just before sample torch.Size([1, 24, 1])
action scaled by temperature: tensor([[95]], device='cuda:0')
action picked by argmax: tensor([231], device='cuda:0')
tensor([[231, 149,  88, 227,  84, 245, 101, 199, 123,  11]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
250         1      232       4       251
469         2      232       4       197
557         3      232       4        12
922         4      232       5       104
1265        5      232       5       174
       user_id  item_id  rating  timestep
12299       46      232       5        15
12815       47      232       3       258
12865       48      232       4        35
13142       49      232       5        39
13469       50      232       3        93
average_rating for this rec across 50 users from same group (less noisy) was: 4.38
all_actions shape just before sample torch.Size([1, 25, 1])
action scaled by temperature: tensor([[196]], device='cuda:0')
action picked by argmax: tensor([149], device='cuda:0')
tensor([[149, 231,  88, 227,  84, 245, 199,  11, 123, 132]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
59          1      150       4        60
274         2      150       1         2
792         3      150       3       247
952         4      150       4       134
1175        5      150       3        84
       user_id  item_id  rating  timestep
12343       46      150       3        59
12750       47      150       3       193
13050       48      150       2       220
13125       49      150       2        22
13522       50      150       4       146
average_rating for this rec across 50 users from same group (less noisy) was: 3.26
all_actions shape just before sample torch.Size([1, 26, 1])
action scaled by temperature: tensor([[61]], device='cuda:0')
action picked by argmax: tensor([149], device='cuda:0')
tensor([[149, 199, 245, 231,  88,  65, 227,  84, 239,  15]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
59          1      150       4        60
274         2      150       1         2
792         3      150       3       247
952         4      150       4       134
1175        5      150       3        84
       user_id  item_id  rating  timestep
12343       46      150       3        59
12750       47      150       3       193
13050       48      150       2       220
13125       49      150       2        22
13522       50      150       4       146
average_rating for this rec across 50 users from same group (less noisy) was: 3.26
all_actions shape just before sample torch.Size([1, 27, 1])
action scaled by temperature: tensor([[271]], device='cuda:0')
action picked by argmax: tensor([149], device='cuda:0')
tensor([[149, 199, 231, 245,  88,  65, 227,  84,  15, 123]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
59          1      150       4        60
274         2      150       1         2
792         3      150       3       247
952         4      150       4       134
1175        5      150       3        84
       user_id  item_id  rating  timestep
12343       46      150       3        59
12750       47      150       3       193
13050       48      150       2       220
13125       49      150       2        22
13522       50      150       4       146
average_rating for this rec across 50 users from same group (less noisy) was: 3.26
all_actions shape just before sample torch.Size([1, 28, 1])
action scaled by temperature: tensor([[46]], device='cuda:0')
action picked by argmax: tensor([149], device='cuda:0')
tensor([[149, 231,  88, 199, 245, 227,  84,  65, 123, 158]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
59          1      150       4        60
274         2      150       1         2
792         3      150       3       247
952         4      150       4       134
1175        5      150       3        84
       user_id  item_id  rating  timestep
12343       46      150       3        59
12750       47      150       3       193
13050       48      150       2       220
13125       49      150       2        22
13522       50      150       4       146
average_rating for this rec across 50 users from same group (less noisy) was: 3.26
all_actions shape just before sample torch.Size([1, 29, 1])
action scaled by temperature: tensor([[132]], device='cuda:0')
action picked by argmax: tensor([231], device='cuda:0')
tensor([[231, 149,  88, 227, 123, 101, 245, 199,  84, 132]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
250         1      232       4       251
469         2      232       4       197
557         3      232       4        12
922         4      232       5       104
1265        5      232       5       174
       user_id  item_id  rating  timestep
12299       46      232       5        15
12815       47      232       3       258
12865       48      232       4        35
13142       49      232       5        39
13469       50      232       3        93
average_rating for this rec across 50 users from same group (less noisy) was: 4.38
all_actions shape just before sample torch.Size([1, 30, 1])
action scaled by temperature: tensor([[0]], device='cuda:0')
action picked by argmax: tensor([199], device='cuda:0')
tensor([[199, 149, 245, 231, 239,  88,  65,  15,  89, 193]], device='cuda:0')
Just recommended 30 new items to 50 users from group 1 and the total rating was 119.82000000000001
train_loss is: 5.202136873654579
action scaled by temperature: tensor([[196]], device='cuda:0')
action picked by argmax: tensor([268], device='cuda:0')
tensor([[268,  10, 260, 205, 246,  30, 231,  95, 144, 180]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
146         1      269       5       147
338         2      269       4        66
695         3      269       5       150
1049        4      269       5       231
1295        5      269       4       204
       user_id  item_id  rating  timestep
12474       46      269       4       190
12685       47      269       5       128
13091       48      269       4       261
13338       49      269       4       235
13558       50      269       5       182
average_rating for this rec across 50 users from same group (less noisy) was: 4.12
all_actions shape just before sample torch.Size([1, 1, 1])
action scaled by temperature: tensor([[266]], device='cuda:0')
action picked by argmax: tensor([83], device='cuda:0')
tensor([[ 83, 157, 178,  47, 267, 186, 128,  56, 155,  19]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
255         1       84       3       256
303         2       84       5        31
754         3       84       4       209
850         4       84       4        32
1230        5       84       5       139
       user_id  item_id  rating  timestep
12517       46       84       4       233
12799       47       84       5       242
12936       48       84       5       106
13329       49       84       5       226
13635       50       84       4       259
average_rating for this rec across 50 users from same group (less noisy) was: 4.2
all_actions shape just before sample torch.Size([1, 2, 1])
action scaled by temperature: tensor([[240]], device='cuda:0')
action picked by argmax: tensor([35], device='cuda:0')
tensor([[ 35, 183,  83,  10,   4,  17, 232, 218, 169, 111]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
155         1       36       4       156
356         2       36       4        84
651         3       36       5       106
923         4       36       5       105
1293        5       36       4       202
       user_id  item_id  rating  timestep
12444       46       36       5       160
12705       47       36       5       148
13096       48       36       5       266
13242       49       36       4       139
13488       50       36       4       112
average_rating for this rec across 50 users from same group (less noisy) was: 4.46
all_actions shape just before sample torch.Size([1, 3, 1])
action scaled by temperature: tensor([[197]], device='cuda:0')
action picked by argmax: tensor([263], device='cuda:0')
tensor([[263,  35, 233, 133,  39,  22, 169,  37,   4, 187]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
24          1      264       4        25
491         2      264       3       219
715         3      264       3       170
1039        4      264       5       221
1334        5      264       4       243
       user_id  item_id  rating  timestep
12302       46      264       5        18
12567       47      264       4        10
12976       48      264       4       146
13241       49      264       4       138
13515       50      264       5       139
average_rating for this rec across 50 users from same group (less noisy) was: 4.42
all_actions shape just before sample torch.Size([1, 4, 1])
action scaled by temperature: tensor([[104]], device='cuda:0')
action picked by argmax: tensor([180], device='cuda:0')
tensor([[180,  75, 160, 201,  15,  37,  13,  10,  85, 163]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
73          1      181       5        74
326         2      181       4        54
708         3      181       5       163
934         4      181       4       116
1231        5      181       5       140
       user_id  item_id  rating  timestep
12317       46      181       4        33
12688       47      181       5       131
13048       48      181       5       218
13131       49      181       5        28
13517       50      181       5       141
average_rating for this rec across 50 users from same group (less noisy) was: 4.68
all_actions shape just before sample torch.Size([1, 5, 1])
action scaled by temperature: tensor([[84]], device='cuda:0')
action picked by argmax: tensor([27], device='cuda:0')
tensor([[ 27,  24, 125, 250,  91,  68,  94, 107, 246,  54]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
0           1       28       4         1
294         2       28       4        22
736         3       28       5       191
1051        4       28       5       233
1244        5       28       3       153
       user_id  item_id  rating  timestep
12297       46       28       3        13
12763       47       28       4       206
13040       48       28       5       210
13309       49       28       5       206
13583       50       28       5       207
average_rating for this rec across 50 users from same group (less noisy) was: 4.3
all_actions shape just before sample torch.Size([1, 6, 1])
action scaled by temperature: tensor([[59]], device='cuda:0')
action picked by argmax: tensor([250], device='cuda:0')
tensor([[250,  24,  27,  68,  91,  18,  85, 268,  79, 182]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
22          1      251       5        23
442         2      251       4       170
691         3      251       3       146
846         4      251       3        28
1092        5      251       4         1
       user_id  item_id  rating  timestep
12533       46      251       5       249
12709       47      251       5       152
13094       48      251       4       264
13262       49      251       2       159
13395       50      251       4        19
average_rating for this rec across 50 users from same group (less noisy) was: 3.88
all_actions shape just before sample torch.Size([1, 7, 1])
action scaled by temperature: tensor([[201]], device='cuda:0')
action picked by argmax: tensor([250], device='cuda:0')
tensor([[250,  24,  68, 268,  85,  91,  27,  18, 182,  79]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
22          1      251       5        23
442         2      251       4       170
691         3      251       3       146
846         4      251       3        28
1092        5      251       4         1
       user_id  item_id  rating  timestep
12533       46      251       5       249
12709       47      251       5       152
13094       48      251       4       264
13262       49      251       2       159
13395       50      251       4        19
average_rating for this rec across 50 users from same group (less noisy) was: 3.88
all_actions shape just before sample torch.Size([1, 8, 1])
action scaled by temperature: tensor([[24]], device='cuda:0')
action picked by argmax: tensor([250], device='cuda:0')
tensor([[250,  24, 268,  68,  91, 182,  18,  85, 168,  80]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
22          1      251       5        23
442         2      251       4       170
691         3      251       3       146
846         4      251       3        28
1092        5      251       4         1
       user_id  item_id  rating  timestep
12533       46      251       5       249
12709       47      251       5       152
13094       48      251       4       264
13262       49      251       2       159
13395       50      251       4        19
average_rating for this rec across 50 users from same group (less noisy) was: 3.88
all_actions shape just before sample torch.Size([1, 9, 1])
action scaled by temperature: tensor([[75]], device='cuda:0')
action picked by argmax: tensor([250], device='cuda:0')
tensor([[250, 268,  24,  68,  91, 182,  18, 168,  80,  27]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
22          1      251       5        23
442         2      251       4       170
691         3      251       3       146
846         4      251       3        28
1092        5      251       4         1
       user_id  item_id  rating  timestep
12533       46      251       5       249
12709       47      251       5       152
13094       48      251       4       264
13262       49      251       2       159
13395       50      251       4        19
average_rating for this rec across 50 users from same group (less noisy) was: 3.88
all_actions shape just before sample torch.Size([1, 10, 1])
action scaled by temperature: tensor([[115]], device='cuda:0')
action picked by argmax: tensor([250], device='cuda:0')
tensor([[250,  24, 268, 182,  68,  91, 168,  18,  85,  80]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
22          1      251       5        23
442         2      251       4       170
691         3      251       3       146
846         4      251       3        28
1092        5      251       4         1
       user_id  item_id  rating  timestep
12533       46      251       5       249
12709       47      251       5       152
13094       48      251       4       264
13262       49      251       2       159
13395       50      251       4        19
average_rating for this rec across 50 users from same group (less noisy) was: 3.88
all_actions shape just before sample torch.Size([1, 11, 1])
action scaled by temperature: tensor([[204]], device='cuda:0')
action picked by argmax: tensor([250], device='cuda:0')
tensor([[250, 268, 182,  24,  68,  91, 168,  18,  85,  80]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
22          1      251       5        23
442         2      251       4       170
691         3      251       3       146
846         4      251       3        28
1092        5      251       4         1
       user_id  item_id  rating  timestep
12533       46      251       5       249
12709       47      251       5       152
13094       48      251       4       264
13262       49      251       2       159
13395       50      251       4        19
average_rating for this rec across 50 users from same group (less noisy) was: 3.88
all_actions shape just before sample torch.Size([1, 12, 1])
action scaled by temperature: tensor([[188]], device='cuda:0')
action picked by argmax: tensor([250], device='cuda:0')
tensor([[250, 182, 168,  68,  18, 268,  24,  91, 189,  85]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
22          1      251       5        23
442         2      251       4       170
691         3      251       3       146
846         4      251       3        28
1092        5      251       4         1
       user_id  item_id  rating  timestep
12533       46      251       5       249
12709       47      251       5       152
13094       48      251       4       264
13262       49      251       2       159
13395       50      251       4        19
average_rating for this rec across 50 users from same group (less noisy) was: 3.88
all_actions shape just before sample torch.Size([1, 13, 1])
action scaled by temperature: tensor([[244]], device='cuda:0')
action picked by argmax: tensor([250], device='cuda:0')
tensor([[250, 182, 268,  24,  68,  91, 168,  18,  80, 189]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
22          1      251       5        23
442         2      251       4       170
691         3      251       3       146
846         4      251       3        28
1092        5      251       4         1
       user_id  item_id  rating  timestep
12533       46      251       5       249
12709       47      251       5       152
13094       48      251       4       264
13262       49      251       2       159
13395       50      251       4        19
average_rating for this rec across 50 users from same group (less noisy) was: 3.88
all_actions shape just before sample torch.Size([1, 14, 1])
action scaled by temperature: tensor([[169]], device='cuda:0')
action picked by argmax: tensor([250], device='cuda:0')
tensor([[250, 182, 268,  24, 168,  91,  68, 189,  18,  80]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
22          1      251       5        23
442         2      251       4       170
691         3      251       3       146
846         4      251       3        28
1092        5      251       4         1
       user_id  item_id  rating  timestep
12533       46      251       5       249
12709       47      251       5       152
13094       48      251       4       264
13262       49      251       2       159
13395       50      251       4        19
average_rating for this rec across 50 users from same group (less noisy) was: 3.88
all_actions shape just before sample torch.Size([1, 15, 1])
action scaled by temperature: tensor([[156]], device='cuda:0')
action picked by argmax: tensor([250], device='cuda:0')
tensor([[250, 182, 268, 168,  91,  24,  68,  18, 189,  80]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
22          1      251       5        23
442         2      251       4       170
691         3      251       3       146
846         4      251       3        28
1092        5      251       4         1
       user_id  item_id  rating  timestep
12533       46      251       5       249
12709       47      251       5       152
13094       48      251       4       264
13262       49      251       2       159
13395       50      251       4        19
average_rating for this rec across 50 users from same group (less noisy) was: 3.88
all_actions shape just before sample torch.Size([1, 16, 1])
action scaled by temperature: tensor([[80]], device='cuda:0')
action picked by argmax: tensor([182], device='cuda:0')
tensor([[182, 250, 168, 268,  91,  24,  68, 189,  80,  18]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
120         1      183       4       121
286         2      183       3        14
760         3      183       4       215
953         4      183       4       135
1292        5      183       5       201
       user_id  item_id  rating  timestep
12483       46      183       5       199
12707       47      183       4       150
12911       48      183       3        81
13371       49      183       4       268
13473       50      183       4        97
average_rating for this rec across 50 users from same group (less noisy) was: 4.12
all_actions shape just before sample torch.Size([1, 17, 1])
action scaled by temperature: tensor([[173]], device='cuda:0')
action picked by argmax: tensor([272], device='cuda:0')
tensor([[272, 140, 123, 157,  88, 270, 106, 174, 249,  31]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
232         1      273       5       233
334         2      273       5        62
694         3      273       4       149
994         4      273       5       176
1131        5      273       5        40
       user_id  item_id  rating  timestep
12539       46      273       4       255
12788       47      273       5       231
12951       48      273       5       121
13264       49      273       5       161
13408       50      273       5        32
average_rating for this rec across 50 users from same group (less noisy) was: 4.5
all_actions shape just before sample torch.Size([1, 18, 1])
action scaled by temperature: tensor([[199]], device='cuda:0')
action picked by argmax: tensor([76], device='cuda:0')
tensor([[ 76, 123,  88,  60,  48, 231, 101, 199,  11,  73]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
243         1       77       5       244
432         2       77       5       160
743         3       77       5       198
835         4       77       4        17
1233        5       77       4       142
       user_id  item_id  rating  timestep
12393       46       77       3       109
12719       47       77       4       162
13098       48       77       5       268
13143       49       77       4        40
13500       50       77       3       124
average_rating for this rec across 50 users from same group (less noisy) was: 3.96
all_actions shape just before sample torch.Size([1, 19, 1])
action scaled by temperature: tensor([[254]], device='cuda:0')
action picked by argmax: tensor([270], device='cuda:0')
tensor([[270, 199, 168,  73, 249, 239,  36, 131, 100,  41]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
262         1      271       4       263
532         2      271       3       260
735         3      271       4       190
958         4      271       5       140
1147        5      271       4        56
       user_id  item_id  rating  timestep
12379       46      271       4        95
12758       47      271       3       201
13055       48      271       4       225
13305       49      271       4       202
13429       50      271       4        53
average_rating for this rec across 50 users from same group (less noisy) was: 4.2
all_actions shape just before sample torch.Size([1, 20, 1])
action scaled by temperature: tensor([[168]], device='cuda:0')
action picked by argmax: tensor([168], device='cuda:0')
tensor([[168,  19,  36, 270,  47, 110,  73, 254, 131, 100]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
119         1      169       5       120
483         2      169       5       211
559         3      169       5        14
886         4      169       5        68
1273        5      169       4       182
       user_id  item_id  rating  timestep
12488       46      169       4       204
12558       47      169       5         1
13080       48      169       4       250
13150       49      169       4        47
13492       50      169       4       116
average_rating for this rec across 50 users from same group (less noisy) was: 4.72
all_actions shape just before sample torch.Size([1, 21, 1])
action scaled by temperature: tensor([[20]], device='cuda:0')
action picked by argmax: tensor([19], device='cuda:0')
tensor([[ 19,  36,  47, 254, 270, 168,  31,  21, 110, 136]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
216         1       20       5       217
314         2       20       4        42
634         3       20       5        89
956         4       20       5       138
1316        5       20       3       225
       user_id  item_id  rating  timestep
12535       46       20       5       251
12580       47       20       5        23
12889       48       20       5        59
13188       49       20       4        85
13439       50       20       4        63
average_rating for this rec across 50 users from same group (less noisy) was: 4.56
all_actions shape just before sample torch.Size([1, 22, 1])
action scaled by temperature: tensor([[254]], device='cuda:0')
action picked by argmax: tensor([19], device='cuda:0')
tensor([[ 19,  36, 119, 178, 254, 267, 239,  31, 270,  21]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
216         1       20       5       217
314         2       20       4        42
634         3       20       5        89
956         4       20       5       138
1316        5       20       3       225
       user_id  item_id  rating  timestep
12535       46       20       5       251
12580       47       20       5        23
12889       48       20       5        59
13188       49       20       4        85
13439       50       20       4        63
average_rating for this rec across 50 users from same group (less noisy) was: 4.56
all_actions shape just before sample torch.Size([1, 23, 1])
action scaled by temperature: tensor([[208]], device='cuda:0')
action picked by argmax: tensor([178], device='cuda:0')
tensor([[178, 119,  31, 267,  62,  40, 120,  19, 226, 106]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
176         1      179       4       177
372         2      179       5       100
551         3      179       5         6
821         4      179       4         3
1183        5      179       4        92
       user_id  item_id  rating  timestep
12511       46      179       4       227
12697       47      179       5       140
12871       48      179       5        41
13208       49      179       5       105
13632       50      179       4       256
average_rating for this rec across 50 users from same group (less noisy) was: 4.48
all_actions shape just before sample torch.Size([1, 24, 1])
action scaled by temperature: tensor([[31]], device='cuda:0')
action picked by argmax: tensor([178], device='cuda:0')
tensor([[178, 119, 267,  19,  36,  31, 226, 239,  69,  40]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
176         1      179       4       177
372         2      179       5       100
551         3      179       5         6
821         4      179       4         3
1183        5      179       4        92
       user_id  item_id  rating  timestep
12511       46      179       4       227
12697       47      179       5       140
12871       48      179       5        41
13208       49      179       5       105
13632       50      179       4       256
average_rating for this rec across 50 users from same group (less noisy) was: 4.48
all_actions shape just before sample torch.Size([1, 25, 1])
action scaled by temperature: tensor([[258]], device='cuda:0')
action picked by argmax: tensor([19], device='cuda:0')
tensor([[ 19, 178, 267, 119,  36,  31,  75, 226,  62, 106]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
216         1       20       5       217
314         2       20       4        42
634         3       20       5        89
956         4       20       5       138
1316        5       20       3       225
       user_id  item_id  rating  timestep
12535       46       20       5       251
12580       47       20       5        23
12889       48       20       5        59
13188       49       20       4        85
13439       50       20       4        63
average_rating for this rec across 50 users from same group (less noisy) was: 4.56
all_actions shape just before sample torch.Size([1, 26, 1])
action scaled by temperature: tensor([[180]], device='cuda:0')
action picked by argmax: tensor([178], device='cuda:0')
tensor([[178, 267, 119, 226,  75,  40,  62, 194,  31,  19]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
176         1      179       4       177
372         2      179       5       100
551         3      179       5         6
821         4      179       4         3
1183        5      179       4        92
       user_id  item_id  rating  timestep
12511       46      179       4       227
12697       47      179       5       140
12871       48      179       5        41
13208       49      179       5       105
13632       50      179       4       256
average_rating for this rec across 50 users from same group (less noisy) was: 4.48
all_actions shape just before sample torch.Size([1, 27, 1])
action scaled by temperature: tensor([[267]], device='cuda:0')
action picked by argmax: tensor([178], device='cuda:0')
tensor([[178, 267,  75, 239, 226, 119,  31,  40,  19,  98]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
176         1      179       4       177
372         2      179       5       100
551         3      179       5         6
821         4      179       4         3
1183        5      179       4        92
       user_id  item_id  rating  timestep
12511       46      179       4       227
12697       47      179       5       140
12871       48      179       5        41
13208       49      179       5       105
13632       50      179       4       256
average_rating for this rec across 50 users from same group (less noisy) was: 4.48
all_actions shape just before sample torch.Size([1, 28, 1])
action scaled by temperature: tensor([[175]], device='cuda:0')
action picked by argmax: tensor([178], device='cuda:0')
tensor([[178, 267, 226, 239,  75, 119,  40,  19,  31,  74]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
176         1      179       4       177
372         2      179       5       100
551         3      179       5         6
821         4      179       4         3
1183        5      179       4        92
       user_id  item_id  rating  timestep
12511       46      179       4       227
12697       47      179       5       140
12871       48      179       5        41
13208       49      179       5       105
13632       50      179       4       256
average_rating for this rec across 50 users from same group (less noisy) was: 4.48
all_actions shape just before sample torch.Size([1, 29, 1])
action scaled by temperature: tensor([[51]], device='cuda:0')
action picked by argmax: tensor([178], device='cuda:0')
tensor([[178, 239, 267,  75, 189,  31, 226,  84,  19, 119]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
176         1      179       4       177
372         2      179       5       100
551         3      179       5         6
821         4      179       4         3
1183        5      179       4        92
       user_id  item_id  rating  timestep
12511       46      179       4       227
12697       47      179       5       140
12871       48      179       5        41
13208       49      179       5       105
13632       50      179       4       256
average_rating for this rec across 50 users from same group (less noisy) was: 4.48
all_actions shape just before sample torch.Size([1, 30, 1])
action scaled by temperature: tensor([[119]], device='cuda:0')
action picked by argmax: tensor([178], device='cuda:0')
tensor([[178, 267,  75,  57, 119, 157, 194, 189, 116,  62]], device='cuda:0')
Just recommended 30 new items to 50 users from group 1 and the total rating was 127.04000000000005
train_loss is: 5.113597835035629
action scaled by temperature: tensor([[186]], device='cuda:0')
action picked by argmax: tensor([10], device='cuda:0')
tensor([[ 10, 231, 205, 180, 119, 260, 183, 147, 144,  75]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
183         1       11       1       184
302         2       11       4        30
616         3       11       3        71
877         4       11       2        59
1096        5       11       3         5
       user_id  item_id  rating  timestep
12340       46       11       2        56
12829       47       11       1       272
12922       48       11       3        92
13155       49       11       2        52
13410       50       11       2        34
average_rating for this rec across 50 users from same group (less noisy) was: 2.2
all_actions shape just before sample torch.Size([1, 1, 1])
action scaled by temperature: tensor([[225]], device='cuda:0')
action picked by argmax: tensor([183], device='cuda:0')
tensor([[183, 267, 205, 263,  47, 160, 119,  83, 268, 144]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
21          1      184       4        22
416         2      184       4       144
817         3      184       4       272
966         4      184       4       148
1239        5      184       4       148
       user_id  item_id  rating  timestep
12555       46      184       4       271
12741       47      184       4       184
12929       48      184       3        99
13232       49      184       2       129
13497       50      184       5       121
average_rating for this rec across 50 users from same group (less noisy) was: 3.9
all_actions shape just before sample torch.Size([1, 2, 1])
action scaled by temperature: tensor([[157]], device='cuda:0')
action picked by argmax: tensor([267], device='cuda:0')
tensor([[267, 205, 231, 119,  39,  90, 268,  83, 183, 160]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
65          1      268       3        66
300         2      268       5        28
748         3      268       2       203
1023        4      268       3       205
1181        5      268       5        90
       user_id  item_id  rating  timestep
12479       46      268       5       195
12730       47      268       5       173
13051       48      268       2       221
13346       49      268       4       243
13556       50      268       3       180
average_rating for this rec across 50 users from same group (less noisy) was: 3.78
all_actions shape just before sample torch.Size([1, 3, 1])
action scaled by temperature: tensor([[220]], device='cuda:0')
action picked by argmax: tensor([267], device='cuda:0')
tensor([[267,  85, 119, 231,   9,  39,  75, 157, 205, 162]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
65          1      268       3        66
300         2      268       5        28
748         3      268       2       203
1023        4      268       3       205
1181        5      268       5        90
       user_id  item_id  rating  timestep
12479       46      268       5       195
12730       47      268       5       173
13051       48      268       2       221
13346       49      268       4       243
13556       50      268       3       180
average_rating for this rec across 50 users from same group (less noisy) was: 3.78
all_actions shape just before sample torch.Size([1, 4, 1])
action scaled by temperature: tensor([[230]], device='cuda:0')
action picked by argmax: tensor([85], device='cuda:0')
tensor([[ 85, 266,  75, 267, 254,  93, 180, 119,   9, 260]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
266         1       86       5       267
509         2       86       5       237
777         3       86       5       232
917         4       86       5        99
1121        5       86       4        30
       user_id  item_id  rating  timestep
12506       46       86       5       222
12600       47       86       5        43
13074       48       86       5       244
13362       49       86       5       259
13397       50       86       5        21
average_rating for this rec across 50 users from same group (less noisy) was: 4.58
all_actions shape just before sample torch.Size([1, 5, 1])
action scaled by temperature: tensor([[230]], device='cuda:0')
action picked by argmax: tensor([219], device='cuda:0')
tensor([[219,  86, 151,  75,  18, 161,  84, 250,  61,  79]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
220         1      220       4       221
495         2      220       5       223
814         3      220       5       269
859         4      220       4        41
1178        5      220       5        87
       user_id  item_id  rating  timestep
12313       46      220       5        29
12606       47      220       4        49
13022       48      220       4       192
13347       49      220       4       244
13521       50      220       5       145
average_rating for this rec across 50 users from same group (less noisy) was: 4.4
all_actions shape just before sample torch.Size([1, 6, 1])
action scaled by temperature: tensor([[218]], device='cuda:0')
action picked by argmax: tensor([75], device='cuda:0')
tensor([[ 75, 219, 151,  18,  86, 161,  29, 152, 126, 250]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
76          1       76       5        77
330         2       76       4        58
571         3       76       3        26
915         4       76       4        97
1167        5       76       4        76
       user_id  item_id  rating  timestep
12440       46       76       3       156
12588       47       76       4        31
12957       48       76       3       127
13325       49       76       5       222
13468       50       76       5        92
average_rating for this rec across 50 users from same group (less noisy) was: 4.04
all_actions shape just before sample torch.Size([1, 7, 1])
action scaled by temperature: tensor([[137]], device='cuda:0')
action picked by argmax: tensor([76], device='cuda:0')
tensor([[ 76,  46, 207, 143, 107,  19,  47, 223, 155,  71]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
243         1       77       5       244
432         2       77       5       160
743         3       77       5       198
835         4       77       4        17
1233        5       77       4       142
       user_id  item_id  rating  timestep
12393       46       77       3       109
12719       47       77       4       162
13098       48       77       5       268
13143       49       77       4        40
13500       50       77       3       124
average_rating for this rec across 50 users from same group (less noisy) was: 3.96
all_actions shape just before sample torch.Size([1, 8, 1])
action scaled by temperature: tensor([[78]], device='cuda:0')
action picked by argmax: tensor([51], device='cuda:0')
tensor([[ 51, 123, 104, 174, 148, 201, 215, 200, 194, 213]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
206         1       52       4       207
379         2       52       4       107
570         3       52       5        25
844         4       52       4        26
1208        5       52       4       117
       user_id  item_id  rating  timestep
12557       46       52       4       273
12712       47       52       5       155
12944       48       52       4       114
13107       49       52       4         4
13387       50       52       4        11
average_rating for this rec across 50 users from same group (less noisy) was: 4.18
all_actions shape just before sample torch.Size([1, 9, 1])
action scaled by temperature: tensor([[102]], device='cuda:0')
action picked by argmax: tensor([51], device='cuda:0')
tensor([[ 51, 123, 148, 126, 215, 104, 194, 103, 174, 191]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
206         1       52       4       207
379         2       52       4       107
570         3       52       5        25
844         4       52       4        26
1208        5       52       4       117
       user_id  item_id  rating  timestep
12557       46       52       4       273
12712       47       52       5       155
12944       48       52       4       114
13107       49       52       4         4
13387       50       52       4        11
average_rating for this rec across 50 users from same group (less noisy) was: 4.18
all_actions shape just before sample torch.Size([1, 10, 1])
action scaled by temperature: tensor([[250]], device='cuda:0')
action picked by argmax: tensor([126], device='cuda:0')
tensor([[126,  19, 148, 107, 191, 252,  28,  23, 103,  83]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
259         1      127       4       260
517         2      127       5       245
774         3      127       5       229
913         4      127       5        95
1260        5      127       5       169
       user_id  item_id  rating  timestep
12492       46      127       4       208
12802       47      127       5       245
12991       48      127       4       161
13261       49      127       5       158
13448       50      127       5        72
average_rating for this rec across 50 users from same group (less noisy) was: 4.66
all_actions shape just before sample torch.Size([1, 11, 1])
action scaled by temperature: tensor([[121]], device='cuda:0')
action picked by argmax: tensor([107], device='cuda:0')
tensor([[107, 140, 246, 121, 238, 122, 209,  84, 167,  53]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
137         1      108       4       138
320         2      108       5        48
555         3      108       5        10
1033        4      108       4       215
1304        5      108       4       213
       user_id  item_id  rating  timestep
12385       46      108       5       101
12814       47      108       4       257
12864       48      108       5        34
13276       49      108       4       173
13592       50      108       5       216
average_rating for this rec across 50 users from same group (less noisy) was: 4.4
all_actions shape just before sample torch.Size([1, 12, 1])
action scaled by temperature: tensor([[238]], device='cuda:0')
action picked by argmax: tensor([107], device='cuda:0')
tensor([[107, 233, 262,  19, 238,  52,  53, 193,  28, 113]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
137         1      108       4       138
320         2      108       5        48
555         3      108       5        10
1033        4      108       4       215
1304        5      108       4       213
       user_id  item_id  rating  timestep
12385       46      108       5       101
12814       47      108       4       257
12864       48      108       5        34
13276       49      108       4       173
13592       50      108       5       216
average_rating for this rec across 50 users from same group (less noisy) was: 4.4
all_actions shape just before sample torch.Size([1, 13, 1])
action scaled by temperature: tensor([[11]], device='cuda:0')
action picked by argmax: tensor([107], device='cuda:0')
tensor([[107, 233,  19,  52, 262,   8,  28, 193, 113, 245]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
137         1      108       4       138
320         2      108       5        48
555         3      108       5        10
1033        4      108       4       215
1304        5      108       4       213
       user_id  item_id  rating  timestep
12385       46      108       5       101
12814       47      108       4       257
12864       48      108       5        34
13276       49      108       4       173
13592       50      108       5       216
average_rating for this rec across 50 users from same group (less noisy) was: 4.4
all_actions shape just before sample torch.Size([1, 14, 1])
action scaled by temperature: tensor([[135]], device='cuda:0')
action picked by argmax: tensor([233], device='cuda:0')
tensor([[233, 107,  52, 262,   8,  82, 113, 244, 193,  28]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
39          1      234       4        40
543         2      234       4       271
707         3      234       4       162
1083        4      234       2       265
1364        5      234       4       273
       user_id  item_id  rating  timestep
12363       46      234       3        79
12812       47      234       5       255
12943       48      234       3       113
13126       49      234       5        23
13420       50      234       4        44
average_rating for this rec across 50 users from same group (less noisy) was: 4.0
all_actions shape just before sample torch.Size([1, 15, 1])
action scaled by temperature: tensor([[64]], device='cuda:0')
action picked by argmax: tensor([130], device='cuda:0')
tensor([[130, 245, 247, 194, 262, 193,  84,  61,  86,   0]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
179         1      131       4       180
394         2      131       4       122
702         3      131       4       157
984         4      131       4       166
1272        5      131       3       181
       user_id  item_id  rating  timestep
12300       46      131       4        16
12775       47      131       5       218
12907       48      131       4        77
13164       49      131       4        61
13528       50      131       4       152
average_rating for this rec across 50 users from same group (less noisy) was: 3.92
all_actions shape just before sample torch.Size([1, 16, 1])
action scaled by temperature: tensor([[21]], device='cuda:0')
action picked by argmax: tensor([194], device='cuda:0')
tensor([[194,  52, 162,  86,   0, 130, 245, 114,  81,  59]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
219         1      195       4       220
461         2      195       3       189
667         3      195       4       122
1047        4      195       5       229
1257        5      195       4       166
       user_id  item_id  rating  timestep
12523       46      195       4       239
12675       47      195       4       118
12965       48      195       4       135
13251       49      195       5       148
13646       50      195       3       270
average_rating for this rec across 50 users from same group (less noisy) was: 3.9
all_actions shape just before sample torch.Size([1, 17, 1])
action scaled by temperature: tensor([[157]], device='cuda:0')
action picked by argmax: tensor([253], device='cuda:0')
tensor([[253, 130, 255,  96, 135, 244, 157, 234, 113, 173]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
102         1      254       3       103
293         2      254       4        21
648         3      254       3       103
987         4      254       4       169
1301        5      254       5       210
       user_id  item_id  rating  timestep
12416       46      254       4       132
12624       47      254       4        67
12971       48      254       4       141
13226       49      254       4       123
13624       50      254       5       248
average_rating for this rec across 50 users from same group (less noisy) was: 4.12
all_actions shape just before sample torch.Size([1, 18, 1])
action scaled by temperature: tensor([[22]], device='cuda:0')
action picked by argmax: tensor([52], device='cuda:0')
tensor([[ 52, 193, 131,  53, 244, 262, 107, 196,  12, 138]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
125         1       53       4       126
456         2       53       5       184
677         3       53       3       132
858         4       53       3        40
1177        5       53       5        86
       user_id  item_id  rating  timestep
12439       46       53       3       155
12677       47       53       4       120
12975       48       53       4       145
13213       49       53       5       110
13474       50       53       3        98
average_rating for this rec across 50 users from same group (less noisy) was: 3.94
all_actions shape just before sample torch.Size([1, 19, 1])
action scaled by temperature: tensor([[83]], device='cuda:0')
action picked by argmax: tensor([120], device='cuda:0')
tensor([[120,  65, 105, 268, 253, 235,  19,  46, 168,  52]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
140         1      121       4       141
340         2      121       4        68
548         3      121       4         3
1028        4      121       4       210
1324        5      121       4       233
       user_id  item_id  rating  timestep
12449       46      121       3       165
12767       47      121       4       210
13025       48      121       4       195
13269       49      121       4       166
13383       50      121       4         7
average_rating for this rec across 50 users from same group (less noisy) was: 4.02
all_actions shape just before sample torch.Size([1, 20, 1])
action scaled by temperature: tensor([[74]], device='cuda:0')
action picked by argmax: tensor([92], device='cuda:0')
tensor([[ 92, 130, 193,  29,   1, 233,  15,  86, 145, 199]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
240         1       93       5       241
512         2       93       5       240
614         3       93       4        69
881         4       93       5        63
1326        5       93       5       235
       user_id  item_id  rating  timestep
12349       46       93       5        65
12787       47       93       5       230
12886       48       93       5        56
13259       49       93       5       156
13386       50       93       4        10
average_rating for this rec across 50 users from same group (less noisy) was: 4.58
all_actions shape just before sample torch.Size([1, 21, 1])
action scaled by temperature: tensor([[54]], device='cuda:0')
action picked by argmax: tensor([92], device='cuda:0')
tensor([[ 92,  15, 130, 193,  29, 201, 199,   7,  91,  61]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
240         1       93       5       241
512         2       93       5       240
614         3       93       4        69
881         4       93       5        63
1326        5       93       5       235
       user_id  item_id  rating  timestep
12349       46       93       5        65
12787       47       93       5       230
12886       48       93       5        56
13259       49       93       5       156
13386       50       93       4        10
average_rating for this rec across 50 users from same group (less noisy) was: 4.58
all_actions shape just before sample torch.Size([1, 22, 1])
action scaled by temperature: tensor([[145]], device='cuda:0')
action picked by argmax: tensor([193], device='cuda:0')
tensor([[193,  92,  15,  29, 130, 199, 201,  61,  86,   7]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
15          1      194       3        16
423         2      194       5       151
569         3      194       2        24
971         4      194       3       153
1099        5      194       5         8
       user_id  item_id  rating  timestep
12512       46      194       4       228
12663       47      194       3       106
13083       48      194       3       253
13117       49      194       3        14
13489       50      194       2       113
average_rating for this rec across 50 users from same group (less noisy) was: 3.58
all_actions shape just before sample torch.Size([1, 23, 1])
action scaled by temperature: tensor([[219]], device='cuda:0')
action picked by argmax: tensor([15], device='cuda:0')
tensor([[ 15, 193, 130,  29,  92, 199,  91,   1,   7,  61]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
152         1       16       4       153
280         2       16       4         8
592         3       16       5        47
840         4       16       4        22
1318        5       16       4       227
       user_id  item_id  rating  timestep
12368       46       16       4        84
12646       47       16       4        89
13001       48       16       4       171
13274       49       16       5       171
13435       50       16       3        59
average_rating for this rec across 50 users from same group (less noisy) was: 4.12
all_actions shape just before sample torch.Size([1, 24, 1])
action scaled by temperature: tensor([[185]], device='cuda:0')
action picked by argmax: tensor([14], device='cuda:0')
tensor([[ 14, 215, 127,  52,  76,  96, 160, 225, 194,  10]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
245         1       15       5       246
419         2       15       5       147
685         3       15       5       140
880         4       15       5        62
1234        5       15       3       143
       user_id  item_id  rating  timestep
12325       46       15       4        41
12584       47       15       5        27
13102       48       15       2       272
13313       49       15       5       210
13413       50       15       3        37
average_rating for this rec across 50 users from same group (less noisy) was: 3.8
all_actions shape just before sample torch.Size([1, 25, 1])
action scaled by temperature: tensor([[99]], device='cuda:0')
action picked by argmax: tensor([14], device='cuda:0')
tensor([[ 14, 215,  76, 225, 127, 160,  96, 149, 194,  52]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
245         1       15       5       246
419         2       15       5       147
685         3       15       5       140
880         4       15       5        62
1234        5       15       3       143
       user_id  item_id  rating  timestep
12325       46       15       4        41
12584       47       15       5        27
13102       48       15       2       272
13313       49       15       5       210
13413       50       15       3        37
average_rating for this rec across 50 users from same group (less noisy) was: 3.8
all_actions shape just before sample torch.Size([1, 26, 1])
action scaled by temperature: tensor([[100]], device='cuda:0')
action picked by argmax: tensor([14], device='cuda:0')
tensor([[ 14, 225, 215, 127,  76,  96, 160, 149,  10,  22]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
245         1       15       5       246
419         2       15       5       147
685         3       15       5       140
880         4       15       5        62
1234        5       15       3       143
       user_id  item_id  rating  timestep
12325       46       15       4        41
12584       47       15       5        27
13102       48       15       2       272
13313       49       15       5       210
13413       50       15       3        37
average_rating for this rec across 50 users from same group (less noisy) was: 3.8
all_actions shape just before sample torch.Size([1, 27, 1])
action scaled by temperature: tensor([[160]], device='cuda:0')
action picked by argmax: tensor([14], device='cuda:0')
tensor([[ 14, 215, 225, 127,  76,  96,  10,  22, 160,  52]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
245         1       15       5       246
419         2       15       5       147
685         3       15       5       140
880         4       15       5        62
1234        5       15       3       143
       user_id  item_id  rating  timestep
12325       46       15       4        41
12584       47       15       5        27
13102       48       15       2       272
13313       49       15       5       210
13413       50       15       3        37
average_rating for this rec across 50 users from same group (less noisy) was: 3.8
all_actions shape just before sample torch.Size([1, 28, 1])
action scaled by temperature: tensor([[159]], device='cuda:0')
action picked by argmax: tensor([14], device='cuda:0')
tensor([[ 14, 225, 215,  10, 127,  96, 152,  76,  22, 257]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
245         1       15       5       246
419         2       15       5       147
685         3       15       5       140
880         4       15       5        62
1234        5       15       3       143
       user_id  item_id  rating  timestep
12325       46       15       4        41
12584       47       15       5        27
13102       48       15       2       272
13313       49       15       5       210
13413       50       15       3        37
average_rating for this rec across 50 users from same group (less noisy) was: 3.8
all_actions shape just before sample torch.Size([1, 29, 1])
action scaled by temperature: tensor([[62]], device='cuda:0')
action picked by argmax: tensor([14], device='cuda:0')
tensor([[ 14, 215, 225, 127,  76,  96,  10, 152, 257,  64]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
245         1       15       5       246
419         2       15       5       147
685         3       15       5       140
880         4       15       5        62
1234        5       15       3       143
       user_id  item_id  rating  timestep
12325       46       15       4        41
12584       47       15       5        27
13102       48       15       2       272
13313       49       15       5       210
13413       50       15       3        37
average_rating for this rec across 50 users from same group (less noisy) was: 3.8
all_actions shape just before sample torch.Size([1, 30, 1])
action scaled by temperature: tensor([[196]], device='cuda:0')
action picked by argmax: tensor([14], device='cuda:0')
tensor([[ 14, 215, 127,  76, 225,  10, 260,  96, 257, 152]], device='cuda:0')
Just recommended 30 new items to 50 users from group 1 and the total rating was 120.41999999999997
train_loss is: 4.9234972043668845
action scaled by temperature: tensor([[35]], device='cuda:0')
action picked by argmax: tensor([231], device='cuda:0')
tensor([[231, 180, 247, 196,  38, 205,  30, 260,  10, 194]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
250         1      232       4       251
469         2      232       4       197
557         3      232       4        12
922         4      232       5       104
1265        5      232       5       174
       user_id  item_id  rating  timestep
12299       46      232       5        15
12815       47      232       3       258
12865       48      232       4        35
13142       49      232       5        39
13469       50      232       3        93
average_rating for this rec across 50 users from same group (less noisy) was: 4.38
all_actions shape just before sample torch.Size([1, 1, 1])
action scaled by temperature: tensor([[167]], device='cuda:0')
action picked by argmax: tensor([247], device='cuda:0')
tensor([[247, 180, 231, 196, 240, 205,  38, 119,  54, 267]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
182         1      248       4       183
295         2      248       5        23
739         3      248       5       194
853         4      248       4        35
1345        5      248       4       254
       user_id  item_id  rating  timestep
12548       46      248       5       264
12573       47      248       5        16
12837       48      248       4         7
13252       49      248       4       149
13495       50      248       5       119
average_rating for this rec across 50 users from same group (less noisy) was: 4.46
all_actions shape just before sample torch.Size([1, 2, 1])
action scaled by temperature: tensor([[45]], device='cuda:0')
action picked by argmax: tensor([247], device='cuda:0')
tensor([[247, 180, 231, 196, 240, 119, 205,  38, 101, 267]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
182         1      248       4       183
295         2      248       5        23
739         3      248       5       194
853         4      248       4        35
1345        5      248       4       254
       user_id  item_id  rating  timestep
12548       46      248       5       264
12573       47      248       5        16
12837       48      248       4         7
13252       49      248       4       149
13495       50      248       5       119
average_rating for this rec across 50 users from same group (less noisy) was: 4.46
all_actions shape just before sample torch.Size([1, 3, 1])
action scaled by temperature: tensor([[7]], device='cuda:0')
action picked by argmax: tensor([247], device='cuda:0')
tensor([[247, 180, 231, 196, 240, 119, 267, 178, 219,  38]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
182         1      248       4       183
295         2      248       5        23
739         3      248       5       194
853         4      248       4        35
1345        5      248       4       254
       user_id  item_id  rating  timestep
12548       46      248       5       264
12573       47      248       5        16
12837       48      248       4         7
13252       49      248       4       149
13495       50      248       5       119
average_rating for this rec across 50 users from same group (less noisy) was: 4.46
all_actions shape just before sample torch.Size([1, 4, 1])
action scaled by temperature: tensor([[80]], device='cuda:0')
action picked by argmax: tensor([247], device='cuda:0')
tensor([[247, 180, 231, 196, 240, 119, 178,  38, 205, 101]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
182         1      248       4       183
295         2      248       5        23
739         3      248       5       194
853         4      248       4        35
1345        5      248       4       254
       user_id  item_id  rating  timestep
12548       46      248       5       264
12573       47      248       5        16
12837       48      248       4         7
13252       49      248       4       149
13495       50      248       5       119
average_rating for this rec across 50 users from same group (less noisy) was: 4.46
all_actions shape just before sample torch.Size([1, 5, 1])
action scaled by temperature: tensor([[133]], device='cuda:0')
action picked by argmax: tensor([247], device='cuda:0')
tensor([[247, 180, 231, 196, 240, 119, 267, 178, 101,  38]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
182         1      248       4       183
295         2      248       5        23
739         3      248       5       194
853         4      248       4        35
1345        5      248       4       254
       user_id  item_id  rating  timestep
12548       46      248       5       264
12573       47      248       5        16
12837       48      248       4         7
13252       49      248       4       149
13495       50      248       5       119
average_rating for this rec across 50 users from same group (less noisy) was: 4.46
all_actions shape just before sample torch.Size([1, 6, 1])
action scaled by temperature: tensor([[40]], device='cuda:0')
action picked by argmax: tensor([247], device='cuda:0')
tensor([[247, 180, 231, 240, 196, 178, 119, 101,  38, 267]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
182         1      248       4       183
295         2      248       5        23
739         3      248       5       194
853         4      248       4        35
1345        5      248       4       254
       user_id  item_id  rating  timestep
12548       46      248       5       264
12573       47      248       5        16
12837       48      248       4         7
13252       49      248       4       149
13495       50      248       5       119
average_rating for this rec across 50 users from same group (less noisy) was: 4.46
all_actions shape just before sample torch.Size([1, 7, 1])
action scaled by temperature: tensor([[46]], device='cuda:0')
action picked by argmax: tensor([247], device='cuda:0')
tensor([[247, 180, 231, 196, 240, 119, 178, 101, 219, 114]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
182         1      248       4       183
295         2      248       5        23
739         3      248       5       194
853         4      248       4        35
1345        5      248       4       254
       user_id  item_id  rating  timestep
12548       46      248       5       264
12573       47      248       5        16
12837       48      248       4         7
13252       49      248       4       149
13495       50      248       5       119
average_rating for this rec across 50 users from same group (less noisy) was: 4.46
all_actions shape just before sample torch.Size([1, 8, 1])
action scaled by temperature: tensor([[212]], device='cuda:0')
action picked by argmax: tensor([247], device='cuda:0')
tensor([[247, 180, 231, 196, 240, 119, 178, 101, 219, 114]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
182         1      248       4       183
295         2      248       5        23
739         3      248       5       194
853         4      248       4        35
1345        5      248       4       254
       user_id  item_id  rating  timestep
12548       46      248       5       264
12573       47      248       5        16
12837       48      248       4         7
13252       49      248       4       149
13495       50      248       5       119
average_rating for this rec across 50 users from same group (less noisy) was: 4.46
all_actions shape just before sample torch.Size([1, 9, 1])
action scaled by temperature: tensor([[205]], device='cuda:0')
action picked by argmax: tensor([247], device='cuda:0')
tensor([[247, 180, 231, 196, 240, 178, 119, 101, 114, 267]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
182         1      248       4       183
295         2      248       5        23
739         3      248       5       194
853         4      248       4        35
1345        5      248       4       254
       user_id  item_id  rating  timestep
12548       46      248       5       264
12573       47      248       5        16
12837       48      248       4         7
13252       49      248       4       149
13495       50      248       5       119
average_rating for this rec across 50 users from same group (less noisy) was: 4.46
all_actions shape just before sample torch.Size([1, 10, 1])
action scaled by temperature: tensor([[198]], device='cuda:0')
action picked by argmax: tensor([247], device='cuda:0')
tensor([[247, 180, 231, 196, 240, 178, 119, 101, 114, 219]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
182         1      248       4       183
295         2      248       5        23
739         3      248       5       194
853         4      248       4        35
1345        5      248       4       254
       user_id  item_id  rating  timestep
12548       46      248       5       264
12573       47      248       5        16
12837       48      248       4         7
13252       49      248       4       149
13495       50      248       5       119
average_rating for this rec across 50 users from same group (less noisy) was: 4.46
all_actions shape just before sample torch.Size([1, 11, 1])
action scaled by temperature: tensor([[129]], device='cuda:0')
action picked by argmax: tensor([247], device='cuda:0')
tensor([[247, 231, 180, 178, 196, 240, 119, 101, 114, 157]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
182         1      248       4       183
295         2      248       5        23
739         3      248       5       194
853         4      248       4        35
1345        5      248       4       254
       user_id  item_id  rating  timestep
12548       46      248       5       264
12573       47      248       5        16
12837       48      248       4         7
13252       49      248       4       149
13495       50      248       5       119
average_rating for this rec across 50 users from same group (less noisy) was: 4.46
all_actions shape just before sample torch.Size([1, 12, 1])
action scaled by temperature: tensor([[71]], device='cuda:0')
action picked by argmax: tensor([247], device='cuda:0')
tensor([[247, 231, 180, 178, 196, 240, 119, 101, 114, 157]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
182         1      248       4       183
295         2      248       5        23
739         3      248       5       194
853         4      248       4        35
1345        5      248       4       254
       user_id  item_id  rating  timestep
12548       46      248       5       264
12573       47      248       5        16
12837       48      248       4         7
13252       49      248       4       149
13495       50      248       5       119
average_rating for this rec across 50 users from same group (less noisy) was: 4.46
all_actions shape just before sample torch.Size([1, 13, 1])
action scaled by temperature: tensor([[159]], device='cuda:0')
action picked by argmax: tensor([247], device='cuda:0')
tensor([[247, 231, 180, 178, 196, 101, 240, 119, 114, 157]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
182         1      248       4       183
295         2      248       5        23
739         3      248       5       194
853         4      248       4        35
1345        5      248       4       254
       user_id  item_id  rating  timestep
12548       46      248       5       264
12573       47      248       5        16
12837       48      248       4         7
13252       49      248       4       149
13495       50      248       5       119
average_rating for this rec across 50 users from same group (less noisy) was: 4.46
all_actions shape just before sample torch.Size([1, 14, 1])
action scaled by temperature: tensor([[201]], device='cuda:0')
action picked by argmax: tensor([247], device='cuda:0')
tensor([[247, 231, 178, 180, 196, 240, 101, 119, 157, 114]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
182         1      248       4       183
295         2      248       5        23
739         3      248       5       194
853         4      248       4        35
1345        5      248       4       254
       user_id  item_id  rating  timestep
12548       46      248       5       264
12573       47      248       5        16
12837       48      248       4         7
13252       49      248       4       149
13495       50      248       5       119
average_rating for this rec across 50 users from same group (less noisy) was: 4.46
all_actions shape just before sample torch.Size([1, 15, 1])
action scaled by temperature: tensor([[235]], device='cuda:0')
action picked by argmax: tensor([247], device='cuda:0')
tensor([[247, 178, 231, 180, 101, 119, 196, 157, 235, 240]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
182         1      248       4       183
295         2      248       5        23
739         3      248       5       194
853         4      248       4        35
1345        5      248       4       254
       user_id  item_id  rating  timestep
12548       46      248       5       264
12573       47      248       5        16
12837       48      248       4         7
13252       49      248       4       149
13495       50      248       5       119
average_rating for this rec across 50 users from same group (less noisy) was: 4.46
all_actions shape just before sample torch.Size([1, 16, 1])
action scaled by temperature: tensor([[48]], device='cuda:0')
action picked by argmax: tensor([235], device='cuda:0')
tensor([[235, 178, 247,  48, 101, 157, 231, 102, 119, 196]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
57          1      236       5        58
392         2      236       4       120
770         3      236       4       225
825         4      236       5         7
1151        5      236       4        60
       user_id  item_id  rating  timestep
12321       46      236       3        37
12669       47      236       5       112
12940       48      236       3       110
13113       49      236       4        10
13638       50      236       3       262
average_rating for this rec across 50 users from same group (less noisy) was: 4.26
all_actions shape just before sample torch.Size([1, 17, 1])
action scaled by temperature: tensor([[77]], device='cuda:0')
action picked by argmax: tensor([35], device='cuda:0')
tensor([[ 35, 207,  46, 111,  87, 155,  34, 187,  45,  83]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
155         1       36       4       156
356         2       36       4        84
651         3       36       5       106
923         4       36       5       105
1293        5       36       4       202
       user_id  item_id  rating  timestep
12444       46       36       5       160
12705       47       36       5       148
13096       48       36       5       266
13242       49       36       4       139
13488       50       36       4       112
average_rating for this rec across 50 users from same group (less noisy) was: 4.46
all_actions shape just before sample torch.Size([1, 18, 1])
action scaled by temperature: tensor([[48]], device='cuda:0')
action picked by argmax: tensor([146], device='cuda:0')
tensor([[146, 136, 187,  35,  37,  87,  42,  99, 268, 137]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
97          1      147       4        98
492         2      147       4       220
612         3      147       4        67
897         4      147       3        79
1350        5      147       5       259
       user_id  item_id  rating  timestep
12336       46      147       5        52
12647       47      147       4        90
12962       48      147       4       132
13367       49      147       4       264
13443       50      147       5        67
average_rating for this rec across 50 users from same group (less noisy) was: 4.24
all_actions shape just before sample torch.Size([1, 19, 1])
action scaled by temperature: tensor([[251]], device='cuda:0')
action picked by argmax: tensor([22], device='cuda:0')
tensor([[ 22, 184,  42,  76, 252, 113, 237,  35, 163,  41]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
190         1       23       4       191
420         2       23       3       148
642         3       23       4        97
900         4       23       3        82
1125        5       23       5        34
       user_id  item_id  rating  timestep
12326       46       23       3        42
12754       47       23       5       197
13092       48       23       5       262
13190       49       23       2        87
13481       50       23       4       105
average_rating for this rec across 50 users from same group (less noisy) was: 3.82
all_actions shape just before sample torch.Size([1, 20, 1])
action scaled by temperature: tensor([[262]], device='cuda:0')
action picked by argmax: tensor([41], device='cuda:0')
tensor([[ 41,  22,  42,  46,  76, 155,  24,  87, 187, 163]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
112         1       42       5       113
421         2       42       5       149
786         3       42       4       241
887         4       42       5        69
1307        5       42       4       216
       user_id  item_id  rating  timestep
12392       46       42       4       108
12660       47       42       5       103
13038       48       42       5       208
13134       49       42       5        31
13377       50       42       5         1
average_rating for this rec across 50 users from same group (less noisy) was: 4.74
all_actions shape just before sample torch.Size([1, 21, 1])
action scaled by temperature: tensor([[235]], device='cuda:0')
action picked by argmax: tensor([41], device='cuda:0')
tensor([[ 41, 235,  50, 197,  66, 185, 157,  37, 202, 264]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
112         1       42       5       113
421         2       42       5       149
786         3       42       4       241
887         4       42       5        69
1307        5       42       4       216
       user_id  item_id  rating  timestep
12392       46       42       4       108
12660       47       42       5       103
13038       48       42       5       208
13134       49       42       5        31
13377       50       42       5         1
average_rating for this rec across 50 users from same group (less noisy) was: 4.74
all_actions shape just before sample torch.Size([1, 22, 1])
action scaled by temperature: tensor([[185]], device='cuda:0')
action picked by argmax: tensor([41], device='cuda:0')
tensor([[ 41, 235,  50, 157,  95, 197, 185, 202,  37, 264]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
112         1       42       5       113
421         2       42       5       149
786         3       42       4       241
887         4       42       5        69
1307        5       42       4       216
       user_id  item_id  rating  timestep
12392       46       42       4       108
12660       47       42       5       103
13038       48       42       5       208
13134       49       42       5        31
13377       50       42       5         1
average_rating for this rec across 50 users from same group (less noisy) was: 4.74
all_actions shape just before sample torch.Size([1, 23, 1])
action scaled by temperature: tensor([[229]], device='cuda:0')
action picked by argmax: tensor([41], device='cuda:0')
tensor([[ 41, 235,  95, 197, 157, 231,  28, 264, 185,  50]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
112         1       42       5       113
421         2       42       5       149
786         3       42       4       241
887         4       42       5        69
1307        5       42       4       216
       user_id  item_id  rating  timestep
12392       46       42       4       108
12660       47       42       5       103
13038       48       42       5       208
13134       49       42       5        31
13377       50       42       5         1
average_rating for this rec across 50 users from same group (less noisy) was: 4.74
all_actions shape just before sample torch.Size([1, 24, 1])
action scaled by temperature: tensor([[0]], device='cuda:0')
action picked by argmax: tensor([235], device='cuda:0')
tensor([[235,  95, 231, 157,  41, 197,  28, 244,  55,  10]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
57          1      236       5        58
392         2      236       4       120
770         3      236       4       225
825         4      236       5         7
1151        5      236       4        60
       user_id  item_id  rating  timestep
12321       46      236       3        37
12669       47      236       5       112
12940       48      236       3       110
13113       49      236       4        10
13638       50      236       3       262
average_rating for this rec across 50 users from same group (less noisy) was: 4.26
all_actions shape just before sample torch.Size([1, 25, 1])
action scaled by temperature: tensor([[244]], device='cuda:0')
action picked by argmax: tensor([95], device='cuda:0')
tensor([[ 95,  28, 197, 157,  55, 244,  81, 235, 267, 111]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
167         1       96       3       168
352         2       96       3        80
654         3       96       5       109
879         4       96       3        61
1136        5       96       3        45
       user_id  item_id  rating  timestep
12407       46       96       3       123
12748       47       96       4       191
12851       48       96       4        21
13222       49       96       5       119
13437       50       96       4        61
average_rating for this rec across 50 users from same group (less noisy) was: 3.9
all_actions shape just before sample torch.Size([1, 26, 1])
action scaled by temperature: tensor([[205]], device='cuda:0')
action picked by argmax: tensor([95], device='cuda:0')
tensor([[ 95,  28,  55, 244, 197, 157, 235, 167,  81, 102]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
167         1       96       3       168
352         2       96       3        80
654         3       96       5       109
879         4       96       3        61
1136        5       96       3        45
       user_id  item_id  rating  timestep
12407       46       96       3       123
12748       47       96       4       191
12851       48       96       4        21
13222       49       96       5       119
13437       50       96       4        61
average_rating for this rec across 50 users from same group (less noisy) was: 3.9
all_actions shape just before sample torch.Size([1, 27, 1])
action scaled by temperature: tensor([[120]], device='cuda:0')
action picked by argmax: tensor([95], device='cuda:0')
tensor([[ 95,  28,  55, 197, 235, 244, 167,  81, 231, 157]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
167         1       96       3       168
352         2       96       3        80
654         3       96       5       109
879         4       96       3        61
1136        5       96       3        45
       user_id  item_id  rating  timestep
12407       46       96       3       123
12748       47       96       4       191
12851       48       96       4        21
13222       49       96       5       119
13437       50       96       4        61
average_rating for this rec across 50 users from same group (less noisy) was: 3.9
all_actions shape just before sample torch.Size([1, 28, 1])
action scaled by temperature: tensor([[187]], device='cuda:0')
action picked by argmax: tensor([95], device='cuda:0')
tensor([[ 95,  28,  55, 197, 244, 235,  81, 157, 167, 231]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
167         1       96       3       168
352         2       96       3        80
654         3       96       5       109
879         4       96       3        61
1136        5       96       3        45
       user_id  item_id  rating  timestep
12407       46       96       3       123
12748       47       96       4       191
12851       48       96       4        21
13222       49       96       5       119
13437       50       96       4        61
average_rating for this rec across 50 users from same group (less noisy) was: 3.9
all_actions shape just before sample torch.Size([1, 29, 1])
action scaled by temperature: tensor([[107]], device='cuda:0')
action picked by argmax: tensor([55], device='cuda:0')
tensor([[ 55,  28, 197,  95, 244, 167, 102, 235, 231,  81]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
17          1       56       4        18
500         2       56       4       228
617         3       56       3        72
1080        4       56       4       262
1108        5       56       5        17
       user_id  item_id  rating  timestep
12459       46       56       5       175
12782       47       56       4       225
13071       48       56       4       241
13174       49       56       3        71
13516       50       56       5       140
average_rating for this rec across 50 users from same group (less noisy) was: 4.14
all_actions shape just before sample torch.Size([1, 30, 1])
action scaled by temperature: tensor([[74]], device='cuda:0')
action picked by argmax: tensor([84], device='cuda:0')
tensor([[ 84,  74,  15, 149, 160, 180,  65,  29, 139,  99]], device='cuda:0')
Just recommended 30 new items to 50 users from group 1 and the total rating was 131.01999999999998
train_loss is: 4.438720459263075
action scaled by temperature: tensor([[245]], device='cuda:0')
action picked by argmax: tensor([38], device='cuda:0')
tensor([[ 38, 180, 212,  47, 196, 214,  43, 218, 149,  97]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
264         1       39       3       265
276         2       39       3         4
670         3       39       2       125
899         4       39       3        81
1171        5       39       4        80
       user_id  item_id  rating  timestep
12532       46       39       3       248
12562       47       39       3         5
13086       48       39       2       256
13210       49       39       3       107
13467       50       39       3        91
average_rating for this rec across 50 users from same group (less noisy) was: 3.04
all_actions shape just before sample torch.Size([1, 1, 1])
action scaled by temperature: tensor([[29]], device='cuda:0')
action picked by argmax: tensor([38], device='cuda:0')
tensor([[ 38, 268, 168,  24,  39,  74, 221,  41,  63, 102]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
264         1       39       3       265
276         2       39       3         4
670         3       39       2       125
899         4       39       3        81
1171        5       39       4        80
       user_id  item_id  rating  timestep
12532       46       39       3       248
12562       47       39       3         5
13086       48       39       2       256
13210       49       39       3       107
13467       50       39       3        91
average_rating for this rec across 50 users from same group (less noisy) was: 3.04
all_actions shape just before sample torch.Size([1, 2, 1])
action scaled by temperature: tensor([[76]], device='cuda:0')
action picked by argmax: tensor([38], device='cuda:0')
tensor([[ 38, 268, 168,  41,  24,  39, 221,  37,  63, 132]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
264         1       39       3       265
276         2       39       3         4
670         3       39       2       125
899         4       39       3        81
1171        5       39       4        80
       user_id  item_id  rating  timestep
12532       46       39       3       248
12562       47       39       3         5
13086       48       39       2       256
13210       49       39       3       107
13467       50       39       3        91
average_rating for this rec across 50 users from same group (less noisy) was: 3.04
all_actions shape just before sample torch.Size([1, 3, 1])
action scaled by temperature: tensor([[39]], device='cuda:0')
action picked by argmax: tensor([268], device='cuda:0')
tensor([[268,  38, 168,  22,  63,  24,  41,  89,  39,  37]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
146         1      269       5       147
338         2      269       4        66
695         3      269       5       150
1049        4      269       5       231
1295        5      269       4       204
       user_id  item_id  rating  timestep
12474       46      269       4       190
12685       47      269       5       128
13091       48      269       4       261
13338       49      269       4       235
13558       50      269       5       182
average_rating for this rec across 50 users from same group (less noisy) was: 4.12
all_actions shape just before sample torch.Size([1, 4, 1])
action scaled by temperature: tensor([[236]], device='cuda:0')
action picked by argmax: tensor([168], device='cuda:0')
tensor([[168, 102, 254,  19,  41, 105,  89, 176, 268,  75]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
119         1      169       5       120
483         2      169       5       211
559         3      169       5        14
886         4      169       5        68
1273        5      169       4       182
       user_id  item_id  rating  timestep
12488       46      169       4       204
12558       47      169       5         1
13080       48      169       4       250
13150       49      169       4        47
13492       50      169       4       116
average_rating for this rec across 50 users from same group (less noisy) was: 4.72
all_actions shape just before sample torch.Size([1, 5, 1])
action scaled by temperature: tensor([[56]], device='cuda:0')
action picked by argmax: tensor([2], device='cuda:0')
tensor([[  2,  62,  77, 104, 119,  22, 112,  24, 172, 235]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
49          1        3       5        50
449         2        3       5       177
615         3        3       5        70
1079        4        3       4       261
1268        5        3       5       177
       user_id  item_id  rating  timestep
12381       46        3       4        97
12621       47        3       5        64
13073       48        3       5       243
13160       49        3       4        57
13549       50        3       5       173
average_rating for this rec across 50 users from same group (less noisy) was: 4.72
all_actions shape just before sample torch.Size([1, 6, 1])
action scaled by temperature: tensor([[15]], device='cuda:0')
action picked by argmax: tensor([2], device='cuda:0')
tensor([[  2,  62,  22,  49, 123, 124, 119, 172,  77, 112]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
49          1        3       5        50
449         2        3       5       177
615         3        3       5        70
1079        4        3       4       261
1268        5        3       5       177
       user_id  item_id  rating  timestep
12381       46        3       4        97
12621       47        3       5        64
13073       48        3       5       243
13160       49        3       4        57
13549       50        3       5       173
average_rating for this rec across 50 users from same group (less noisy) was: 4.72
all_actions shape just before sample torch.Size([1, 7, 1])
action scaled by temperature: tensor([[121]], device='cuda:0')
action picked by argmax: tensor([2], device='cuda:0')
tensor([[  2, 124,  49,  62,  43, 172, 251,  22, 112, 123]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
49          1        3       5        50
449         2        3       5       177
615         3        3       5        70
1079        4        3       4       261
1268        5        3       5       177
       user_id  item_id  rating  timestep
12381       46        3       4        97
12621       47        3       5        64
13073       48        3       5       243
13160       49        3       4        57
13549       50        3       5       173
average_rating for this rec across 50 users from same group (less noisy) was: 4.72
all_actions shape just before sample torch.Size([1, 8, 1])
action scaled by temperature: tensor([[176]], device='cuda:0')
action picked by argmax: tensor([2], device='cuda:0')
tensor([[  2,  49, 124, 251,  43, 236,  62, 202, 135,  79]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
49          1        3       5        50
449         2        3       5       177
615         3        3       5        70
1079        4        3       4       261
1268        5        3       5       177
       user_id  item_id  rating  timestep
12381       46        3       4        97
12621       47        3       5        64
13073       48        3       5       243
13160       49        3       4        57
13549       50        3       5       173
average_rating for this rec across 50 users from same group (less noisy) was: 4.72
all_actions shape just before sample torch.Size([1, 9, 1])
action scaled by temperature: tensor([[2]], device='cuda:0')
action picked by argmax: tensor([2], device='cuda:0')
tensor([[  2, 124,  49, 251,  43, 236, 135,  25,  62, 172]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
49          1        3       5        50
449         2        3       5       177
615         3        3       5        70
1079        4        3       4       261
1268        5        3       5       177
       user_id  item_id  rating  timestep
12381       46        3       4        97
12621       47        3       5        64
13073       48        3       5       243
13160       49        3       4        57
13549       50        3       5       173
average_rating for this rec across 50 users from same group (less noisy) was: 4.72
all_actions shape just before sample torch.Size([1, 10, 1])
action scaled by temperature: tensor([[102]], device='cuda:0')
action picked by argmax: tensor([2], device='cuda:0')
tensor([[  2, 124, 251,  43, 236,  49,  25, 135,  62,  23]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
49          1        3       5        50
449         2        3       5       177
615         3        3       5        70
1079        4        3       4       261
1268        5        3       5       177
       user_id  item_id  rating  timestep
12381       46        3       4        97
12621       47        3       5        64
13073       48        3       5       243
13160       49        3       4        57
13549       50        3       5       173
average_rating for this rec across 50 users from same group (less noisy) was: 4.72
all_actions shape just before sample torch.Size([1, 11, 1])
action scaled by temperature: tensor([[89]], device='cuda:0')
action picked by argmax: tensor([2], device='cuda:0')
tensor([[  2, 124, 251, 236,  43,  23,  95, 135,  25,  62]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
49          1        3       5        50
449         2        3       5       177
615         3        3       5        70
1079        4        3       4       261
1268        5        3       5       177
       user_id  item_id  rating  timestep
12381       46        3       4        97
12621       47        3       5        64
13073       48        3       5       243
13160       49        3       4        57
13549       50        3       5       173
average_rating for this rec across 50 users from same group (less noisy) was: 4.72
all_actions shape just before sample torch.Size([1, 12, 1])
action scaled by temperature: tensor([[235]], device='cuda:0')
action picked by argmax: tensor([2], device='cuda:0')
tensor([[  2, 124, 251, 236,  43,  23,  95,  25,  49,   5]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
49          1        3       5        50
449         2        3       5       177
615         3        3       5        70
1079        4        3       4       261
1268        5        3       5       177
       user_id  item_id  rating  timestep
12381       46        3       4        97
12621       47        3       5        64
13073       48        3       5       243
13160       49        3       4        57
13549       50        3       5       173
average_rating for this rec across 50 users from same group (less noisy) was: 4.72
all_actions shape just before sample torch.Size([1, 13, 1])
action scaled by temperature: tensor([[62]], device='cuda:0')
action picked by argmax: tensor([2], device='cuda:0')
tensor([[  2, 124, 251, 236,  95,  23,  97,  80,   5, 111]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
49          1        3       5        50
449         2        3       5       177
615         3        3       5        70
1079        4        3       4       261
1268        5        3       5       177
       user_id  item_id  rating  timestep
12381       46        3       4        97
12621       47        3       5        64
13073       48        3       5       243
13160       49        3       4        57
13549       50        3       5       173
average_rating for this rec across 50 users from same group (less noisy) was: 4.72
all_actions shape just before sample torch.Size([1, 14, 1])
action scaled by temperature: tensor([[124]], device='cuda:0')
action picked by argmax: tensor([2], device='cuda:0')
tensor([[  2, 124,  95, 251,  23, 236,  97,  80, 111,  51]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
49          1        3       5        50
449         2        3       5       177
615         3        3       5        70
1079        4        3       4       261
1268        5        3       5       177
       user_id  item_id  rating  timestep
12381       46        3       4        97
12621       47        3       5        64
13073       48        3       5       243
13160       49        3       4        57
13549       50        3       5       173
average_rating for this rec across 50 users from same group (less noisy) was: 4.72
all_actions shape just before sample torch.Size([1, 15, 1])
action scaled by temperature: tensor([[23]], device='cuda:0')
action picked by argmax: tensor([2], device='cuda:0')
tensor([[  2,  95, 124,  23, 236,  97,  51, 251,  80, 111]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
49          1        3       5        50
449         2        3       5       177
615         3        3       5        70
1079        4        3       4       261
1268        5        3       5       177
       user_id  item_id  rating  timestep
12381       46        3       4        97
12621       47        3       5        64
13073       48        3       5       243
13160       49        3       4        57
13549       50        3       5       173
average_rating for this rec across 50 users from same group (less noisy) was: 4.72
all_actions shape just before sample torch.Size([1, 16, 1])
action scaled by temperature: tensor([[55]], device='cuda:0')
action picked by argmax: tensor([2], device='cuda:0')
tensor([[  2,  95, 251,  97,  80, 111,  51, 124, 236,  23]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
49          1        3       5        50
449         2        3       5       177
615         3        3       5        70
1079        4        3       4       261
1268        5        3       5       177
       user_id  item_id  rating  timestep
12381       46        3       4        97
12621       47        3       5        64
13073       48        3       5       243
13160       49        3       4        57
13549       50        3       5       173
average_rating for this rec across 50 users from same group (less noisy) was: 4.72
all_actions shape just before sample torch.Size([1, 17, 1])
action scaled by temperature: tensor([[251]], device='cuda:0')
action picked by argmax: tensor([2], device='cuda:0')
tensor([[  2,  97,  51, 111,  95,  23, 124,  80, 236, 251]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
49          1        3       5        50
449         2        3       5       177
615         3        3       5        70
1079        4        3       4       261
1268        5        3       5       177
       user_id  item_id  rating  timestep
12381       46        3       4        97
12621       47        3       5        64
13073       48        3       5       243
13160       49        3       4        57
13549       50        3       5       173
average_rating for this rec across 50 users from same group (less noisy) was: 4.72
all_actions shape just before sample torch.Size([1, 18, 1])
action scaled by temperature: tensor([[111]], device='cuda:0')
action picked by argmax: tensor([51], device='cuda:0')
tensor([[ 51, 111,  97,   2,  95,  23, 112,  80, 236, 124]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
206         1       52       4       207
379         2       52       4       107
570         3       52       5        25
844         4       52       4        26
1208        5       52       4       117
       user_id  item_id  rating  timestep
12557       46       52       4       273
12712       47       52       5       155
12944       48       52       4       114
13107       49       52       4         4
13387       50       52       4        11
average_rating for this rec across 50 users from same group (less noisy) was: 4.18
all_actions shape just before sample torch.Size([1, 19, 1])
action scaled by temperature: tensor([[8]], device='cuda:0')
action picked by argmax: tensor([194], device='cuda:0')
tensor([[194, 126, 180, 203, 237,  92,  10,  11,  15, 252]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
219         1      195       4       220
461         2      195       3       189
667         3      195       4       122
1047        4      195       5       229
1257        5      195       4       166
       user_id  item_id  rating  timestep
12523       46      195       4       239
12675       47      195       4       118
12965       48      195       4       135
13251       49      195       5       148
13646       50      195       3       270
average_rating for this rec across 50 users from same group (less noisy) was: 3.9
all_actions shape just before sample torch.Size([1, 20, 1])
action scaled by temperature: tensor([[126]], device='cuda:0')
action picked by argmax: tensor([218], device='cuda:0')
tensor([[218,  43,  77,  35,  11, 148, 105, 150,  64, 128]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
19          1      219       4        20
366         2      219       4        94
796         3      219       3       251
925         4      219       3       107
1212        5      219       4       121
       user_id  item_id  rating  timestep
12441       46      219       3       157
12756       47      219       4       199
12836       48      219       4         6
13278       49      219       5       175
13562       50      219       4       186
average_rating for this rec across 50 users from same group (less noisy) was: 3.64
all_actions shape just before sample torch.Size([1, 21, 1])
action scaled by temperature: tensor([[267]], device='cuda:0')
action picked by argmax: tensor([43], device='cuda:0')
tensor([[ 43, 150, 172,  11, 218, 148, 267,  77, 105,  35]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
267         1       44       4       268
341         2       44       4        69
706         3       44       4       161
939         4       44       4       121
1331        5       44       4       240
       user_id  item_id  rating  timestep
12435       46       44       3       151
12717       47       44       4       160
13103       48       44       3       273
13146       49       44       3        43
13615       50       44       4       239
average_rating for this rec across 50 users from same group (less noisy) was: 3.74
all_actions shape just before sample torch.Size([1, 22, 1])
action scaled by temperature: tensor([[184]], device='cuda:0')
action picked by argmax: tensor([48], device='cuda:0')
tensor([[ 48, 229, 270, 109, 180,  64, 208, 261,  17,  23]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
237         1       49       5       238
454         2       49       3       182
599         3       49       4        54
876         4       49       4        58
1320        5       49       4       229
       user_id  item_id  rating  timestep
12370       46       49       3        86
12811       47       49       4       254
13032       48       49       2       202
13179       49       49       3        76
13552       50       49       4       176
average_rating for this rec across 50 users from same group (less noisy) was: 3.92
all_actions shape just before sample torch.Size([1, 23, 1])
action scaled by temperature: tensor([[172]], device='cuda:0')
action picked by argmax: tensor([257], device='cuda:0')
tensor([[257, 184,   7, 172, 225,  85, 127, 203, 118,  66]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
74          1      258       5        75
383         2      258       4       111
558         3      258       5        13
950         4      258       5       132
1256        5      258       5       165
       user_id  item_id  rating  timestep
12352       46      258       3        68
12721       47      258       5       164
13088       48      258       5       258
13123       49      258       4        20
13444       50      258       5        68
average_rating for this rec across 50 users from same group (less noisy) was: 4.68
all_actions shape just before sample torch.Size([1, 24, 1])
action scaled by temperature: tensor([[41]], device='cuda:0')
action picked by argmax: tensor([109], device='cuda:0')
tensor([[109, 184, 229, 118, 110,   7,  85,  99, 136,  66]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
132         1      110       4       133
472         2      110       5       200
687         3      110       5       142
910         4      110       5        92
1217        5      110       4       126
       user_id  item_id  rating  timestep
12408       46      110       5       124
12729       47      110       5       172
12956       48      110       5       126
13369       49      110       5       266
13458       50      110       5        82
average_rating for this rec across 50 users from same group (less noisy) was: 4.66
all_actions shape just before sample torch.Size([1, 25, 1])
action scaled by temperature: tensor([[66]], device='cuda:0')
action picked by argmax: tensor([118], device='cuda:0')
tensor([[118,  66,  90, 233, 184, 187,  74,  87, 229, 161]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
52          1      119       5        53
434         2      119       5       162
593         3      119       5        48
948         4      119       5       130
1173        5      119       5        82
       user_id  item_id  rating  timestep
12399       46      119       5       115
12597       47      119       5        40
12859       48      119       5        29
13287       49      119       5       184
13381       50      119       4         5
average_rating for this rec across 50 users from same group (less noisy) was: 4.8
all_actions shape just before sample torch.Size([1, 26, 1])
action scaled by temperature: tensor([[66]], device='cuda:0')
action picked by argmax: tensor([66], device='cuda:0')
tensor([[ 66, 118,  74, 233,  90, 187, 184, 161,  87, 232]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
158         1       67       4       159
457         2       67       4       185
650         3       67       4       105
1076        4       67       5       258
1322        5       67       5       231
       user_id  item_id  rating  timestep
12304       46       67       5        20
12644       47       67       3        87
12846       48       67       5        16
13233       49       67       4       130
13407       50       67       3        31
average_rating for this rec across 50 users from same group (less noisy) was: 3.94
all_actions shape just before sample torch.Size([1, 27, 1])
action scaled by temperature: tensor([[187]], device='cuda:0')
action picked by argmax: tensor([118], device='cuda:0')
tensor([[118,  66, 233, 161, 187,  74, 184,  90, 227, 261]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
52          1      119       5        53
434         2      119       5       162
593         3      119       5        48
948         4      119       5       130
1173        5      119       5        82
       user_id  item_id  rating  timestep
12399       46      119       5       115
12597       47      119       5        40
12859       48      119       5        29
13287       49      119       5       184
13381       50      119       4         5
average_rating for this rec across 50 users from same group (less noisy) was: 4.8
all_actions shape just before sample torch.Size([1, 28, 1])
action scaled by temperature: tensor([[65]], device='cuda:0')
action picked by argmax: tensor([74], device='cuda:0')
tensor([[ 74,  66, 118,  90, 187,  39, 232, 227, 203, 268]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
195         1       75       5       196
284         2       75       5        12
737         3       75       5       192
1026        4       75       4       208
1111        5       75       3        20
       user_id  item_id  rating  timestep
12410       46       75       5       126
12652       47       75       3        95
12974       48       75       3       144
13348       49       75       2       245
13573       50       75       4       197
average_rating for this rec across 50 users from same group (less noisy) was: 3.6
all_actions shape just before sample torch.Size([1, 29, 1])
action scaled by temperature: tensor([[264]], device='cuda:0')
action picked by argmax: tensor([66], device='cuda:0')
tensor([[ 66, 264, 187,  94, 165,  19,  41,   7, 128,  89]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
158         1       67       4       159
457         2       67       4       185
650         3       67       4       105
1076        4       67       5       258
1322        5       67       5       231
       user_id  item_id  rating  timestep
12304       46       67       5        20
12644       47       67       3        87
12846       48       67       5        16
13233       49       67       4       130
13407       50       67       3        31
average_rating for this rec across 50 users from same group (less noisy) was: 3.94
all_actions shape just before sample torch.Size([1, 30, 1])
action scaled by temperature: tensor([[264]], device='cuda:0')
action picked by argmax: tensor([66], device='cuda:0')
tensor([[ 66, 264, 187, 128,  19, 111, 235,  41, 165,   7]], device='cuda:0')
Just recommended 30 new items to 50 users from group 1 and the total rating was 129.11999999999998
train_loss is: 3.6412902553331907
action scaled by temperature: tensor([[164]], device='cuda:0')
action picked by argmax: tensor([212], device='cuda:0')
tensor([[212, 113,  38, 196, 180, 166,  47, 231, 151, 111]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
86          1      213       4        87
310         2      213       4        38
768         3      213       4       223
1008        4      213       4       190
1110        5      213       5        19
       user_id  item_id  rating  timestep
12306       46      213       3        22
12784       47      213       4       227
12934       48      213       4       104
13228       49      213       4       125
13447       50      213       4        71
average_rating for this rec across 50 users from same group (less noisy) was: 3.84
all_actions shape just before sample torch.Size([1, 1, 1])
action scaled by temperature: tensor([[206]], device='cuda:0')
action picked by argmax: tensor([238], device='cuda:0')
tensor([[238, 200,  75,  86, 166,  28,  21, 150,  15,  43]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
91          1      239       5        92
481         2      239       4       209
596         3      239       5        51
962         4      239       5       144
1362        5      239       5       271
       user_id  item_id  rating  timestep
12486       46      239       5       202
12613       47      239       4        56
13047       48      239       4       217
13194       49      239       4        91
13525       50      239       5       149
average_rating for this rec across 50 users from same group (less noisy) was: 4.58
all_actions shape just before sample torch.Size([1, 2, 1])
action scaled by temperature: tensor([[131]], device='cuda:0')
action picked by argmax: tensor([238], device='cuda:0')
tensor([[238, 200, 221, 166,  21, 168,  72, 249, 239,  86]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
91          1      239       5        92
481         2      239       4       209
596         3      239       5        51
962         4      239       5       144
1362        5      239       5       271
       user_id  item_id  rating  timestep
12486       46      239       5       202
12613       47      239       4        56
13047       48      239       4       217
13194       49      239       4        91
13525       50      239       5       149
average_rating for this rec across 50 users from same group (less noisy) was: 4.58
all_actions shape just before sample torch.Size([1, 3, 1])
action scaled by temperature: tensor([[247]], device='cuda:0')
action picked by argmax: tensor([238], device='cuda:0')
tensor([[238, 166, 221, 200,  21, 239,  72, 168, 162, 249]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
91          1      239       5        92
481         2      239       4       209
596         3      239       5        51
962         4      239       5       144
1362        5      239       5       271
       user_id  item_id  rating  timestep
12486       46      239       5       202
12613       47      239       4        56
13047       48      239       4       217
13194       49      239       4        91
13525       50      239       5       149
average_rating for this rec across 50 users from same group (less noisy) was: 4.58
all_actions shape just before sample torch.Size([1, 4, 1])
action scaled by temperature: tensor([[189]], device='cuda:0')
action picked by argmax: tensor([221], device='cuda:0')
tensor([[221, 168, 239,  21,  72, 249, 140, 166, 162, 247]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
211         1      222       4       212
390         2      222       2       118
597         3      222       5        52
1001        4      222       4       183
1353        5      222       4       262
       user_id  item_id  rating  timestep
12434       46      222       4       150
12801       47      222       4       244
12884       48      222       3        54
13211       49      222       5       108
13394       50      222       5        18
average_rating for this rec across 50 users from same group (less noisy) was: 4.2
all_actions shape just before sample torch.Size([1, 5, 1])
action scaled by temperature: tensor([[254]], device='cuda:0')
action picked by argmax: tensor([184], device='cuda:0')
tensor([[184,  79, 145, 238, 158,  86,  75, 179,  10, 125]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
159         1      185       5       160
406         2      185       4       134
647         3      185       5       102
992         4      185       4       174
1240        5      185       4       149
       user_id  item_id  rating  timestep
12373       46      185       5        89
12733       47      185       5       176
13028       48      185       5       198
13148       49      185       3        45
13456       50      185       4        80
average_rating for this rec across 50 users from same group (less noisy) was: 4.56
all_actions shape just before sample torch.Size([1, 6, 1])
action scaled by temperature: tensor([[15]], device='cuda:0')
action picked by argmax: tensor([15], device='cuda:0')
tensor([[ 15, 145, 219,  92, 261,  22,   7,  30, 248, 246]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
152         1       16       4       153
280         2       16       4         8
592         3       16       5        47
840         4       16       4        22
1318        5       16       4       227
       user_id  item_id  rating  timestep
12368       46       16       4        84
12646       47       16       4        89
13001       48       16       4       171
13274       49       16       5       171
13435       50       16       3        59
average_rating for this rec across 50 users from same group (less noisy) was: 4.12
all_actions shape just before sample torch.Size([1, 7, 1])
action scaled by temperature: tensor([[32]], device='cuda:0')
action picked by argmax: tensor([22], device='cuda:0')
tensor([[ 22, 104,  60, 109, 211,  57, 181, 268, 105,   1]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
190         1       23       4       191
420         2       23       3       148
642         3       23       4        97
900         4       23       3        82
1125        5       23       5        34
       user_id  item_id  rating  timestep
12326       46       23       3        42
12754       47       23       5       197
13092       48       23       5       262
13190       49       23       2        87
13481       50       23       4       105
average_rating for this rec across 50 users from same group (less noisy) was: 3.82
all_actions shape just before sample torch.Size([1, 8, 1])
action scaled by temperature: tensor([[192]], device='cuda:0')
action picked by argmax: tensor([22], device='cuda:0')
tensor([[ 22, 109,  27, 269, 252,  20, 212,  60, 219, 166]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
190         1       23       4       191
420         2       23       3       148
642         3       23       4        97
900         4       23       3        82
1125        5       23       5        34
       user_id  item_id  rating  timestep
12326       46       23       3        42
12754       47       23       5       197
13092       48       23       5       262
13190       49       23       2        87
13481       50       23       4       105
average_rating for this rec across 50 users from same group (less noisy) was: 3.82
all_actions shape just before sample torch.Size([1, 9, 1])
action scaled by temperature: tensor([[226]], device='cuda:0')
action picked by argmax: tensor([269], device='cuda:0')
tensor([[269,  27, 212,  22,  20, 252, 152, 114, 166, 109]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
164         1      270       5       165
417         2      270       4       145
772         3      270       5       227
863         4      270       5        45
1211        5      270       5       120
       user_id  item_id  rating  timestep
12341       46      270       4        57
12626       47      270       4        69
12885       48      270       3        55
13182       49      270       4        79
13453       50      270       4        77
average_rating for this rec across 50 users from same group (less noisy) was: 4.28
all_actions shape just before sample torch.Size([1, 10, 1])
action scaled by temperature: tensor([[226]], device='cuda:0')
action picked by argmax: tensor([27], device='cuda:0')
tensor([[ 27, 269, 166,  22, 212, 114,  57,  20, 225,  60]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
0           1       28       4         1
294         2       28       4        22
736         3       28       5       191
1051        4       28       5       233
1244        5       28       3       153
       user_id  item_id  rating  timestep
12297       46       28       3        13
12763       47       28       4       206
13040       48       28       5       210
13309       49       28       5       206
13583       50       28       5       207
average_rating for this rec across 50 users from same group (less noisy) was: 4.3
all_actions shape just before sample torch.Size([1, 11, 1])
action scaled by temperature: tensor([[72]], device='cuda:0')
action picked by argmax: tensor([32], device='cuda:0')
tensor([[ 32,  33,  27, 241, 150,  50, 269, 225,  60,  68]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
117         1       33       3       118
463         2       33       2       191
738         3       33       2       193
837         4       33       5        19
1267        5       33       3       176
       user_id  item_id  rating  timestep
12454       46       33       4       170
12590       47       33       4        33
12848       48       33       4        18
13360       49       33       4       257
13418       50       33       5        42
average_rating for this rec across 50 users from same group (less noisy) was: 3.6
all_actions shape just before sample torch.Size([1, 12, 1])
action scaled by temperature: tensor([[192]], device='cuda:0')
action picked by argmax: tensor([92], device='cuda:0')
tensor([[ 92,  72, 223,  11,   7, 192,  43, 160,  75, 148]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
240         1       93       5       241
512         2       93       5       240
614         3       93       4        69
881         4       93       5        63
1326        5       93       5       235
       user_id  item_id  rating  timestep
12349       46       93       5        65
12787       47       93       5       230
12886       48       93       5        56
13259       49       93       5       156
13386       50       93       4        10
average_rating for this rec across 50 users from same group (less noisy) was: 4.58
all_actions shape just before sample torch.Size([1, 13, 1])
action scaled by temperature: tensor([[72]], device='cuda:0')
action picked by argmax: tensor([72], device='cuda:0')
tensor([[ 72, 192,  75, 204,   7,   5,  92, 148, 160, 209]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
75          1       73       4        76
440         2       73       5       168
720         3       73       5       175
1038        4       73       5       220
1357        5       73       4       266
       user_id  item_id  rating  timestep
12520       46       73       5       236
12643       47       73       5        86
12870       48       73       4        40
13297       49       73       4       194
13380       50       73       5         4
average_rating for this rec across 50 users from same group (less noisy) was: 4.56
all_actions shape just before sample torch.Size([1, 14, 1])
action scaled by temperature: tensor([[72]], device='cuda:0')
action picked by argmax: tensor([72], device='cuda:0')
tensor([[ 72,  43, 209, 160, 204,  92, 192, 260,  33, 248]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
75          1       73       4        76
440         2       73       5       168
720         3       73       5       175
1038        4       73       5       220
1357        5       73       4       266
       user_id  item_id  rating  timestep
12520       46       73       5       236
12643       47       73       5        86
12870       48       73       4        40
13297       49       73       4       194
13380       50       73       5         4
average_rating for this rec across 50 users from same group (less noisy) was: 4.56
all_actions shape just before sample torch.Size([1, 15, 1])
action scaled by temperature: tensor([[209]], device='cuda:0')
action picked by argmax: tensor([209], device='cuda:0')
tensor([[209,  43,  99, 200, 119,  72, 215, 160, 117, 197]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
60          1      210       5        61
336         2      210       4        64
564         3      210       3        19
916         4      210       2        98
1118        5      210       5        27
       user_id  item_id  rating  timestep
12528       46      210       4       244
12569       47      210       4        12
12854       48      210       3        24
13288       49      210       4       185
13535       50      210       5       159
average_rating for this rec across 50 users from same group (less noisy) was: 3.94
all_actions shape just before sample torch.Size([1, 16, 1])
action scaled by temperature: tensor([[118]], device='cuda:0')
action picked by argmax: tensor([50], device='cuda:0')
tensor([[ 50, 265, 118, 259,  93,  28, 150, 219, 158, 269]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
234         1       51       4       235
498         2       51       3       226
789         3       51       4       244
1040        4       51       4       222
1226        5       51       4       135
       user_id  item_id  rating  timestep
12330       46       51       3        46
12720       47       51       5       163
12981       48       51       3       151
13110       49       51       5         7
13618       50       51       4       242
average_rating for this rec across 50 users from same group (less noisy) was: 3.86
all_actions shape just before sample torch.Size([1, 17, 1])
action scaled by temperature: tensor([[260]], device='cuda:0')
action picked by argmax: tensor([45], device='cuda:0')
tensor([[ 45, 248, 119, 179, 138, 107,   5, 164,   7,  99]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
139         1       46       5       140
296         2       46       5        24
714         3       46       5       169
973         4       46       3       155
1219        5       46       5       128
       user_id  item_id  rating  timestep
12425       46       46       5       141
12651       47       46       5        94
12862       48       46       4        32
13247       49       46       4       144
13537       50       46       3       161
average_rating for this rec across 50 users from same group (less noisy) was: 4.14
all_actions shape just before sample torch.Size([1, 18, 1])
action scaled by temperature: tensor([[107]], device='cuda:0')
action picked by argmax: tensor([119], device='cuda:0')
tensor([[119,  99, 168,  45, 179, 248,  11, 250, 169,  75]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
138         1      120       5       139
524         2      120       4       252
674         3      120       2       129
957         4      120       2       139
1242        5      120       3       151
       user_id  item_id  rating  timestep
12334       46      120       4        50
12574       47      120       3        17
12876       48      120       5        46
13120       49      120       5        17
13389       50      120       5        13
average_rating for this rec across 50 users from same group (less noisy) was: 3.74
all_actions shape just before sample torch.Size([1, 19, 1])
action scaled by temperature: tensor([[190]], device='cuda:0')
action picked by argmax: tensor([75], device='cuda:0')
tensor([[ 75,  65,  43, 191, 215, 150, 223, 227, 269,  88]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
76          1       76       5        77
330         2       76       4        58
571         3       76       3        26
915         4       76       4        97
1167        5       76       4        76
       user_id  item_id  rating  timestep
12440       46       76       3       156
12588       47       76       4        31
12957       48       76       3       127
13325       49       76       5       222
13468       50       76       5        92
average_rating for this rec across 50 users from same group (less noisy) was: 4.04
all_actions shape just before sample torch.Size([1, 20, 1])
action scaled by temperature: tensor([[75]], device='cuda:0')
action picked by argmax: tensor([75], device='cuda:0')
tensor([[ 75,   5, 150,  96,  43, 223,  46, 200,  65, 206]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
76          1       76       5        77
330         2       76       4        58
571         3       76       3        26
915         4       76       4        97
1167        5       76       4        76
       user_id  item_id  rating  timestep
12440       46       76       3       156
12588       47       76       4        31
12957       48       76       3       127
13325       49       76       5       222
13468       50       76       5        92
average_rating for this rec across 50 users from same group (less noisy) was: 4.04
all_actions shape just before sample torch.Size([1, 21, 1])
action scaled by temperature: tensor([[43]], device='cuda:0')
action picked by argmax: tensor([75], device='cuda:0')
tensor([[ 75,   5, 150, 223,  96, 200,  43,  46, 244, 206]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
76          1       76       5        77
330         2       76       4        58
571         3       76       3        26
915         4       76       4        97
1167        5       76       4        76
       user_id  item_id  rating  timestep
12440       46       76       3       156
12588       47       76       4        31
12957       48       76       3       127
13325       49       76       5       222
13468       50       76       5        92
average_rating for this rec across 50 users from same group (less noisy) was: 4.04
all_actions shape just before sample torch.Size([1, 22, 1])
action scaled by temperature: tensor([[46]], device='cuda:0')
action picked by argmax: tensor([75], device='cuda:0')
tensor([[ 75,  96,   5, 200, 244, 150, 213,  43, 223, 163]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
76          1       76       5        77
330         2       76       4        58
571         3       76       3        26
915         4       76       4        97
1167        5       76       4        76
       user_id  item_id  rating  timestep
12440       46       76       3       156
12588       47       76       4        31
12957       48       76       3       127
13325       49       76       5       222
13468       50       76       5        92
average_rating for this rec across 50 users from same group (less noisy) was: 4.04
all_actions shape just before sample torch.Size([1, 23, 1])
action scaled by temperature: tensor([[96]], device='cuda:0')
action picked by argmax: tensor([96], device='cuda:0')
tensor([[ 96, 244, 200,  75,   5, 206, 213,  43, 135, 163]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
46          1       97       5        47
363         2       97       4        91
656         3       97       5       111
1059        4       97       4       241
1138        5       97       5        47
       user_id  item_id  rating  timestep
12431       46       97       5       147
12715       47       97       5       158
12880       48       97       5        50
13198       49       97       5        95
13414       50       97       4        38
average_rating for this rec across 50 users from same group (less noisy) was: 4.5
all_actions shape just before sample torch.Size([1, 24, 1])
action scaled by temperature: tensor([[206]], device='cuda:0')
action picked by argmax: tensor([255], device='cuda:0')
tensor([[255, 200, 237,  56,  96, 244, 206, 154,   2, 214]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
85          1      256       2        86
409         2      256       4       137
693         3      256       4       148
889         4      256       5        71
1191        5      256       5       100
       user_id  item_id  rating  timestep
12509       46      256       4       225
12728       47      256       4       171
12993       48      256       5       163
13128       49      256       5        25
13480       50      256       4       104
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 25, 1])
action scaled by temperature: tensor([[200]], device='cuda:0')
action picked by argmax: tensor([200], device='cuda:0')
tensor([[200, 237,  43,   1, 255,  96,  56,   2, 244,  92]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
168         1      201       3       169
506         2      201       3       234
704         3      201       2       159
865         4      201       2        47
1246        5      201       5       155
       user_id  item_id  rating  timestep
12552       46      201       5       268
12755       47      201       4       198
13042       48      201       4       212
13221       49      201       3       118
13499       50      201       3       123
average_rating for this rec across 50 users from same group (less noisy) was: 3.76
all_actions shape just before sample torch.Size([1, 26, 1])
action scaled by temperature: tensor([[56]], device='cuda:0')
action picked by argmax: tensor([1], device='cuda:0')
tensor([[  1,  77, 225, 243,  56,  92, 237, 255,  44,  69]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
41          1        2       5        42
443         2        2       5       171
788         3        2       5       243
891         4        2       4        73
1097        5        2       5         6
       user_id  item_id  rating  timestep
12508       46        2       5       224
12785       47        2       4       228
13021       48        2       5       191
13124       49        2       5        21
13637       50        2       5       261
average_rating for this rec across 50 users from same group (less noisy) was: 4.72
all_actions shape just before sample torch.Size([1, 27, 1])
action scaled by temperature: tensor([[123]], device='cuda:0')
action picked by argmax: tensor([96], device='cuda:0')
tensor([[ 96, 148, 237,  43, 123, 243,  77, 163, 127,   5]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
46          1       97       5        47
363         2       97       4        91
656         3       97       5       111
1059        4       97       4       241
1138        5       97       5        47
       user_id  item_id  rating  timestep
12431       46       97       5       147
12715       47       97       5       158
12880       48       97       5        50
13198       49       97       5        95
13414       50       97       4        38
average_rating for this rec across 50 users from same group (less noisy) was: 4.5
all_actions shape just before sample torch.Size([1, 28, 1])
action scaled by temperature: tensor([[163]], device='cuda:0')
action picked by argmax: tensor([96], device='cuda:0')
tensor([[ 96,   1,  77,  43, 237, 163, 165, 169, 134, 148]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
46          1       97       5        47
363         2       97       4        91
656         3       97       5       111
1059        4       97       4       241
1138        5       97       5        47
       user_id  item_id  rating  timestep
12431       46       97       5       147
12715       47       97       5       158
12880       48       97       5        50
13198       49       97       5        95
13414       50       97       4        38
average_rating for this rec across 50 users from same group (less noisy) was: 4.5
all_actions shape just before sample torch.Size([1, 29, 1])
action scaled by temperature: tensor([[77]], device='cuda:0')
action picked by argmax: tensor([1], device='cuda:0')
tensor([[  1,  43, 165,  77, 134,  96, 206, 236, 237, 169]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
41          1        2       5        42
443         2        2       5       171
788         3        2       5       243
891         4        2       4        73
1097        5        2       5         6
       user_id  item_id  rating  timestep
12508       46        2       5       224
12785       47        2       4       228
13021       48        2       5       191
13124       49        2       5        21
13637       50        2       5       261
average_rating for this rec across 50 users from same group (less noisy) was: 4.72
all_actions shape just before sample torch.Size([1, 30, 1])
action scaled by temperature: tensor([[51]], device='cuda:0')
action picked by argmax: tensor([96], device='cuda:0')
tensor([[ 96,  43, 134, 148,   5,  77, 237,   1, 252, 165]], device='cuda:0')
Just recommended 30 new items to 50 users from group 1 and the total rating was 126.58000000000003
train_loss is: 2.908746226193154
action scaled by temperature: tensor([[138]], device='cuda:0')
action picked by argmax: tensor([136], device='cuda:0')
tensor([[136, 268,  98, 200, 196, 267, 237,  37,  30, 233]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
272         1      137       4       273
451         2      137       3       179
595         3      137       5        50
1017        4      137       4       199
1298        5      137       4       207
       user_id  item_id  rating  timestep
12307       46      137       4        23
12565       47      137       4         8
12961       48      137       4       131
13254       49      137       3       151
13529       50      137       4       153
average_rating for this rec across 50 users from same group (less noisy) was: 3.76
all_actions shape just before sample torch.Size([1, 1, 1])
action scaled by temperature: tensor([[261]], device='cuda:0')
action picked by argmax: tensor([234], device='cuda:0')
tensor([[234, 268, 235,  23, 107,  85, 203,  52,   8, 131]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
233         1      235       3       234
468         2      235       4       196
662         3      235       4       117
927         4      235       3       109
1185        5      235       4        94
       user_id  item_id  rating  timestep
12305       46      235       3        21
12679       47      235       2       122
12895       48      235       4        65
13238       49      235       5       135
13642       50      235       5       266
average_rating for this rec across 50 users from same group (less noisy) was: 3.78
all_actions shape just before sample torch.Size([1, 2, 1])
action scaled by temperature: tensor([[61]], device='cuda:0')
action picked by argmax: tensor([23], device='cuda:0')
tensor([[ 23, 263, 226, 159, 111, 166, 251,  30,  52,  25]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
122         1       24       4       123
389         2       24       5       117
666         3       24       3       121
871         4       24       5        53
1330        5       24       5       239
       user_id  item_id  rating  timestep
12339       46       24       4        55
12640       47       24       4        83
12930       48       24       3       100
13266       49       24       5       163
13582       50       24       4       206
average_rating for this rec across 50 users from same group (less noisy) was: 3.84
all_actions shape just before sample torch.Size([1, 3, 1])
action scaled by temperature: tensor([[49]], device='cuda:0')
action picked by argmax: tensor([23], device='cuda:0')
tensor([[ 23, 263, 159, 166, 204,  30, 111, 226,  65,  13]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
122         1       24       4       123
389         2       24       5       117
666         3       24       3       121
871         4       24       5        53
1330        5       24       5       239
       user_id  item_id  rating  timestep
12339       46       24       4        55
12640       47       24       4        83
12930       48       24       3       100
13266       49       24       5       163
13582       50       24       4       206
average_rating for this rec across 50 users from same group (less noisy) was: 3.84
all_actions shape just before sample torch.Size([1, 4, 1])
action scaled by temperature: tensor([[128]], device='cuda:0')
action picked by argmax: tensor([23], device='cuda:0')
tensor([[ 23, 263, 166, 204,  30, 159,  65,  13, 162,  85]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
122         1       24       4       123
389         2       24       5       117
666         3       24       3       121
871         4       24       5        53
1330        5       24       5       239
       user_id  item_id  rating  timestep
12339       46       24       4        55
12640       47       24       4        83
12930       48       24       3       100
13266       49       24       5       163
13582       50       24       4       206
average_rating for this rec across 50 users from same group (less noisy) was: 3.84
all_actions shape just before sample torch.Size([1, 5, 1])
action scaled by temperature: tensor([[8]], device='cuda:0')
action picked by argmax: tensor([263], device='cuda:0')
tensor([[263,  23,  13,  30, 204, 166,  65,  92,  66,  85]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
24          1      264       4        25
491         2      264       3       219
715         3      264       3       170
1039        4      264       5       221
1334        5      264       4       243
       user_id  item_id  rating  timestep
12302       46      264       5        18
12567       47      264       4        10
12976       48      264       4       146
13241       49      264       4       138
13515       50      264       5       139
average_rating for this rec across 50 users from same group (less noisy) was: 4.42
all_actions shape just before sample torch.Size([1, 6, 1])
action scaled by temperature: tensor([[84]], device='cuda:0')
action picked by argmax: tensor([23], device='cuda:0')
tensor([[ 23, 270,  66, 190,  85, 130, 167,  18, 225,  29]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
122         1       24       4       123
389         2       24       5       117
666         3       24       3       121
871         4       24       5        53
1330        5       24       5       239
       user_id  item_id  rating  timestep
12339       46       24       4        55
12640       47       24       4        83
12930       48       24       3       100
13266       49       24       5       163
13582       50       24       4       206
average_rating for this rec across 50 users from same group (less noisy) was: 3.84
all_actions shape just before sample torch.Size([1, 7, 1])
action scaled by temperature: tensor([[66]], device='cuda:0')
action picked by argmax: tensor([23], device='cuda:0')
tensor([[ 23,  66, 190, 270,  85, 167, 130,  29, 231, 108]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
122         1       24       4       123
389         2       24       5       117
666         3       24       3       121
871         4       24       5        53
1330        5       24       5       239
       user_id  item_id  rating  timestep
12339       46       24       4        55
12640       47       24       4        83
12930       48       24       3       100
13266       49       24       5       163
13582       50       24       4       206
average_rating for this rec across 50 users from same group (less noisy) was: 3.84
all_actions shape just before sample torch.Size([1, 8, 1])
action scaled by temperature: tensor([[126]], device='cuda:0')
action picked by argmax: tensor([66], device='cuda:0')
tensor([[ 66,  23, 190,  85, 270, 130, 108, 167, 231, 188]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
158         1       67       4       159
457         2       67       4       185
650         3       67       4       105
1076        4       67       5       258
1322        5       67       5       231
       user_id  item_id  rating  timestep
12304       46       67       5        20
12644       47       67       3        87
12846       48       67       5        16
13233       49       67       4       130
13407       50       67       3        31
average_rating for this rec across 50 users from same group (less noisy) was: 3.94
all_actions shape just before sample torch.Size([1, 9, 1])
action scaled by temperature: tensor([[82]], device='cuda:0')
action picked by argmax: tensor([23], device='cuda:0')
tensor([[ 23,  85, 190, 167,  66, 108, 130, 231,  82, 188]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
122         1       24       4       123
389         2       24       5       117
666         3       24       3       121
871         4       24       5        53
1330        5       24       5       239
       user_id  item_id  rating  timestep
12339       46       24       4        55
12640       47       24       4        83
12930       48       24       3       100
13266       49       24       5       163
13582       50       24       4       206
average_rating for this rec across 50 users from same group (less noisy) was: 3.84
all_actions shape just before sample torch.Size([1, 10, 1])
action scaled by temperature: tensor([[214]], device='cuda:0')
action picked by argmax: tensor([23], device='cuda:0')
tensor([[ 23, 190,  85,  66, 167, 108,  82, 130, 188, 231]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
122         1       24       4       123
389         2       24       5       117
666         3       24       3       121
871         4       24       5        53
1330        5       24       5       239
       user_id  item_id  rating  timestep
12339       46       24       4        55
12640       47       24       4        83
12930       48       24       3       100
13266       49       24       5       163
13582       50       24       4       206
average_rating for this rec across 50 users from same group (less noisy) was: 3.84
all_actions shape just before sample torch.Size([1, 11, 1])
action scaled by temperature: tensor([[91]], device='cuda:0')
action picked by argmax: tensor([85], device='cuda:0')
tensor([[ 85, 190, 108,  66,  23, 188,  82, 130, 214, 142]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
266         1       86       5       267
509         2       86       5       237
777         3       86       5       232
917         4       86       5        99
1121        5       86       4        30
       user_id  item_id  rating  timestep
12506       46       86       5       222
12600       47       86       5        43
13074       48       86       5       244
13362       49       86       5       259
13397       50       86       5        21
average_rating for this rec across 50 users from same group (less noisy) was: 4.58
all_actions shape just before sample torch.Size([1, 12, 1])
action scaled by temperature: tensor([[60]], device='cuda:0')
action picked by argmax: tensor([48], device='cuda:0')
tensor([[ 48, 185, 196, 143, 149, 160, 246,  77, 158, 214]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
237         1       49       5       238
454         2       49       3       182
599         3       49       4        54
876         4       49       4        58
1320        5       49       4       229
       user_id  item_id  rating  timestep
12370       46       49       3        86
12811       47       49       4       254
13032       48       49       2       202
13179       49       49       3        76
13552       50       49       4       176
average_rating for this rec across 50 users from same group (less noisy) was: 3.92
all_actions shape just before sample torch.Size([1, 13, 1])
action scaled by temperature: tensor([[246]], device='cuda:0')
action picked by argmax: tensor([163], device='cuda:0')
tensor([[163, 188, 196, 180,  84, 149, 225,  61,  87,  58]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
33          1      164       4        34
378         2      164       3       106
701         3      164       5       156
893         4      164       4        75
1338        5      164       4       247
       user_id  item_id  rating  timestep
12418       46      164       5       134
12718       47      164       4       161
13069       48      164       5       239
13265       49      164       4       162
13576       50      164       4       200
average_rating for this rec across 50 users from same group (less noisy) was: 4.46
all_actions shape just before sample torch.Size([1, 14, 1])
action scaled by temperature: tensor([[254]], device='cuda:0')
action picked by argmax: tensor([50], device='cuda:0')
tensor([[ 50, 219, 266,   9, 265,  95, 106, 254,  30,  32]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
234         1       51       4       235
498         2       51       3       226
789         3       51       4       244
1040        4       51       4       222
1226        5       51       4       135
       user_id  item_id  rating  timestep
12330       46       51       3        46
12720       47       51       5       163
12981       48       51       3       151
13110       49       51       5         7
13618       50       51       4       242
average_rating for this rec across 50 users from same group (less noisy) was: 3.86
all_actions shape just before sample torch.Size([1, 15, 1])
action scaled by temperature: tensor([[6]], device='cuda:0')
action picked by argmax: tensor([6], device='cuda:0')
tensor([[  6, 244,  15, 108, 231,  64,   5, 138,   7, 149]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
82          1        7       4        83
388         2        7       4       116
811         3        7       4       266
990         4        7       4       172
1154        5        7       3        63
       user_id  item_id  rating  timestep
12491       46        7       3       207
12722       47        7       4       165
13002       48        7       5       172
13104       49        7       4         1
13378       50        7       5         2
average_rating for this rec across 50 users from same group (less noisy) was: 3.68
all_actions shape just before sample torch.Size([1, 16, 1])
action scaled by temperature: tensor([[244]], device='cuda:0')
action picked by argmax: tensor([5], device='cuda:0')
tensor([[  5, 244,   6,  15, 138, 149,   7,  30, 153,  64]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
133         1        6       5       134
431         2        6       5       159
655         3        6       5       110
968         4        6       4       150
1206        5        6       3       115
       user_id  item_id  rating  timestep
12316       46        6       5        32
12746       47        6       3       189
13036       48        6       4       206
13216       49        6       5       113
13602       50        6       5       226
average_rating for this rec across 50 users from same group (less noisy) was: 4.02
all_actions shape just before sample torch.Size([1, 17, 1])
action scaled by temperature: tensor([[244]], device='cuda:0')
action picked by argmax: tensor([149], device='cuda:0')
tensor([[149,   5, 244,   1, 200, 218,  64, 138, 114,   7]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
59          1      150       4        60
274         2      150       1         2
792         3      150       3       247
952         4      150       4       134
1175        5      150       3        84
       user_id  item_id  rating  timestep
12343       46      150       3        59
12750       47      150       3       193
13050       48      150       2       220
13125       49      150       2        22
13522       50      150       4       146
average_rating for this rec across 50 users from same group (less noisy) was: 3.26
all_actions shape just before sample torch.Size([1, 18, 1])
action scaled by temperature: tensor([[153]], device='cuda:0')
action picked by argmax: tensor([5], device='cuda:0')
tensor([[  5, 149,   1, 218, 244, 200, 138, 114,  87, 153]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
133         1        6       5       134
431         2        6       5       159
655         3        6       5       110
968         4        6       4       150
1206        5        6       3       115
       user_id  item_id  rating  timestep
12316       46        6       5        32
12746       47        6       3       189
13036       48        6       4       206
13216       49        6       5       113
13602       50        6       5       226
average_rating for this rec across 50 users from same group (less noisy) was: 4.02
all_actions shape just before sample torch.Size([1, 19, 1])
action scaled by temperature: tensor([[9]], device='cuda:0')
action picked by argmax: tensor([149], device='cuda:0')
tensor([[149,   5, 200,   1, 218, 141, 250,  26,  87, 114]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
59          1      150       4        60
274         2      150       1         2
792         3      150       3       247
952         4      150       4       134
1175        5      150       3        84
       user_id  item_id  rating  timestep
12343       46      150       3        59
12750       47      150       3       193
13050       48      150       2       220
13125       49      150       2        22
13522       50      150       4       146
average_rating for this rec across 50 users from same group (less noisy) was: 3.26
all_actions shape just before sample torch.Size([1, 20, 1])
action scaled by temperature: tensor([[149]], device='cuda:0')
action picked by argmax: tensor([149], device='cuda:0')
tensor([[149, 218, 200,   5,   1,  26, 250, 141,  87, 257]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
59          1      150       4        60
274         2      150       1         2
792         3      150       3       247
952         4      150       4       134
1175        5      150       3        84
       user_id  item_id  rating  timestep
12343       46      150       3        59
12750       47      150       3       193
13050       48      150       2       220
13125       49      150       2        22
13522       50      150       4       146
average_rating for this rec across 50 users from same group (less noisy) was: 3.26
all_actions shape just before sample torch.Size([1, 21, 1])
action scaled by temperature: tensor([[218]], device='cuda:0')
action picked by argmax: tensor([149], device='cuda:0')
tensor([[149, 218,   1, 141, 200,   5,  26,  87, 130, 257]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
59          1      150       4        60
274         2      150       1         2
792         3      150       3       247
952         4      150       4       134
1175        5      150       3        84
       user_id  item_id  rating  timestep
12343       46      150       3        59
12750       47      150       3       193
13050       48      150       2       220
13125       49      150       2        22
13522       50      150       4       146
average_rating for this rec across 50 users from same group (less noisy) was: 3.26
all_actions shape just before sample torch.Size([1, 22, 1])
action scaled by temperature: tensor([[218]], device='cuda:0')
action picked by argmax: tensor([149], device='cuda:0')
tensor([[149,   1, 218, 141,  87,   5, 200, 257,  26, 130]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
59          1      150       4        60
274         2      150       1         2
792         3      150       3       247
952         4      150       4       134
1175        5      150       3        84
       user_id  item_id  rating  timestep
12343       46      150       3        59
12750       47      150       3       193
13050       48      150       2       220
13125       49      150       2        22
13522       50      150       4       146
average_rating for this rec across 50 users from same group (less noisy) was: 3.26
all_actions shape just before sample torch.Size([1, 23, 1])
action scaled by temperature: tensor([[218]], device='cuda:0')
action picked by argmax: tensor([5], device='cuda:0')
tensor([[  5, 149, 200,   1, 218, 257, 209, 176, 142, 141]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
133         1        6       5       134
431         2        6       5       159
655         3        6       5       110
968         4        6       4       150
1206        5        6       3       115
       user_id  item_id  rating  timestep
12316       46        6       5        32
12746       47        6       3       189
13036       48        6       4       206
13216       49        6       5       113
13602       50        6       5       226
average_rating for this rec across 50 users from same group (less noisy) was: 4.02
all_actions shape just before sample torch.Size([1, 24, 1])
action scaled by temperature: tensor([[130]], device='cuda:0')
action picked by argmax: tensor([130], device='cuda:0')
tensor([[130,  73, 134, 209,  32,   5, 179,  29, 149, 136]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
179         1      131       4       180
394         2      131       4       122
702         3      131       4       157
984         4      131       4       166
1272        5      131       3       181
       user_id  item_id  rating  timestep
12300       46      131       4        16
12775       47      131       5       218
12907       48      131       4        77
13164       49      131       4        61
13528       50      131       4       152
average_rating for this rec across 50 users from same group (less noisy) was: 3.92
all_actions shape just before sample torch.Size([1, 25, 1])
action scaled by temperature: tensor([[37]], device='cuda:0')
action picked by argmax: tensor([252], device='cuda:0')
tensor([[252,  37,   3, 251,  13, 241,   9,  48, 139, 227]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
53          1      253       5        54
325         2      253       5        53
761         3      253       5       216
1068        4      253       5       250
1176        5      253       5        85
       user_id  item_id  rating  timestep
12446       46      253       5       162
12791       47      253       5       234
13019       48      253       5       189
13220       49      253       5       117
13580       50      253       5       204
average_rating for this rec across 50 users from same group (less noisy) was: 4.7
all_actions shape just before sample torch.Size([1, 26, 1])
action scaled by temperature: tensor([[66]], device='cuda:0')
action picked by argmax: tensor([99], device='cuda:0')
tensor([[ 99,  66,  94,  13,  97,  83, 154, 163, 170, 251]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
181         1      100       5       182
298         2      100       4        26
779         3      100       5       234
902         4      100       5        84
1101        5      100       5        10
       user_id  item_id  rating  timestep
12367       46      100       5        83
12682       47      100       5       125
13064       48      100       5       234
13324       49      100       5       221
13421       50      100       4        45
average_rating for this rec across 50 users from same group (less noisy) was: 4.78
all_actions shape just before sample torch.Size([1, 27, 1])
action scaled by temperature: tensor([[83]], device='cuda:0')
action picked by argmax: tensor([251], device='cuda:0')
tensor([[251,  83,  13,  66, 246,  99, 235, 182, 116, 217]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
93          1      252       4        94
494         2      252       5       222
552         3      252       5         7
998         4      252       5       180
1347        5      252       4       256
       user_id  item_id  rating  timestep
12322       46      252       5        38
12798       47      252       4       241
12948       48      252       4       118
13342       49      252       5       239
13451       50      252       5        75
average_rating for this rec across 50 users from same group (less noisy) was: 4.62
all_actions shape just before sample torch.Size([1, 28, 1])
action scaled by temperature: tensor([[116]], device='cuda:0')
action picked by argmax: tensor([83], device='cuda:0')
tensor([[ 83, 246, 217,  13, 251,  99,  97, 235, 163,  66]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
255         1       84       3       256
303         2       84       5        31
754         3       84       4       209
850         4       84       4        32
1230        5       84       5       139
       user_id  item_id  rating  timestep
12517       46       84       4       233
12799       47       84       5       242
12936       48       84       5       106
13329       49       84       5       226
13635       50       84       4       259
average_rating for this rec across 50 users from same group (less noisy) was: 4.2
all_actions shape just before sample torch.Size([1, 29, 1])
action scaled by temperature: tensor([[116]], device='cuda:0')
action picked by argmax: tensor([116], device='cuda:0')
tensor([[116, 155,  13, 151, 246, 203, 251, 259,  83, 235]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
111         1      117       4       112
476         2      117       1       204
727         3      117       1       182
1058        4      117       2       240
1280        5      117       2       189
       user_id  item_id  rating  timestep
12364       46      117       1        80
12780       47      117       4       223
12950       48      117       4       120
13106       49      117       2         3
13568       50      117       5       192
average_rating for this rec across 50 users from same group (less noisy) was: 2.64
all_actions shape just before sample torch.Size([1, 30, 1])
action scaled by temperature: tensor([[184]], device='cuda:0')
action picked by argmax: tensor([246], device='cuda:0')
tensor([[246, 211, 182, 184, 230,  66, 123,  13, 185, 124]], device='cuda:0')
Just recommended 30 new items to 50 users from group 1 and the total rating was 116.50000000000003
train_loss is: 2.370224792663365
action scaled by temperature: tensor([[176]], device='cuda:0')
action picked by argmax: tensor([212], device='cuda:0')
tensor([[212,  38, 215, 268, 196, 223, 168,  52, 201, 129]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
86          1      213       4        87
310         2      213       4        38
768         3      213       4       223
1008        4      213       4       190
1110        5      213       5        19
       user_id  item_id  rating  timestep
12306       46      213       3        22
12784       47      213       4       227
12934       48      213       4       104
13228       49      213       4       125
13447       50      213       4        71
average_rating for this rec across 50 users from same group (less noisy) was: 3.84
all_actions shape just before sample torch.Size([1, 1, 1])
action scaled by temperature: tensor([[239]], device='cuda:0')
action picked by argmax: tensor([265], device='cuda:0')
tensor([[265, 200,  72, 168, 150,  75,  18,  30, 238, 254]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
81          1      266       3        82
342         2      266       3        70
793         3      266       4       248
901         4      266       3        83
1113        5      266       4        22
       user_id  item_id  rating  timestep
12394       46      266       5       110
12827       47      266       2       270
12927       48      266       5        97
13151       49      266       4        48
13393       50      266       5        17
average_rating for this rec across 50 users from same group (less noisy) was: 3.82
all_actions shape just before sample torch.Size([1, 2, 1])
action scaled by temperature: tensor([[257]], device='cuda:0')
action picked by argmax: tensor([81], device='cuda:0')
tensor([[ 81, 195, 104, 181,  82, 268, 191, 140, 146,  34]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
68          1       82       5        69
540         2       82       5       268
688         3       82       4       143
963         4       82       5       145
1140        5       82       4        49
       user_id  item_id  rating  timestep
12345       46       82       4        61
12570       47       82       4        13
12926       48       82       5        96
13162       49       82       4        59
13379       50       82       4         3
average_rating for this rec across 50 users from same group (less noisy) was: 4.44
all_actions shape just before sample torch.Size([1, 3, 1])
action scaled by temperature: tensor([[222]], device='cuda:0')
action picked by argmax: tensor([167], device='cuda:0')
tensor([[167,  69, 270, 245, 211, 128, 201, 181, 108,  55]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
38          1      168       5        39
418         2      168       3       146
699         3      168       4       154
928         4      168       5       110
1133        5      168       5        42
       user_id  item_id  rating  timestep
12493       46      168       3       209
12781       47      168       4       224
12921       48      168       3        91
13219       49      168       5       116
13564       50      168       4       188
average_rating for this rec across 50 users from same group (less noisy) was: 4.08
all_actions shape just before sample torch.Size([1, 4, 1])
action scaled by temperature: tensor([[131]], device='cuda:0')
action picked by argmax: tensor([131], device='cuda:0')
tensor([[131, 145, 211, 173, 110,  79,  14,  10, 107,  19]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
157         1      132       5       158
519         2      132       4       247
574         3      132       5        29
1061        4      132       3       243
1323        5      132       4       232
       user_id  item_id  rating  timestep
12481       46      132       4       197
12692       47      132       4       135
12997       48      132       4       167
13321       49      132       5       218
13606       50      132       4       230
average_rating for this rec across 50 users from same group (less noisy) was: 4.42
all_actions shape just before sample torch.Size([1, 5, 1])
action scaled by temperature: tensor([[131]], device='cuda:0')
action picked by argmax: tensor([131], device='cuda:0')
tensor([[131, 145, 173,  10,  14,  79, 211,  19,   7,  43]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
157         1      132       5       158
519         2      132       4       247
574         3      132       5        29
1061        4      132       3       243
1323        5      132       4       232
       user_id  item_id  rating  timestep
12481       46      132       4       197
12692       47      132       4       135
12997       48      132       4       167
13321       49      132       5       218
13606       50      132       4       230
average_rating for this rec across 50 users from same group (less noisy) was: 4.42
all_actions shape just before sample torch.Size([1, 6, 1])
action scaled by temperature: tensor([[32]], device='cuda:0')
action picked by argmax: tensor([131], device='cuda:0')
tensor([[131,  10, 145,  79,  43,  14, 173, 129, 197,   7]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
157         1      132       5       158
519         2      132       4       247
574         3      132       5        29
1061        4      132       3       243
1323        5      132       4       232
       user_id  item_id  rating  timestep
12481       46      132       4       197
12692       47      132       4       135
12997       48      132       4       167
13321       49      132       5       218
13606       50      132       4       230
average_rating for this rec across 50 users from same group (less noisy) was: 4.42
all_actions shape just before sample torch.Size([1, 7, 1])
action scaled by temperature: tensor([[131]], device='cuda:0')
action picked by argmax: tensor([131], device='cuda:0')
tensor([[131,  10,  43,  14, 129,  79, 145,   7, 164, 197]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
157         1      132       5       158
519         2      132       4       247
574         3      132       5        29
1061        4      132       3       243
1323        5      132       4       232
       user_id  item_id  rating  timestep
12481       46      132       4       197
12692       47      132       4       135
12997       48      132       4       167
13321       49      132       5       218
13606       50      132       4       230
average_rating for this rec across 50 users from same group (less noisy) was: 4.42
all_actions shape just before sample torch.Size([1, 8, 1])
action scaled by temperature: tensor([[219]], device='cuda:0')
action picked by argmax: tensor([131], device='cuda:0')
tensor([[131,  10, 129,  14,  43,  79, 173, 145,   7,  90]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
157         1      132       5       158
519         2      132       4       247
574         3      132       5        29
1061        4      132       3       243
1323        5      132       4       232
       user_id  item_id  rating  timestep
12481       46      132       4       197
12692       47      132       4       135
12997       48      132       4       167
13321       49      132       5       218
13606       50      132       4       230
average_rating for this rec across 50 users from same group (less noisy) was: 4.42
all_actions shape just before sample torch.Size([1, 9, 1])
action scaled by temperature: tensor([[131]], device='cuda:0')
action picked by argmax: tensor([131], device='cuda:0')
tensor([[131,  10, 129,  43, 267,  14,   7,  79,  90, 134]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
157         1      132       5       158
519         2      132       4       247
574         3      132       5        29
1061        4      132       3       243
1323        5      132       4       232
       user_id  item_id  rating  timestep
12481       46      132       4       197
12692       47      132       4       135
12997       48      132       4       167
13321       49      132       5       218
13606       50      132       4       230
average_rating for this rec across 50 users from same group (less noisy) was: 4.42
all_actions shape just before sample torch.Size([1, 10, 1])
action scaled by temperature: tensor([[165]], device='cuda:0')
action picked by argmax: tensor([131], device='cuda:0')
tensor([[131,  43,  14, 129, 267,  10, 134,  79,  38, 165]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
157         1      132       5       158
519         2      132       4       247
574         3      132       5        29
1061        4      132       3       243
1323        5      132       4       232
       user_id  item_id  rating  timestep
12481       46      132       4       197
12692       47      132       4       135
12997       48      132       4       167
13321       49      132       5       218
13606       50      132       4       230
average_rating for this rec across 50 users from same group (less noisy) was: 4.42
all_actions shape just before sample torch.Size([1, 11, 1])
action scaled by temperature: tensor([[134]], device='cuda:0')
action picked by argmax: tensor([131], device='cuda:0')
tensor([[131, 129, 134, 267,  43, 165,  38,  14,  10,   7]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
157         1      132       5       158
519         2      132       4       247
574         3      132       5        29
1061        4      132       3       243
1323        5      132       4       232
       user_id  item_id  rating  timestep
12481       46      132       4       197
12692       47      132       4       135
12997       48      132       4       167
13321       49      132       5       218
13606       50      132       4       230
average_rating for this rec across 50 users from same group (less noisy) was: 4.42
all_actions shape just before sample torch.Size([1, 12, 1])
action scaled by temperature: tensor([[131]], device='cuda:0')
action picked by argmax: tensor([131], device='cuda:0')
tensor([[131, 134, 129, 267,  38, 165,  14,  43,  10,   7]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
157         1      132       5       158
519         2      132       4       247
574         3      132       5        29
1061        4      132       3       243
1323        5      132       4       232
       user_id  item_id  rating  timestep
12481       46      132       4       197
12692       47      132       4       135
12997       48      132       4       167
13321       49      132       5       218
13606       50      132       4       230
average_rating for this rec across 50 users from same group (less noisy) was: 4.42
all_actions shape just before sample torch.Size([1, 13, 1])
action scaled by temperature: tensor([[147]], device='cuda:0')
action picked by argmax: tensor([131], device='cuda:0')
tensor([[131, 134, 129, 165,  43, 194, 267, 236,  38,  14]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
157         1      132       5       158
519         2      132       4       247
574         3      132       5        29
1061        4      132       3       243
1323        5      132       4       232
       user_id  item_id  rating  timestep
12481       46      132       4       197
12692       47      132       4       135
12997       48      132       4       167
13321       49      132       5       218
13606       50      132       4       230
average_rating for this rec across 50 users from same group (less noisy) was: 4.42
all_actions shape just before sample torch.Size([1, 14, 1])
action scaled by temperature: tensor([[131]], device='cuda:0')
action picked by argmax: tensor([131], device='cuda:0')
tensor([[131, 134, 111, 165, 244,  55,  14, 110, 128, 236]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
157         1      132       5       158
519         2      132       4       247
574         3      132       5        29
1061        4      132       3       243
1323        5      132       4       232
       user_id  item_id  rating  timestep
12481       46      132       4       197
12692       47      132       4       135
12997       48      132       4       167
13321       49      132       5       218
13606       50      132       4       230
average_rating for this rec across 50 users from same group (less noisy) was: 4.42
all_actions shape just before sample torch.Size([1, 15, 1])
action scaled by temperature: tensor([[131]], device='cuda:0')
action picked by argmax: tensor([131], device='cuda:0')
tensor([[131, 134, 165,  14, 111,  43, 173, 244,  55, 236]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
157         1      132       5       158
519         2      132       4       247
574         3      132       5        29
1061        4      132       3       243
1323        5      132       4       232
       user_id  item_id  rating  timestep
12481       46      132       4       197
12692       47      132       4       135
12997       48      132       4       167
13321       49      132       5       218
13606       50      132       4       230
average_rating for this rec across 50 users from same group (less noisy) was: 4.42
all_actions shape just before sample torch.Size([1, 16, 1])
action scaled by temperature: tensor([[236]], device='cuda:0')
action picked by argmax: tensor([236], device='cuda:0')
tensor([[236, 165,  18,  59,  19, 134, 131, 244, 253, 111]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
37          1      237       5        38
516         2      237       5       244
734         3      237       5       189
999         4      237       5       181
1227        5      237       5       136
       user_id  item_id  rating  timestep
12448       46      237       5       164
12818       47      237       4       261
12861       48      237       4        31
13105       49      237       5         2
13446       50      237       4        70
average_rating for this rec across 50 users from same group (less noisy) was: 4.66
all_actions shape just before sample torch.Size([1, 17, 1])
action scaled by temperature: tensor([[141]], device='cuda:0')
action picked by argmax: tensor([30], device='cuda:0')
tensor([[ 30, 261, 141, 215, 131, 255,  91,  36, 137, 155]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
31          1       31       4        32
538         2       31       4       266
740         3       31       4       195
1053        4       31       5       235
1186        5       31       5        95
       user_id  item_id  rating  timestep
12404       46       31       5       120
12738       47       31       5       181
12892       48       31       5        62
13137       49       31       5        34
13462       50       31       4        86
average_rating for this rec across 50 users from same group (less noisy) was: 4.8
all_actions shape just before sample torch.Size([1, 18, 1])
action scaled by temperature: tensor([[22]], device='cuda:0')
action picked by argmax: tensor([225], device='cuda:0')
tensor([[225,  22, 261,  96, 162, 169,  73, 183, 207,  77]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
77          1      226       4        78
291         2      226       4        19
632         3      226       4        87
918         4      226       4       100
1222        5      226       4       131
       user_id  item_id  rating  timestep
12432       46      226       4       148
12672       47      226       5       115
12834       48      226       5         4
13255       49      226       5       152
13415       50      226       4        39
average_rating for this rec across 50 users from same group (less noisy) was: 4.46
all_actions shape just before sample torch.Size([1, 19, 1])
action scaled by temperature: tensor([[210]], device='cuda:0')
action picked by argmax: tensor([48], device='cuda:0')
tensor([[ 48,  89, 231, 139, 191,  97, 181,  37, 172, 169]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
237         1       49       5       238
454         2       49       3       182
599         3       49       4        54
876         4       49       4        58
1320        5       49       4       229
       user_id  item_id  rating  timestep
12370       46       49       3        86
12811       47       49       4       254
13032       48       49       2       202
13179       49       49       3        76
13552       50       49       4       176
average_rating for this rec across 50 users from same group (less noisy) was: 3.92
all_actions shape just before sample torch.Size([1, 20, 1])
action scaled by temperature: tensor([[89]], device='cuda:0')
action picked by argmax: tensor([89], device='cuda:0')
tensor([[ 89,  42, 210,  15,  14,  43, 139, 191,  48, 172]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
108         1       90       4       109
482         2       90       4       210
751         3       90       4       206
1056        4       90       4       238
1114        5       90       4        23
       user_id  item_id  rating  timestep
12495       46       90       5       211
12823       47       90       4       266
13100       48       90       4       270
13366       49       90       4       263
13641       50       90       4       265
average_rating for this rec across 50 users from same group (less noisy) was: 3.88
all_actions shape just before sample torch.Size([1, 21, 1])
action scaled by temperature: tensor([[237]], device='cuda:0')
action picked by argmax: tensor([237], device='cuda:0')
tensor([[237,  97,  14,  19, 229,  89,  63,  83,  43,  35]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
228         1      238       4       229
475         2      238       3       203
719         3      238       3       174
860         4      238       5        42
1166        5      238       5        75
       user_id  item_id  rating  timestep
12462       46      238       3       178
12618       47      238       4        61
13000       48      238       5       170
13192       49      238       3        89
13431       50      238       5        55
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 22, 1])
action scaled by temperature: tensor([[4]], device='cuda:0')
action picked by argmax: tensor([4], device='cuda:0')
tensor([[  4,  43, 209, 103,  51, 210, 134, 109, 172, 178]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
218         1        5       5       219
370         2        5       5        98
649         3        5       5       104
890         4        5       5        72
1333        5        5       5       242
       user_id  item_id  rating  timestep
12447       46        5       5       163
12790       47        5       5       233
12966       48        5       5       136
13353       49        5       5       250
13491       50        5       5       115
average_rating for this rec across 50 users from same group (less noisy) was: 4.82
all_actions shape just before sample torch.Size([1, 23, 1])
action scaled by temperature: tensor([[42]], device='cuda:0')
action picked by argmax: tensor([63], device='cuda:0')
tensor([[ 63,  20, 197, 208, 103,  42, 133, 194, 106, 209]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
227         1       64       5       228
530         2       64       4       258
781         3       64       4       236
1036        4       64       5       218
1148        5       64       5        57
       user_id  item_id  rating  timestep
12401       46       64       3       117
12630       47       64       3        73
12869       48       64       4        39
13138       49       64       5        35
13605       50       64       4       229
average_rating for this rec across 50 users from same group (less noisy) was: 3.82
all_actions shape just before sample torch.Size([1, 24, 1])
action scaled by temperature: tensor([[190]], device='cuda:0')
action picked by argmax: tensor([190], device='cuda:0')
tensor([[190, 192,  42,  20, 209, 108,  24, 160, 252, 265]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
128         1      191       5       129
357         2      191       4        85
609         3      191       4        64
862         4      191       5        44
1319        5      191       4       228
       user_id  item_id  rating  timestep
12515       46      191       5       231
12649       47      191       5        92
12915       48      191       4        85
13130       49      191       5        27
13506       50      191       5       130
average_rating for this rec across 50 users from same group (less noisy) was: 4.48
all_actions shape just before sample torch.Size([1, 25, 1])
action scaled by temperature: tensor([[190]], device='cuda:0')
action picked by argmax: tensor([190], device='cuda:0')
tensor([[190, 192, 108,  24,  42,  20, 160, 181, 145, 265]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
128         1      191       5       129
357         2      191       4        85
609         3      191       4        64
862         4      191       5        44
1319        5      191       4       228
       user_id  item_id  rating  timestep
12515       46      191       5       231
12649       47      191       5        92
12915       48      191       4        85
13130       49      191       5        27
13506       50      191       5       130
average_rating for this rec across 50 users from same group (less noisy) was: 4.48
all_actions shape just before sample torch.Size([1, 26, 1])
action scaled by temperature: tensor([[213]], device='cuda:0')
action picked by argmax: tensor([192], device='cuda:0')
tensor([[192, 190,  42,  24, 181, 213, 160, 108,  20, 109]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
11          1      193       3        12
393         2      193       4       121
628         3      193       5        83
878         4      193       5        60
1325        5      193       4       234
       user_id  item_id  rating  timestep
12327       46      193       3        43
12762       47      193       3       205
12992       48      193       5       162
13129       49      193       5        26
13493       50      193       3       117
average_rating for this rec across 50 users from same group (less noisy) was: 4.14
all_actions shape just before sample torch.Size([1, 27, 1])
action scaled by temperature: tensor([[160]], device='cuda:0')
action picked by argmax: tensor([160], device='cuda:0')
tensor([[160, 109,  64,  24,  42, 172, 252, 190, 265, 145]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
202         1      161       4       203
473         2      161       5       201
806         3      161       4       261
907         4      161       4        89
1158        5      161       5        67
       user_id  item_id  rating  timestep
12310       46      161       4        26
12731       47      161       3       174
12919       48      161       5        89
13203       49      161       3       100
13523       50      161       4       147
average_rating for this rec across 50 users from same group (less noisy) was: 4.24
all_actions shape just before sample torch.Size([1, 28, 1])
action scaled by temperature: tensor([[24]], device='cuda:0')
action picked by argmax: tensor([24], device='cuda:0')
tensor([[ 24,  25,  64,  37,  42, 223, 109, 135,   5,  69]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
50          1       25       5        51
277         2       25       4         5
749         3       25       4       204
1042        4       25       5       224
1232        5       25       5       141
       user_id  item_id  rating  timestep
12295       46       25       5        11
12795       47       25       4       238
13004       48       25       5       174
13315       49       25       4       212
13403       50       25       4        27
average_rating for this rec across 50 users from same group (less noisy) was: 4.68
all_actions shape just before sample torch.Size([1, 29, 1])
action scaled by temperature: tensor([[42]], device='cuda:0')
action picked by argmax: tensor([42], device='cuda:0')
tensor([[ 42,  69,   5,  45,  25, 269,  24,  64,  37, 208]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
208         1       43       2       209
518         2       43       5       246
577         3       43       5        32
981         4       43       4       163
1203        5       43       4       112
       user_id  item_id  rating  timestep
12510       46       43       3       226
12665       47       43       3       108
12896       48       43       5        66
13195       49       43       4        92
13464       50       43       3        88
average_rating for this rec across 50 users from same group (less noisy) was: 3.86
all_actions shape just before sample torch.Size([1, 30, 1])
action scaled by temperature: tensor([[64]], device='cuda:0')
action picked by argmax: tensor([25], device='cuda:0')
tensor([[ 25,  42, 159,   5,  29, 269,  37,  45,  69, 195]], device='cuda:0')
Just recommended 30 new items to 50 users from group 1 and the total rating was 129.52
train_loss is: 1.9018510394989083
action scaled by temperature: tensor([[8]], device='cuda:0')
action picked by argmax: tensor([267], device='cuda:0')
tensor([[267,  83, 180, 185, 252,  20, 238,  24, 151, 233]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
65          1      268       3        66
300         2      268       5        28
748         3      268       2       203
1023        4      268       3       205
1181        5      268       5        90
       user_id  item_id  rating  timestep
12479       46      268       5       195
12730       47      268       5       173
13051       48      268       2       221
13346       49      268       4       243
13556       50      268       3       180
average_rating for this rec across 50 users from same group (less noisy) was: 3.78
all_actions shape just before sample torch.Size([1, 1, 1])
action scaled by temperature: tensor([[249]], device='cuda:0')
action picked by argmax: tensor([257], device='cuda:0')
tensor([[257, 172,  40,  28, 176, 240,  20, 259, 118,  90]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
74          1      258       5        75
383         2      258       4       111
558         3      258       5        13
950         4      258       5       132
1256        5      258       5       165
       user_id  item_id  rating  timestep
12352       46      258       3        68
12721       47      258       5       164
13088       48      258       5       258
13123       49      258       4        20
13444       50      258       5        68
average_rating for this rec across 50 users from same group (less noisy) was: 4.68
all_actions shape just before sample torch.Size([1, 2, 1])
action scaled by temperature: tensor([[238]], device='cuda:0')
action picked by argmax: tensor([120], device='cuda:0')
tensor([[120,  76, 154,  37, 238, 170, 242,  55, 239,  40]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
140         1      121       4       141
340         2      121       4        68
548         3      121       4         3
1028        4      121       4       210
1324        5      121       4       233
       user_id  item_id  rating  timestep
12449       46      121       3       165
12767       47      121       4       210
13025       48      121       4       195
13269       49      121       4       166
13383       50      121       4         7
average_rating for this rec across 50 users from same group (less noisy) was: 4.02
all_actions shape just before sample torch.Size([1, 3, 1])
action scaled by temperature: tensor([[259]], device='cuda:0')
action picked by argmax: tensor([46], device='cuda:0')
tensor([[ 46,  44, 259,  62, 175, 139, 208, 232, 230,  32]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
135         1       47       5       136
350         2       47       5        78
801         3       47       5       256
905         4       47       4        87
1275        5       47       5       184
       user_id  item_id  rating  timestep
12291       46       47       5         7
12594       47       47       4        37
13013       48       47       5       183
13248       49       47       5       145
13569       50       47       5       193
average_rating for this rec across 50 users from same group (less noisy) was: 4.42
all_actions shape just before sample torch.Size([1, 4, 1])
action scaled by temperature: tensor([[63]], device='cuda:0')
action picked by argmax: tensor([206], device='cuda:0')
tensor([[206, 224,   0,   8, 179, 175, 117, 253, 137, 185]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
56          1      207       5        57
362         2      207       4        90
657         3      207       4       112
834         4      207       5        16
1156        5      207       5        65
       user_id  item_id  rating  timestep
12324       46      207       5        40
12751       47      207       3       194
12949       48      207       5       119
13307       49      207       5       204
13412       50      207       4        36
average_rating for this rec across 50 users from same group (less noisy) was: 4.24
all_actions shape just before sample torch.Size([1, 5, 1])
action scaled by temperature: tensor([[179]], device='cuda:0')
action picked by argmax: tensor([179], device='cuda:0')
tensor([[179, 117, 187, 185, 229,  44, 190, 106,  64, 118]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
13          1      180       4        14
477         2      180       5       205
563         3      180       3        18
965         4      180       5       147
1218        5      180       5       127
       user_id  item_id  rating  timestep
12516       46      180       4       232
12671       47      180       5       114
12860       48      180       5        30
13363       49      180       5       260
13433       50      180       5        57
average_rating for this rec across 50 users from same group (less noisy) was: 4.58
all_actions shape just before sample torch.Size([1, 6, 1])
action scaled by temperature: tensor([[109]], device='cuda:0')
action picked by argmax: tensor([109], device='cuda:0')
tensor([[109,  33, 187, 179,  96,  12, 139,  53, 126, 195]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
132         1      110       4       133
472         2      110       5       200
687         3      110       5       142
910         4      110       5        92
1217        5      110       4       126
       user_id  item_id  rating  timestep
12408       46      110       5       124
12729       47      110       5       172
12956       48      110       5       126
13369       49      110       5       266
13458       50      110       5        82
average_rating for this rec across 50 users from same group (less noisy) was: 4.66
all_actions shape just before sample torch.Size([1, 7, 1])
action scaled by temperature: tensor([[109]], device='cuda:0')
action picked by argmax: tensor([109], device='cuda:0')
tensor([[109,  33, 108, 225, 187, 240, 126,  53,  12, 119]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
132         1      110       4       133
472         2      110       5       200
687         3      110       5       142
910         4      110       5        92
1217        5      110       4       126
       user_id  item_id  rating  timestep
12408       46      110       5       124
12729       47      110       5       172
12956       48      110       5       126
13369       49      110       5       266
13458       50      110       5        82
average_rating for this rec across 50 users from same group (less noisy) was: 4.66
all_actions shape just before sample torch.Size([1, 8, 1])
action scaled by temperature: tensor([[109]], device='cuda:0')
action picked by argmax: tensor([109], device='cuda:0')
tensor([[109, 225, 108,  33, 119, 240,  49,  68, 114,  53]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
132         1      110       4       133
472         2      110       5       200
687         3      110       5       142
910         4      110       5        92
1217        5      110       4       126
       user_id  item_id  rating  timestep
12408       46      110       5       124
12729       47      110       5       172
12956       48      110       5       126
13369       49      110       5       266
13458       50      110       5        82
average_rating for this rec across 50 users from same group (less noisy) was: 4.66
all_actions shape just before sample torch.Size([1, 9, 1])
action scaled by temperature: tensor([[225]], device='cuda:0')
action picked by argmax: tensor([225], device='cuda:0')
tensor([[225, 108, 109,  68,  18, 119,  58, 168,  33, 144]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
77          1      226       4        78
291         2      226       4        19
632         3      226       4        87
918         4      226       4       100
1222        5      226       4       131
       user_id  item_id  rating  timestep
12432       46      226       4       148
12672       47      226       5       115
12834       48      226       5         4
13255       49      226       5       152
13415       50      226       4        39
average_rating for this rec across 50 users from same group (less noisy) was: 4.46
all_actions shape just before sample torch.Size([1, 10, 1])
action scaled by temperature: tensor([[178]], device='cuda:0')
action picked by argmax: tensor([114], device='cuda:0')
tensor([[114, 100,  53,  49,  96, 171, 144, 105, 109,  23]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
172         1      115       4       173
527         2      115       4       255
673         3      115       4       128
1006        4      115       5       188
1251        5      115       5       160
       user_id  item_id  rating  timestep
12546       46      115       4       262
12759       47      115       3       202
12890       48      115       5        60
13135       49      115       5        32
13616       50      115       5       240
average_rating for this rec across 50 users from same group (less noisy) was: 4.2
all_actions shape just before sample torch.Size([1, 11, 1])
action scaled by temperature: tensor([[114]], device='cuda:0')
action picked by argmax: tensor([114], device='cuda:0')
tensor([[114,  53, 100,  96,  49,  23, 144, 182,  55, 167]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
172         1      115       4       173
527         2      115       4       255
673         3      115       4       128
1006        4      115       5       188
1251        5      115       5       160
       user_id  item_id  rating  timestep
12546       46      115       4       262
12759       47      115       3       202
12890       48      115       5        60
13135       49      115       5        32
13616       50      115       5       240
average_rating for this rec across 50 users from same group (less noisy) was: 4.2
all_actions shape just before sample torch.Size([1, 12, 1])
action scaled by temperature: tensor([[53]], device='cuda:0')
action picked by argmax: tensor([53], device='cuda:0')
tensor([[ 53, 100, 114,  26, 223, 167, 157,  49, 144, 152]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
235         1       54       5       236
536         2       54       4       264
645         3       54       5       100
1050        4       54       4       232
1197        5       54       4       106
       user_id  item_id  rating  timestep
12353       46       54       5        69
12559       47       54       4         2
12978       48       54       4       148
13283       49       54       3       180
13424       50       54       3        48
average_rating for this rec across 50 users from same group (less noisy) was: 3.88
all_actions shape just before sample torch.Size([1, 13, 1])
action scaled by temperature: tensor([[26]], device='cuda:0')
action picked by argmax: tensor([26], device='cuda:0')
tensor([[ 26, 152, 223, 100, 157, 246, 204, 114,  20,  60]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
55          1       27       4        56
387         2       27       4       115
795         3       27       4       250
1011        4       27       5       193
1266        5       27       4       175
       user_id  item_id  rating  timestep
12433       46       27       4       149
12635       47       27       5        78
12969       48       27       4       139
13275       49       27       5       172
13544       50       27       5       168
average_rating for this rec across 50 users from same group (less noisy) was: 4.36
all_actions shape just before sample torch.Size([1, 14, 1])
action scaled by temperature: tensor([[255]], device='cuda:0')
action picked by argmax: tensor([223], device='cuda:0')
tensor([[223, 255,   2,  63,  53,  60, 246, 227,  62,  20]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
194         1      224       4       195
511         2      224       4       239
726         3      224       5       181
861         4      224       4        43
1145        5      224       5        54
       user_id  item_id  rating  timestep
12371       46      224       5        87
12578       47      224       5        21
12946       48      224       4       116
13334       49      224       5       231
13417       50      224       4        41
average_rating for this rec across 50 users from same group (less noisy) was: 4.4
all_actions shape just before sample torch.Size([1, 15, 1])
action scaled by temperature: tensor([[36]], device='cuda:0')
action picked by argmax: tensor([178], device='cuda:0')
tensor([[178, 255, 156,  44, 181, 154,  74, 120, 125,  60]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
176         1      179       4       177
372         2      179       5       100
551         3      179       5         6
821         4      179       4         3
1183        5      179       4        92
       user_id  item_id  rating  timestep
12511       46      179       4       227
12697       47      179       5       140
12871       48      179       5        41
13208       49      179       5       105
13632       50      179       4       256
average_rating for this rec across 50 users from same group (less noisy) was: 4.48
all_actions shape just before sample torch.Size([1, 16, 1])
action scaled by temperature: tensor([[173]], device='cuda:0')
action picked by argmax: tensor([60], device='cuda:0')
tensor([[ 60, 173,  84,  51, 255, 242, 125,  69,  73, 261]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
107         1       61       5       108
402         2       61       5       130
784         3       61       5       239
904         4       61       5        86
1135        5       61       4        44
       user_id  item_id  rating  timestep
12522       46       61       5       238
12713       47       61       4       156
12883       48       61       3        53
13153       49       61       5        50
13536       50       61       5       160
average_rating for this rec across 50 users from same group (less noisy) was: 4.38
all_actions shape just before sample torch.Size([1, 17, 1])
action scaled by temperature: tensor([[60]], device='cuda:0')
action picked by argmax: tensor([173], device='cuda:0')
tensor([[173,  84,  60,  51, 242, 171,  83,  54, 246, 211]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
214         1      174       4       215
281         2      174       4         9
741         3      174       4       196
896         4      174       5        78
1116        5      174       4        25
       user_id  item_id  rating  timestep
12288       46      174       4         4
12807       47      174       4       250
13007       48      174       5       177
13168       49      174       4        65
13478       50      174       5       102
average_rating for this rec across 50 users from same group (less noisy) was: 4.2
all_actions shape just before sample torch.Size([1, 18, 1])
action scaled by temperature: tensor([[84]], device='cuda:0')
action picked by argmax: tensor([84], device='cuda:0')
tensor([[ 84, 240, 261, 254,   9,  13,  79,  30, 228, 105]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
238         1       85       4       239
289         2       85       5        17
802         3       85       4       257
1069        4       85       5       251
1306        5       85       5       215
       user_id  item_id  rating  timestep
12403       46       85       3       119
12623       47       85       5        66
13082       48       85       4       252
13218       49       85       5       115
13630       50       85       4       254
average_rating for this rec across 50 users from same group (less noisy) was: 3.82
all_actions shape just before sample torch.Size([1, 19, 1])
action scaled by temperature: tensor([[13]], device='cuda:0')
action picked by argmax: tensor([13], device='cuda:0')
tensor([[ 13, 240,  11,  84, 145,  73, 261,  18, 254, 133]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
265         1       14       5       266
319         2       14       5        47
782         3       14       4       237
1043        4       14       4       225
1336        5       14       5       245
       user_id  item_id  rating  timestep
12497       46       14       4       213
12794       47       14       5       237
13093       48       14       4       263
13293       49       14       5       190
13396       50       14       5        20
average_rating for this rec across 50 users from same group (less noisy) was: 4.64
all_actions shape just before sample torch.Size([1, 20, 1])
action scaled by temperature: tensor([[11]], device='cuda:0')
action picked by argmax: tensor([11], device='cuda:0')
tensor([[ 11, 145, 133, 247,  67, 225, 240, 216,  62, 251]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
28          1       12       4        29
466         2       12       3       194
765         3       12       5       220
845         4       12       5        27
1207        5       12       3       116
       user_id  item_id  rating  timestep
12471       46       12       4       187
12693       47       12       5       136
12980       48       12       4       150
13184       49       12       3        81
13608       50       12       4       232
average_rating for this rec across 50 users from same group (less noisy) was: 3.7
all_actions shape just before sample torch.Size([1, 21, 1])
action scaled by temperature: tensor([[56]], device='cuda:0')
action picked by argmax: tensor([56], device='cuda:0')
tensor([[ 56,  84,  95, 180, 222,   7, 187,  88, 100, 135]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
136         1       57       3       137
486         2       57       3       214
624         3       57       5        79
937         4       57       5       119
1128        5       57       5        37
       user_id  item_id  rating  timestep
12472       46       57       5       188
12796       47       57       5       239
12920       48       57       3        90
13311       49       57       3       208
13416       50       57       4        40
average_rating for this rec across 50 users from same group (less noisy) was: 4.14
all_actions shape just before sample torch.Size([1, 22, 1])
action scaled by temperature: tensor([[213]], device='cuda:0')
action picked by argmax: tensor([213], device='cuda:0')
tensor([[213,  97,  32, 135,  83, 173, 240,  84, 231, 252]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
20          1      214       4        21
346         2      214       4        74
771         3      214       5       226
830         4      214       4        12
1348        5      214       4       257
       user_id  item_id  rating  timestep
12303       46      214       5        19
12776       47      214       5       219
12942       48      214       3       112
13250       49      214       3       147
13409       50      214       5        33
average_rating for this rec across 50 users from same group (less noisy) was: 4.12
all_actions shape just before sample torch.Size([1, 23, 1])
action scaled by temperature: tensor([[97]], device='cuda:0')
action picked by argmax: tensor([97], device='cuda:0')
tensor([[ 97, 213,  29,  86,  32, 207,  96, 152, 153,  15]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
174         1       98       4       175
414         2       98       4       142
681         3       98       2       136
941         4       98       3       123
1120        5       98       3        29
       user_id  item_id  rating  timestep
12465       46       98       4       181
12789       47       98       3       232
13078       48       98       4       248
13292       49       98       4       189
13565       50       98       4       189
average_rating for this rec across 50 users from same group (less noisy) was: 3.52
all_actions shape just before sample torch.Size([1, 24, 1])
action scaled by temperature: tensor([[32]], device='cuda:0')
action picked by argmax: tensor([32], device='cuda:0')
tensor([[ 32,  51, 236, 102,  86, 224,  41, 213, 231, 252]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
117         1       33       3       118
463         2       33       2       191
738         3       33       2       193
837         4       33       5        19
1267        5       33       3       176
       user_id  item_id  rating  timestep
12454       46       33       4       170
12590       47       33       4        33
12848       48       33       4        18
13360       49       33       4       257
13418       50       33       5        42
average_rating for this rec across 50 users from same group (less noisy) was: 3.6
all_actions shape just before sample torch.Size([1, 25, 1])
action scaled by temperature: tensor([[112]], device='cuda:0')
action picked by argmax: tensor([112], device='cuda:0')
tensor([[112, 272, 111, 105,  30, 102, 234, 124, 202,   9]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
229         1      113       5       230
305         2      113       3        33
611         3      113       3        66
1032        4      113       5       214
1356        5      113       4       265
       user_id  item_id  rating  timestep
12513       46      113       5       229
12828       47      113       3       271
12843       48      113       1        13
13169       49      113       4        66
13472       50      113       4        96
average_rating for this rec across 50 users from same group (less noisy) was: 3.62
all_actions shape just before sample torch.Size([1, 26, 1])
action scaled by temperature: tensor([[263]], device='cuda:0')
action picked by argmax: tensor([263], device='cuda:0')
tensor([[263,  25, 183,  42,  32,  28,  17, 118,  43, 175]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
24          1      264       4        25
491         2      264       3       219
715         3      264       3       170
1039        4      264       5       221
1334        5      264       4       243
       user_id  item_id  rating  timestep
12302       46      264       5        18
12567       47      264       4        10
12976       48      264       4       146
13241       49      264       4       138
13515       50      264       5       139
average_rating for this rec across 50 users from same group (less noisy) was: 4.42
all_actions shape just before sample torch.Size([1, 27, 1])
action scaled by temperature: tensor([[28]], device='cuda:0')
action picked by argmax: tensor([25], device='cuda:0')
tensor([[ 25,  28, 263,  42, 153, 187,  17, 183, 227, 111]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
134         1       26       4       135
413         2       26       3       141
576         3       26       5        31
1087        4       26       5       269
1287        5       26       3       196
       user_id  item_id  rating  timestep
12487       46       26       5       203
12611       47       26       5        54
12983       48       26       5       153
13149       49       26       5        46
13625       50       26       4       249
average_rating for this rec across 50 users from same group (less noisy) was: 4.36
all_actions shape just before sample torch.Size([1, 28, 1])
action scaled by temperature: tensor([[42]], device='cuda:0')
action picked by argmax: tensor([42], device='cuda:0')
tensor([[ 42,  28,  25, 172, 263, 124, 250, 183, 255, 147]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
208         1       43       2       209
518         2       43       5       246
577         3       43       5        32
981         4       43       4       163
1203        5       43       4       112
       user_id  item_id  rating  timestep
12510       46       43       3       226
12665       47       43       3       108
12896       48       43       5        66
13195       49       43       4        92
13464       50       43       3        88
average_rating for this rec across 50 users from same group (less noisy) was: 3.86
all_actions shape just before sample torch.Size([1, 29, 1])
action scaled by temperature: tensor([[235]], device='cuda:0')
action picked by argmax: tensor([42], device='cuda:0')
tensor([[ 42, 147,  87,  25, 144, 235,  10, 212, 183, 187]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
208         1       43       2       209
518         2       43       5       246
577         3       43       5        32
981         4       43       4       163
1203        5       43       4       112
       user_id  item_id  rating  timestep
12510       46       43       3       226
12665       47       43       3       108
12896       48       43       5        66
13195       49       43       4        92
13464       50       43       3        88
average_rating for this rec across 50 users from same group (less noisy) was: 3.86
all_actions shape just before sample torch.Size([1, 30, 1])
action scaled by temperature: tensor([[144]], device='cuda:0')
action picked by argmax: tensor([144], device='cuda:0')
tensor([[144,  87, 147,  29,  10,  25, 261,  20, 235,  36]], device='cuda:0')
Just recommended 30 new items to 50 users from group 1 and the total rating was 125.92000000000002
train_loss is: 1.4825113587183496
action scaled by temperature: tensor([[40]], device='cuda:0')
action picked by argmax: tensor([30], device='cuda:0')
tensor([[ 30,  83, 110, 165, 205,  38, 180, 105, 167, 196]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
31          1       31       4        32
538         2       31       4       266
740         3       31       4       195
1053        4       31       5       235
1186        5       31       5        95
       user_id  item_id  rating  timestep
12404       46       31       5       120
12738       47       31       5       181
12892       48       31       5        62
13137       49       31       5        34
13462       50       31       4        86
average_rating for this rec across 50 users from same group (less noisy) was: 4.8
all_actions shape just before sample torch.Size([1, 1, 1])
action scaled by temperature: tensor([[128]], device='cuda:0')
action picked by argmax: tensor([48], device='cuda:0')
tensor([[ 48, 186, 139,  89, 180, 123, 170, 252, 183, 101]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
237         1       49       5       238
454         2       49       3       182
599         3       49       4        54
876         4       49       4        58
1320        5       49       4       229
       user_id  item_id  rating  timestep
12370       46       49       3        86
12811       47       49       4       254
13032       48       49       2       202
13179       49       49       3        76
13552       50       49       4       176
average_rating for this rec across 50 users from same group (less noisy) was: 3.92
all_actions shape just before sample torch.Size([1, 2, 1])
action scaled by temperature: tensor([[43]], device='cuda:0')
action picked by argmax: tensor([174], device='cuda:0')
tensor([[174,  89,  51, 252, 180,  64,  28, 236, 183, 147]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
215         1      175       5       216
403         2      175       3       131
698         3      175       5       153
1024        4      175       5       206
1243        5      175       4       152
       user_id  item_id  rating  timestep
12292       46      175       4         8
12752       47      175       4       195
13084       48      175       5       254
13258       49      175       5       155
13595       50      175       4       219
average_rating for this rec across 50 users from same group (less noisy) was: 4.58
all_actions shape just before sample torch.Size([1, 3, 1])
action scaled by temperature: tensor([[111]], device='cuda:0')
action picked by argmax: tensor([105], device='cuda:0')
tensor([[105,  43, 244, 157,  28, 172,  62, 167, 235, 221]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
151         1      106       4       152
453         2      106       4       181
605         3      106       5        60
1071        4      106       2       253
1228        5      106       3       137
       user_id  item_id  rating  timestep
12389       46      106       4       105
12808       47      106       4       251
12996       48      106       4       166
13279       49      106       4       176
13559       50      106       5       183
average_rating for this rec across 50 users from same group (less noisy) was: 4.14
all_actions shape just before sample torch.Size([1, 4, 1])
action scaled by temperature: tensor([[178]], device='cuda:0')
action picked by argmax: tensor([178], device='cuda:0')
tensor([[178, 268,  56,   2,  36,  81, 117, 114,  51,  80]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
176         1      179       4       177
372         2      179       5       100
551         3      179       5         6
821         4      179       4         3
1183        5      179       4        92
       user_id  item_id  rating  timestep
12511       46      179       4       227
12697       47      179       5       140
12871       48      179       5        41
13208       49      179       5       105
13632       50      179       4       256
average_rating for this rec across 50 users from same group (less noisy) was: 4.48
all_actions shape just before sample torch.Size([1, 5, 1])
action scaled by temperature: tensor([[178]], device='cuda:0')
action picked by argmax: tensor([24], device='cuda:0')
tensor([[ 24,   0,  36, 178,  66, 222, 235, 243, 136, 226]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
50          1       25       5        51
277         2       25       4         5
749         3       25       4       204
1042        4       25       5       224
1232        5       25       5       141
       user_id  item_id  rating  timestep
12295       46       25       5        11
12795       47       25       4       238
13004       48       25       5       174
13315       49       25       4       212
13403       50       25       4        27
average_rating for this rec across 50 users from same group (less noisy) was: 4.68
all_actions shape just before sample torch.Size([1, 6, 1])
action scaled by temperature: tensor([[6]], device='cuda:0')
action picked by argmax: tensor([6], device='cuda:0')
tensor([[  6, 102, 203,  87, 235, 251, 244, 226,   2,  91]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
82          1        7       4        83
388         2        7       4       116
811         3        7       4       266
990         4        7       4       172
1154        5        7       3        63
       user_id  item_id  rating  timestep
12491       46        7       3       207
12722       47        7       4       165
13002       48        7       5       172
13104       49        7       4         1
13378       50        7       5         2
average_rating for this rec across 50 users from same group (less noisy) was: 3.68
all_actions shape just before sample torch.Size([1, 7, 1])
action scaled by temperature: tensor([[102]], device='cuda:0')
action picked by argmax: tensor([102], device='cuda:0')
tensor([[102, 203,  91,   6, 189, 226,   2, 164, 176, 106]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
248         1      103       5       249
398         2      103       4       126
585         3      103       5        40
1009        4      103       5       191
1127        5      103       5        36
       user_id  item_id  rating  timestep
12388       46      103       5       104
12771       47      103       5       214
12958       48      103       5       128
13158       49      103       5        55
13411       50      103       4        35
average_rating for this rec across 50 users from same group (less noisy) was: 4.64
all_actions shape just before sample torch.Size([1, 8, 1])
action scaled by temperature: tensor([[235]], device='cuda:0')
action picked by argmax: tensor([235], device='cuda:0')
tensor([[235,  76, 237, 178,  63, 203, 210, 160, 250, 267]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
57          1      236       5        58
392         2      236       4       120
770         3      236       4       225
825         4      236       5         7
1151        5      236       4        60
       user_id  item_id  rating  timestep
12321       46      236       3        37
12669       47      236       5       112
12940       48      236       3       110
13113       49      236       4        10
13638       50      236       3       262
average_rating for this rec across 50 users from same group (less noisy) was: 4.26
all_actions shape just before sample torch.Size([1, 9, 1])
action scaled by temperature: tensor([[160]], device='cuda:0')
action picked by argmax: tensor([160], device='cuda:0')
tensor([[160,  99, 233,  37,  76,  50, 214, 139, 192,  61]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
202         1      161       4       203
473         2      161       5       201
806         3      161       4       261
907         4      161       4        89
1158        5      161       5        67
       user_id  item_id  rating  timestep
12310       46      161       4        26
12731       47      161       3       174
12919       48      161       5        89
13203       49      161       3       100
13523       50      161       4       147
average_rating for this rec across 50 users from same group (less noisy) was: 4.24
all_actions shape just before sample torch.Size([1, 10, 1])
action scaled by temperature: tensor([[221]], device='cuda:0')
action picked by argmax: tensor([221], device='cuda:0')
tensor([[221, 117, 250,  17, 268,  67,  10, 135,  23, 225]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
211         1      222       4       212
390         2      222       2       118
597         3      222       5        52
1001        4      222       4       183
1353        5      222       4       262
       user_id  item_id  rating  timestep
12434       46      222       4       150
12801       47      222       4       244
12884       48      222       3        54
13211       49      222       5       108
13394       50      222       5        18
average_rating for this rec across 50 users from same group (less noisy) was: 4.2
all_actions shape just before sample torch.Size([1, 11, 1])
action scaled by temperature: tensor([[235]], device='cuda:0')
action picked by argmax: tensor([235], device='cuda:0')
tensor([[235, 250,  19, 268,  10, 246, 156, 135,  54,  38]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
57          1      236       5        58
392         2      236       4       120
770         3      236       4       225
825         4      236       5         7
1151        5      236       4        60
       user_id  item_id  rating  timestep
12321       46      236       3        37
12669       47      236       5       112
12940       48      236       3       110
13113       49      236       4        10
13638       50      236       3       262
average_rating for this rec across 50 users from same group (less noisy) was: 4.26
all_actions shape just before sample torch.Size([1, 12, 1])
action scaled by temperature: tensor([[250]], device='cuda:0')
action picked by argmax: tensor([250], device='cuda:0')
tensor([[250,  19, 235,  24, 135, 246, 221, 157,  38,  10]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
22          1      251       5        23
442         2      251       4       170
691         3      251       3       146
846         4      251       3        28
1092        5      251       4         1
       user_id  item_id  rating  timestep
12533       46      251       5       249
12709       47      251       5       152
13094       48      251       4       264
13262       49      251       2       159
13395       50      251       4        19
average_rating for this rec across 50 users from same group (less noisy) was: 3.88
all_actions shape just before sample torch.Size([1, 13, 1])
action scaled by temperature: tensor([[250]], device='cuda:0')
action picked by argmax: tensor([250], device='cuda:0')
tensor([[250,  19,  24, 235, 135, 246, 221, 157,  18,  38]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
22          1      251       5        23
442         2      251       4       170
691         3      251       3       146
846         4      251       3        28
1092        5      251       4         1
       user_id  item_id  rating  timestep
12533       46      251       5       249
12709       47      251       5       152
13094       48      251       4       264
13262       49      251       2       159
13395       50      251       4        19
average_rating for this rec across 50 users from same group (less noisy) was: 3.88
all_actions shape just before sample torch.Size([1, 14, 1])
action scaled by temperature: tensor([[19]], device='cuda:0')
action picked by argmax: tensor([19], device='cuda:0')
tensor([[ 19, 250,  24,  37,  18, 135, 213, 221,  51, 106]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
216         1       20       5       217
314         2       20       4        42
634         3       20       5        89
956         4       20       5       138
1316        5       20       3       225
       user_id  item_id  rating  timestep
12535       46       20       5       251
12580       47       20       5        23
12889       48       20       5        59
13188       49       20       4        85
13439       50       20       4        63
average_rating for this rec across 50 users from same group (less noisy) was: 4.56
all_actions shape just before sample torch.Size([1, 15, 1])
action scaled by temperature: tensor([[24]], device='cuda:0')
action picked by argmax: tensor([24], device='cuda:0')
tensor([[ 24,  18,  19, 197, 229, 135, 250, 252, 266, 235]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
50          1       25       5        51
277         2       25       4         5
749         3       25       4       204
1042        4       25       5       224
1232        5       25       5       141
       user_id  item_id  rating  timestep
12295       46       25       5        11
12795       47       25       4       238
13004       48       25       5       174
13315       49       25       4       212
13403       50       25       4        27
average_rating for this rec across 50 users from same group (less noisy) was: 4.68
all_actions shape just before sample torch.Size([1, 16, 1])
action scaled by temperature: tensor([[18]], device='cuda:0')
action picked by argmax: tensor([18], device='cuda:0')
tensor([[ 18,  37, 266, 159, 200,  19,  74, 126,  66,  68]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
84          1       19       4        85
507         2       19       5       235
684         3       19       5       139
851         4       19       5        33
1163        5       19       5        72
       user_id  item_id  rating  timestep
12466       46       19       4       182
12792       47       19       5       235
13089       48       19       4       259
13200       49       19       4        97
13586       50       19       3       210
average_rating for this rec across 50 users from same group (less noisy) was: 4.42
all_actions shape just before sample torch.Size([1, 17, 1])
action scaled by temperature: tensor([[37]], device='cuda:0')
action picked by argmax: tensor([37], device='cuda:0')
tensor([[ 37, 266,  66,  18,  19,   7,  30, 144, 126, 196]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
118         1       38       3       119
455         2       38       2       183
757         3       38       5       212
856         4       38       4        38
1253        5       38       5       162
       user_id  item_id  rating  timestep
12320       46       38       2        36
12622       47       38       3        65
13068       48       38       3       238
13336       49       38       3       233
13466       50       38       5        90
average_rating for this rec across 50 users from same group (less noisy) was: 3.36
all_actions shape just before sample torch.Size([1, 18, 1])
action scaled by temperature: tensor([[266]], device='cuda:0')
action picked by argmax: tensor([266], device='cuda:0')
tensor([[266,  37, 229, 144, 126, 106, 257,   9, 252, 143]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
71          1      267       5        72
328         2      267       5        56
672         3      267       5       127
1022        4      267       5       204
1335        5      267       5       244
       user_id  item_id  rating  timestep
12387       46      267       5       103
12633       47      267       4        76
13003       48      267       5       173
13204       49      267       5       101
13626       50      267       5       250
average_rating for this rec across 50 users from same group (less noisy) was: 4.78
all_actions shape just before sample torch.Size([1, 19, 1])
action scaled by temperature: tensor([[229]], device='cuda:0')
action picked by argmax: tensor([229], device='cuda:0')
tensor([[229,  44,  18, 194,  25, 106, 252, 211, 144, 265]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
143         1      230       5       144
331         2      230       4        59
658         3      230       4       113
820         4      230       4         2
1142        5      230       5        51
       user_id  item_id  rating  timestep
12397       46      230       5       113
12599       47      230       4        42
12963       48      230       4       133
13314       49      230       5       211
13423       50      230       5        47
average_rating for this rec across 50 users from same group (less noisy) was: 4.24
all_actions shape just before sample torch.Size([1, 20, 1])
action scaled by temperature: tensor([[44]], device='cuda:0')
action picked by argmax: tensor([44], device='cuda:0')
tensor([[ 44,  74,  18, 156, 121, 166, 229,  39,  48, 108]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
223         1       45       4       224
337         2       45       4        65
608         3       45       3        63
931         4       45       3       113
1241        5       45       4       150
       user_id  item_id  rating  timestep
12328       46       45       4        44
12737       47       45       4       180
13058       48       45       3       228
13244       49       45       4       141
13631       50       45       3       255
average_rating for this rec across 50 users from same group (less noisy) was: 3.84
all_actions shape just before sample torch.Size([1, 21, 1])
action scaled by temperature: tensor([[237]], device='cuda:0')
action picked by argmax: tensor([237], device='cuda:0')
tensor([[237,  73, 115, 177,  30, 170, 213,   6, 102,  17]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
228         1      238       4       229
475         2      238       3       203
719         3      238       3       174
860         4      238       5        42
1166        5      238       5        75
       user_id  item_id  rating  timestep
12462       46      238       3       178
12618       47      238       4        61
13000       48      238       5       170
13192       49      238       3        89
13431       50      238       5        55
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 22, 1])
action scaled by temperature: tensor([[228]], device='cuda:0')
action picked by argmax: tensor([6], device='cuda:0')
tensor([[  6, 228, 202,  90, 205,   7, 115,  64, 109, 102]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
82          1        7       4        83
388         2        7       4       116
811         3        7       4       266
990         4        7       4       172
1154        5        7       3        63
       user_id  item_id  rating  timestep
12491       46        7       3       207
12722       47        7       4       165
13002       48        7       5       172
13104       49        7       4         1
13378       50        7       5         2
average_rating for this rec across 50 users from same group (less noisy) was: 3.68
all_actions shape just before sample torch.Size([1, 23, 1])
action scaled by temperature: tensor([[228]], device='cuda:0')
action picked by argmax: tensor([228], device='cuda:0')
tensor([[228, 154, 109,   6, 188, 132, 202,   5,  37,  84]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
10          1      229       5        11
339         2      229       4        67
731         3      229       4       186
831         4      229       4        13
1129        5      229       4        38
       user_id  item_id  rating  timestep
12527       46      229       5       243
12747       47      229       5       190
12891       48      229       4        61
13281       49      229       5       178
13513       50      229       4       137
average_rating for this rec across 50 users from same group (less noisy) was: 4.32
all_actions shape just before sample torch.Size([1, 24, 1])
action scaled by temperature: tensor([[132]], device='cuda:0')
action picked by argmax: tensor([6], device='cuda:0')
tensor([[  6,  84, 120,  58, 154, 132, 237, 213, 201,  77]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
82          1        7       4        83
388         2        7       4       116
811         3        7       4       266
990         4        7       4       172
1154        5        7       3        63
       user_id  item_id  rating  timestep
12491       46        7       3       207
12722       47        7       4       165
13002       48        7       5       172
13104       49        7       4         1
13378       50        7       5         2
average_rating for this rec across 50 users from same group (less noisy) was: 3.68
all_actions shape just before sample torch.Size([1, 25, 1])
action scaled by temperature: tensor([[154]], device='cuda:0')
action picked by argmax: tensor([154], device='cuda:0')
tensor([[154,  58,  84, 116,   9, 253,  95,  13, 181,  82]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
249         1      155       5       250
345         2      155       2        73
697         3      155       4       152
819         4      155       4         1
1100        5      155       3         9
       user_id  item_id  rating  timestep
12437       46      155       2       153
12774       47      155       4       217
13033       48      155       3       203
13343       49      155       4       240
13482       50      155       3       106
average_rating for this rec across 50 users from same group (less noisy) was: 3.44
all_actions shape just before sample torch.Size([1, 26, 1])
action scaled by temperature: tensor([[58]], device='cuda:0')
action picked by argmax: tensor([58], device='cuda:0')
tensor([[ 58,  89, 253, 120, 116, 242,  82,  84,  99, 154]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
40          1       59       4        41
309         2       59       4        37
622         3       59       4        77
1063        4       59       3       245
1144        5       59       4        53
       user_id  item_id  rating  timestep
12484       46       59       4       200
12757       47       59       4       200
12968       48       59       4       138
13243       49       59       4       140
13594       50       59       4       218
average_rating for this rec across 50 users from same group (less noisy) was: 4.16
all_actions shape just before sample torch.Size([1, 27, 1])
action scaled by temperature: tensor([[84]], device='cuda:0')
action picked by argmax: tensor([84], device='cuda:0')
tensor([[ 84,  33, 119,  89, 151,  54,  18, 187,  99, 138]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
238         1       85       4       239
289         2       85       5        17
802         3       85       4       257
1069        4       85       5       251
1306        5       85       5       215
       user_id  item_id  rating  timestep
12403       46       85       3       119
12623       47       85       5        66
13082       48       85       4       252
13218       49       85       5       115
13630       50       85       4       254
average_rating for this rec across 50 users from same group (less noisy) was: 3.82
all_actions shape just before sample torch.Size([1, 28, 1])
action scaled by temperature: tensor([[69]], device='cuda:0')
action picked by argmax: tensor([69], device='cuda:0')
tensor([[ 69,  62,  89,  30, 178, 114,  16,  18, 181, 156]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
72          1       70       4        73
282         2       70       2        10
591         3       70       5        46
949         4       70       3       131
1329        5       70       3       238
       user_id  item_id  rating  timestep
12414       46       70       5       130
12691       47       70       4       134
12894       48       70       5        64
13323       49       70       5       220
13404       50       70       4        28
average_rating for this rec across 50 users from same group (less noisy) was: 4.08
all_actions shape just before sample torch.Size([1, 29, 1])
action scaled by temperature: tensor([[36]], device='cuda:0')
action picked by argmax: tensor([36], device='cuda:0')
tensor([[ 36,  69,   4,  95,  81, 189, 164, 251,  66,  13]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
201         1       37       2       202
424         2       37       5       152
565         3       37       4        20
1025        4       37       3       207
1221        5       37       4       130
       user_id  item_id  rating  timestep
12390       46       37       4       106
12575       47       37       4        18
13059       48       37       4       229
13368       49       37       5       265
13436       50       37       3        60
average_rating for this rec across 50 users from same group (less noisy) was: 3.72
all_actions shape just before sample torch.Size([1, 30, 1])
action scaled by temperature: tensor([[218]], device='cuda:0')
action picked by argmax: tensor([218], device='cuda:0')
tensor([[218,  28, 197, 131,  56,  45, 113,  74,  64, 152]], device='cuda:0')
Just recommended 30 new items to 50 users from group 1 and the total rating was 124.48
train_loss is: 1.1576772299531388
action scaled by temperature: tensor([[52]], device='cuda:0')
action picked by argmax: tensor([83], device='cuda:0')
tensor([[ 83,  38, 101, 233, 267, 200, 169, 196,  30, 215]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
255         1       84       3       256
303         2       84       5        31
754         3       84       4       209
850         4       84       4        32
1230        5       84       5       139
       user_id  item_id  rating  timestep
12517       46       84       4       233
12799       47       84       5       242
12936       48       84       5       106
13329       49       84       5       226
13635       50       84       4       259
average_rating for this rec across 50 users from same group (less noisy) was: 4.2
all_actions shape just before sample torch.Size([1, 1, 1])
action scaled by temperature: tensor([[251]], device='cuda:0')
action picked by argmax: tensor([133], device='cuda:0')
tensor([[133, 127,  32, 225, 213,  42,  10,   4, 261,  13]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
247         1      134       3       248
412         2      134       4       140
728         3      134       3       183
1048        4      134       4       230
1308        5      134       4       217
       user_id  item_id  rating  timestep
12383       46      134       4        99
12702       47      134       5       145
12872       48      134       4        42
13298       49      134       5       195
13645       50      134       5       269
average_rating for this rec across 50 users from same group (less noisy) was: 4.32
all_actions shape just before sample torch.Size([1, 2, 1])
action scaled by temperature: tensor([[79]], device='cuda:0')
action picked by argmax: tensor([196], device='cuda:0')
tensor([[196,  94, 110,  55, 157,  17, 183, 198,  97, 271]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
98          1      197       3        99
369         2      197       4        97
729         3      197       3       184
867         4      197       5        49
1109        5      197       4        18
       user_id  item_id  rating  timestep
12311       46      197       2        27
12645       47      197       4        88
13014       48      197       3       184
13119       49      197       1        16
13636       50      197       3       260
average_rating for this rec across 50 users from same group (less noisy) was: 3.28
all_actions shape just before sample torch.Size([1, 3, 1])
action scaled by temperature: tensor([[127]], device='cuda:0')
action picked by argmax: tensor([220], device='cuda:0')
tensor([[220,  18, 165, 237, 118, 126, 217, 175, 206,  79]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
225         1      221       4       226
380         2      221       4       108
549         3      221       4         4
854         4      221       4        36
1188        5      221       5        97
       user_id  item_id  rating  timestep
12421       46      221       3       137
12641       47      221       4        84
13072       48      221       4       242
13351       49      221       5       248
13455       50      221       4        79
average_rating for this rec across 50 users from same group (less noisy) was: 4.16
all_actions shape just before sample torch.Size([1, 4, 1])
action scaled by temperature: tensor([[75]], device='cuda:0')
action picked by argmax: tensor([23], device='cuda:0')
tensor([[ 23, 134, 165, 103,   0, 118,  18, 161, 121,  75]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
122         1       24       4       123
389         2       24       5       117
666         3       24       3       121
871         4       24       5        53
1330        5       24       5       239
       user_id  item_id  rating  timestep
12339       46       24       4        55
12640       47       24       4        83
12930       48       24       3       100
13266       49       24       5       163
13582       50       24       4       206
average_rating for this rec across 50 users from same group (less noisy) was: 3.84
all_actions shape just before sample torch.Size([1, 5, 1])
action scaled by temperature: tensor([[0]], device='cuda:0')
action picked by argmax: tensor([0], device='cuda:0')
tensor([[  0, 165, 121, 134, 206,  44, 208, 160,  96, 213]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
62          1        1       4        63
522         2        1       5       250
671         3        1       4       126
892         4        1       4        74
1204        5        1       5       113
       user_id  item_id  rating  timestep
12375       46        1       5        91
12816       47        1       5       259
13045       48        1       4       215
13375       49        1       5       272
13542       50        1       5       166
average_rating for this rec across 50 users from same group (less noisy) was: 4.66
all_actions shape just before sample torch.Size([1, 6, 1])
action scaled by temperature: tensor([[252]], device='cuda:0')
action picked by argmax: tensor([252], device='cuda:0')
tensor([[252, 204, 240,  59, 238, 152, 233,   0,  22,  27]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
53          1      253       5        54
325         2      253       5        53
761         3      253       5       216
1068        4      253       5       250
1176        5      253       5        85
       user_id  item_id  rating  timestep
12446       46      253       5       162
12791       47      253       5       234
13019       48      253       5       189
13220       49      253       5       117
13580       50      253       5       204
average_rating for this rec across 50 users from same group (less noisy) was: 4.7
all_actions shape just before sample torch.Size([1, 7, 1])
action scaled by temperature: tensor([[81]], device='cuda:0')
action picked by argmax: tensor([81], device='cuda:0')
tensor([[ 81, 113, 255,  56, 235,  42, 231, 123,  37, 170]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
68          1       82       5        69
540         2       82       5       268
688         3       82       4       143
963         4       82       5       145
1140        5       82       4        49
       user_id  item_id  rating  timestep
12345       46       82       4        61
12570       47       82       4        13
12926       48       82       5        96
13162       49       82       4        59
13379       50       82       4         3
average_rating for this rec across 50 users from same group (less noisy) was: 4.44
all_actions shape just before sample torch.Size([1, 8, 1])
action scaled by temperature: tensor([[113]], device='cuda:0')
action picked by argmax: tensor([113], device='cuda:0')
tensor([[113, 255,  81, 178,  97, 256, 170,  86, 235, 231]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
109         1      114       4       110
324         2      114       3        52
744         3      114       4       199
920         4      114       5       102
1160        5      114       5        69
       user_id  item_id  rating  timestep
12470       46      114       3       186
12608       47      114       4        51
13034       48      114       4       204
13365       49      114       4       262
13593       50      114       5       217
average_rating for this rec across 50 users from same group (less noisy) was: 4.24
all_actions shape just before sample torch.Size([1, 9, 1])
action scaled by temperature: tensor([[97]], device='cuda:0')
action picked by argmax: tensor([97], device='cuda:0')
tensor([[ 97, 189,  23, 131, 230, 217,  67, 220, 138,  42]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
174         1       98       4       175
414         2       98       4       142
681         3       98       2       136
941         4       98       3       123
1120        5       98       3        29
       user_id  item_id  rating  timestep
12465       46       98       4       181
12789       47       98       3       232
13078       48       98       4       248
13292       49       98       4       189
13565       50       98       4       189
average_rating for this rec across 50 users from same group (less noisy) was: 3.52
all_actions shape just before sample torch.Size([1, 10, 1])
action scaled by temperature: tensor([[189]], device='cuda:0')
action picked by argmax: tensor([189], device='cuda:0')
tensor([[189,  14, 270, 178, 131,  23, 193, 164,  97,  67]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
54          1      190       5        55
354         2      190       4        82
732         3      190       4       187
1016        4      190       4       198
1119        5      190       5        28
       user_id  item_id  rating  timestep
12308       46      190       3        24
12634       47      190       4        77
13085       48      190       4       255
13209       49      190       4       106
13502       50      190       5       126
average_rating for this rec across 50 users from same group (less noisy) was: 4.14
all_actions shape just before sample torch.Size([1, 11, 1])
action scaled by temperature: tensor([[67]], device='cuda:0')
action picked by argmax: tensor([67], device='cuda:0')
tensor([[ 67, 200, 189,  97, 197, 216,  48, 158, 111,   8]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
191         1       68       3       192
351         2       68       2        79
623         3       68       4        78
866         4       68       5        48
1237        5       68       3       146
       user_id  item_id  rating  timestep
12499       46       68       3       215
12639       47       68       5        82
13060       48       68       4       230
13114       49       68       3        11
13452       50       68       5        76
average_rating for this rec across 50 users from same group (less noisy) was: 3.82
all_actions shape just before sample torch.Size([1, 12, 1])
action scaled by temperature: tensor([[200]], device='cuda:0')
action picked by argmax: tensor([200], device='cuda:0')
tensor([[200, 122,  67, 197,  70, 217,  92, 104, 164, 101]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
168         1      201       3       169
506         2      201       3       234
704         3      201       2       159
865         4      201       2        47
1246        5      201       5       155
       user_id  item_id  rating  timestep
12552       46      201       5       268
12755       47      201       4       198
13042       48      201       4       212
13221       49      201       3       118
13499       50      201       3       123
average_rating for this rec across 50 users from same group (less noisy) was: 3.76
all_actions shape just before sample torch.Size([1, 13, 1])
action scaled by temperature: tensor([[122]], device='cuda:0')
action picked by argmax: tensor([122], device='cuda:0')
tensor([[122, 164, 197, 177, 200,  70, 104,  56, 101, 222]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
260         1      123       5       261
437         2      123       5       165
653         3      123       5       108
1037        4      123       3       219
1341        5      123       3       250
       user_id  item_id  rating  timestep
12287       46      123       4         3
12764       47      123       5       207
12932       48      123       3       102
13330       49      123       5       227
13629       50      123       5       253
average_rating for this rec across 50 users from same group (less noisy) was: 4.04
all_actions shape just before sample torch.Size([1, 14, 1])
action scaled by temperature: tensor([[197]], device='cuda:0')
action picked by argmax: tensor([197], device='cuda:0')
tensor([[197, 128, 132, 173, 181, 164, 149, 122,  14, 200]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
124         1      198       4       125
499         2      198       3       227
547         3      198       3         2
1072        4      198       3       254
1122        5      198       3        31
       user_id  item_id  rating  timestep
12427       46      198       4       143
12739       47      198       3       182
13054       48      198       4       224
13196       49      198       3        93
13607       50      198       5       231
average_rating for this rec across 50 users from same group (less noisy) was: 3.72
all_actions shape just before sample torch.Size([1, 15, 1])
action scaled by temperature: tensor([[62]], device='cuda:0')
action picked by argmax: tensor([62], device='cuda:0')
tensor([[ 62, 240, 249,  49, 167, 109, 261, 267, 124, 111]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
221         1       63       5       222
458         2       63       4       186
619         3       63       3        74
1089        4       63       4       271
1340        5       63       3       249
       user_id  item_id  rating  timestep
12354       46       63       4        70
12650       47       63       3        93
12903       48       63       3        73
13166       49       63       3        63
13459       50       63       3        83
average_rating for this rec across 50 users from same group (less noisy) was: 3.72
all_actions shape just before sample torch.Size([1, 16, 1])
action scaled by temperature: tensor([[240]], device='cuda:0')
action picked by argmax: tensor([240], device='cuda:0')
tensor([[240,  62, 268, 167, 111, 249,  49, 109,   0, 261]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
200         1      241       4       201
397         2      241       5       125
583         3      241       2        38
883         4      241       4        65
1199        5      241       4       108
       user_id  item_id  rating  timestep
12545       46      241       5       261
12770       47      241       3       213
13006       48      241       5       176
13145       49      241       5        42
13557       50      241       3       181
average_rating for this rec across 50 users from same group (less noisy) was: 3.62
all_actions shape just before sample torch.Size([1, 17, 1])
action scaled by temperature: tensor([[111]], device='cuda:0')
action picked by argmax: tensor([111], device='cuda:0')
tensor([[111,  62, 262, 240, 194, 249,  22, 216, 197, 170]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
271         1      112       4       272
479         2      112       5       207
553         3      112       5         8
1041        4      112       5       223
1094        5      112       5         3
       user_id  item_id  rating  timestep
12382       46      112       5        98
12566       47      112       5         9
12954       48      112       4       124
13319       49      112       4       216
13388       50      112       5        12
average_rating for this rec across 50 users from same group (less noisy) was: 4.7
all_actions shape just before sample torch.Size([1, 18, 1])
action scaled by temperature: tensor([[262]], device='cuda:0')
action picked by argmax: tensor([262], device='cuda:0')
tensor([[262, 194, 229, 111, 166, 131, 148, 268, 252,  62]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
230         1      263       5       231
515         2      263       4       243
589         3      263       4        44
977         4      263       4       159
1146        5      263       5        55
       user_id  item_id  rating  timestep
12402       46      263       4       118
12797       47      263       5       240
12947       48      263       4       117
13225       49      263       3       122
13463       50      263       5        87
average_rating for this rec across 50 users from same group (less noisy) was: 4.34
all_actions shape just before sample torch.Size([1, 19, 1])
action scaled by temperature: tensor([[194]], device='cuda:0')
action picked by argmax: tensor([194], device='cuda:0')
tensor([[194,  43, 252, 262, 166,  39,  63,  38,  62,  44]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
219         1      195       4       220
461         2      195       3       189
667         3      195       4       122
1047        4      195       5       229
1257        5      195       4       166
       user_id  item_id  rating  timestep
12523       46      195       4       239
12675       47      195       4       118
12965       48      195       4       135
13251       49      195       5       148
13646       50      195       3       270
average_rating for this rec across 50 users from same group (less noisy) was: 3.9
all_actions shape just before sample torch.Size([1, 20, 1])
action scaled by temperature: tensor([[43]], device='cuda:0')
action picked by argmax: tensor([43], device='cuda:0')
tensor([[ 43,  38,  62,  71, 167, 237,  65, 105, 205, 214]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
267         1       44       4       268
341         2       44       4        69
706         3       44       4       161
939         4       44       4       121
1331        5       44       4       240
       user_id  item_id  rating  timestep
12435       46       44       3       151
12717       47       44       4       160
13103       48       44       3       273
13146       49       44       3        43
13615       50       44       4       239
average_rating for this rec across 50 users from same group (less noisy) was: 3.74
all_actions shape just before sample torch.Size([1, 21, 1])
action scaled by temperature: tensor([[229]], device='cuda:0')
action picked by argmax: tensor([229], device='cuda:0')
tensor([[229, 222, 225,  60, 159,  47, 227, 155,   2,  71]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
143         1      230       5       144
331         2      230       4        59
658         3      230       4       113
820         4      230       4         2
1142        5      230       5        51
       user_id  item_id  rating  timestep
12397       46      230       5       113
12599       47      230       4        42
12963       48      230       4       133
13314       49      230       5       211
13423       50      230       5        47
average_rating for this rec across 50 users from same group (less noisy) was: 4.24
all_actions shape just before sample torch.Size([1, 22, 1])
action scaled by temperature: tensor([[222]], device='cuda:0')
action picked by argmax: tensor([222], device='cuda:0')
tensor([[222, 225,  99, 155, 227, 229,  72, 128, 263, 159]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
198         1      223       3       199
386         2      223       4       114
640         3      223       5        95
936         4      223       5       118
1310        5      223       4       219
       user_id  item_id  rating  timestep
12409       46      223       5       125
12619       47      223       5        62
12967       48      223       4       137
13372       49      223       5       269
13567       50      223       4       191
average_rating for this rec across 50 users from same group (less noisy) was: 4.54
all_actions shape just before sample torch.Size([1, 23, 1])
action scaled by temperature: tensor([[225]], device='cuda:0')
action picked by argmax: tensor([225], device='cuda:0')
tensor([[225, 231, 163, 211,  47,  79,  69,  60,  35, 119]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
77          1      226       4        78
291         2      226       4        19
632         3      226       4        87
918         4      226       4       100
1222        5      226       4       131
       user_id  item_id  rating  timestep
12432       46      226       4       148
12672       47      226       5       115
12834       48      226       5         4
13255       49      226       5       152
13415       50      226       4        39
average_rating for this rec across 50 users from same group (less noisy) was: 4.46
all_actions shape just before sample torch.Size([1, 24, 1])
action scaled by temperature: tensor([[144]], device='cuda:0')
action picked by argmax: tensor([144], device='cuda:0')
tensor([[144,  27,  71, 163,  14,   2, 187, 231,  90, 211]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
36          1      145       4        37
299         2      145       4        27
724         3      145       4       179
864         4      145       4        46
1132        5      145       4        41
       user_id  item_id  rating  timestep
12452       46      145       4       168
12749       47      145       4       192
13008       48      145       5       178
13317       49      145       4       214
13442       50      145       3        66
average_rating for this rec across 50 users from same group (less noisy) was: 4.14
all_actions shape just before sample torch.Size([1, 25, 1])
action scaled by temperature: tensor([[256]], device='cuda:0')
action picked by argmax: tensor([256], device='cuda:0')
tensor([[256,  57,  69, 110, 102, 242,  20,  90,  29,  86]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
270         1      257       4       271
447         2      257       5       175
696         3      257       5       151
1086        4      257       4       268
1238        5      257       4       147
       user_id  item_id  rating  timestep
12554       46      257       4       270
12564       47      257       4         7
13057       48      257       5       227
13246       49      257       5       143
13460       50      257       5        84
average_rating for this rec across 50 users from same group (less noisy) was: 4.26
all_actions shape just before sample torch.Size([1, 26, 1])
action scaled by temperature: tensor([[242]], device='cuda:0')
action picked by argmax: tensor([242], device='cuda:0')
tensor([[242, 105, 185,  65,  90, 208, 160,  72, 225,  53]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
236         1      243       4       237
365         2      243       5        93
703         3      243       5       158
1014        4      243       4       196
1106        5      243       5        15
       user_id  item_id  rating  timestep
12544       46      243       4       260
12745       47      243       4       188
13024       48      243       2       194
13154       49      243       3        51
13427       50      243       4        51
average_rating for this rec across 50 users from same group (less noisy) was: 3.8
all_actions shape just before sample torch.Size([1, 27, 1])
action scaled by temperature: tensor([[55]], device='cuda:0')
action picked by argmax: tensor([55], device='cuda:0')
tensor([[ 55, 185, 179, 144, 161, 189,  22, 197, 221, 207]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
17          1       56       4        18
500         2       56       4       228
617         3       56       3        72
1080        4       56       4       262
1108        5       56       5        17
       user_id  item_id  rating  timestep
12459       46       56       5       175
12782       47       56       4       225
13071       48       56       4       241
13174       49       56       3        71
13516       50       56       5       140
average_rating for this rec across 50 users from same group (less noisy) was: 4.14
all_actions shape just before sample torch.Size([1, 28, 1])
action scaled by temperature: tensor([[187]], device='cuda:0')
action picked by argmax: tensor([187], device='cuda:0')
tensor([[187, 124, 140,  62,  58, 189, 156,   2,  82,  44]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
14          1      188       4        15
374         2      188       4       102
812         3      188       5       267
970         4      188       4       152
1289        5      188       3       198
       user_id  item_id  rating  timestep
12460       46      188       4       176
12653       47      188       5        96
13044       48      188       4       214
13181       49      188       4        78
13574       50      188       4       198
average_rating for this rec across 50 users from same group (less noisy) was: 3.98
all_actions shape just before sample torch.Size([1, 29, 1])
action scaled by temperature: tensor([[140]], device='cuda:0')
action picked by argmax: tensor([140], device='cuda:0')
tensor([[140, 187, 232, 216,  69, 189, 148,  37, 197,  74]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
251         1      141       3       252
306         2      141       5        34
794         3      141       5       249
1064        4      141       1       246
1339        5      141       4       248
       user_id  item_id  rating  timestep
12480       46      141       3       196
12668       47      141       4       111
12998       48      141       4       168
13234       49      141       5       131
13406       50      141       4        30
average_rating for this rec across 50 users from same group (less noisy) was: 3.82
all_actions shape just before sample torch.Size([1, 30, 1])
action scaled by temperature: tensor([[74]], device='cuda:0')
action picked by argmax: tensor([74], device='cuda:0')
tensor([[ 74, 148, 185,  75, 142,  12,  73, 156, 187, 140]], device='cuda:0')
Just recommended 30 new items to 50 users from group 1 and the total rating was 122.24000000000001
train_loss is: 0.951196176820694
action scaled by temperature: tensor([[86]], device='cuda:0')
action picked by argmax: tensor([83], device='cuda:0')
tensor([[ 83, 267, 165,  29, 233, 169, 237,  38, 196,  30]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
255         1       84       3       256
303         2       84       5        31
754         3       84       4       209
850         4       84       4        32
1230        5       84       5       139
       user_id  item_id  rating  timestep
12517       46       84       4       233
12799       47       84       5       242
12936       48       84       5       106
13329       49       84       5       226
13635       50       84       4       259
average_rating for this rec across 50 users from same group (less noisy) was: 4.2
all_actions shape just before sample torch.Size([1, 1, 1])
action scaled by temperature: tensor([[261]], device='cuda:0')
action picked by argmax: tensor([133], device='cuda:0')
tensor([[133,  32, 127,  39, 213,  28,  42,   4, 225, 240]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
247         1      134       3       248
412         2      134       4       140
728         3      134       3       183
1048        4      134       4       230
1308        5      134       4       217
       user_id  item_id  rating  timestep
12383       46      134       4        99
12702       47      134       5       145
12872       48      134       4        42
13298       49      134       5       195
13645       50      134       5       269
average_rating for this rec across 50 users from same group (less noisy) was: 4.32
all_actions shape just before sample torch.Size([1, 2, 1])
action scaled by temperature: tensor([[56]], device='cuda:0')
action picked by argmax: tensor([196], device='cuda:0')
tensor([[196,  94,  55, 110, 271, 157, 168,  97, 183,  17]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
98          1      197       3        99
369         2      197       4        97
729         3      197       3       184
867         4      197       5        49
1109        5      197       4        18
       user_id  item_id  rating  timestep
12311       46      197       2        27
12645       47      197       4        88
13014       48      197       3       184
13119       49      197       1        16
13636       50      197       3       260
average_rating for this rec across 50 users from same group (less noisy) was: 3.28
all_actions shape just before sample torch.Size([1, 3, 1])
action scaled by temperature: tensor([[118]], device='cuda:0')
action picked by argmax: tensor([220], device='cuda:0')
tensor([[220, 118,  18, 237, 217, 175, 165,  79, 206, 134]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
225         1      221       4       226
380         2      221       4       108
549         3      221       4         4
854         4      221       4        36
1188        5      221       5        97
       user_id  item_id  rating  timestep
12421       46      221       3       137
12641       47      221       4        84
13072       48      221       4       242
13351       49      221       5       248
13455       50      221       4        79
average_rating for this rec across 50 users from same group (less noisy) was: 4.16
all_actions shape just before sample torch.Size([1, 4, 1])
action scaled by temperature: tensor([[23]], device='cuda:0')
action picked by argmax: tensor([23], device='cuda:0')
tensor([[ 23,   0, 161, 118, 134, 137, 213,  14,  18, 103]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
122         1       24       4       123
389         2       24       5       117
666         3       24       3       121
871         4       24       5        53
1330        5       24       5       239
       user_id  item_id  rating  timestep
12339       46       24       4        55
12640       47       24       4        83
12930       48       24       3       100
13266       49       24       5       163
13582       50       24       4       206
average_rating for this rec across 50 users from same group (less noisy) was: 3.84
all_actions shape just before sample torch.Size([1, 5, 1])
action scaled by temperature: tensor([[0]], device='cuda:0')
action picked by argmax: tensor([0], device='cuda:0')
tensor([[  0, 121,  96,  77, 208,  44, 134, 177, 213, 165]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
62          1        1       4        63
522         2        1       5       250
671         3        1       4       126
892         4        1       4        74
1204        5        1       5       113
       user_id  item_id  rating  timestep
12375       46        1       5        91
12816       47        1       5       259
13045       48        1       4       215
13375       49        1       5       272
13542       50        1       5       166
average_rating for this rec across 50 users from same group (less noisy) was: 4.66
all_actions shape just before sample torch.Size([1, 6, 1])
action scaled by temperature: tensor([[252]], device='cuda:0')
action picked by argmax: tensor([252], device='cuda:0')
tensor([[252, 251, 238, 204, 240, 152,  59, 177, 137, 261]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
53          1      253       5        54
325         2      253       5        53
761         3      253       5       216
1068        4      253       5       250
1176        5      253       5        85
       user_id  item_id  rating  timestep
12446       46      253       5       162
12791       47      253       5       234
13019       48      253       5       189
13220       49      253       5       117
13580       50      253       5       204
average_rating for this rec across 50 users from same group (less noisy) was: 4.7
all_actions shape just before sample torch.Size([1, 7, 1])
action scaled by temperature: tensor([[81]], device='cuda:0')
action picked by argmax: tensor([81], device='cuda:0')
tensor([[ 81, 113, 255, 231,  56,  42,  37,  97,  20, 176]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
68          1       82       5        69
540         2       82       5       268
688         3       82       4       143
963         4       82       5       145
1140        5       82       4        49
       user_id  item_id  rating  timestep
12345       46       82       4        61
12570       47       82       4        13
12926       48       82       5        96
13162       49       82       4        59
13379       50       82       4         3
average_rating for this rec across 50 users from same group (less noisy) was: 4.44
all_actions shape just before sample torch.Size([1, 8, 1])
action scaled by temperature: tensor([[113]], device='cuda:0')
action picked by argmax: tensor([113], device='cuda:0')
tensor([[113,  97, 178, 255,  81, 170,  95, 256, 231, 158]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
109         1      114       4       110
324         2      114       3        52
744         3      114       4       199
920         4      114       5       102
1160        5      114       5        69
       user_id  item_id  rating  timestep
12470       46      114       3       186
12608       47      114       4        51
13034       48      114       4       204
13365       49      114       4       262
13593       50      114       5       217
average_rating for this rec across 50 users from same group (less noisy) was: 4.24
all_actions shape just before sample torch.Size([1, 9, 1])
action scaled by temperature: tensor([[97]], device='cuda:0')
action picked by argmax: tensor([97], device='cuda:0')
tensor([[ 97,  67,  23, 131, 189, 220, 138, 230, 217, 264]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
174         1       98       4       175
414         2       98       4       142
681         3       98       2       136
941         4       98       3       123
1120        5       98       3        29
       user_id  item_id  rating  timestep
12465       46       98       4       181
12789       47       98       3       232
13078       48       98       4       248
13292       49       98       4       189
13565       50       98       4       189
average_rating for this rec across 50 users from same group (less noisy) was: 3.52
all_actions shape just before sample torch.Size([1, 10, 1])
action scaled by temperature: tensor([[189]], device='cuda:0')
action picked by argmax: tensor([189], device='cuda:0')
tensor([[189, 178,  14,  95,  67, 131,   7, 231,  23, 109]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
54          1      190       5        55
354         2      190       4        82
732         3      190       4       187
1016        4      190       4       198
1119        5      190       5        28
       user_id  item_id  rating  timestep
12308       46      190       3        24
12634       47      190       4        77
13085       48      190       4       255
13209       49      190       4       106
13502       50      190       5       126
average_rating for this rec across 50 users from same group (less noisy) was: 4.14
all_actions shape just before sample torch.Size([1, 11, 1])
action scaled by temperature: tensor([[67]], device='cuda:0')
action picked by argmax: tensor([67], device='cuda:0')
tensor([[ 67, 200, 189,  97, 197, 122, 164, 216, 113,  48]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
191         1       68       3       192
351         2       68       2        79
623         3       68       4        78
866         4       68       5        48
1237        5       68       3       146
       user_id  item_id  rating  timestep
12499       46       68       3       215
12639       47       68       5        82
13060       48       68       4       230
13114       49       68       3        11
13452       50       68       5        76
average_rating for this rec across 50 users from same group (less noisy) was: 3.82
all_actions shape just before sample torch.Size([1, 12, 1])
action scaled by temperature: tensor([[200]], device='cuda:0')
action picked by argmax: tensor([200], device='cuda:0')
tensor([[200, 122,  70, 197,  67,  95, 101,  92, 217, 164]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
168         1      201       3       169
506         2      201       3       234
704         3      201       2       159
865         4      201       2        47
1246        5      201       5       155
       user_id  item_id  rating  timestep
12552       46      201       5       268
12755       47      201       4       198
13042       48      201       4       212
13221       49      201       3       118
13499       50      201       3       123
average_rating for this rec across 50 users from same group (less noisy) was: 3.76
all_actions shape just before sample torch.Size([1, 13, 1])
action scaled by temperature: tensor([[122]], device='cuda:0')
action picked by argmax: tensor([122], device='cuda:0')
tensor([[122, 164, 197,  70, 177,  56, 102,  95, 200, 101]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
260         1      123       5       261
437         2      123       5       165
653         3      123       5       108
1037        4      123       3       219
1341        5      123       3       250
       user_id  item_id  rating  timestep
12287       46      123       4         3
12764       47      123       5       207
12932       48      123       3       102
13330       49      123       5       227
13629       50      123       5       253
average_rating for this rec across 50 users from same group (less noisy) was: 4.04
all_actions shape just before sample torch.Size([1, 14, 1])
action scaled by temperature: tensor([[197]], device='cuda:0')
action picked by argmax: tensor([197], device='cuda:0')
tensor([[197, 122, 128,  45, 132, 181, 164,  91, 149,  56]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
124         1      198       4       125
499         2      198       3       227
547         3      198       3         2
1072        4      198       3       254
1122        5      198       3        31
       user_id  item_id  rating  timestep
12427       46      198       4       143
12739       47      198       3       182
13054       48      198       4       224
13196       49      198       3        93
13607       50      198       5       231
average_rating for this rec across 50 users from same group (less noisy) was: 3.72
all_actions shape just before sample torch.Size([1, 15, 1])
action scaled by temperature: tensor([[62]], device='cuda:0')
action picked by argmax: tensor([62], device='cuda:0')
tensor([[ 62, 240, 249, 261,  49, 109, 167, 111, 124, 267]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
221         1       63       5       222
458         2       63       4       186
619         3       63       3        74
1089        4       63       4       271
1340        5       63       3       249
       user_id  item_id  rating  timestep
12354       46       63       4        70
12650       47       63       3        93
12903       48       63       3        73
13166       49       63       3        63
13459       50       63       3        83
average_rating for this rec across 50 users from same group (less noisy) was: 3.72
all_actions shape just before sample torch.Size([1, 16, 1])
action scaled by temperature: tensor([[240]], device='cuda:0')
action picked by argmax: tensor([240], device='cuda:0')
tensor([[240,  62, 268, 167, 111, 194,   0, 109, 263,  49]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
200         1      241       4       201
397         2      241       5       125
583         3      241       2        38
883         4      241       4        65
1199        5      241       4       108
       user_id  item_id  rating  timestep
12545       46      241       5       261
12770       47      241       3       213
13006       48      241       5       176
13145       49      241       5        42
13557       50      241       3       181
average_rating for this rec across 50 users from same group (less noisy) was: 3.62
all_actions shape just before sample torch.Size([1, 17, 1])
action scaled by temperature: tensor([[111]], device='cuda:0')
action picked by argmax: tensor([111], device='cuda:0')
tensor([[111, 262, 194, 240, 146,  62,  41,  22, 216, 229]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
271         1      112       4       272
479         2      112       5       207
553         3      112       5         8
1041        4      112       5       223
1094        5      112       5         3
       user_id  item_id  rating  timestep
12382       46      112       5        98
12566       47      112       5         9
12954       48      112       4       124
13319       49      112       4       216
13388       50      112       5        12
average_rating for this rec across 50 users from same group (less noisy) was: 4.7
all_actions shape just before sample torch.Size([1, 18, 1])
action scaled by temperature: tensor([[262]], device='cuda:0')
action picked by argmax: tensor([262], device='cuda:0')
tensor([[262, 194, 229, 111, 252,  25, 166, 170, 131, 146]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
230         1      263       5       231
515         2      263       4       243
589         3      263       4        44
977         4      263       4       159
1146        5      263       5        55
       user_id  item_id  rating  timestep
12402       46      263       4       118
12797       47      263       5       240
12947       48      263       4       117
13225       49      263       3       122
13463       50      263       5        87
average_rating for this rec across 50 users from same group (less noisy) was: 4.34
all_actions shape just before sample torch.Size([1, 19, 1])
action scaled by temperature: tensor([[194]], device='cuda:0')
action picked by argmax: tensor([194], device='cuda:0')
tensor([[194,  43, 262, 252,  44,  39, 166, 229, 142,  38]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
219         1      195       4       220
461         2      195       3       189
667         3      195       4       122
1047        4      195       5       229
1257        5      195       4       166
       user_id  item_id  rating  timestep
12523       46      195       4       239
12675       47      195       4       118
12965       48      195       4       135
13251       49      195       5       148
13646       50      195       3       270
average_rating for this rec across 50 users from same group (less noisy) was: 3.9
all_actions shape just before sample torch.Size([1, 20, 1])
action scaled by temperature: tensor([[43]], device='cuda:0')
action picked by argmax: tensor([43], device='cuda:0')
tensor([[ 43,  65, 167, 214, 194,  62,  38, 159, 222, 160]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
267         1       44       4       268
341         2       44       4        69
706         3       44       4       161
939         4       44       4       121
1331        5       44       4       240
       user_id  item_id  rating  timestep
12435       46       44       3       151
12717       47       44       4       160
13103       48       44       3       273
13146       49       44       3        43
13615       50       44       4       239
average_rating for this rec across 50 users from same group (less noisy) was: 3.74
all_actions shape just before sample torch.Size([1, 21, 1])
action scaled by temperature: tensor([[229]], device='cuda:0')
action picked by argmax: tensor([229], device='cuda:0')
tensor([[229, 222, 225,  47, 211,   2, 159, 237,  60, 141]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
143         1      230       5       144
331         2      230       4        59
658         3      230       4       113
820         4      230       4         2
1142        5      230       5        51
       user_id  item_id  rating  timestep
12397       46      230       5       113
12599       47      230       4        42
12963       48      230       4       133
13314       49      230       5       211
13423       50      230       5        47
average_rating for this rec across 50 users from same group (less noisy) was: 4.24
all_actions shape just before sample torch.Size([1, 22, 1])
action scaled by temperature: tensor([[222]], device='cuda:0')
action picked by argmax: tensor([222], device='cuda:0')
tensor([[222, 225, 229,  99, 155, 135, 263, 227,  71, 112]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
198         1      223       3       199
386         2      223       4       114
640         3      223       5        95
936         4      223       5       118
1310        5      223       4       219
       user_id  item_id  rating  timestep
12409       46      223       5       125
12619       47      223       5        62
12967       48      223       4       137
13372       49      223       5       269
13567       50      223       4       191
average_rating for this rec across 50 users from same group (less noisy) was: 4.54
all_actions shape just before sample torch.Size([1, 23, 1])
action scaled by temperature: tensor([[225]], device='cuda:0')
action picked by argmax: tensor([225], device='cuda:0')
tensor([[225,  69,  47, 231, 211, 163, 119,  60,  65, 157]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
77          1      226       4        78
291         2      226       4        19
632         3      226       4        87
918         4      226       4       100
1222        5      226       4       131
       user_id  item_id  rating  timestep
12432       46      226       4       148
12672       47      226       5       115
12834       48      226       5         4
13255       49      226       5       152
13415       50      226       4        39
average_rating for this rec across 50 users from same group (less noisy) was: 4.46
all_actions shape just before sample torch.Size([1, 24, 1])
action scaled by temperature: tensor([[144]], device='cuda:0')
action picked by argmax: tensor([144], device='cuda:0')
tensor([[144, 225,  14, 187,  71,  58, 256,  69,  27, 231]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
36          1      145       4        37
299         2      145       4        27
724         3      145       4       179
864         4      145       4        46
1132        5      145       4        41
       user_id  item_id  rating  timestep
12452       46      145       4       168
12749       47      145       4       192
13008       48      145       5       178
13317       49      145       4       214
13442       50      145       3        66
average_rating for this rec across 50 users from same group (less noisy) was: 4.14
all_actions shape just before sample torch.Size([1, 25, 1])
action scaled by temperature: tensor([[256]], device='cuda:0')
action picked by argmax: tensor([256], device='cuda:0')
tensor([[256,  69,  57, 143, 242,  20,  29, 167, 110,  85]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
270         1      257       4       271
447         2      257       5       175
696         3      257       5       151
1086        4      257       4       268
1238        5      257       4       147
       user_id  item_id  rating  timestep
12554       46      257       4       270
12564       47      257       4         7
13057       48      257       5       227
13246       49      257       5       143
13460       50      257       5        84
average_rating for this rec across 50 users from same group (less noisy) was: 4.26
all_actions shape just before sample torch.Size([1, 26, 1])
action scaled by temperature: tensor([[242]], device='cuda:0')
action picked by argmax: tensor([242], device='cuda:0')
tensor([[242, 105, 208, 185,  51,  65,  77,  72, 160,  90]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
236         1      243       4       237
365         2      243       5        93
703         3      243       5       158
1014        4      243       4       196
1106        5      243       5        15
       user_id  item_id  rating  timestep
12544       46      243       4       260
12745       47      243       4       188
13024       48      243       2       194
13154       49      243       3        51
13427       50      243       4        51
average_rating for this rec across 50 users from same group (less noisy) was: 3.8
all_actions shape just before sample torch.Size([1, 27, 1])
action scaled by temperature: tensor([[55]], device='cuda:0')
action picked by argmax: tensor([55], device='cuda:0')
tensor([[ 55, 144, 221, 189, 197, 179, 210, 115,  19, 185]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
17          1       56       4        18
500         2       56       4       228
617         3       56       3        72
1080        4       56       4       262
1108        5       56       5        17
       user_id  item_id  rating  timestep
12459       46       56       5       175
12782       47       56       4       225
13071       48       56       4       241
13174       49       56       3        71
13516       50       56       5       140
average_rating for this rec across 50 users from same group (less noisy) was: 4.14
all_actions shape just before sample torch.Size([1, 28, 1])
action scaled by temperature: tensor([[187]], device='cuda:0')
action picked by argmax: tensor([187], device='cuda:0')
tensor([[187, 156, 124,  82, 140,  58,  62,  81,  74, 232]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
14          1      188       4        15
374         2      188       4       102
812         3      188       5       267
970         4      188       4       152
1289        5      188       3       198
       user_id  item_id  rating  timestep
12460       46      188       4       176
12653       47      188       5        96
13044       48      188       4       214
13181       49      188       4        78
13574       50      188       4       198
average_rating for this rec across 50 users from same group (less noisy) was: 3.98
all_actions shape just before sample torch.Size([1, 29, 1])
action scaled by temperature: tensor([[140]], device='cuda:0')
action picked by argmax: tensor([140], device='cuda:0')
tensor([[140, 187, 232,  69, 148, 189, 216,  74, 156, 185]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
251         1      141       3       252
306         2      141       5        34
794         3      141       5       249
1064        4      141       1       246
1339        5      141       4       248
       user_id  item_id  rating  timestep
12480       46      141       3       196
12668       47      141       4       111
12998       48      141       4       168
13234       49      141       5       131
13406       50      141       4        30
average_rating for this rec across 50 users from same group (less noisy) was: 3.82
all_actions shape just before sample torch.Size([1, 30, 1])
action scaled by temperature: tensor([[74]], device='cuda:0')
action picked by argmax: tensor([74], device='cuda:0')
tensor([[ 74, 148, 142, 156,  12, 100,  75, 177, 187,  41]], device='cuda:0')
Just recommended 30 new items to 50 users from group 1 and the total rating was 122.24000000000001
train_loss is: 0.874626581799494
action scaled by temperature: tensor([[2]], device='cuda:0')
action picked by argmax: tensor([83], device='cuda:0')
tensor([[ 83, 265, 180, 237,  29, 169, 246,  76, 119,  24]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
255         1       84       3       256
303         2       84       5        31
754         3       84       4       209
850         4       84       4        32
1230        5       84       5       139
       user_id  item_id  rating  timestep
12517       46       84       4       233
12799       47       84       5       242
12936       48       84       5       106
13329       49       84       5       226
13635       50       84       4       259
average_rating for this rec across 50 users from same group (less noisy) was: 4.2
all_actions shape just before sample torch.Size([1, 1, 1])
action scaled by temperature: tensor([[206]], device='cuda:0')
action picked by argmax: tensor([133], device='cuda:0')
tensor([[133,  32, 119,  10, 127, 225, 213,  59, 198, 196]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
247         1      134       3       248
412         2      134       4       140
728         3      134       3       183
1048        4      134       4       230
1308        5      134       4       217
       user_id  item_id  rating  timestep
12383       46      134       4        99
12702       47      134       5       145
12872       48      134       4        42
13298       49      134       5       195
13645       50      134       5       269
average_rating for this rec across 50 users from same group (less noisy) was: 4.32
all_actions shape just before sample torch.Size([1, 2, 1])
action scaled by temperature: tensor([[235]], device='cuda:0')
action picked by argmax: tensor([196], device='cuda:0')
tensor([[196,  94, 271,  55,  56,  97, 110, 168, 157,  17]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
98          1      197       3        99
369         2      197       4        97
729         3      197       3       184
867         4      197       5        49
1109        5      197       4        18
       user_id  item_id  rating  timestep
12311       46      197       2        27
12645       47      197       4        88
13014       48      197       3       184
13119       49      197       1        16
13636       50      197       3       260
average_rating for this rec across 50 users from same group (less noisy) was: 3.28
all_actions shape just before sample torch.Size([1, 3, 1])
action scaled by temperature: tensor([[220]], device='cuda:0')
action picked by argmax: tensor([220], device='cuda:0')
tensor([[220, 118,  18, 217, 175,  56, 206, 126, 165, 182]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
225         1      221       4       226
380         2      221       4       108
549         3      221       4         4
854         4      221       4        36
1188        5      221       5        97
       user_id  item_id  rating  timestep
12421       46      221       3       137
12641       47      221       4        84
13072       48      221       4       242
13351       49      221       5       248
13455       50      221       4        79
average_rating for this rec across 50 users from same group (less noisy) was: 4.16
all_actions shape just before sample torch.Size([1, 4, 1])
action scaled by temperature: tensor([[23]], device='cuda:0')
action picked by argmax: tensor([23], device='cuda:0')
tensor([[ 23, 118,   0, 161, 134,  14,  18, 175,  77, 213]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
122         1       24       4       123
389         2       24       5       117
666         3       24       3       121
871         4       24       5        53
1330        5       24       5       239
       user_id  item_id  rating  timestep
12339       46       24       4        55
12640       47       24       4        83
12930       48       24       3       100
13266       49       24       5       163
13582       50       24       4       206
average_rating for this rec across 50 users from same group (less noisy) was: 3.84
all_actions shape just before sample torch.Size([1, 5, 1])
action scaled by temperature: tensor([[0]], device='cuda:0')
action picked by argmax: tensor([0], device='cuda:0')
tensor([[  0,  96,  44, 121,  77, 165, 134,  23, 177, 208]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
62          1        1       4        63
522         2        1       5       250
671         3        1       4       126
892         4        1       4        74
1204        5        1       5       113
       user_id  item_id  rating  timestep
12375       46        1       5        91
12816       47        1       5       259
13045       48        1       4       215
13375       49        1       5       272
13542       50        1       5       166
average_rating for this rec across 50 users from same group (less noisy) was: 4.66
all_actions shape just before sample torch.Size([1, 6, 1])
action scaled by temperature: tensor([[252]], device='cuda:0')
action picked by argmax: tensor([252], device='cuda:0')
tensor([[252, 238, 240, 251, 177, 204,   0, 209,  96,  83]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
53          1      253       5        54
325         2      253       5        53
761         3      253       5       216
1068        4      253       5       250
1176        5      253       5        85
       user_id  item_id  rating  timestep
12446       46      253       5       162
12791       47      253       5       234
13019       48      253       5       189
13220       49      253       5       117
13580       50      253       5       204
average_rating for this rec across 50 users from same group (less noisy) was: 4.7
all_actions shape just before sample torch.Size([1, 7, 1])
action scaled by temperature: tensor([[81]], device='cuda:0')
action picked by argmax: tensor([81], device='cuda:0')
tensor([[ 81, 113, 255,  20, 231,  37,  42,  56, 117, 235]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
68          1       82       5        69
540         2       82       5       268
688         3       82       4       143
963         4       82       5       145
1140        5       82       4        49
       user_id  item_id  rating  timestep
12345       46       82       4        61
12570       47       82       4        13
12926       48       82       5        96
13162       49       82       4        59
13379       50       82       4         3
average_rating for this rec across 50 users from same group (less noisy) was: 4.44
all_actions shape just before sample torch.Size([1, 8, 1])
action scaled by temperature: tensor([[113]], device='cuda:0')
action picked by argmax: tensor([113], device='cuda:0')
tensor([[113, 178, 255, 170,  97,  81, 256,  86,  95, 235]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
109         1      114       4       110
324         2      114       3        52
744         3      114       4       199
920         4      114       5       102
1160        5      114       5        69
       user_id  item_id  rating  timestep
12470       46      114       3       186
12608       47      114       4        51
13034       48      114       4       204
13365       49      114       4       262
13593       50      114       5       217
average_rating for this rec across 50 users from same group (less noisy) was: 4.24
all_actions shape just before sample torch.Size([1, 9, 1])
action scaled by temperature: tensor([[97]], device='cuda:0')
action picked by argmax: tensor([97], device='cuda:0')
tensor([[ 97,  23,  67, 131, 138, 220, 230, 189, 149, 182]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
174         1       98       4       175
414         2       98       4       142
681         3       98       2       136
941         4       98       3       123
1120        5       98       3        29
       user_id  item_id  rating  timestep
12465       46       98       4       181
12789       47       98       3       232
13078       48       98       4       248
13292       49       98       4       189
13565       50       98       4       189
average_rating for this rec across 50 users from same group (less noisy) was: 3.52
all_actions shape just before sample torch.Size([1, 10, 1])
action scaled by temperature: tensor([[189]], device='cuda:0')
action picked by argmax: tensor([189], device='cuda:0')
tensor([[189, 178,  67,  14,  95,   7, 202, 109,  23, 131]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
54          1      190       5        55
354         2      190       4        82
732         3      190       4       187
1016        4      190       4       198
1119        5      190       5        28
       user_id  item_id  rating  timestep
12308       46      190       3        24
12634       47      190       4        77
13085       48      190       4       255
13209       49      190       4       106
13502       50      190       5       126
average_rating for this rec across 50 users from same group (less noisy) was: 4.14
all_actions shape just before sample torch.Size([1, 11, 1])
action scaled by temperature: tensor([[67]], device='cuda:0')
action picked by argmax: tensor([67], device='cuda:0')
tensor([[ 67, 200,  97, 189, 197, 122, 113, 216,   8, 164]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
191         1       68       3       192
351         2       68       2        79
623         3       68       4        78
866         4       68       5        48
1237        5       68       3       146
       user_id  item_id  rating  timestep
12499       46       68       3       215
12639       47       68       5        82
13060       48       68       4       230
13114       49       68       3        11
13452       50       68       5        76
average_rating for this rec across 50 users from same group (less noisy) was: 3.82
all_actions shape just before sample torch.Size([1, 12, 1])
action scaled by temperature: tensor([[200]], device='cuda:0')
action picked by argmax: tensor([200], device='cuda:0')
tensor([[200, 122, 197,  67,  70,  92,  95, 164, 217, 111]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
168         1      201       3       169
506         2      201       3       234
704         3      201       2       159
865         4      201       2        47
1246        5      201       5       155
       user_id  item_id  rating  timestep
12552       46      201       5       268
12755       47      201       4       198
13042       48      201       4       212
13221       49      201       3       118
13499       50      201       3       123
average_rating for this rec across 50 users from same group (less noisy) was: 3.76
all_actions shape just before sample torch.Size([1, 13, 1])
action scaled by temperature: tensor([[122]], device='cuda:0')
action picked by argmax: tensor([122], device='cuda:0')
tensor([[122, 197, 164, 177, 200,  70, 163,  95,  56, 102]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
260         1      123       5       261
437         2      123       5       165
653         3      123       5       108
1037        4      123       3       219
1341        5      123       3       250
       user_id  item_id  rating  timestep
12287       46      123       4         3
12764       47      123       5       207
12932       48      123       3       102
13330       49      123       5       227
13629       50      123       5       253
average_rating for this rec across 50 users from same group (less noisy) was: 4.04
all_actions shape just before sample torch.Size([1, 14, 1])
action scaled by temperature: tensor([[197]], device='cuda:0')
action picked by argmax: tensor([197], device='cuda:0')
tensor([[197, 122, 128, 132,  45,  67,  91, 164, 149, 181]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
124         1      198       4       125
499         2      198       3       227
547         3      198       3         2
1072        4      198       3       254
1122        5      198       3        31
       user_id  item_id  rating  timestep
12427       46      198       4       143
12739       47      198       3       182
13054       48      198       4       224
13196       49      198       3        93
13607       50      198       5       231
average_rating for this rec across 50 users from same group (less noisy) was: 3.72
all_actions shape just before sample torch.Size([1, 15, 1])
action scaled by temperature: tensor([[62]], device='cuda:0')
action picked by argmax: tensor([62], device='cuda:0')
tensor([[ 62, 240, 261, 249,  49, 167, 109, 111, 124,   0]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
221         1       63       5       222
458         2       63       4       186
619         3       63       3        74
1089        4       63       4       271
1340        5       63       3       249
       user_id  item_id  rating  timestep
12354       46       63       4        70
12650       47       63       3        93
12903       48       63       3        73
13166       49       63       3        63
13459       50       63       3        83
average_rating for this rec across 50 users from same group (less noisy) was: 3.72
all_actions shape just before sample torch.Size([1, 16, 1])
action scaled by temperature: tensor([[240]], device='cuda:0')
action picked by argmax: tensor([240], device='cuda:0')
tensor([[240,  62, 268, 167, 111, 194,   0, 261,  49, 262]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
200         1      241       4       201
397         2      241       5       125
583         3      241       2        38
883         4      241       4        65
1199        5      241       4       108
       user_id  item_id  rating  timestep
12545       46      241       5       261
12770       47      241       3       213
13006       48      241       5       176
13145       49      241       5        42
13557       50      241       3       181
average_rating for this rec across 50 users from same group (less noisy) was: 3.62
all_actions shape just before sample torch.Size([1, 17, 1])
action scaled by temperature: tensor([[111]], device='cuda:0')
action picked by argmax: tensor([111], device='cuda:0')
tensor([[111, 262, 194, 146, 240,  41,  22, 216,  62, 229]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
271         1      112       4       272
479         2      112       5       207
553         3      112       5         8
1041        4      112       5       223
1094        5      112       5         3
       user_id  item_id  rating  timestep
12382       46      112       5        98
12566       47      112       5         9
12954       48      112       4       124
13319       49      112       4       216
13388       50      112       5        12
average_rating for this rec across 50 users from same group (less noisy) was: 4.7
all_actions shape just before sample torch.Size([1, 18, 1])
action scaled by temperature: tensor([[262]], device='cuda:0')
action picked by argmax: tensor([262], device='cuda:0')
tensor([[262, 194, 229, 111,  25, 131, 170, 146, 252, 166]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
230         1      263       5       231
515         2      263       4       243
589         3      263       4        44
977         4      263       4       159
1146        5      263       5        55
       user_id  item_id  rating  timestep
12402       46      263       4       118
12797       47      263       5       240
12947       48      263       4       117
13225       49      263       3       122
13463       50      263       5        87
average_rating for this rec across 50 users from same group (less noisy) was: 4.34
all_actions shape just before sample torch.Size([1, 19, 1])
action scaled by temperature: tensor([[194]], device='cuda:0')
action picked by argmax: tensor([194], device='cuda:0')
tensor([[194,  43, 252, 262,  44,  39,  63, 142,  33, 166]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
219         1      195       4       220
461         2      195       3       189
667         3      195       4       122
1047        4      195       5       229
1257        5      195       4       166
       user_id  item_id  rating  timestep
12523       46      195       4       239
12675       47      195       4       118
12965       48      195       4       135
13251       49      195       5       148
13646       50      195       3       270
average_rating for this rec across 50 users from same group (less noisy) was: 3.9
all_actions shape just before sample torch.Size([1, 20, 1])
action scaled by temperature: tensor([[43]], device='cuda:0')
action picked by argmax: tensor([43], device='cuda:0')
tensor([[ 43,  65, 167,  67,  62, 160,  38, 159,  56, 214]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
267         1       44       4       268
341         2       44       4        69
706         3       44       4       161
939         4       44       4       121
1331        5       44       4       240
       user_id  item_id  rating  timestep
12435       46       44       3       151
12717       47       44       4       160
13103       48       44       3       273
13146       49       44       3        43
13615       50       44       4       239
average_rating for this rec across 50 users from same group (less noisy) was: 3.74
all_actions shape just before sample torch.Size([1, 21, 1])
action scaled by temperature: tensor([[229]], device='cuda:0')
action picked by argmax: tensor([229], device='cuda:0')
tensor([[229, 222, 225,  47, 211,   2, 149, 112, 105, 166]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
143         1      230       5       144
331         2      230       4        59
658         3      230       4       113
820         4      230       4         2
1142        5      230       5        51
       user_id  item_id  rating  timestep
12397       46      230       5       113
12599       47      230       4        42
12963       48      230       4       133
13314       49      230       5       211
13423       50      230       5        47
average_rating for this rec across 50 users from same group (less noisy) was: 4.24
all_actions shape just before sample torch.Size([1, 22, 1])
action scaled by temperature: tensor([[222]], device='cuda:0')
action picked by argmax: tensor([222], device='cuda:0')
tensor([[222, 229, 225, 227, 155,  71,  47,  99, 263, 112]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
198         1      223       3       199
386         2      223       4       114
640         3      223       5        95
936         4      223       5       118
1310        5      223       4       219
       user_id  item_id  rating  timestep
12409       46      223       5       125
12619       47      223       5        62
12967       48      223       4       137
13372       49      223       5       269
13567       50      223       4       191
average_rating for this rec across 50 users from same group (less noisy) was: 4.54
all_actions shape just before sample torch.Size([1, 23, 1])
action scaled by temperature: tensor([[225]], device='cuda:0')
action picked by argmax: tensor([225], device='cuda:0')
tensor([[225,  47, 211,  69, 231, 157, 163, 119,  60,  65]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
77          1      226       4        78
291         2      226       4        19
632         3      226       4        87
918         4      226       4       100
1222        5      226       4       131
       user_id  item_id  rating  timestep
12432       46      226       4       148
12672       47      226       5       115
12834       48      226       5         4
13255       49      226       5       152
13415       50      226       4        39
average_rating for this rec across 50 users from same group (less noisy) was: 4.46
all_actions shape just before sample torch.Size([1, 24, 1])
action scaled by temperature: tensor([[144]], device='cuda:0')
action picked by argmax: tensor([144], device='cuda:0')
tensor([[144,  14, 104,  71, 225, 187,   2,  27, 155, 146]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
36          1      145       4        37
299         2      145       4        27
724         3      145       4       179
864         4      145       4        46
1132        5      145       4        41
       user_id  item_id  rating  timestep
12452       46      145       4       168
12749       47      145       4       192
13008       48      145       5       178
13317       49      145       4       214
13442       50      145       3        66
average_rating for this rec across 50 users from same group (less noisy) was: 4.14
all_actions shape just before sample torch.Size([1, 25, 1])
action scaled by temperature: tensor([[256]], device='cuda:0')
action picked by argmax: tensor([256], device='cuda:0')
tensor([[256,  69,  57,  20, 242, 117,  85, 246, 104, 143]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
270         1      257       4       271
447         2      257       5       175
696         3      257       5       151
1086        4      257       4       268
1238        5      257       4       147
       user_id  item_id  rating  timestep
12554       46      257       4       270
12564       47      257       4         7
13057       48      257       5       227
13246       49      257       5       143
13460       50      257       5        84
average_rating for this rec across 50 users from same group (less noisy) was: 4.26
all_actions shape just before sample torch.Size([1, 26, 1])
action scaled by temperature: tensor([[242]], device='cuda:0')
action picked by argmax: tensor([242], device='cuda:0')
tensor([[242, 185, 105,  65, 208,  44,  77,  12, 160,  72]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
236         1      243       4       237
365         2      243       5        93
703         3      243       5       158
1014        4      243       4       196
1106        5      243       5        15
       user_id  item_id  rating  timestep
12544       46      243       4       260
12745       47      243       4       188
13024       48      243       2       194
13154       49      243       3        51
13427       50      243       4        51
average_rating for this rec across 50 users from same group (less noisy) was: 3.8
all_actions shape just before sample torch.Size([1, 27, 1])
action scaled by temperature: tensor([[55]], device='cuda:0')
action picked by argmax: tensor([55], device='cuda:0')
tensor([[ 55, 221, 189, 161, 144, 185,   9,  19, 115,   8]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
17          1       56       4        18
500         2       56       4       228
617         3       56       3        72
1080        4       56       4       262
1108        5       56       5        17
       user_id  item_id  rating  timestep
12459       46       56       5       175
12782       47       56       4       225
13071       48       56       4       241
13174       49       56       3        71
13516       50       56       5       140
average_rating for this rec across 50 users from same group (less noisy) was: 4.14
all_actions shape just before sample torch.Size([1, 28, 1])
action scaled by temperature: tensor([[187]], device='cuda:0')
action picked by argmax: tensor([187], device='cuda:0')
tensor([[187, 140, 124, 156,  82, 216,  62,  44, 232,  81]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
14          1      188       4        15
374         2      188       4       102
812         3      188       5       267
970         4      188       4       152
1289        5      188       3       198
       user_id  item_id  rating  timestep
12460       46      188       4       176
12653       47      188       5        96
13044       48      188       4       214
13181       49      188       4        78
13574       50      188       4       198
average_rating for this rec across 50 users from same group (less noisy) was: 3.98
all_actions shape just before sample torch.Size([1, 29, 1])
action scaled by temperature: tensor([[140]], device='cuda:0')
action picked by argmax: tensor([140], device='cuda:0')
tensor([[140, 187,  74,  69, 148, 232, 216, 189, 156, 124]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
251         1      141       3       252
306         2      141       5        34
794         3      141       5       249
1064        4      141       1       246
1339        5      141       4       248
       user_id  item_id  rating  timestep
12480       46      141       3       196
12668       47      141       4       111
12998       48      141       4       168
13234       49      141       5       131
13406       50      141       4        30
average_rating for this rec across 50 users from same group (less noisy) was: 3.82
all_actions shape just before sample torch.Size([1, 30, 1])
action scaled by temperature: tensor([[74]], device='cuda:0')
action picked by argmax: tensor([74], device='cuda:0')
tensor([[ 74, 148, 142, 156,  73, 259, 100,  12,  75, 177]], device='cuda:0')
Just recommended 30 new items to 50 users from group 1 and the total rating was 122.24000000000001
train_loss is: 0.8449372646471137
action scaled by temperature: tensor([[198]], device='cuda:0')
action picked by argmax: tensor([265], device='cuda:0')
tensor([[265,  38,  83, 165, 169, 237,  24,  55,  76, 267]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
81          1      266       3        82
342         2      266       3        70
793         3      266       4       248
901         4      266       3        83
1113        5      266       4        22
       user_id  item_id  rating  timestep
12394       46      266       5       110
12827       47      266       2       270
12927       48      266       5        97
13151       49      266       4        48
13393       50      266       5        17
average_rating for this rec across 50 users from same group (less noisy) was: 3.82
all_actions shape just before sample torch.Size([1, 1, 1])
action scaled by temperature: tensor([[37]], device='cuda:0')
action picked by argmax: tensor([197], device='cuda:0')
tensor([[197,  22, 183,  45, 207, 180,  78, 250, 117, 118]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
124         1      198       4       125
499         2      198       3       227
547         3      198       3         2
1072        4      198       3       254
1122        5      198       3        31
       user_id  item_id  rating  timestep
12427       46      198       4       143
12739       47      198       3       182
13054       48      198       4       224
13196       49      198       3        93
13607       50      198       5       231
average_rating for this rec across 50 users from same group (less noisy) was: 3.72
all_actions shape just before sample torch.Size([1, 2, 1])
action scaled by temperature: tensor([[209]], device='cuda:0')
action picked by argmax: tensor([41], device='cuda:0')
tensor([[ 41, 209, 136, 108,  74, 167, 126, 130, 161,  55]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
112         1       42       5       113
421         2       42       5       149
786         3       42       4       241
887         4       42       5        69
1307        5       42       4       216
       user_id  item_id  rating  timestep
12392       46       42       4       108
12660       47       42       5       103
13038       48       42       5       208
13134       49       42       5        31
13377       50       42       5         1
average_rating for this rec across 50 users from same group (less noisy) was: 4.74
all_actions shape just before sample torch.Size([1, 3, 1])
action scaled by temperature: tensor([[65]], device='cuda:0')
action picked by argmax: tensor([167], device='cuda:0')
tensor([[167,  65, 100, 205,  23, 251,  44,  63,  66,  61]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
38          1      168       5        39
418         2      168       3       146
699         3      168       4       154
928         4      168       5       110
1133        5      168       5        42
       user_id  item_id  rating  timestep
12493       46      168       3       209
12781       47      168       4       224
12921       48      168       3        91
13219       49      168       5       116
13564       50      168       4       188
average_rating for this rec across 50 users from same group (less noisy) was: 4.08
all_actions shape just before sample torch.Size([1, 4, 1])
action scaled by temperature: tensor([[38]], device='cuda:0')
action picked by argmax: tensor([38], device='cuda:0')
tensor([[ 38,  95, 147, 178,  65, 249, 264,  10,  39, 263]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
264         1       39       3       265
276         2       39       3         4
670         3       39       2       125
899         4       39       3        81
1171        5       39       4        80
       user_id  item_id  rating  timestep
12532       46       39       3       248
12562       47       39       3         5
13086       48       39       2       256
13210       49       39       3       107
13467       50       39       3        91
average_rating for this rec across 50 users from same group (less noisy) was: 3.04
all_actions shape just before sample torch.Size([1, 5, 1])
action scaled by temperature: tensor([[10]], device='cuda:0')
action picked by argmax: tensor([95], device='cuda:0')
tensor([[ 95,  10,  38,  41, 114,  74, 147, 178,  21,  17]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
167         1       96       3       168
352         2       96       3        80
654         3       96       5       109
879         4       96       3        61
1136        5       96       3        45
       user_id  item_id  rating  timestep
12407       46       96       3       123
12748       47       96       4       191
12851       48       96       4        21
13222       49       96       5       119
13437       50       96       4        61
average_rating for this rec across 50 users from same group (less noisy) was: 3.9
all_actions shape just before sample torch.Size([1, 6, 1])
action scaled by temperature: tensor([[10]], device='cuda:0')
action picked by argmax: tensor([10], device='cuda:0')
tensor([[ 10,  17,  95, 145,  38, 241,  14, 230, 219, 148]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
183         1       11       1       184
302         2       11       4        30
616         3       11       3        71
877         4       11       2        59
1096        5       11       3         5
       user_id  item_id  rating  timestep
12340       46       11       2        56
12829       47       11       1       272
12922       48       11       3        92
13155       49       11       2        52
13410       50       11       2        34
average_rating for this rec across 50 users from same group (less noisy) was: 2.2
all_actions shape just before sample torch.Size([1, 7, 1])
action scaled by temperature: tensor([[15]], device='cuda:0')
action picked by argmax: tensor([15], device='cuda:0')
tensor([[ 15, 199,  19,  11,  36, 145, 102, 152,  90, 144]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
152         1       16       4       153
280         2       16       4         8
592         3       16       5        47
840         4       16       4        22
1318        5       16       4       227
       user_id  item_id  rating  timestep
12368       46       16       4        84
12646       47       16       4        89
13001       48       16       4       171
13274       49       16       5       171
13435       50       16       3        59
average_rating for this rec across 50 users from same group (less noisy) was: 4.12
all_actions shape just before sample torch.Size([1, 8, 1])
action scaled by temperature: tensor([[18]], device='cuda:0')
action picked by argmax: tensor([18], device='cuda:0')
tensor([[ 18, 170,  44, 138, 219,  84, 271, 203, 235, 260]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
84          1       19       4        85
507         2       19       5       235
684         3       19       5       139
851         4       19       5        33
1163        5       19       5        72
       user_id  item_id  rating  timestep
12466       46       19       4       182
12792       47       19       5       235
13089       48       19       4       259
13200       49       19       4        97
13586       50       19       3       210
average_rating for this rec across 50 users from same group (less noisy) was: 4.42
all_actions shape just before sample torch.Size([1, 9, 1])
action scaled by temperature: tensor([[170]], device='cuda:0')
action picked by argmax: tensor([170], device='cuda:0')
tensor([[170,  32, 102, 180,  28,  18, 265, 259,  30, 203]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
80          1      171       5        81
348         2      171       4        76
556         3      171       3        11
1027        4      171       3       209
1299        5      171       5       208
       user_id  item_id  rating  timestep
12477       46      171       3       193
12826       47      171       4       269
12852       48      171       5        22
13357       49      171       5       254
13476       50      171       4       100
average_rating for this rec across 50 users from same group (less noisy) was: 3.96
all_actions shape just before sample torch.Size([1, 10, 1])
action scaled by temperature: tensor([[32]], device='cuda:0')
action picked by argmax: tensor([32], device='cuda:0')
tensor([[ 32, 170, 180, 157,  28,  47, 160, 199,  77,  58]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
117         1       33       3       118
463         2       33       2       191
738         3       33       2       193
837         4       33       5        19
1267        5       33       3       176
       user_id  item_id  rating  timestep
12454       46       33       4       170
12590       47       33       4        33
12848       48       33       4        18
13360       49       33       4       257
13418       50       33       5        42
average_rating for this rec across 50 users from same group (less noisy) was: 3.6
all_actions shape just before sample torch.Size([1, 11, 1])
action scaled by temperature: tensor([[160]], device='cuda:0')
action picked by argmax: tensor([160], device='cuda:0')
tensor([[160,  43, 263,  92,  50, 119, 225, 125,  32, 223]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
202         1      161       4       203
473         2      161       5       201
806         3      161       4       261
907         4      161       4        89
1158        5      161       5        67
       user_id  item_id  rating  timestep
12310       46      161       4        26
12731       47      161       3       174
12919       48      161       5        89
13203       49      161       3       100
13523       50      161       4       147
average_rating for this rec across 50 users from same group (less noisy) was: 4.24
all_actions shape just before sample torch.Size([1, 12, 1])
action scaled by temperature: tensor([[75]], device='cuda:0')
action picked by argmax: tensor([75], device='cuda:0')
tensor([[ 75, 125,  94, 238, 209, 124, 225, 223,  67,  50]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
76          1       76       5        77
330         2       76       4        58
571         3       76       3        26
915         4       76       4        97
1167        5       76       4        76
       user_id  item_id  rating  timestep
12440       46       76       3       156
12588       47       76       4        31
12957       48       76       3       127
13325       49       76       5       222
13468       50       76       5        92
average_rating for this rec across 50 users from same group (less noisy) was: 4.04
all_actions shape just before sample torch.Size([1, 13, 1])
action scaled by temperature: tensor([[125]], device='cuda:0')
action picked by argmax: tensor([125], device='cuda:0')
tensor([[125, 199,  75, 124, 232,  94,  67, 179, 238,  13]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
204         1      126       5       205
367         2      126       3        95
594         3      126       3        49
1031        4      126       2       213
1200        5      126       3       109
       user_id  item_id  rating  timestep
12366       46      126       3        82
12598       47      126       3        41
13012       48      126       3       182
13223       49      126       4       120
13647       50      126       4       271
average_rating for this rec across 50 users from same group (less noisy) was: 3.32
all_actions shape just before sample torch.Size([1, 14, 1])
action scaled by temperature: tensor([[199]], device='cuda:0')
action picked by argmax: tensor([199], device='cuda:0')
tensor([[199, 125, 168, 246, 232,  66, 206,  53, 249, 107]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
78          1      200       3        79
285         2      200       3        13
644         3      200       4        99
855         4      200       4        37
1249        5      200       5       158
       user_id  item_id  rating  timestep
12286       46      200       5         2
12625       47      200       5        68
13016       48      200       4       186
13186       49      200       5        83
13509       50      200       4       133
average_rating for this rec across 50 users from same group (less noisy) was: 4.04
all_actions shape just before sample torch.Size([1, 15, 1])
action scaled by temperature: tensor([[246]], device='cuda:0')
action picked by argmax: tensor([246], device='cuda:0')
tensor([[246,  63, 124, 100, 218, 204,   2, 199, 209, 168]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
185         1      247       4       186
384         2      247       4       112
620         3      247       5        75
986         4      247       5       168
1337        5      247       4       246
       user_id  item_id  rating  timestep
12355       46      247       4        71
12740       47      247       4       183
12928       48      247       5        98
13339       49      247       3       236
13639       50      247       4       263
average_rating for this rec across 50 users from same group (less noisy) was: 4.12
all_actions shape just before sample torch.Size([1, 16, 1])
action scaled by temperature: tensor([[63]], device='cuda:0')
action picked by argmax: tensor([63], device='cuda:0')
tensor([[ 63, 223, 100, 216,  78, 246, 124, 209, 136, 126]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
227         1       64       5       228
530         2       64       4       258
781         3       64       4       236
1036        4       64       5       218
1148        5       64       5        57
       user_id  item_id  rating  timestep
12401       46       64       3       117
12630       47       64       3        73
12869       48       64       4        39
13138       49       64       5        35
13605       50       64       4       229
average_rating for this rec across 50 users from same group (less noisy) was: 3.82
all_actions shape just before sample torch.Size([1, 17, 1])
action scaled by temperature: tensor([[124]], device='cuda:0')
action picked by argmax: tensor([124], device='cuda:0')
tensor([[124,   2, 246, 126, 132, 218, 100,  55, 151,  96]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
203         1      125       3       204
439         2      125       5       167
584         3      125       5        39
959         4      125       5       141
1123        5      125       3        32
       user_id  item_id  rating  timestep
12347       46      125       4        63
12670       47      125       5       113
13037       48      125       3       207
13144       49      125       4        41
13613       50      125       5       237
average_rating for this rec across 50 users from same group (less noisy) was: 3.92
all_actions shape just before sample torch.Size([1, 18, 1])
action scaled by temperature: tensor([[2]], device='cuda:0')
action picked by argmax: tensor([2], device='cuda:0')
tensor([[  2, 124, 204,  33, 197, 253, 161,  23, 246,   7]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
49          1        3       5        50
449         2        3       5       177
615         3        3       5        70
1079        4        3       4       261
1268        5        3       5       177
       user_id  item_id  rating  timestep
12381       46        3       4        97
12621       47        3       5        64
13073       48        3       5       243
13160       49        3       4        57
13549       50        3       5       173
average_rating for this rec across 50 users from same group (less noisy) was: 4.72
all_actions shape just before sample torch.Size([1, 19, 1])
action scaled by temperature: tensor([[158]], device='cuda:0')
action picked by argmax: tensor([158], device='cuda:0')
tensor([[158, 255, 257,   3, 270, 202, 201,  60, 131, 133]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
129         1      159       3       130
480         2      159       3       208
579         3      159       3        34
1057        4      159       3       239
1270        5      159       2       179
       user_id  item_id  rating  timestep
12525       46      159       5       241
12736       47      159       4       179
12973       48      159       5       143
13326       49      159       4       223
13490       50      159       4       114
average_rating for this rec across 50 users from same group (less noisy) was: 3.6
all_actions shape just before sample torch.Size([1, 20, 1])
action scaled by temperature: tensor([[58]], device='cuda:0')
action picked by argmax: tensor([58], device='cuda:0')
tensor([[ 58,  83, 150,  42, 185, 187, 196,  37, 116,  56]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
40          1       59       4        41
309         2       59       4        37
622         3       59       4        77
1063        4       59       3       245
1144        5       59       4        53
       user_id  item_id  rating  timestep
12484       46       59       4       200
12757       47       59       4       200
12968       48       59       4       138
13243       49       59       4       140
13594       50       59       4       218
average_rating for this rec across 50 users from same group (less noisy) was: 4.16
all_actions shape just before sample torch.Size([1, 21, 1])
action scaled by temperature: tensor([[83]], device='cuda:0')
action picked by argmax: tensor([83], device='cuda:0')
tensor([[ 83,  58,  42,  37, 185, 196, 150,  56, 187, 107]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
255         1       84       3       256
303         2       84       5        31
754         3       84       4       209
850         4       84       4        32
1230        5       84       5       139
       user_id  item_id  rating  timestep
12517       46       84       4       233
12799       47       84       5       242
12936       48       84       5       106
13329       49       84       5       226
13635       50       84       4       259
average_rating for this rec across 50 users from same group (less noisy) was: 4.2
all_actions shape just before sample torch.Size([1, 22, 1])
action scaled by temperature: tensor([[42]], device='cuda:0')
action picked by argmax: tensor([42], device='cuda:0')
tensor([[ 42,  58, 185,  37, 126,  83, 152, 217,  68, 150]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
208         1       43       2       209
518         2       43       5       246
577         3       43       5        32
981         4       43       4       163
1203        5       43       4       112
       user_id  item_id  rating  timestep
12510       46       43       3       226
12665       47       43       3       108
12896       48       43       5        66
13195       49       43       4        92
13464       50       43       3        88
average_rating for this rec across 50 users from same group (less noisy) was: 3.86
all_actions shape just before sample torch.Size([1, 23, 1])
action scaled by temperature: tensor([[185]], device='cuda:0')
action picked by argmax: tensor([185], device='cuda:0')
tensor([[185, 100,  15, 151, 152, 204, 246, 235, 223,  60]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
149         1      186       3       150
283         2      186       3        11
635         3      186       2        90
1052        4      186       4       234
1137        5      186       3        46
       user_id  item_id  rating  timestep
12412       46      186       4       128
12689       47      186       2       132
12858       48      186       3        28
13206       49      186       4       103
13612       50      186       3       236
average_rating for this rec across 50 users from same group (less noisy) was: 3.22
all_actions shape just before sample torch.Size([1, 24, 1])
action scaled by temperature: tensor([[252]], device='cuda:0')
action picked by argmax: tensor([252], device='cuda:0')
tensor([[252, 271, 126, 215, 269, 169, 121, 266, 171, 167]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
53          1      253       5        54
325         2      253       5        53
761         3      253       5       216
1068        4      253       5       250
1176        5      253       5        85
       user_id  item_id  rating  timestep
12446       46      253       5       162
12791       47      253       5       234
13019       48      253       5       189
13220       49      253       5       117
13580       50      253       5       204
average_rating for this rec across 50 users from same group (less noisy) was: 4.7
all_actions shape just before sample torch.Size([1, 25, 1])
action scaled by temperature: tensor([[242]], device='cuda:0')
action picked by argmax: tensor([242], device='cuda:0')
tensor([[242,  42, 190,  66, 150,  80, 176,  91, 257, 140]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
236         1      243       4       237
365         2      243       5        93
703         3      243       5       158
1014        4      243       4       196
1106        5      243       5        15
       user_id  item_id  rating  timestep
12544       46      243       4       260
12745       47      243       4       188
13024       48      243       2       194
13154       49      243       3        51
13427       50      243       4        51
average_rating for this rec across 50 users from same group (less noisy) was: 3.8
all_actions shape just before sample torch.Size([1, 26, 1])
action scaled by temperature: tensor([[150]], device='cuda:0')
action picked by argmax: tensor([150], device='cuda:0')
tensor([[150, 269, 242,  66,  80, 224, 113, 197, 117, 171]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
110         1      151       4       111
405         2      151       3       133
700         3      151       4       155
947         4      151       3       129
1285        5      151       4       194
       user_id  item_id  rating  timestep
12315       46      151       4        31
12694       47      151       2       137
13066       48      151       5       236
13161       49      151       2        58
13520       50      151       4       144
average_rating for this rec across 50 users from same group (less noisy) was: 3.64
all_actions shape just before sample torch.Size([1, 27, 1])
action scaled by temperature: tensor([[269]], device='cuda:0')
action picked by argmax: tensor([269], device='cuda:0')
tensor([[269, 252,  66,   5, 188, 113, 200, 117, 212, 187]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
164         1      270       5       165
417         2      270       4       145
772         3      270       5       227
863         4      270       5        45
1211        5      270       5       120
       user_id  item_id  rating  timestep
12341       46      270       4        57
12626       47      270       4        69
12885       48      270       3        55
13182       49      270       4        79
13453       50      270       4        77
average_rating for this rec across 50 users from same group (less noisy) was: 4.28
all_actions shape just before sample torch.Size([1, 28, 1])
action scaled by temperature: tensor([[5]], device='cuda:0')
action picked by argmax: tensor([5], device='cuda:0')
tensor([[  5,  54, 270, 240, 139,  95, 196, 148, 145, 213]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
133         1        6       5       134
431         2        6       5       159
655         3        6       5       110
968         4        6       4       150
1206        5        6       3       115
       user_id  item_id  rating  timestep
12316       46        6       5        32
12746       47        6       3       189
13036       48        6       4       206
13216       49        6       5       113
13602       50        6       5       226
average_rating for this rec across 50 users from same group (less noisy) was: 4.02
all_actions shape just before sample torch.Size([1, 29, 1])
action scaled by temperature: tensor([[54]], device='cuda:0')
action picked by argmax: tensor([54], device='cuda:0')
tensor([[ 54,   5, 113, 270, 212,  14, 213, 123,  51, 139]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
95          1       55       4        96
316         2       55       4        44
718         3       55       5       173
1034        4       55       5       216
1274        5       55       4       183
       user_id  item_id  rating  timestep
12450       46       55       3       166
12817       47       55       3       260
13041       48       55       4       211
13121       49       55       3        18
13504       50       55       3       128
average_rating for this rec across 50 users from same group (less noisy) was: 3.88
all_actions shape just before sample torch.Size([1, 30, 1])
action scaled by temperature: tensor([[102]], device='cuda:0')
action picked by argmax: tensor([102], device='cuda:0')
tensor([[102,  11, 106,   5, 234,  15, 155,  54, 233,   0]], device='cuda:0')
Just recommended 30 new items to 50 users from group 1 and the total rating was 117.17999999999998
train_loss is: 0.8391315379099215
action scaled by temperature: tensor([[43]], device='cuda:0')
action picked by argmax: tensor([101], device='cuda:0')
tensor([[101, 215, 267,  30, 246, 238,  83, 110, 205, 233]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
103         1      102       4       104
377         2      102       4       105
581         3      102       3        36
1082        4      102       5       264
1107        5      102       4        16
       user_id  item_id  rating  timestep
12374       46      102       5        90
12638       47      102       5        81
12875       48      102       5        45
13115       49      102       5        12
13571       50      102       4       195
average_rating for this rec across 50 users from same group (less noisy) was: 4.1
all_actions shape just before sample torch.Size([1, 1, 1])
action scaled by temperature: tensor([[121]], device='cuda:0')
action picked by argmax: tensor([263], device='cuda:0')
tensor([[263, 167,  41,  17, 262, 154, 121, 245, 215, 216]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
24          1      264       4        25
491         2      264       3       219
715         3      264       3       170
1039        4      264       5       221
1334        5      264       4       243
       user_id  item_id  rating  timestep
12302       46      264       5        18
12567       47      264       4        10
12976       48      264       4       146
13241       49      264       4       138
13515       50      264       5       139
average_rating for this rec across 50 users from same group (less noisy) was: 4.42
all_actions shape just before sample torch.Size([1, 2, 1])
action scaled by temperature: tensor([[227]], device='cuda:0')
action picked by argmax: tensor([222], device='cuda:0')
tensor([[222, 186, 227,  32, 180, 117, 270,  92, 171,  14]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
198         1      223       3       199
386         2      223       4       114
640         3      223       5        95
936         4      223       5       118
1310        5      223       4       219
       user_id  item_id  rating  timestep
12409       46      223       5       125
12619       47      223       5        62
12967       48      223       4       137
13372       49      223       5       269
13567       50      223       4       191
average_rating for this rec across 50 users from same group (less noisy) was: 4.54
all_actions shape just before sample torch.Size([1, 3, 1])
action scaled by temperature: tensor([[108]], device='cuda:0')
action picked by argmax: tensor([108], device='cuda:0')
tensor([[108, 147, 198,  41, 163,  87, 205,  36, 180,  23]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
217         1      109       4       218
521         2      109       5       249
808         3      109       4       263
1013        4      109       5       195
1332        5      109       5       241
       user_id  item_id  rating  timestep
12395       46      109       5       111
12654       47      109       5        97
13079       48      109       5       249
13139       49      109       5        36
13588       50      109       5       212
average_rating for this rec across 50 users from same group (less noisy) was: 4.9
all_actions shape just before sample torch.Size([1, 4, 1])
action scaled by temperature: tensor([[147]], device='cuda:0')
action picked by argmax: tensor([147], device='cuda:0')
tensor([[147, 186,  41,  32,  29, 142, 262, 233, 144,  23]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
246         1      148       5       247
493         2      148       3       221
652         3      148       3       107
961         4      148       4       143
1311        5      148       3       220
       user_id  item_id  rating  timestep
12463       46      148       4       179
12766       47      148       4       209
13010       48      148       4       180
13299       49      148       4       196
13532       50      148       3       156
average_rating for this rec across 50 users from same group (less noisy) was: 3.76
all_actions shape just before sample torch.Size([1, 5, 1])
action scaled by temperature: tensor([[24]], device='cuda:0')
action picked by argmax: tensor([24], device='cuda:0')
tensor([[ 24, 159, 153, 229, 164,  41, 116, 218,  47, 272]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
50          1       25       5        51
277         2       25       4         5
749         3       25       4       204
1042        4       25       5       224
1232        5       25       5       141
       user_id  item_id  rating  timestep
12295       46       25       5        11
12795       47       25       4       238
13004       48       25       5       174
13315       49       25       4       212
13403       50       25       4        27
average_rating for this rec across 50 users from same group (less noisy) was: 4.68
all_actions shape just before sample torch.Size([1, 6, 1])
action scaled by temperature: tensor([[159]], device='cuda:0')
action picked by argmax: tensor([159], device='cuda:0')
tensor([[159, 174, 116,  47, 221,  91, 164,  37,  24, 150]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
48          1      160       3        49
514         2      160       4       242
790         3      160       3       245
849         4      160       3        31
1264        5      160       4       173
       user_id  item_id  rating  timestep
12473       46      160       5       189
12595       47      160       3        38
13099       48      160       4       269
13202       49      160       2        99
13526       50      160       3       150
average_rating for this rec across 50 users from same group (less noisy) was: 3.56
all_actions shape just before sample torch.Size([1, 7, 1])
action scaled by temperature: tensor([[37]], device='cuda:0')
action picked by argmax: tensor([37], device='cuda:0')
tensor([[ 37,  88,  41, 188, 114, 120, 164,  22, 100, 205]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
118         1       38       3       119
455         2       38       2       183
757         3       38       5       212
856         4       38       4        38
1253        5       38       5       162
       user_id  item_id  rating  timestep
12320       46       38       2        36
12622       47       38       3        65
13068       48       38       3       238
13336       49       38       3       233
13466       50       38       5        90
average_rating for this rec across 50 users from same group (less noisy) was: 3.36
all_actions shape just before sample torch.Size([1, 8, 1])
action scaled by temperature: tensor([[185]], device='cuda:0')
action picked by argmax: tensor([185], device='cuda:0')
tensor([[185, 116, 159, 203, 257, 188, 166, 191, 167, 218]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
149         1      186       3       150
283         2      186       3        11
635         3      186       2        90
1052        4      186       4       234
1137        5      186       3        46
       user_id  item_id  rating  timestep
12412       46      186       4       128
12689       47      186       2       132
12858       48      186       3        28
13206       49      186       4       103
13612       50      186       3       236
average_rating for this rec across 50 users from same group (less noisy) was: 3.22
all_actions shape just before sample torch.Size([1, 9, 1])
action scaled by temperature: tensor([[235]], device='cuda:0')
action picked by argmax: tensor([235], device='cuda:0')
tensor([[235, 174,  62,  96, 164,  78, 258, 212, 176, 154]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
57          1      236       5        58
392         2      236       4       120
770         3      236       4       225
825         4      236       5         7
1151        5      236       4        60
       user_id  item_id  rating  timestep
12321       46      236       3        37
12669       47      236       5       112
12940       48      236       3       110
13113       49      236       4        10
13638       50      236       3       262
average_rating for this rec across 50 users from same group (less noisy) was: 4.26
all_actions shape just before sample torch.Size([1, 10, 1])
action scaled by temperature: tensor([[174]], device='cuda:0')
action picked by argmax: tensor([174], device='cuda:0')
tensor([[174, 176,  62, 235,  96,  89, 214, 121, 249,  99]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
215         1      175       5       216
403         2      175       3       131
698         3      175       5       153
1024        4      175       5       206
1243        5      175       4       152
       user_id  item_id  rating  timestep
12292       46      175       4         8
12752       47      175       4       195
13084       48      175       5       254
13258       49      175       5       155
13595       50      175       4       219
average_rating for this rec across 50 users from same group (less noisy) was: 4.58
all_actions shape just before sample torch.Size([1, 11, 1])
action scaled by temperature: tensor([[28]], device='cuda:0')
action picked by argmax: tensor([28], device='cuda:0')
tensor([[ 28, 119,  15,  64, 109, 203, 138,  54, 170, 270]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
189         1       29       4       190
450         2       29       3       178
625         3       29       2        80
908         4       29       4        90
1359        5       29       3       268
       user_id  item_id  rating  timestep
12424       46       29       3       140
12661       47       29       4       104
12989       48       29       4       159
13239       49       29       3       136
13445       50       29       3        69
average_rating for this rec across 50 users from same group (less noisy) was: 3.58
all_actions shape just before sample torch.Size([1, 12, 1])
action scaled by temperature: tensor([[119]], device='cuda:0')
action picked by argmax: tensor([119], device='cuda:0')
tensor([[119,  11, 203, 109,  31, 244, 162, 138,  54,  77]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
138         1      120       5       139
524         2      120       4       252
674         3      120       2       129
957         4      120       2       139
1242        5      120       3       151
       user_id  item_id  rating  timestep
12334       46      120       4        50
12574       47      120       3        17
12876       48      120       5        46
13120       49      120       5        17
13389       50      120       5        13
average_rating for this rec across 50 users from same group (less noisy) was: 3.74
all_actions shape just before sample torch.Size([1, 13, 1])
action scaled by temperature: tensor([[203]], device='cuda:0')
action picked by argmax: tensor([203], device='cuda:0')
tensor([[203,  31,  54, 138, 239, 235, 271, 119, 244, 210]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
63          1      204       3        64
400         2      204       3       128
755         3      204       3       210
1045        4      204       4       227
1220        5      204       3       129
       user_id  item_id  rating  timestep
12398       46      204       4       114
12571       47      204       5        14
12977       48      204       3       147
13282       49      204       4       179
13547       50      204       4       171
average_rating for this rec across 50 users from same group (less noisy) was: 3.52
all_actions shape just before sample torch.Size([1, 14, 1])
action scaled by temperature: tensor([[31]], device='cuda:0')
action picked by argmax: tensor([31], device='cuda:0')
tensor([[ 31, 203, 210, 138, 155, 157, 244, 271,  65,  28]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
207         1       32       4       208
505         2       32       4       233
813         3       32       5       268
833         4       32       5        15
1309        5       32       4       218
       user_id  item_id  rating  timestep
12338       46       32       3        54
12783       47       32       3       226
12917       48       32       5        87
13318       49       32       4       215
13390       50       32       3        14
average_rating for this rec across 50 users from same group (less noisy) was: 4.1
all_actions shape just before sample torch.Size([1, 15, 1])
action scaled by temperature: tensor([[97]], device='cuda:0')
action picked by argmax: tensor([97], device='cuda:0')
tensor([[ 97, 213, 211, 111, 150, 161,   8, 260, 262,  31]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
174         1       98       4       175
414         2       98       4       142
681         3       98       2       136
941         4       98       3       123
1120        5       98       3        29
       user_id  item_id  rating  timestep
12465       46       98       4       181
12789       47       98       3       232
13078       48       98       4       248
13292       49       98       4       189
13565       50       98       4       189
average_rating for this rec across 50 users from same group (less noisy) was: 3.52
all_actions shape just before sample torch.Size([1, 16, 1])
action scaled by temperature: tensor([[213]], device='cuda:0')
action picked by argmax: tensor([213], device='cuda:0')
tensor([[213,  13,  94, 159, 150,  75,  97, 262, 207, 163]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
20          1      214       4        21
346         2      214       4        74
771         3      214       5       226
830         4      214       4        12
1348        5      214       4       257
       user_id  item_id  rating  timestep
12303       46      214       5        19
12776       47      214       5       219
12942       48      214       3       112
13250       49      214       3       147
13409       50      214       5        33
average_rating for this rec across 50 users from same group (less noisy) was: 4.12
all_actions shape just before sample torch.Size([1, 17, 1])
action scaled by temperature: tensor([[13]], device='cuda:0')
action picked by argmax: tensor([13], device='cuda:0')
tensor([[ 13, 183,  27, 270, 171, 117,  51, 108, 194, 209]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
265         1       14       5       266
319         2       14       5        47
782         3       14       4       237
1043        4       14       4       225
1336        5       14       5       245
       user_id  item_id  rating  timestep
12497       46       14       4       213
12794       47       14       5       237
13093       48       14       4       263
13293       49       14       5       190
13396       50       14       5        20
average_rating for this rec across 50 users from same group (less noisy) was: 4.64
all_actions shape just before sample torch.Size([1, 18, 1])
action scaled by temperature: tensor([[183]], device='cuda:0')
action picked by argmax: tensor([183], device='cuda:0')
tensor([[183,  27,  13,  51,  76, 270,  77, 171, 108, 209]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
21          1      184       4        22
416         2      184       4       144
817         3      184       4       272
966         4      184       4       148
1239        5      184       4       148
       user_id  item_id  rating  timestep
12555       46      184       4       271
12741       47      184       4       184
12929       48      184       3        99
13232       49      184       2       129
13497       50      184       5       121
average_rating for this rec across 50 users from same group (less noisy) was: 3.9
all_actions shape just before sample torch.Size([1, 19, 1])
action scaled by temperature: tensor([[76]], device='cuda:0')
action picked by argmax: tensor([76], device='cuda:0')
tensor([[ 76, 183,  13,  70, 209,   0, 132,  51,  79, 121]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
243         1       77       5       244
432         2       77       5       160
743         3       77       5       198
835         4       77       4        17
1233        5       77       4       142
       user_id  item_id  rating  timestep
12393       46       77       3       109
12719       47       77       4       162
13098       48       77       5       268
13143       49       77       4        40
13500       50       77       3       124
average_rating for this rec across 50 users from same group (less noisy) was: 3.96
all_actions shape just before sample torch.Size([1, 20, 1])
action scaled by temperature: tensor([[60]], device='cuda:0')
action picked by argmax: tensor([60], device='cuda:0')
tensor([[ 60, 148, 123,  54, 181, 210, 255, 126, 100, 245]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
107         1       61       5       108
402         2       61       5       130
784         3       61       5       239
904         4       61       5        86
1135        5       61       4        44
       user_id  item_id  rating  timestep
12522       46       61       5       238
12713       47       61       4       156
12883       48       61       3        53
13153       49       61       5        50
13536       50       61       5       160
average_rating for this rec across 50 users from same group (less noisy) was: 4.38
all_actions shape just before sample torch.Size([1, 21, 1])
action scaled by temperature: tensor([[148]], device='cuda:0')
action picked by argmax: tensor([148], device='cuda:0')
tensor([[148, 255, 123,  43, 168,  22, 249, 254, 272,  60]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
222         1      149       2       223
489         2      149       4       217
780         3      149       3       235
836         4      149       3        18
1112        5      149       3        21
       user_id  item_id  rating  timestep
12501       46      149       3       217
12704       47      149       3       147
12841       48      149       4        11
13331       49      149       4       228
13494       50      149       4       118
average_rating for this rec across 50 users from same group (less noisy) was: 3.48
all_actions shape just before sample torch.Size([1, 22, 1])
action scaled by temperature: tensor([[255]], device='cuda:0')
action picked by argmax: tensor([255], device='cuda:0')
tensor([[255,  43,  51, 249, 189,  81, 166, 126,  92, 168]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
85          1      256       2        86
409         2      256       4       137
693         3      256       4       148
889         4      256       5        71
1191        5      256       5       100
       user_id  item_id  rating  timestep
12509       46      256       4       225
12728       47      256       4       171
12993       48      256       5       163
13128       49      256       5        25
13480       50      256       4       104
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 23, 1])
action scaled by temperature: tensor([[43]], device='cuda:0')
action picked by argmax: tensor([43], device='cuda:0')
tensor([[ 43, 249, 268, 189, 140, 212, 255, 221, 169, 168]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
267         1       44       4       268
341         2       44       4        69
706         3       44       4       161
939         4       44       4       121
1331        5       44       4       240
       user_id  item_id  rating  timestep
12435       46       44       3       151
12717       47       44       4       160
13103       48       44       3       273
13146       49       44       3        43
13615       50       44       4       239
average_rating for this rec across 50 users from same group (less noisy) was: 3.74
all_actions shape just before sample torch.Size([1, 24, 1])
action scaled by temperature: tensor([[150]], device='cuda:0')
action picked by argmax: tensor([150], device='cuda:0')
tensor([[150, 176, 224, 253,  73, 241,  83, 111, 112,  81]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
110         1      151       4       111
405         2      151       3       133
700         3      151       4       155
947         4      151       3       129
1285        5      151       4       194
       user_id  item_id  rating  timestep
12315       46      151       4        31
12694       47      151       2       137
13066       48      151       5       236
13161       49      151       2        58
13520       50      151       4       144
average_rating for this rec across 50 users from same group (less noisy) was: 3.64
all_actions shape just before sample torch.Size([1, 25, 1])
action scaled by temperature: tensor([[19]], device='cuda:0')
action picked by argmax: tensor([19], device='cuda:0')
tensor([[ 19, 231, 233, 186, 111, 135, 193,   9, 203,  50]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
216         1       20       5       217
314         2       20       4        42
634         3       20       5        89
956         4       20       5       138
1316        5       20       3       225
       user_id  item_id  rating  timestep
12535       46       20       5       251
12580       47       20       5        23
12889       48       20       5        59
13188       49       20       4        85
13439       50       20       4        63
average_rating for this rec across 50 users from same group (less noisy) was: 4.56
all_actions shape just before sample torch.Size([1, 26, 1])
action scaled by temperature: tensor([[231]], device='cuda:0')
action picked by argmax: tensor([231], device='cuda:0')
tensor([[231, 113, 107,  19, 225, 169, 124, 251, 218,  51]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
250         1      232       4       251
469         2      232       4       197
557         3      232       4        12
922         4      232       5       104
1265        5      232       5       174
       user_id  item_id  rating  timestep
12299       46      232       5        15
12815       47      232       3       258
12865       48      232       4        35
13142       49      232       5        39
13469       50      232       3        93
average_rating for this rec across 50 users from same group (less noisy) was: 4.38
all_actions shape just before sample torch.Size([1, 27, 1])
action scaled by temperature: tensor([[113]], device='cuda:0')
action picked by argmax: tensor([113], device='cuda:0')
tensor([[113, 231,  30,  79, 169, 194, 238,  50,  15, 159]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
109         1      114       4       110
324         2      114       3        52
744         3      114       4       199
920         4      114       5       102
1160        5      114       5        69
       user_id  item_id  rating  timestep
12470       46      114       3       186
12608       47      114       4        51
13034       48      114       4       204
13365       49      114       4       262
13593       50      114       5       217
average_rating for this rec across 50 users from same group (less noisy) was: 4.24
all_actions shape just before sample torch.Size([1, 28, 1])
action scaled by temperature: tensor([[240]], device='cuda:0')
action picked by argmax: tensor([240], device='cuda:0')
tensor([[240, 234, 141,  44, 161, 188,  81, 231,  17, 138]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
200         1      241       4       201
397         2      241       5       125
583         3      241       2        38
883         4      241       4        65
1199        5      241       4       108
       user_id  item_id  rating  timestep
12545       46      241       5       261
12770       47      241       3       213
13006       48      241       5       176
13145       49      241       5        42
13557       50      241       3       181
average_rating for this rec across 50 users from same group (less noisy) was: 3.62
all_actions shape just before sample torch.Size([1, 29, 1])
action scaled by temperature: tensor([[141]], device='cuda:0')
action picked by argmax: tensor([141], device='cuda:0')
tensor([[141, 161, 134,   2,  54, 160, 165, 211,  16, 231]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
1           1      142       4         2
459         2      142       5       187
818         3      142       4       273
1091        4      142       5       273
1169        5      142       4        78
       user_id  item_id  rating  timestep
12356       46      142       5        72
12768       47      142       5       211
13009       48      142       4       179
13205       49      142       5       102
13514       50      142       5       138
average_rating for this rec across 50 users from same group (less noisy) was: 4.72
all_actions shape just before sample torch.Size([1, 30, 1])
action scaled by temperature: tensor([[211]], device='cuda:0')
action picked by argmax: tensor([211], device='cuda:0')
tensor([[211,  29, 241, 141,   2, 131,   0, 231,  93,  75]], device='cuda:0')
Just recommended 30 new items to 50 users from group 1 and the total rating was 121.28
train_loss is: 0.925891102993325
action scaled by temperature: tensor([[168]], device='cuda:0')
action picked by argmax: tensor([215], device='cuda:0')
tensor([[215, 233,  30,  95,  94, 167, 109,  35, 212, 150]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
96          1      216       5        97
545         2      216       3       273
668         3      216       4       123
823         4      216       4         5
1103        5      216       5        12
       user_id  item_id  rating  timestep
12524       46      216       3       240
12735       47      216       3       178
12901       48      216       4        71
13359       49      216       4       256
13563       50      216       5       187
average_rating for this rec across 50 users from same group (less noisy) was: 3.64
all_actions shape just before sample torch.Size([1, 1, 1])
action scaled by temperature: tensor([[203]], device='cuda:0')
action picked by argmax: tensor([129], device='cuda:0')
tensor([[129, 174,  76, 119, 165, 159,  75,  96, 109,  54]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
165         1      130       4       166
533         2      130       5       261
759         3      130       5       214
895         4      130       5        77
1182        5      130       4        91
       user_id  item_id  rating  timestep
12417       46      130       5       133
12813       47      130       5       256
13076       48      130       5       246
13229       49      130       5       126
13570       50      130       5       194
average_rating for this rec across 50 users from same group (less noisy) was: 4.46
all_actions shape just before sample torch.Size([1, 2, 1])
action scaled by temperature: tensor([[154]], device='cuda:0')
action picked by argmax: tensor([154], device='cuda:0')
tensor([[154,  52,  50, 258, 212, 113, 151,  30, 153,  90]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
249         1      155       5       250
345         2      155       2        73
697         3      155       4       152
819         4      155       4         1
1100        5      155       3         9
       user_id  item_id  rating  timestep
12437       46      155       2       153
12774       47      155       4       217
13033       48      155       3       203
13343       49      155       4       240
13482       50      155       3       106
average_rating for this rec across 50 users from same group (less noisy) was: 3.44
all_actions shape just before sample torch.Size([1, 3, 1])
action scaled by temperature: tensor([[14]], device='cuda:0')
action picked by argmax: tensor([83], device='cuda:0')
tensor([[ 83, 180, 238, 154,  52, 105, 173, 213, 119,  48]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
255         1       84       3       256
303         2       84       5        31
754         3       84       4       209
850         4       84       4        32
1230        5       84       5       139
       user_id  item_id  rating  timestep
12517       46       84       4       233
12799       47       84       5       242
12936       48       84       5       106
13329       49       84       5       226
13635       50       84       4       259
average_rating for this rec across 50 users from same group (less noisy) was: 4.2
all_actions shape just before sample torch.Size([1, 4, 1])
action scaled by temperature: tensor([[214]], device='cuda:0')
action picked by argmax: tensor([214], device='cuda:0')
tensor([[214, 138, 180,  37,  28, 184, 119, 248, 267, 236]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
51          1      215       4        52
503         2      215       4       231
773         3      215       5       228
1002        4      215       4       184
1312        5      215       5       221
       user_id  item_id  rating  timestep
12436       46      215       3       152
12637       47      215       4        80
12844       48      215       4        14
13199       49      215       4        96
13475       50      215       4        99
average_rating for this rec across 50 users from same group (less noisy) was: 4.08
all_actions shape just before sample torch.Size([1, 5, 1])
action scaled by temperature: tensor([[39]], device='cuda:0')
action picked by argmax: tensor([255], device='cuda:0')
tensor([[255,  39, 110,  29,  48,  37,  21, 178, 201, 136]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
85          1      256       2        86
409         2      256       4       137
693         3      256       4       148
889         4      256       5        71
1191        5      256       5       100
       user_id  item_id  rating  timestep
12509       46      256       4       225
12728       47      256       4       171
12993       48      256       5       163
13128       49      256       5        25
13480       50      256       4       104
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 6, 1])
action scaled by temperature: tensor([[110]], device='cuda:0')
action picked by argmax: tensor([110], device='cuda:0')
tensor([[110,  22,  68,  37, 166, 139, 263, 125, 264, 227]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
45          1      111       3        46
436         2      111       4       164
815         3      111       3       270
940         4      111       2       122
1196        5      111       3       105
       user_id  item_id  rating  timestep
12346       46      111       3        62
12636       47      111       4        79
12867       48      111       4        37
13207       49      111       5       104
13617       50      111       3       241
average_rating for this rec across 50 users from same group (less noisy) was: 3.72
all_actions shape just before sample torch.Size([1, 7, 1])
action scaled by temperature: tensor([[227]], device='cuda:0')
action picked by argmax: tensor([227], device='cuda:0')
tensor([[227,  81, 203, 239, 233, 255, 147,  93, 206,  61]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
205         1      228       4       206
490         2      228       3       218
663         3      228       3       118
1070        4      228       2       252
1271        5      228       3       180
       user_id  item_id  rating  timestep
12329       46      228       4        45
12703       47      228       3       146
12879       48      228       5        49
13111       49      228       2         8
13530       50      228       4       154
average_rating for this rec across 50 users from same group (less noisy) was: 3.34
all_actions shape just before sample torch.Size([1, 8, 1])
action scaled by temperature: tensor([[22]], device='cuda:0')
action picked by argmax: tensor([22], device='cuda:0')
tensor([[ 22, 139, 148,   7, 166, 160, 162, 230, 199,  28]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
190         1       23       4       191
420         2       23       3       148
642         3       23       4        97
900         4       23       3        82
1125        5       23       5        34
       user_id  item_id  rating  timestep
12326       46       23       3        42
12754       47       23       5       197
13092       48       23       5       262
13190       49       23       2        87
13481       50       23       4       105
average_rating for this rec across 50 users from same group (less noisy) was: 3.82
all_actions shape just before sample torch.Size([1, 9, 1])
action scaled by temperature: tensor([[126]], device='cuda:0')
action picked by argmax: tensor([126], device='cuda:0')
tensor([[126,  22, 139,  42,  37,  68,   7, 148,  39, 162]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
259         1      127       4       260
517         2      127       5       245
774         3      127       5       229
913         4      127       5        95
1260        5      127       5       169
       user_id  item_id  rating  timestep
12492       46      127       4       208
12802       47      127       5       245
12991       48      127       4       161
13261       49      127       5       158
13448       50      127       5        72
average_rating for this rec across 50 users from same group (less noisy) was: 4.66
all_actions shape just before sample torch.Size([1, 10, 1])
action scaled by temperature: tensor([[263]], device='cuda:0')
action picked by argmax: tensor([263], device='cuda:0')
tensor([[263,  31,  21,  38, 179, 158, 107, 135, 189,  47]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
24          1      264       4        25
491         2      264       3       219
715         3      264       3       170
1039        4      264       5       221
1334        5      264       4       243
       user_id  item_id  rating  timestep
12302       46      264       5        18
12567       47      264       4        10
12976       48      264       4       146
13241       49      264       4       138
13515       50      264       5       139
average_rating for this rec across 50 users from same group (less noisy) was: 4.42
all_actions shape just before sample torch.Size([1, 11, 1])
action scaled by temperature: tensor([[96]], device='cuda:0')
action picked by argmax: tensor([96], device='cuda:0')
tensor([[ 96,  32,  18, 166, 208, 189, 221, 111, 162, 168]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
46          1       97       5        47
363         2       97       4        91
656         3       97       5       111
1059        4       97       4       241
1138        5       97       5        47
       user_id  item_id  rating  timestep
12431       46       97       5       147
12715       47       97       5       158
12880       48       97       5        50
13198       49       97       5        95
13414       50       97       4        38
average_rating for this rec across 50 users from same group (less noisy) was: 4.5
all_actions shape just before sample torch.Size([1, 12, 1])
action scaled by temperature: tensor([[32]], device='cuda:0')
action picked by argmax: tensor([32], device='cuda:0')
tensor([[ 32, 135, 111, 210, 168, 247,  87,  21,  68, 129]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
117         1       33       3       118
463         2       33       2       191
738         3       33       2       193
837         4       33       5        19
1267        5       33       3       176
       user_id  item_id  rating  timestep
12454       46       33       4       170
12590       47       33       4        33
12848       48       33       4        18
13360       49       33       4       257
13418       50       33       5        42
average_rating for this rec across 50 users from same group (less noisy) was: 3.6
all_actions shape just before sample torch.Size([1, 13, 1])
action scaled by temperature: tensor([[135]], device='cuda:0')
action picked by argmax: tensor([135], device='cuda:0')
tensor([[135, 270,  92, 169,  66, 255,  40,  75, 264, 160]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
166         1      136       4       167
401         2      136       4       129
775         3      136       3       230
1007        4      136       3       189
1187        5      136       3        96
       user_id  item_id  rating  timestep
12285       46      136       4         1
12742       47      136       5       185
12835       48      136       5         5
13263       49      136       2       160
13585       50      136       3       209
average_rating for this rec across 50 users from same group (less noisy) was: 3.84
all_actions shape just before sample torch.Size([1, 14, 1])
action scaled by temperature: tensor([[98]], device='cuda:0')
action picked by argmax: tensor([98], device='cuda:0')
tensor([[ 98, 174,  96,  92,  68, 148, 233, 143,  64, 206]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
180         1       99       3       181
304         2       99       5        32
607         3       99       4        62
1046        4       99       5       228
1134        5       99       5        43
       user_id  item_id  rating  timestep
12419       46       99       4       135
12560       47       99       4         3
12902       48       99       4        72
13217       49       99       5       114
13518       50       99       5       142
average_rating for this rec across 50 users from same group (less noisy) was: 3.72
all_actions shape just before sample torch.Size([1, 15, 1])
action scaled by temperature: tensor([[155]], device='cuda:0')
action picked by argmax: tensor([155], device='cuda:0')
tensor([[155, 174, 137, 264,  82, 168, 271,  71,  67,  40]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
88          1      156       5        89
478         2      156       3       206
606         3      156       2        61
898         4      156       3        80
1283        5      156       3       192
       user_id  item_id  rating  timestep
12518       46      156       3       234
12830       47      156       5       273
12853       48      156       4        23
13361       49      156       3       258
13438       50      156       4        62
average_rating for this rec across 50 users from same group (less noisy) was: 3.52
all_actions shape just before sample torch.Size([1, 16, 1])
action scaled by temperature: tensor([[137]], device='cuda:0')
action picked by argmax: tensor([137], device='cuda:0')
tensor([[137,  82,  44, 175, 155,   9, 118, 234, 174, 108]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
197         1      138       4       198
542         2      138       4       270
636         3      138       5        91
926         4      138       4       108
1195        5      138       5       104
       user_id  item_id  rating  timestep
12538       46      138       4       254
12596       47      138       4        39
13053       48      138       4       223
13354       49      138       5       251
13519       50      138       5       143
average_rating for this rec across 50 users from same group (less noisy) was: 4.36
all_actions shape just before sample torch.Size([1, 17, 1])
action scaled by temperature: tensor([[40]], device='cuda:0')
action picked by argmax: tensor([40], device='cuda:0')
tensor([[ 40,  24, 271,  94,  97, 248, 184,  78,  59,  56]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
66          1       41       4        67
353         2       41       5        81
756         3       41       3       211
1060        4       41       2       242
1343        5       41       3       252
       user_id  item_id  rating  timestep
12376       46       41       3        92
12615       47       41       3        58
12882       48       41       3        52
13156       49       41       5        53
13485       50       41       4       109
average_rating for this rec across 50 users from same group (less noisy) was: 3.66
all_actions shape just before sample torch.Size([1, 18, 1])
action scaled by temperature: tensor([[10]], device='cuda:0')
action picked by argmax: tensor([10], device='cuda:0')
tensor([[ 10, 248, 233, 222,  90,  11, 152, 134,  47, 239]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
183         1       11       1       184
302         2       11       4        30
616         3       11       3        71
877         4       11       2        59
1096        5       11       3         5
       user_id  item_id  rating  timestep
12340       46       11       2        56
12829       47       11       1       272
12922       48       11       3        92
13155       49       11       2        52
13410       50       11       2        34
average_rating for this rec across 50 users from same group (less noisy) was: 2.2
all_actions shape just before sample torch.Size([1, 19, 1])
action scaled by temperature: tensor([[90]], device='cuda:0')
action picked by argmax: tensor([90], device='cuda:0')
tensor([[ 90, 191,  10, 136, 134, 117,  35, 233,  71, 211]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
26          1       91       4        27
452         2       91       4       180
580         3       91       2        35
982         4       91       3       164
1198        5       91       4       107
       user_id  item_id  rating  timestep
12411       46       91       3       127
12568       47       91       4        11
13005       48       91       5       175
13291       49       91       5       188
13603       50       91       5       227
average_rating for this rec across 50 users from same group (less noisy) was: 3.9
all_actions shape just before sample torch.Size([1, 20, 1])
action scaled by temperature: tensor([[191]], device='cuda:0')
action picked by argmax: tensor([191], device='cuda:0')
tensor([[191, 136,  15,  73, 257, 134,  35,  40,  41,   6]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
32          1      192       4        33
537         2      192       4       265
582         3      192       5        37
1010        4      192       5       192
1170        5      192       4        79
       user_id  item_id  rating  timestep
12369       46      192       5        85
12673       47      192       5       116
13020       48      192       5       190
13277       49      192       4       174
13457       50      192       4        81
average_rating for this rec across 50 users from same group (less noisy) was: 4.34
all_actions shape just before sample torch.Size([1, 21, 1])
action scaled by temperature: tensor([[7]], device='cuda:0')
action picked by argmax: tensor([7], device='cuda:0')
tensor([[  7,  75,  21, 221, 249, 239,  88,  94, 255, 141]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
184         1        8       5       185
502         2        8       3       230
778         3        8       5       233
985         4        8       4       167
1354        5        8       5       263
       user_id  item_id  rating  timestep
12503       46        8       4       219
12614       47        8       4        57
13018       48        8       3       188
13337       49        8       3       234
13465       50        8       3        89
average_rating for this rec across 50 users from same group (less noisy) was: 4.08
all_actions shape just before sample torch.Size([1, 22, 1])
action scaled by temperature: tensor([[75]], device='cuda:0')
action picked by argmax: tensor([75], device='cuda:0')
tensor([[ 75, 132,  67,   7,  38,  33, 239,  88, 138, 221]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
76          1       76       5        77
330         2       76       4        58
571         3       76       3        26
915         4       76       4        97
1167        5       76       4        76
       user_id  item_id  rating  timestep
12440       46       76       3       156
12588       47       76       4        31
12957       48       76       3       127
13325       49       76       5       222
13468       50       76       5        92
average_rating for this rec across 50 users from same group (less noisy) was: 4.04
all_actions shape just before sample torch.Size([1, 23, 1])
action scaled by temperature: tensor([[67]], device='cuda:0')
action picked by argmax: tensor([67], device='cuda:0')
tensor([[ 67,  38,   7, 147, 138,  40, 197, 132,  55, 178]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
191         1       68       3       192
351         2       68       2        79
623         3       68       4        78
866         4       68       5        48
1237        5       68       3       146
       user_id  item_id  rating  timestep
12499       46       68       3       215
12639       47       68       5        82
13060       48       68       4       230
13114       49       68       3        11
13452       50       68       5        76
average_rating for this rec across 50 users from same group (less noisy) was: 3.82
all_actions shape just before sample torch.Size([1, 24, 1])
action scaled by temperature: tensor([[38]], device='cuda:0')
action picked by argmax: tensor([38], device='cuda:0')
tensor([[ 38,  67,   7, 199,  50,  79, 187, 138,  83, 115]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
264         1       39       3       265
276         2       39       3         4
670         3       39       2       125
899         4       39       3        81
1171        5       39       4        80
       user_id  item_id  rating  timestep
12532       46       39       3       248
12562       47       39       3         5
13086       48       39       2       256
13210       49       39       3       107
13467       50       39       3        91
average_rating for this rec across 50 users from same group (less noisy) was: 3.04
all_actions shape just before sample torch.Size([1, 25, 1])
action scaled by temperature: tensor([[187]], device='cuda:0')
action picked by argmax: tensor([187], device='cuda:0')
tensor([[187, 178,   7, 236, 256, 144, 132,  33,  93,  69]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
14          1      188       4        15
374         2      188       4       102
812         3      188       5       267
970         4      188       4       152
1289        5      188       3       198
       user_id  item_id  rating  timestep
12460       46      188       4       176
12653       47      188       5        96
13044       48      188       4       214
13181       49      188       4        78
13574       50      188       4       198
average_rating for this rec across 50 users from same group (less noisy) was: 3.98
all_actions shape just before sample torch.Size([1, 26, 1])
action scaled by temperature: tensor([[178]], device='cuda:0')
action picked by argmax: tensor([178], device='cuda:0')
tensor([[178, 236,  57,  69,  67, 187, 132,  15, 101,  75]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
176         1      179       4       177
372         2      179       5       100
551         3      179       5         6
821         4      179       4         3
1183        5      179       4        92
       user_id  item_id  rating  timestep
12511       46      179       4       227
12697       47      179       5       140
12871       48      179       5        41
13208       49      179       5       105
13632       50      179       4       256
average_rating for this rec across 50 users from same group (less noisy) was: 4.48
all_actions shape just before sample torch.Size([1, 27, 1])
action scaled by temperature: tensor([[236]], device='cuda:0')
action picked by argmax: tensor([236], device='cuda:0')
tensor([[236, 178,  69,  51, 256, 187, 227,  90, 261, 120]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
37          1      237       5        38
516         2      237       5       244
734         3      237       5       189
999         4      237       5       181
1227        5      237       5       136
       user_id  item_id  rating  timestep
12448       46      237       5       164
12818       47      237       4       261
12861       48      237       4        31
13105       49      237       5         2
13446       50      237       4        70
average_rating for this rec across 50 users from same group (less noisy) was: 4.66
all_actions shape just before sample torch.Size([1, 28, 1])
action scaled by temperature: tensor([[256]], device='cuda:0')
action picked by argmax: tensor([256], device='cuda:0')
tensor([[256,  77, 187, 268, 101, 161, 183, 214,  10, 255]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
270         1      257       4       271
447         2      257       5       175
696         3      257       5       151
1086        4      257       4       268
1238        5      257       4       147
       user_id  item_id  rating  timestep
12554       46      257       4       270
12564       47      257       4         7
13057       48      257       5       227
13246       49      257       5       143
13460       50      257       5        84
average_rating for this rec across 50 users from same group (less noisy) was: 4.26
all_actions shape just before sample torch.Size([1, 29, 1])
action scaled by temperature: tensor([[183]], device='cuda:0')
action picked by argmax: tensor([183], device='cuda:0')
tensor([[183,  51, 159, 244, 197,  27,  13, 270,  43, 238]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
21          1      184       4        22
416         2      184       4       144
817         3      184       4       272
966         4      184       4       148
1239        5      184       4       148
       user_id  item_id  rating  timestep
12555       46      184       4       271
12741       47      184       4       184
12929       48      184       3        99
13232       49      184       2       129
13497       50      184       5       121
average_rating for this rec across 50 users from same group (less noisy) was: 3.9
all_actions shape just before sample torch.Size([1, 30, 1])
action scaled by temperature: tensor([[51]], device='cuda:0')
action picked by argmax: tensor([51], device='cuda:0')
tensor([[ 51,  46, 178, 103,  38, 137, 236,  80,  97,  93]], device='cuda:0')
Just recommended 30 new items to 50 users from group 1 and the total rating was 117.74000000000004
train_loss is: 1.038963648554397
action scaled by temperature: tensor([[204]], device='cuda:0')
action picked by argmax: tensor([233], device='cuda:0')
tensor([[233,  28, 178,  14, 265, 237, 169, 101, 112, 219]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
39          1      234       4        40
543         2      234       4       271
707         3      234       4       162
1083        4      234       2       265
1364        5      234       4       273
       user_id  item_id  rating  timestep
12363       46      234       3        79
12812       47      234       5       255
12943       48      234       3       113
13126       49      234       5        23
13420       50      234       4        44
average_rating for this rec across 50 users from same group (less noisy) was: 4.0
all_actions shape just before sample torch.Size([1, 1, 1])
action scaled by temperature: tensor([[112]], device='cuda:0')
action picked by argmax: tensor([108], device='cuda:0')
tensor([[108,  60, 112, 113, 194, 209, 245,  72, 244,  26]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
217         1      109       4       218
521         2      109       5       249
808         3      109       4       263
1013        4      109       5       195
1332        5      109       5       241
       user_id  item_id  rating  timestep
12395       46      109       5       111
12654       47      109       5        97
13079       48      109       5       249
13139       49      109       5        36
13588       50      109       5       212
average_rating for this rec across 50 users from same group (less noisy) was: 4.9
all_actions shape just before sample torch.Size([1, 2, 1])
action scaled by temperature: tensor([[216]], device='cuda:0')
action picked by argmax: tensor([200], device='cuda:0')
tensor([[200, 107, 263, 216, 245, 113, 260, 136, 137,   4]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
168         1      201       3       169
506         2      201       3       234
704         3      201       2       159
865         4      201       2        47
1246        5      201       5       155
       user_id  item_id  rating  timestep
12552       46      201       5       268
12755       47      201       4       198
13042       48      201       4       212
13221       49      201       3       118
13499       50      201       3       123
average_rating for this rec across 50 users from same group (less noisy) was: 3.76
all_actions shape just before sample torch.Size([1, 3, 1])
action scaled by temperature: tensor([[164]], device='cuda:0')
action picked by argmax: tensor([164], device='cuda:0')
tensor([[164, 242, 238,  58,  42,  60,  43,  50, 187, 109]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
64          1      165       5        65
381         2      165       4       109
758         3      165       4       213
1003        4      165       5       185
1276        5      165       5       185
       user_id  item_id  rating  timestep
12289       46      165       4         5
12681       47      165       4       124
13095       48      165       5       265
13328       49      165       4       225
13633       50      165       3       257
average_rating for this rec across 50 users from same group (less noisy) was: 4.02
all_actions shape just before sample torch.Size([1, 4, 1])
action scaled by temperature: tensor([[243]], device='cuda:0')
action picked by argmax: tensor([243], device='cuda:0')
tensor([[243,  28, 242, 257, 176,   7, 200,  16, 267, 187]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
105         1      244       3       106
335         2      244       4        63
627         3      244       4        82
838         4      244       4        20
1190        5      244       4        99
       user_id  item_id  rating  timestep
12314       46      244       3        30
12617       47      244       4        60
12887       48      244       3        57
13301       49      244       4       198
13579       50      244       3       203
average_rating for this rec across 50 users from same group (less noisy) was: 3.76
all_actions shape just before sample torch.Size([1, 5, 1])
action scaled by temperature: tensor([[208]], device='cuda:0')
action picked by argmax: tensor([208], device='cuda:0')
tensor([[208,  47, 236, 224, 233, 268, 239,  30, 246, 150]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
169         1      209       4       170
526         2      209       4       254
631         3      209       4        86
828         4      209       5        10
1286        5      209       4       195
       user_id  item_id  rating  timestep
12406       46      209       3       122
12684       47      209       4       127
13030       48      209       4       200
13345       49      209       4       242
13644       50      209       4       268
average_rating for this rec across 50 users from same group (less noisy) was: 4.02
all_actions shape just before sample torch.Size([1, 6, 1])
action scaled by temperature: tensor([[47]], device='cuda:0')
action picked by argmax: tensor([47], device='cuda:0')
tensor([[ 47, 208, 222, 113, 236, 246,  13,  96,  77, 224]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
104         1       48       5       105
471         2       48       5       199
567         3       48       4        22
888         4       48       4        70
1155        5       48       4        64
       user_id  item_id  rating  timestep
12362       46       48       5        78
12710       47       48       4       153
12898       48       48       5        68
13180       49       48       4        77
13648       50       48       4       272
average_rating for this rec across 50 users from same group (less noisy) was: 4.08
all_actions shape just before sample torch.Size([1, 7, 1])
action scaled by temperature: tensor([[222]], device='cuda:0')
action picked by argmax: tensor([222], device='cuda:0')
tensor([[222,  47,   6, 220, 173, 159, 247, 224, 205, 131]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
198         1      223       3       199
386         2      223       4       114
640         3      223       5        95
936         4      223       5       118
1310        5      223       4       219
       user_id  item_id  rating  timestep
12409       46      223       5       125
12619       47      223       5        62
12967       48      223       4       137
13372       49      223       5       269
13567       50      223       4       191
average_rating for this rec across 50 users from same group (less noisy) was: 4.54
all_actions shape just before sample torch.Size([1, 8, 1])
action scaled by temperature: tensor([[159]], device='cuda:0')
action picked by argmax: tensor([159], device='cuda:0')
tensor([[159, 222, 220,  47,  97,   6, 224,  79,  93, 131]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
48          1      160       3        49
514         2      160       4       242
790         3      160       3       245
849         4      160       3        31
1264        5      160       4       173
       user_id  item_id  rating  timestep
12473       46      160       5       189
12595       47      160       3        38
13099       48      160       4       269
13202       49      160       2        99
13526       50      160       3       150
average_rating for this rec across 50 users from same group (less noisy) was: 3.56
all_actions shape just before sample torch.Size([1, 9, 1])
action scaled by temperature: tensor([[131]], device='cuda:0')
action picked by argmax: tensor([131], device='cuda:0')
tensor([[131,  12,  23, 220, 269, 145,   6,  65,  52,  55]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
157         1      132       5       158
519         2      132       4       247
574         3      132       5        29
1061        4      132       3       243
1323        5      132       4       232
       user_id  item_id  rating  timestep
12481       46      132       4       197
12692       47      132       4       135
12997       48      132       4       167
13321       49      132       5       218
13606       50      132       4       230
average_rating for this rec across 50 users from same group (less noisy) was: 4.42
all_actions shape just before sample torch.Size([1, 10, 1])
action scaled by temperature: tensor([[220]], device='cuda:0')
action picked by argmax: tensor([220], device='cuda:0')
tensor([[220, 109,   6,  92, 224, 191,  12, 190,  65, 132]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
225         1      221       4       226
380         2      221       4       108
549         3      221       4         4
854         4      221       4        36
1188        5      221       5        97
       user_id  item_id  rating  timestep
12421       46      221       3       137
12641       47      221       4        84
13072       48      221       4       242
13351       49      221       5       248
13455       50      221       4        79
average_rating for this rec across 50 users from same group (less noisy) was: 4.16
all_actions shape just before sample torch.Size([1, 11, 1])
action scaled by temperature: tensor([[6]], device='cuda:0')
action picked by argmax: tensor([6], device='cuda:0')
tensor([[  6,   0, 177, 145, 220, 247, 172,  53, 224, 141]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
82          1        7       4        83
388         2        7       4       116
811         3        7       4       266
990         4        7       4       172
1154        5        7       3        63
       user_id  item_id  rating  timestep
12491       46        7       3       207
12722       47        7       4       165
13002       48        7       5       172
13104       49        7       4         1
13378       50        7       5         2
average_rating for this rec across 50 users from same group (less noisy) was: 3.68
all_actions shape just before sample torch.Size([1, 12, 1])
action scaled by temperature: tensor([[113]], device='cuda:0')
action picked by argmax: tensor([113], device='cuda:0')
tensor([[113,  56,  52,  51, 268, 120, 175, 234, 128,   4]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
109         1      114       4       110
324         2      114       3        52
744         3      114       4       199
920         4      114       5       102
1160        5      114       5        69
       user_id  item_id  rating  timestep
12470       46      114       3       186
12608       47      114       4        51
13034       48      114       4       204
13365       49      114       4       262
13593       50      114       5       217
average_rating for this rec across 50 users from same group (less noisy) was: 4.24
all_actions shape just before sample torch.Size([1, 13, 1])
action scaled by temperature: tensor([[10]], device='cuda:0')
action picked by argmax: tensor([10], device='cuda:0')
tensor([[ 10, 179,  17, 264, 143,  90, 268, 136,  81,  52]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
183         1       11       1       184
302         2       11       4        30
616         3       11       3        71
877         4       11       2        59
1096        5       11       3         5
       user_id  item_id  rating  timestep
12340       46       11       2        56
12829       47       11       1       272
12922       48       11       3        92
13155       49       11       2        52
13410       50       11       2        34
average_rating for this rec across 50 users from same group (less noisy) was: 2.2
all_actions shape just before sample torch.Size([1, 14, 1])
action scaled by temperature: tensor([[17]], device='cuda:0')
action picked by argmax: tensor([17], device='cuda:0')
tensor([[ 17, 169, 228,  49, 252, 259,  95,  83, 264, 179]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
239         1       18       3       240
464         2       18       3       192
613         3       18       4        68
870         4       18       5        52
1290        5       18       5       199
       user_id  item_id  rating  timestep
12360       46       18       5        76
12706       47       18       5       149
12925       48       18       5        95
13183       49       18       4        80
13391       50       18       4        15
average_rating for this rec across 50 users from same group (less noisy) was: 4.4
all_actions shape just before sample torch.Size([1, 15, 1])
action scaled by temperature: tensor([[169]], device='cuda:0')
action picked by argmax: tensor([169], device='cuda:0')
tensor([[169, 252,  24,  44, 171, 206, 207,  17,  83, 113]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
126         1      170       5       127
429         2      170       5       157
722         3      170       4       177
983         4      170       5       165
1126        5      170       4        35
       user_id  item_id  rating  timestep
12490       46      170       4       206
12602       47      170       4        45
13027       48      170       5       197
13304       49      170       5       201
13599       50      170       5       223
average_rating for this rec across 50 users from same group (less noisy) was: 4.54
all_actions shape just before sample torch.Size([1, 16, 1])
action scaled by temperature: tensor([[252]], device='cuda:0')
action picked by argmax: tensor([252], device='cuda:0')
tensor([[252, 259,  38,  83, 101,  49,  24,  56,  82, 228]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
53          1      253       5        54
325         2      253       5        53
761         3      253       5       216
1068        4      253       5       250
1176        5      253       5        85
       user_id  item_id  rating  timestep
12446       46      253       5       162
12791       47      253       5       234
13019       48      253       5       189
13220       49      253       5       117
13580       50      253       5       204
average_rating for this rec across 50 users from same group (less noisy) was: 4.7
all_actions shape just before sample torch.Size([1, 17, 1])
action scaled by temperature: tensor([[261]], device='cuda:0')
action picked by argmax: tensor([261], device='cuda:0')
tensor([[261, 135,  33,  95, 185, 269, 213, 123, 188, 116]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
188         1      262       5       189
292         2      262       4        20
676         3      262       3       131
914         4      262       3        96
1194        5      262       3       103
       user_id  item_id  rating  timestep
12551       46      262       5       267
12620       47      262       5        63
12953       48      262       5       123
13350       49      262       4       247
13419       50      262       4        43
average_rating for this rec across 50 users from same group (less noisy) was: 4.0
all_actions shape just before sample torch.Size([1, 18, 1])
action scaled by temperature: tensor([[135]], device='cuda:0')
action picked by argmax: tensor([135], device='cuda:0')
tensor([[135,  95, 117, 213, 269, 188,  33, 113, 160, 101]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
166         1      136       4       167
401         2      136       4       129
775         3      136       3       230
1007        4      136       3       189
1187        5      136       3        96
       user_id  item_id  rating  timestep
12285       46      136       4         1
12742       47      136       5       185
12835       48      136       5         5
13263       49      136       2       160
13585       50      136       3       209
average_rating for this rec across 50 users from same group (less noisy) was: 3.84
all_actions shape just before sample torch.Size([1, 19, 1])
action scaled by temperature: tensor([[259]], device='cuda:0')
action picked by argmax: tensor([259], device='cuda:0')
tensor([[259,  41, 176, 164, 172,  68, 116,  44, 196, 200]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
241         1      260       5       242
427         2      260       5       155
709         3      260       5       164
906         4      260       3        88
1149        5      260       5        58
       user_id  item_id  rating  timestep
12293       46      260       3         9
12601       47      260       5        44
12960       48      260       4       130
13175       49      260       5        72
13511       50      260       4       135
average_rating for this rec across 50 users from same group (less noisy) was: 4.16
all_actions shape just before sample torch.Size([1, 20, 1])
action scaled by temperature: tensor([[41]], device='cuda:0')
action picked by argmax: tensor([41], device='cuda:0')
tensor([[ 41, 259, 176,   0, 172,  74, 196, 243,  44, 235]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
112         1       42       5       113
421         2       42       5       149
786         3       42       4       241
887         4       42       5        69
1307        5       42       4       216
       user_id  item_id  rating  timestep
12392       46       42       4       108
12660       47       42       5       103
13038       48       42       5       208
13134       49       42       5        31
13377       50       42       5         1
average_rating for this rec across 50 users from same group (less noisy) was: 4.74
all_actions shape just before sample torch.Size([1, 21, 1])
action scaled by temperature: tensor([[172]], device='cuda:0')
action picked by argmax: tensor([172], device='cuda:0')
tensor([[172, 123,  41, 265, 105, 116, 235, 185, 259, 164]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
42          1      173       5        43
446         2      173       4       174
578         3      173       3        33
932         4      173       5       114
1095        5      173       5         4
       user_id  item_id  rating  timestep
12519       46      173       5       235
12803       47      173       4       246
13015       48      173       5       185
13335       49      173       5       232
13425       50      173       5        49
average_rating for this rec across 50 users from same group (less noisy) was: 4.56
all_actions shape just before sample torch.Size([1, 22, 1])
action scaled by temperature: tensor([[123]], device='cuda:0')
action picked by argmax: tensor([123], device='cuda:0')
tensor([[123, 188, 265, 116, 105, 259, 172, 178,  41,  68]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
178         1      124       5       179
430         2      124       3       158
600         3      124       4        55
826         4      124       5         8
1098        5      124       4         7
       user_id  item_id  rating  timestep
12550       46      124       3       266
12607       47      124       5        50
12899       48      124       4        69
13176       49      124       3        73
13398       50      124       5        22
average_rating for this rec across 50 users from same group (less noisy) was: 4.44
all_actions shape just before sample torch.Size([1, 23, 1])
action scaled by temperature: tensor([[265]], device='cuda:0')
action picked by argmax: tensor([265], device='cuda:0')
tensor([[265, 116, 105, 184, 188,  61, 160, 123, 235, 172]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
81          1      266       3        82
342         2      266       3        70
793         3      266       4       248
901         4      266       3        83
1113        5      266       4        22
       user_id  item_id  rating  timestep
12394       46      266       5       110
12827       47      266       2       270
12927       48      266       5        97
13151       49      266       4        48
13393       50      266       5        17
average_rating for this rec across 50 users from same group (less noisy) was: 3.82
all_actions shape just before sample torch.Size([1, 24, 1])
action scaled by temperature: tensor([[184]], device='cuda:0')
action picked by argmax: tensor([184], device='cuda:0')
tensor([[184,  61, 110, 123, 196, 250,  90, 150, 113, 149]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
159         1      185       5       160
406         2      185       4       134
647         3      185       5       102
992         4      185       4       174
1240        5      185       4       149
       user_id  item_id  rating  timestep
12373       46      185       5        89
12733       47      185       5       176
13028       48      185       5       198
13148       49      185       3        45
13456       50      185       4        80
average_rating for this rec across 50 users from same group (less noisy) was: 4.56
all_actions shape just before sample torch.Size([1, 25, 1])
action scaled by temperature: tensor([[61]], device='cuda:0')
action picked by argmax: tensor([61], device='cuda:0')
tensor([[ 61,  40, 153, 180,  52, 251, 201, 222, 187,  10]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
30          1       62       5        31
312         2       62       4        40
601         3       62       5        56
972         4       62       5       154
1216        5       62       4       125
       user_id  item_id  rating  timestep
12507       46       62       5       223
12631       47       62       5        74
12897       48       62       5        67
13296       49       62       4       193
13527       50       62       5       151
average_rating for this rec across 50 users from same group (less noisy) was: 4.76
all_actions shape just before sample torch.Size([1, 26, 1])
action scaled by temperature: tensor([[180]], device='cuda:0')
action picked by argmax: tensor([180], device='cuda:0')
tensor([[180,  61,  40, 208,  10, 204,  59,  77, 153, 117]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
73          1      181       5        74
326         2      181       4        54
708         3      181       5       163
934         4      181       4       116
1231        5      181       5       140
       user_id  item_id  rating  timestep
12317       46      181       4        33
12688       47      181       5       131
13048       48      181       5       218
13131       49      181       5        28
13517       50      181       5       141
average_rating for this rec across 50 users from same group (less noisy) was: 4.68
all_actions shape just before sample torch.Size([1, 27, 1])
action scaled by temperature: tensor([[235]], device='cuda:0')
action picked by argmax: tensor([235], device='cuda:0')
tensor([[235,  57,  42,  48, 170,  41,  21, 164, 237, 116]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
57          1      236       5        58
392         2      236       4       120
770         3      236       4       225
825         4      236       5         7
1151        5      236       4        60
       user_id  item_id  rating  timestep
12321       46      236       3        37
12669       47      236       5       112
12940       48      236       3       110
13113       49      236       4        10
13638       50      236       3       262
average_rating for this rec across 50 users from same group (less noisy) was: 4.26
all_actions shape just before sample torch.Size([1, 28, 1])
action scaled by temperature: tensor([[237]], device='cuda:0')
action picked by argmax: tensor([237], device='cuda:0')
tensor([[237, 235, 115, 106,  48,  13, 222,  20,  47, 251]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
228         1      238       4       229
475         2      238       3       203
719         3      238       3       174
860         4      238       5        42
1166        5      238       5        75
       user_id  item_id  rating  timestep
12462       46      238       3       178
12618       47      238       4        61
13000       48      238       5       170
13192       49      238       3        89
13431       50      238       5        55
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 29, 1])
action scaled by temperature: tensor([[251]], device='cuda:0')
action picked by argmax: tensor([251], device='cuda:0')
tensor([[251,  42,  79, 170,  18,  94,  54, 246, 155, 271]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
93          1      252       4        94
494         2      252       5       222
552         3      252       5         7
998         4      252       5       180
1347        5      252       4       256
       user_id  item_id  rating  timestep
12322       46      252       5        38
12798       47      252       4       241
12948       48      252       4       118
13342       49      252       5       239
13451       50      252       5        75
average_rating for this rec across 50 users from same group (less noisy) was: 4.62
all_actions shape just before sample torch.Size([1, 30, 1])
action scaled by temperature: tensor([[271]], device='cuda:0')
action picked by argmax: tensor([271], device='cuda:0')
tensor([[271,  18, 251,  10,  24, 179,  33,  38,   3,  40]], device='cuda:0')
Just recommended 30 new items to 50 users from group 1 and the total rating was 125.48
train_loss is: 1.1113772661718604
action scaled by temperature: tensor([[185]], device='cuda:0')
action picked by argmax: tensor([29], device='cuda:0')
tensor([[ 29, 259, 267, 180, 246, 136,  44, 113, 200, 215]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
196         1       30       2       197
462         2       30       2       190
683         3       30       2       138
832         4       30       3        14
1277        5       30       3       186
       user_id  item_id  rating  timestep
12298       46       30       3        14
12786       47       30       4       229
13049       48       30       3       219
13167       49       30       5        64
13545       50       30       5       169
average_rating for this rec across 50 users from same group (less noisy) was: 3.2
all_actions shape just before sample torch.Size([1, 1, 1])
action scaled by temperature: tensor([[18]], device='cuda:0')
action picked by argmax: tensor([85], device='cuda:0')
tensor([[ 85,   4, 163, 167,  18, 109,  95, 217, 201,  17]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
266         1       86       5       267
509         2       86       5       237
777         3       86       5       232
917         4       86       5        99
1121        5       86       4        30
       user_id  item_id  rating  timestep
12506       46       86       5       222
12600       47       86       5        43
13074       48       86       5       244
13362       49       86       5       259
13397       50       86       5        21
average_rating for this rec across 50 users from same group (less noisy) was: 4.58
all_actions shape just before sample torch.Size([1, 2, 1])
action scaled by temperature: tensor([[125]], device='cuda:0')
action picked by argmax: tensor([125], device='cuda:0')
tensor([[125, 256, 113, 139, 108,  62, 262, 224, 227,  79]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
204         1      126       5       205
367         2      126       3        95
594         3      126       3        49
1031        4      126       2       213
1200        5      126       3       109
       user_id  item_id  rating  timestep
12366       46      126       3        82
12598       47      126       3        41
13012       48      126       3       182
13223       49      126       4       120
13647       50      126       4       271
average_rating for this rec across 50 users from same group (less noisy) was: 3.32
all_actions shape just before sample torch.Size([1, 3, 1])
action scaled by temperature: tensor([[48]], device='cuda:0')
action picked by argmax: tensor([48], device='cuda:0')
tensor([[ 48, 106, 256, 139,  95, 113,  60, 125, 251,   4]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
237         1       49       5       238
454         2       49       3       182
599         3       49       4        54
876         4       49       4        58
1320        5       49       4       229
       user_id  item_id  rating  timestep
12370       46       49       3        86
12811       47       49       4       254
13032       48       49       2       202
13179       49       49       3        76
13552       50       49       4       176
average_rating for this rec across 50 users from same group (less noisy) was: 3.92
all_actions shape just before sample torch.Size([1, 4, 1])
action scaled by temperature: tensor([[114]], device='cuda:0')
action picked by argmax: tensor([215], device='cuda:0')
tensor([[215, 114, 126,  87, 142, 144,  16, 200, 264,  95]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
96          1      216       5        97
545         2      216       3       273
668         3      216       4       123
823         4      216       4         5
1103        5      216       5        12
       user_id  item_id  rating  timestep
12524       46      216       3       240
12735       47      216       3       178
12901       48      216       4        71
13359       49      216       4       256
13563       50      216       5       187
average_rating for this rec across 50 users from same group (less noisy) was: 3.64
all_actions shape just before sample torch.Size([1, 5, 1])
action scaled by temperature: tensor([[129]], device='cuda:0')
action picked by argmax: tensor([129], device='cuda:0')
tensor([[129, 114,  75, 188,  71, 174, 219, 267, 167, 231]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
165         1      130       4       166
533         2      130       5       261
759         3      130       5       214
895         4      130       5        77
1182        5      130       4        91
       user_id  item_id  rating  timestep
12417       46      130       5       133
12813       47      130       5       256
13076       48      130       5       246
13229       49      130       5       126
13570       50      130       5       194
average_rating for this rec across 50 users from same group (less noisy) was: 4.46
all_actions shape just before sample torch.Size([1, 6, 1])
action scaled by temperature: tensor([[258]], device='cuda:0')
action picked by argmax: tensor([258], device='cuda:0')
tensor([[258, 248, 114, 251, 215,  75, 206, 171, 263,  30]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
7           1      259       4         8
395         2      259       4       123
747         3      259       4       202
960         4      259       4       142
1210        5      259       4       119
       user_id  item_id  rating  timestep
12445       46      259       4       161
12683       47      259       3       126
12909       48      259       4        79
13189       49      259       1        86
13575       50      259       4       199
average_rating for this rec across 50 users from same group (less noisy) was: 3.36
all_actions shape just before sample torch.Size([1, 7, 1])
action scaled by temperature: tensor([[21]], device='cuda:0')
action picked by argmax: tensor([21], device='cuda:0')
tensor([[ 21, 166,  18,  49, 129, 103, 162, 167, 232, 118]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
87          1       22       4        88
425         2       22       4       153
554         3       22       4         9
997         4       22       4       179
1263        5       22       5       172
       user_id  item_id  rating  timestep
12335       46       22       4        51
12810       47       22       5       253
12839       48       22       5         9
13116       49       22       4        13
13577       50       22       4       201
average_rating for this rec across 50 users from same group (less noisy) was: 4.24
all_actions shape just before sample torch.Size([1, 8, 1])
action scaled by temperature: tensor([[166]], device='cuda:0')
action picked by argmax: tensor([166], device='cuda:0')
tensor([[166,  21, 248,  18,  79, 263,  23, 162, 160,  49]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
141         1      167       4       142
539         2      167       5       267
791         3      167       4       246
1054        4      167       4       236
1153        5      167       3        62
       user_id  item_id  rating  timestep
12348       46      167       4        64
12628       47      167       4        71
12941       48      167       5       111
13112       49      167       4         9
13578       50      167       2       202
average_rating for this rec across 50 users from same group (less noisy) was: 4.2
all_actions shape just before sample torch.Size([1, 9, 1])
action scaled by temperature: tensor([[23]], device='cuda:0')
action picked by argmax: tensor([23], device='cuda:0')
tensor([[ 23, 266,   7, 154, 131, 171, 114,  17,  18,  84]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
122         1       24       4       123
389         2       24       5       117
666         3       24       3       121
871         4       24       5        53
1330        5       24       5       239
       user_id  item_id  rating  timestep
12339       46       24       4        55
12640       47       24       4        83
12930       48       24       3       100
13266       49       24       5       163
13582       50       24       4       206
average_rating for this rec across 50 users from same group (less noisy) was: 3.84
all_actions shape just before sample torch.Size([1, 10, 1])
action scaled by temperature: tensor([[18]], device='cuda:0')
action picked by argmax: tensor([18], device='cuda:0')
tensor([[ 18, 268,  85, 108,  66, 233, 171, 258, 166, 165]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
84          1       19       4        85
507         2       19       5       235
684         3       19       5       139
851         4       19       5        33
1163        5       19       5        72
       user_id  item_id  rating  timestep
12466       46       19       4       182
12792       47       19       5       235
13089       48       19       4       259
13200       49       19       4        97
13586       50       19       3       210
average_rating for this rec across 50 users from same group (less noisy) was: 4.42
all_actions shape just before sample torch.Size([1, 11, 1])
action scaled by temperature: tensor([[108]], device='cuda:0')
action picked by argmax: tensor([108], device='cuda:0')
tensor([[108, 266,  12, 232, 192,  62, 214, 233, 162,  68]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
217         1      109       4       218
521         2      109       5       249
808         3      109       4       263
1013        4      109       5       195
1332        5      109       5       241
       user_id  item_id  rating  timestep
12395       46      109       5       111
12654       47      109       5        97
13079       48      109       5       249
13139       49      109       5        36
13588       50      109       5       212
average_rating for this rec across 50 users from same group (less noisy) was: 4.9
all_actions shape just before sample torch.Size([1, 12, 1])
action scaled by temperature: tensor([[162]], device='cuda:0')
action picked by argmax: tensor([162], device='cuda:0')
tensor([[162, 165,  32, 156, 130, 126,   1, 214, 245,  16]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
47          1      163       5        48
410         2      163       5       138
669         3      163       4       124
1012        4      163       5       194
1349        5      163       5       258
       user_id  item_id  rating  timestep
12464       46      163       5       180
12699       47      163       4       142
12881       48      163       4        51
13289       49      163       5       186
13596       50      163       5       220
average_rating for this rec across 50 users from same group (less noisy) was: 4.54
all_actions shape just before sample torch.Size([1, 13, 1])
action scaled by temperature: tensor([[226]], device='cuda:0')
action picked by argmax: tensor([226], device='cuda:0')
tensor([[226,  12,  64,  31, 174,  33, 222, 237, 230, 272]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
127         1      227       4       128
504         2      227       4       232
588         3      227       4        43
945         4      227       4       127
1255        5      227       5       164
       user_id  item_id  rating  timestep
12337       46      227       5        53
12591       47      227       5        34
13101       48      227       5       271
13333       49      227       5       230
13598       50      227       4       222
average_rating for this rec across 50 users from same group (less noisy) was: 4.72
all_actions shape just before sample torch.Size([1, 14, 1])
action scaled by temperature: tensor([[11]], device='cuda:0')
action picked by argmax: tensor([11], device='cuda:0')
tensor([[ 11, 225, 210, 179, 162,  33,  82, 152, 126, 251]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
28          1       12       4        29
466         2       12       3       194
765         3       12       5       220
845         4       12       5        27
1207        5       12       3       116
       user_id  item_id  rating  timestep
12471       46       12       4       187
12693       47       12       5       136
12980       48       12       4       150
13184       49       12       3        81
13608       50       12       4       232
average_rating for this rec across 50 users from same group (less noisy) was: 3.7
all_actions shape just before sample torch.Size([1, 15, 1])
action scaled by temperature: tensor([[43]], device='cuda:0')
action picked by argmax: tensor([43], device='cuda:0')
tensor([[ 43,  25, 184,  18, 162, 256,  85,  56, 118,   4]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
267         1       44       4       268
341         2       44       4        69
706         3       44       4       161
939         4       44       4       121
1331        5       44       4       240
       user_id  item_id  rating  timestep
12435       46       44       3       151
12717       47       44       4       160
13103       48       44       3       273
13146       49       44       3        43
13615       50       44       4       239
average_rating for this rec across 50 users from same group (less noisy) was: 3.74
all_actions shape just before sample torch.Size([1, 16, 1])
action scaled by temperature: tensor([[25]], device='cuda:0')
action picked by argmax: tensor([25], device='cuda:0')
tensor([[ 25,  43, 234, 184, 207, 162, 118,  18, 161, 256]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
134         1       26       4       135
413         2       26       3       141
576         3       26       5        31
1087        4       26       5       269
1287        5       26       3       196
       user_id  item_id  rating  timestep
12487       46       26       5       203
12611       47       26       5        54
12983       48       26       5       153
13149       49       26       5        46
13625       50       26       4       249
average_rating for this rec across 50 users from same group (less noisy) was: 4.36
all_actions shape just before sample torch.Size([1, 17, 1])
action scaled by temperature: tensor([[164]], device='cuda:0')
action picked by argmax: tensor([164], device='cuda:0')
tensor([[164,   4, 212,  42, 177, 167, 182,  43, 218, 262]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
64          1      165       5        65
381         2      165       4       109
758         3      165       4       213
1003        4      165       5       185
1276        5      165       5       185
       user_id  item_id  rating  timestep
12289       46      165       4         5
12681       47      165       4       124
13095       48      165       5       265
13328       49      165       4       225
13633       50      165       3       257
average_rating for this rec across 50 users from same group (less noisy) was: 4.02
all_actions shape just before sample torch.Size([1, 18, 1])
action scaled by temperature: tensor([[201]], device='cuda:0')
action picked by argmax: tensor([201], device='cuda:0')
tensor([[201,  78, 224,  59, 174, 179,  16, 185, 192, 171]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
258         1      202       3       259
510         2      202       3       238
799         3      202       4       254
930         4      202       3       112
1360        5      202       4       269
       user_id  item_id  rating  timestep
12415       46      202       1       131
12676       47      202       4       119
13070       48      202       3       240
13273       49      202       2       170
13643       50      202       3       267
average_rating for this rec across 50 users from same group (less noisy) was: 2.82
all_actions shape just before sample torch.Size([1, 19, 1])
action scaled by temperature: tensor([[59]], device='cuda:0')
action picked by argmax: tensor([59], device='cuda:0')
tensor([[ 59, 226, 216,   1, 200,  75, 171,  16,  35, 189]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
58          1       60       5        59
460         2       60       4       188
689         3       60       4       144
1018        4       60       4       200
1262        5       60       4       171
       user_id  item_id  rating  timestep
12461       46       60       3       177
12587       47       60       3        30
12868       48       60       2        38
13178       49       60       5        75
13649       50       60       3       273
average_rating for this rec across 50 users from same group (less noisy) was: 3.82
all_actions shape just before sample torch.Size([1, 20, 1])
action scaled by temperature: tensor([[1]], device='cuda:0')
action picked by argmax: tensor([1], device='cuda:0')
tensor([[  1,   4, 231, 111,  92, 158, 216, 208, 180, 225]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
41          1        2       5        42
443         2        2       5       171
788         3        2       5       243
891         4        2       4        73
1097        5        2       5         6
       user_id  item_id  rating  timestep
12508       46        2       5       224
12785       47        2       4       228
13021       48        2       5       191
13124       49        2       5        21
13637       50        2       5       261
average_rating for this rec across 50 users from same group (less noisy) was: 4.72
all_actions shape just before sample torch.Size([1, 21, 1])
action scaled by temperature: tensor([[19]], device='cuda:0')
action picked by argmax: tensor([19], device='cuda:0')
tensor([[ 19, 223, 169, 253,  47, 233, 116, 248,  58, 156]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
216         1       20       5       217
314         2       20       4        42
634         3       20       5        89
956         4       20       5       138
1316        5       20       3       225
       user_id  item_id  rating  timestep
12535       46       20       5       251
12580       47       20       5        23
12889       48       20       5        59
13188       49       20       4        85
13439       50       20       4        63
average_rating for this rec across 50 users from same group (less noisy) was: 4.56
all_actions shape just before sample torch.Size([1, 22, 1])
action scaled by temperature: tensor([[169]], device='cuda:0')
action picked by argmax: tensor([169], device='cuda:0')
tensor([[169, 223, 233,  90,   9, 155, 196, 237, 148,  75]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
126         1      170       5       127
429         2      170       5       157
722         3      170       4       177
983         4      170       5       165
1126        5      170       4        35
       user_id  item_id  rating  timestep
12490       46      170       4       206
12602       47      170       4        45
13027       48      170       5       197
13304       49      170       5       201
13599       50      170       5       223
average_rating for this rec across 50 users from same group (less noisy) was: 4.54
all_actions shape just before sample torch.Size([1, 23, 1])
action scaled by temperature: tensor([[223]], device='cuda:0')
action picked by argmax: tensor([223], device='cuda:0')
tensor([[223, 169,  83, 196,  75, 221, 104, 246, 154,  90]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
194         1      224       4       195
511         2      224       4       239
726         3      224       5       181
861         4      224       4        43
1145        5      224       5        54
       user_id  item_id  rating  timestep
12371       46      224       5        87
12578       47      224       5        21
12946       48      224       4       116
13334       49      224       5       231
13417       50      224       4        41
average_rating for this rec across 50 users from same group (less noisy) was: 4.4
all_actions shape just before sample torch.Size([1, 24, 1])
action scaled by temperature: tensor([[9]], device='cuda:0')
action picked by argmax: tensor([9], device='cuda:0')
tensor([[  9,  39,  92, 169, 264, 175, 184, 154,  44,  37]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
256         1       10       5       257
308         2       10       5        36
626         3       10       4        81
1055        4       10       4       237
1193        5       10       5       102
       user_id  item_id  rating  timestep
12521       46       10       5       237
12698       47       10       5       141
12982       48       10       4       152
13245       49       10       5       142
13461       50       10       4        85
average_rating for this rec across 50 users from same group (less noisy) was: 4.56
all_actions shape just before sample torch.Size([1, 25, 1])
action scaled by temperature: tensor([[39]], device='cuda:0')
action picked by argmax: tensor([39], device='cuda:0')
tensor([[ 39,   9, 169,  37, 159,  61,  92, 125, 160, 175]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
101         1       40       5       102
275         2       40       5         3
550         3       40       4         5
1065        4       40       5       247
1189        5       40       5        98
       user_id  item_id  rating  timestep
12542       46       40       5       258
12805       47       40       5       248
12866       48       40       5        36
13122       49       40       5        19
13587       50       40       4       211
average_rating for this rec across 50 users from same group (less noisy) was: 4.68
all_actions shape just before sample torch.Size([1, 26, 1])
action scaled by temperature: tensor([[159]], device='cuda:0')
action picked by argmax: tensor([159], device='cuda:0')
tensor([[159,   3,  25, 219,  37,  39,  61, 169, 272, 154]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
48          1      160       3        49
514         2      160       4       242
790         3      160       3       245
849         4      160       3        31
1264        5      160       4       173
       user_id  item_id  rating  timestep
12473       46      160       5       189
12595       47      160       3        38
13099       48      160       4       269
13202       49      160       2        99
13526       50      160       3       150
average_rating for this rec across 50 users from same group (less noisy) was: 3.56
all_actions shape just before sample torch.Size([1, 27, 1])
action scaled by temperature: tensor([[142]], device='cuda:0')
action picked by argmax: tensor([142], device='cuda:0')
tensor([[142,  39, 229, 246,  78,   3, 104, 184, 171, 169]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
142         1      143       3       143
323         2      143       4        51
572         3      143       3        27
824         4      143       4         6
1327        5      143       5       236
       user_id  item_id  rating  timestep
12405       46      143       5       121
12687       47      143       5       130
13063       48      143       4       233
13260       49      143       4       157
13561       50      143       5       185
average_rating for this rec across 50 users from same group (less noisy) was: 4.18
all_actions shape just before sample torch.Size([1, 28, 1])
action scaled by temperature: tensor([[3]], device='cuda:0')
action picked by argmax: tensor([3], device='cuda:0')
tensor([[  3, 169,  11,  78, 203,  19, 122, 142,  86,  14]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
35          1        4       4        36
501         2        4       5       229
680         3        4       5       135
938         4        4       4       120
1201        5        4       5       110
       user_id  item_id  rating  timestep
12530       46        4       5       246
12610       47        4       4        53
13062       48        4       4       232
13214       49        4       4       111
13385       50        4       4         9
average_rating for this rec across 50 users from same group (less noisy) was: 4.6
all_actions shape just before sample torch.Size([1, 29, 1])
action scaled by temperature: tensor([[78]], device='cuda:0')
action picked by argmax: tensor([78], device='cuda:0')
tensor([[ 78,  86,  83, 146,  23, 229, 256, 186, 193, 147]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
3           1       79       4         4
349         2       79       1        77
783         3       79       1       238
841         4       79       3        23
1235        5       79       4       144
       user_id  item_id  rating  timestep
12547       46       79       3       263
12589       47       79       1        32
12914       48       79       3        84
13356       49       79       2       253
13496       50       79       2       120
average_rating for this rec across 50 users from same group (less noisy) was: 2.62
all_actions shape just before sample torch.Size([1, 30, 1])
action scaled by temperature: tensor([[186]], device='cuda:0')
action picked by argmax: tensor([186], device='cuda:0')
tensor([[186, 109,  84,  23, 137, 256, 202,  37,  14,  78]], device='cuda:0')
Just recommended 30 new items to 50 users from group 1 and the total rating was 122.22
train_loss is: 1.0983493858820772
action scaled by temperature: tensor([[253]], device='cuda:0')
action picked by argmax: tensor([44], device='cuda:0')
tensor([[ 44, 169,  94, 217, 112, 233,  78, 179,  81, 187]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
223         1       45       4       224
337         2       45       4        65
608         3       45       3        63
931         4       45       3       113
1241        5       45       4       150
       user_id  item_id  rating  timestep
12328       46       45       4        44
12737       47       45       4       180
13058       48       45       3       228
13244       49       45       4       141
13631       50       45       3       255
average_rating for this rec across 50 users from same group (less noisy) was: 3.84
all_actions shape just before sample torch.Size([1, 1, 1])
action scaled by temperature: tensor([[26]], device='cuda:0')
action picked by argmax: tensor([254], device='cuda:0')
tensor([[254, 229, 177, 217, 249, 237,   7, 189,  16, 102]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
153         1      255       5       154
544         2      255       5       272
618         3      255       4        73
989         4      255       5       171
1214        5      255       4       123
       user_id  item_id  rating  timestep
12365       46      255       5        81
12724       47      255       4       167
12933       48      255       4       103
13227       49      255       3       124
13601       50      255       3       225
average_rating for this rec across 50 users from same group (less noisy) was: 4.5
all_actions shape just before sample torch.Size([1, 2, 1])
action scaled by temperature: tensor([[63]], device='cuda:0')
action picked by argmax: tensor([63], device='cuda:0')
tensor([[ 63, 177,  40, 230,  16,  58,  17, 161, 182,   7]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
227         1       64       5       228
530         2       64       4       258
781         3       64       4       236
1036        4       64       5       218
1148        5       64       5        57
       user_id  item_id  rating  timestep
12401       46       64       3       117
12630       47       64       3        73
12869       48       64       4        39
13138       49       64       5        35
13605       50       64       4       229
average_rating for this rec across 50 users from same group (less noisy) was: 3.82
all_actions shape just before sample torch.Size([1, 3, 1])
action scaled by temperature: tensor([[40]], device='cuda:0')
action picked by argmax: tensor([40], device='cuda:0')
tensor([[ 40, 177, 219, 205,  91,  80, 248, 180,  52,  78]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
66          1       41       4        67
353         2       41       5        81
756         3       41       3       211
1060        4       41       2       242
1343        5       41       3       252
       user_id  item_id  rating  timestep
12376       46       41       3        92
12615       47       41       3        58
12882       48       41       3        52
13156       49       41       5        53
13485       50       41       4       109
average_rating for this rec across 50 users from same group (less noisy) was: 3.66
all_actions shape just before sample torch.Size([1, 4, 1])
action scaled by temperature: tensor([[46]], device='cuda:0')
action picked by argmax: tensor([46], device='cuda:0')
tensor([[ 46,  71,  45, 186,  83,  58,  74, 178, 173,  47]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
135         1       47       5       136
350         2       47       5        78
801         3       47       5       256
905         4       47       4        87
1275        5       47       5       184
       user_id  item_id  rating  timestep
12291       46       47       5         7
12594       47       47       4        37
13013       48       47       5       183
13248       49       47       5       145
13569       50       47       5       193
average_rating for this rec across 50 users from same group (less noisy) was: 4.42
all_actions shape just before sample torch.Size([1, 5, 1])
action scaled by temperature: tensor([[45]], device='cuda:0')
action picked by argmax: tensor([45], device='cuda:0')
tensor([[ 45, 110, 106,  29, 152, 179,  48, 137, 185, 149]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
139         1       46       5       140
296         2       46       5        24
714         3       46       5       169
973         4       46       3       155
1219        5       46       5       128
       user_id  item_id  rating  timestep
12425       46       46       5       141
12651       47       46       5        94
12862       48       46       4        32
13247       49       46       4       144
13537       50       46       3       161
average_rating for this rec across 50 users from same group (less noisy) was: 4.14
all_actions shape just before sample torch.Size([1, 6, 1])
action scaled by temperature: tensor([[110]], device='cuda:0')
action picked by argmax: tensor([110], device='cuda:0')
tensor([[110,  45,  89, 149, 227,  29, 171,   0,  93, 222]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
45          1      111       3        46
436         2      111       4       164
815         3      111       3       270
940         4      111       2       122
1196        5      111       3       105
       user_id  item_id  rating  timestep
12346       46      111       3        62
12636       47      111       4        79
12867       48      111       4        37
13207       49      111       5       104
13617       50      111       3       241
average_rating for this rec across 50 users from same group (less noisy) was: 3.72
all_actions shape just before sample torch.Size([1, 7, 1])
action scaled by temperature: tensor([[89]], device='cuda:0')
action picked by argmax: tensor([89], device='cuda:0')
tensor([[ 89,  93,  94, 120, 268, 264, 109,  35,  30, 112]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
108         1       90       4       109
482         2       90       4       210
751         3       90       4       206
1056        4       90       4       238
1114        5       90       4        23
       user_id  item_id  rating  timestep
12495       46       90       5       211
12823       47       90       4       266
13100       48       90       4       270
13366       49       90       4       263
13641       50       90       4       265
average_rating for this rec across 50 users from same group (less noisy) was: 3.88
all_actions shape just before sample torch.Size([1, 8, 1])
action scaled by temperature: tensor([[93]], device='cuda:0')
action picked by argmax: tensor([93], device='cuda:0')
tensor([[ 93,  23,  49,  94, 141,  50,  95,  75, 257, 216]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
115         1       94       5       116
391         2       94       5       119
752         3       94       5       207
929         4       94       5       111
1303        5       94       3       212
       user_id  item_id  rating  timestep
12500       46       94       4       216
12695       47       94       4       138
12964       48       94       5       134
13270       49       94       3       167
13589       50       94       4       213
average_rating for this rec across 50 users from same group (less noisy) was: 4.42
all_actions shape just before sample torch.Size([1, 9, 1])
action scaled by temperature: tensor([[94]], device='cuda:0')
action picked by argmax: tensor([94], device='cuda:0')
tensor([[ 94, 120,  89, 198, 141, 231,   7, 263,  67, 129]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
162         1       95       3       163
474         2       95       5       202
762         3       95       5       217
978         4       95       4       160
1355        5       95       3       264
       user_id  item_id  rating  timestep
12350       46       95       3        66
12800       47       95       4       243
12918       48       95       4        88
13240       49       95       4       137
13581       50       95       5       205
average_rating for this rec across 50 users from same group (less noisy) was: 3.76
all_actions shape just before sample torch.Size([1, 10, 1])
action scaled by temperature: tensor([[189]], device='cuda:0')
action picked by argmax: tensor([189], device='cuda:0')
tensor([[189, 232, 216,  74,  82,   5,  76, 120,  69, 190]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
54          1      190       5        55
354         2      190       4        82
732         3      190       4       187
1016        4      190       4       198
1119        5      190       5        28
       user_id  item_id  rating  timestep
12308       46      190       3        24
12634       47      190       4        77
13085       48      190       4       255
13209       49      190       4       106
13502       50      190       5       126
average_rating for this rec across 50 users from same group (less noisy) was: 4.14
all_actions shape just before sample torch.Size([1, 11, 1])
action scaled by temperature: tensor([[49]], device='cuda:0')
action picked by argmax: tensor([49], device='cuda:0')
tensor([[ 49, 135, 215, 114, 123, 116,  82,  81, 216, 202]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
4           1       50       3         5
470         2       50       5       198
646         3       50       5       101
1035        4       50       5       217
1315        5       50       4       224
       user_id  item_id  rating  timestep
12400       46       50       5       116
12824       47       50       4       267
12908       48       50       5        78
13271       49       50       3       168
13627       50       50       4       251
average_rating for this rec across 50 users from same group (less noisy) was: 4.24
all_actions shape just before sample torch.Size([1, 12, 1])
action scaled by temperature: tensor([[135]], device='cuda:0')
action picked by argmax: tensor([135], device='cuda:0')
tensor([[135, 179, 202, 116,  90, 118, 236,  11,  49, 106]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
166         1      136       4       167
401         2      136       4       129
775         3      136       3       230
1007        4      136       3       189
1187        5      136       3        96
       user_id  item_id  rating  timestep
12285       46      136       4         1
12742       47      136       5       185
12835       48      136       5         5
13263       49      136       2       160
13585       50      136       3       209
average_rating for this rec across 50 users from same group (less noisy) was: 3.84
all_actions shape just before sample torch.Size([1, 13, 1])
action scaled by temperature: tensor([[90]], device='cuda:0')
action picked by argmax: tensor([90], device='cuda:0')
tensor([[ 90, 135,  11,  30, 179, 250, 172, 202, 231, 197]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
26          1       91       4        27
452         2       91       4       180
580         3       91       2        35
982         4       91       3       164
1198        5       91       4       107
       user_id  item_id  rating  timestep
12411       46       91       3       127
12568       47       91       4        11
13005       48       91       5       175
13291       49       91       5       188
13603       50       91       5       227
average_rating for this rec across 50 users from same group (less noisy) was: 3.9
all_actions shape just before sample torch.Size([1, 14, 1])
action scaled by temperature: tensor([[23]], device='cuda:0')
action picked by argmax: tensor([23], device='cuda:0')
tensor([[ 23, 117, 147, 114, 119,  78, 201, 137, 234, 193]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
122         1       24       4       123
389         2       24       5       117
666         3       24       3       121
871         4       24       5        53
1330        5       24       5       239
       user_id  item_id  rating  timestep
12339       46       24       4        55
12640       47       24       4        83
12930       48       24       3       100
13266       49       24       5       163
13582       50       24       4       206
average_rating for this rec across 50 users from same group (less noisy) was: 3.84
all_actions shape just before sample torch.Size([1, 15, 1])
action scaled by temperature: tensor([[119]], device='cuda:0')
action picked by argmax: tensor([119], device='cuda:0')
tensor([[119,  23, 193, 135, 130,  30,  12, 117,  57, 113]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
138         1      120       5       139
524         2      120       4       252
674         3      120       2       129
957         4      120       2       139
1242        5      120       3       151
       user_id  item_id  rating  timestep
12334       46      120       4        50
12574       47      120       3        17
12876       48      120       5        46
13120       49      120       5        17
13389       50      120       5        13
average_rating for this rec across 50 users from same group (less noisy) was: 3.74
all_actions shape just before sample torch.Size([1, 16, 1])
action scaled by temperature: tensor([[193]], device='cuda:0')
action picked by argmax: tensor([193], device='cuda:0')
tensor([[193,  57, 135, 119, 147, 155, 215,  11, 245,  31]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
15          1      194       3        16
423         2      194       5       151
569         3      194       2        24
971         4      194       3       153
1099        5      194       5         8
       user_id  item_id  rating  timestep
12512       46      194       4       228
12663       47      194       3       106
13083       48      194       3       253
13117       49      194       3        14
13489       50      194       2       113
average_rating for this rec across 50 users from same group (less noisy) was: 3.58
all_actions shape just before sample torch.Size([1, 17, 1])
action scaled by temperature: tensor([[57]], device='cuda:0')
action picked by argmax: tensor([57], device='cuda:0')
tensor([[ 57, 193, 119,   2, 247, 147, 124, 203,   6, 191]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
131         1       58       4       132
278         2       58       3         6
816         3       58       4       271
852         4       58       5        34
1130        5       58       4        39
       user_id  item_id  rating  timestep
12496       46       58       3       212
12725       47       58       3       168
12938       48       58       4       108
13152       49       58       3        49
13512       50       58       5       136
average_rating for this rec across 50 users from same group (less noisy) was: 3.88
all_actions shape just before sample torch.Size([1, 18, 1])
action scaled by temperature: tensor([[40]], device='cuda:0')
action picked by argmax: tensor([40], device='cuda:0')
tensor([[ 40, 117,  23, 193, 218, 119, 147,   6,  57, 114]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
66          1       41       4        67
353         2       41       5        81
756         3       41       3       211
1060        4       41       2       242
1343        5       41       3       252
       user_id  item_id  rating  timestep
12376       46       41       3        92
12615       47       41       3        58
12882       48       41       3        52
13156       49       41       5        53
13485       50       41       4       109
average_rating for this rec across 50 users from same group (less noisy) was: 3.66
all_actions shape just before sample torch.Size([1, 19, 1])
action scaled by temperature: tensor([[83]], device='cuda:0')
action picked by argmax: tensor([83], device='cuda:0')
tensor([[ 83,  79, 179, 193, 173, 136, 114,  13, 207,  99]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
255         1       84       3       256
303         2       84       5        31
754         3       84       4       209
850         4       84       4        32
1230        5       84       5       139
       user_id  item_id  rating  timestep
12517       46       84       4       233
12799       47       84       5       242
12936       48       84       5       106
13329       49       84       5       226
13635       50       84       4       259
average_rating for this rec across 50 users from same group (less noisy) was: 4.2
all_actions shape just before sample torch.Size([1, 20, 1])
action scaled by temperature: tensor([[188]], device='cuda:0')
action picked by argmax: tensor([188], device='cuda:0')
tensor([[188,   1, 193, 249,  41,  13,  75,  76,  36,  10]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
83          1      189       4        84
373         2      189       5       101
797         3      189       4       252
885         4      189       5        67
1165        5      189       5        74
       user_id  item_id  rating  timestep
12391       46      189       5       107
12642       47      189       5        85
12984       48      189       3       154
13290       49      189       3       187
13426       50      189       5        50
average_rating for this rec across 50 users from same group (less noisy) was: 4.28
all_actions shape just before sample torch.Size([1, 21, 1])
action scaled by temperature: tensor([[85]], device='cuda:0')
action picked by argmax: tensor([85], device='cuda:0')
tensor([[ 85, 271, 226, 243, 235,  99, 221,  10,  91, 101]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
266         1       86       5       267
509         2       86       5       237
777         3       86       5       232
917         4       86       5        99
1121        5       86       4        30
       user_id  item_id  rating  timestep
12506       46       86       5       222
12600       47       86       5        43
13074       48       86       5       244
13362       49       86       5       259
13397       50       86       5        21
average_rating for this rec across 50 users from same group (less noisy) was: 4.58
all_actions shape just before sample torch.Size([1, 22, 1])
action scaled by temperature: tensor([[226]], device='cuda:0')
action picked by argmax: tensor([226], device='cuda:0')
tensor([[226,   6,  85, 124,  83, 178,  52, 185,   1,  92]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
127         1      227       4       128
504         2      227       4       232
588         3      227       4        43
945         4      227       4       127
1255        5      227       5       164
       user_id  item_id  rating  timestep
12337       46      227       5        53
12591       47      227       5        34
13101       48      227       5       271
13333       49      227       5       230
13598       50      227       4       222
average_rating for this rec across 50 users from same group (less noisy) was: 4.72
all_actions shape just before sample torch.Size([1, 23, 1])
action scaled by temperature: tensor([[230]], device='cuda:0')
action picked by argmax: tensor([230], device='cuda:0')
tensor([[230, 171, 207, 117, 192, 183,  49,  10, 263,  85]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
269         1      231       5       270
359         2      231       5        87
633         3      231       4        88
967         4      231       5       149
1184        5      231       4        93
       user_id  item_id  rating  timestep
12505       46      231       5       221
12658       47      231       5       101
12987       48      231       4       157
13341       49      231       5       238
13428       50      231       5        52
average_rating for this rec across 50 users from same group (less noisy) was: 4.6
all_actions shape just before sample torch.Size([1, 24, 1])
action scaled by temperature: tensor([[207]], device='cuda:0')
action picked by argmax: tensor([207], device='cuda:0')
tensor([[207, 183, 135, 230, 186, 171,  80,  45, 205,  11]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
61          1      208       5        62
364         2      208       3        92
745         3      208       3       200
1074        4      208       5       256
1278        5      208       3       187
       user_id  item_id  rating  timestep
12429       46      208       5       145
12753       47      208       5       196
12912       48      208       5        82
13308       49      208       1       205
13400       50      208       4        24
average_rating for this rec across 50 users from same group (less noisy) was: 4.04
all_actions shape just before sample torch.Size([1, 25, 1])
action scaled by temperature: tensor([[124]], device='cuda:0')
action picked by argmax: tensor([124], device='cuda:0')
tensor([[124, 263,  99,  83,  37,  45, 149, 221, 207,  39]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
203         1      125       3       204
439         2      125       5       167
584         3      125       5        39
959         4      125       5       141
1123        5      125       3        32
       user_id  item_id  rating  timestep
12347       46      125       4        63
12670       47      125       5       113
13037       48      125       3       207
13144       49      125       4        41
13613       50      125       5       237
average_rating for this rec across 50 users from same group (less noisy) was: 3.92
all_actions shape just before sample torch.Size([1, 26, 1])
action scaled by temperature: tensor([[263]], device='cuda:0')
action picked by argmax: tensor([263], device='cuda:0')
tensor([[263,  83, 124,  11, 250,  37,   9,  33,  93,  99]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
24          1      264       4        25
491         2      264       3       219
715         3      264       3       170
1039        4      264       5       221
1334        5      264       4       243
       user_id  item_id  rating  timestep
12302       46      264       5        18
12567       47      264       4        10
12976       48      264       4       146
13241       49      264       4       138
13515       50      264       5       139
average_rating for this rec across 50 users from same group (less noisy) was: 4.42
all_actions shape just before sample torch.Size([1, 27, 1])
action scaled by temperature: tensor([[93]], device='cuda:0')
action picked by argmax: tensor([93], device='cuda:0')
tensor([[ 93,  23, 117, 153, 195,  16, 131, 122,   6, 270]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
115         1       94       5       116
391         2       94       5       119
752         3       94       5       207
929         4       94       5       111
1303        5       94       3       212
       user_id  item_id  rating  timestep
12500       46       94       4       216
12695       47       94       4       138
12964       48       94       5       134
13270       49       94       3       167
13589       50       94       4       213
average_rating for this rec across 50 users from same group (less noisy) was: 4.42
all_actions shape just before sample torch.Size([1, 28, 1])
action scaled by temperature: tensor([[6]], device='cuda:0')
action picked by argmax: tensor([6], device='cuda:0')
tensor([[  6, 192, 124, 122, 180,  32,  11,  85,  50, 218]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
82          1        7       4        83
388         2        7       4       116
811         3        7       4       266
990         4        7       4       172
1154        5        7       3        63
       user_id  item_id  rating  timestep
12491       46        7       3       207
12722       47        7       4       165
13002       48        7       5       172
13104       49        7       4         1
13378       50        7       5         2
average_rating for this rec across 50 users from same group (less noisy) was: 3.68
all_actions shape just before sample torch.Size([1, 29, 1])
action scaled by temperature: tensor([[192]], device='cuda:0')
action picked by argmax: tensor([192], device='cuda:0')
tensor([[192, 117,  25, 218, 209, 219, 269,  50,  53,  52]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
11          1      193       3        12
393         2      193       4       121
628         3      193       5        83
878         4      193       5        60
1325        5      193       4       234
       user_id  item_id  rating  timestep
12327       46      193       3        43
12762       47      193       3       205
12992       48      193       5       162
13129       49      193       5        26
13493       50      193       3       117
average_rating for this rec across 50 users from same group (less noisy) was: 4.14
all_actions shape just before sample torch.Size([1, 30, 1])
action scaled by temperature: tensor([[266]], device='cuda:0')
action picked by argmax: tensor([266], device='cuda:0')
tensor([[266, 110, 236, 192, 214,  35,  51, 230, 219, 257]], device='cuda:0')
Just recommended 30 new items to 50 users from group 1 and the total rating was 121.98
train_loss is: 1.0098734669489404
action scaled by temperature: tensor([[246]], device='cuda:0')
action picked by argmax: tensor([255], device='cuda:0')
tensor([[255,  14, 110, 267, 187, 246, 272, 247,   3, 112]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
85          1      256       2        86
409         2      256       4       137
693         3      256       4       148
889         4      256       5        71
1191        5      256       5       100
       user_id  item_id  rating  timestep
12509       46      256       4       225
12728       47      256       4       171
12993       48      256       5       163
13128       49      256       5        25
13480       50      256       4       104
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 1, 1])
action scaled by temperature: tensor([[131]], device='cuda:0')
action picked by argmax: tensor([117], device='cuda:0')
tensor([[117,  17,  68,  95, 234, 186, 103, 145,  96, 148]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
70          1      118       4        71
404         2      118       4       132
643         3      118       5        98
1000        4      118       5       182
1302        5      118       4       211
       user_id  item_id  rating  timestep
12489       46      118       4       205
12576       47      118       4        19
12923       48      118       4        93
13374       49      118       3       271
13566       50      118       4       190
average_rating for this rec across 50 users from same group (less noisy) was: 4.3
all_actions shape just before sample torch.Size([1, 2, 1])
action scaled by temperature: tensor([[122]], device='cuda:0')
action picked by argmax: tensor([39], device='cuda:0')
tensor([[ 39, 112,  26, 109,  44, 200,  81, 143,  59, 248]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
101         1       40       5       102
275         2       40       5         3
550         3       40       4         5
1065        4       40       5       247
1189        5       40       5        98
       user_id  item_id  rating  timestep
12542       46       40       5       258
12805       47       40       5       248
12866       48       40       5        36
13122       49       40       5        19
13587       50       40       4       211
average_rating for this rec across 50 users from same group (less noisy) was: 4.68
all_actions shape just before sample torch.Size([1, 3, 1])
action scaled by temperature: tensor([[49]], device='cuda:0')
action picked by argmax: tensor([85], device='cuda:0')
tensor([[ 85,  47,  64, 101, 224,  79, 150,  17, 249,   7]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
266         1       86       5       267
509         2       86       5       237
777         3       86       5       232
917         4       86       5        99
1121        5       86       4        30
       user_id  item_id  rating  timestep
12506       46       86       5       222
12600       47       86       5        43
13074       48       86       5       244
13362       49       86       5       259
13397       50       86       5        21
average_rating for this rec across 50 users from same group (less noisy) was: 4.58
all_actions shape just before sample torch.Size([1, 4, 1])
action scaled by temperature: tensor([[167]], device='cuda:0')
action picked by argmax: tensor([167], device='cuda:0')
tensor([[167, 163,  74,  61, 271, 264,  52, 161, 152, 184]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
38          1      168       5        39
418         2      168       3       146
699         3      168       4       154
928         4      168       5       110
1133        5      168       5        42
       user_id  item_id  rating  timestep
12493       46      168       3       209
12781       47      168       4       224
12921       48      168       3        91
13219       49      168       5       116
13564       50      168       4       188
average_rating for this rec across 50 users from same group (less noisy) was: 4.08
all_actions shape just before sample torch.Size([1, 5, 1])
action scaled by temperature: tensor([[232]], device='cuda:0')
action picked by argmax: tensor([76], device='cuda:0')
tensor([[ 76, 232, 246, 224, 162, 262,  87, 183, 257, 120]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
243         1       77       5       244
432         2       77       5       160
743         3       77       5       198
835         4       77       4        17
1233        5       77       4       142
       user_id  item_id  rating  timestep
12393       46       77       3       109
12719       47       77       4       162
13098       48       77       5       268
13143       49       77       4        40
13500       50       77       3       124
average_rating for this rec across 50 users from same group (less noisy) was: 3.96
all_actions shape just before sample torch.Size([1, 6, 1])
action scaled by temperature: tensor([[216]], device='cuda:0')
action picked by argmax: tensor([216], device='cuda:0')
tensor([[216, 140, 199, 158, 272,  21,  60, 112,  12, 113]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
148         1      217       4       149
288         2      217       5        16
639         3      217       4        94
1073        4      217       3       255
1245        5      217       3       154
       user_id  item_id  rating  timestep
12456       46      217       4       172
12582       47      217       3        25
12937       48      217       4       107
13147       49      217       4        44
13432       50      217       4        56
average_rating for this rec across 50 users from same group (less noisy) was: 3.94
all_actions shape just before sample torch.Size([1, 7, 1])
action scaled by temperature: tensor([[272]], device='cuda:0')
action picked by argmax: tensor([272], device='cuda:0')
tensor([[272,  60, 255, 233, 194, 262,  46, 121, 142, 247]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
232         1      273       5       233
334         2      273       5        62
694         3      273       4       149
994         4      273       5       176
1131        5      273       5        40
       user_id  item_id  rating  timestep
12539       46      273       4       255
12788       47      273       5       231
12951       48      273       5       121
13264       49      273       5       161
13408       50      273       5        32
average_rating for this rec across 50 users from same group (less noisy) was: 4.5
all_actions shape just before sample torch.Size([1, 8, 1])
action scaled by temperature: tensor([[106]], device='cuda:0')
action picked by argmax: tensor([100], device='cuda:0')
tensor([[100, 106, 196, 210, 157, 142, 265, 209, 152,  46]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
5           1      101       3         6
322         2      101       4        50
763         3      101       2       218
946         4      101       5       128
1161        5      101       4        70
       user_id  item_id  rating  timestep
12556       46      101       3       272
12579       47      101       4        22
12877       48      101       5        47
13370       49      101       3       267
13597       50      101       5       221
average_rating for this rec across 50 users from same group (less noisy) was: 3.72
all_actions shape just before sample torch.Size([1, 9, 1])
action scaled by temperature: tensor([[60]], device='cuda:0')
action picked by argmax: tensor([60], device='cuda:0')
tensor([[ 60, 153, 174, 193,  66, 196, 269, 125, 198, 264]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
107         1       61       5       108
402         2       61       5       130
784         3       61       5       239
904         4       61       5        86
1135        5       61       4        44
       user_id  item_id  rating  timestep
12522       46       61       5       238
12713       47       61       4       156
12883       48       61       3        53
13153       49       61       5        50
13536       50       61       5       160
average_rating for this rec across 50 users from same group (less noisy) was: 4.38
all_actions shape just before sample torch.Size([1, 10, 1])
action scaled by temperature: tensor([[153]], device='cuda:0')
action picked by argmax: tensor([153], device='cuda:0')
tensor([[153, 174,  60, 249, 239,  89,  20, 247,  73, 102]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
186         1      154       5       187
433         2      154       5       161
566         3      154       4        21
875         4      154       5        57
1157        5      154       4        66
       user_id  item_id  rating  timestep
12351       46      154       5        67
12734       47      154       4       177
13011       48      154       4       181
13253       49      154       5       150
13572       50      154       3       196
average_rating for this rec across 50 users from same group (less noisy) was: 4.32
all_actions shape just before sample torch.Size([1, 11, 1])
action scaled by temperature: tensor([[239]], device='cuda:0')
action picked by argmax: tensor([239], device='cuda:0')
tensor([[239,  77, 176, 158,  20,  89,  47, 150, 174,  48]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
187         1      240       4       188
438         2      240       2       166
711         3      240       4       166
911         4      240       3        93
1162        5      240       5        71
       user_id  item_id  rating  timestep
12384       46      240       4       100
12819       47      240       3       262
12972       48      240       4       142
13230       49      240       4       127
13454       50      240       2        78
average_rating for this rec across 50 users from same group (less noisy) was: 3.72
all_actions shape just before sample torch.Size([1, 12, 1])
action scaled by temperature: tensor([[112]], device='cuda:0')
action picked by argmax: tensor([112], device='cuda:0')
tensor([[112,  45, 185, 150,  81,  36, 107, 230, 223,  56]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
229         1      113       5       230
305         2      113       3        33
611         3      113       3        66
1032        4      113       5       214
1356        5      113       4       265
       user_id  item_id  rating  timestep
12513       46      113       5       229
12828       47      113       3       271
12843       48      113       1        13
13169       49      113       4        66
13472       50      113       4        96
average_rating for this rec across 50 users from same group (less noisy) was: 3.62
all_actions shape just before sample torch.Size([1, 13, 1])
action scaled by temperature: tensor([[77]], device='cuda:0')
action picked by argmax: tensor([77], device='cuda:0')
tensor([[ 77, 108,  99, 218,  95, 225, 183,  14, 126,  55]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
252         1       78       5       253
311         2       78       4        39
630         3       78       3        85
1085        4       78       4       267
1321        5       78       4       230
       user_id  item_id  rating  timestep
12290       46       78       3         6
12727       47       78       3       170
12855       48       78       4        25
13256       49       78       4       153
13543       50       78       3       167
average_rating for this rec across 50 users from same group (less noisy) was: 3.74
all_actions shape just before sample torch.Size([1, 14, 1])
action scaled by temperature: tensor([[77]], device='cuda:0')
action picked by argmax: tensor([99], device='cuda:0')
tensor([[ 99,  77,  93,  17, 133, 112, 126, 196, 108,  81]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
181         1      100       5       182
298         2      100       4        26
779         3      100       5       234
902         4      100       5        84
1101        5      100       5        10
       user_id  item_id  rating  timestep
12367       46      100       5        83
12682       47      100       5       125
13064       48      100       5       234
13324       49      100       5       221
13421       50      100       4        45
average_rating for this rec across 50 users from same group (less noisy) was: 4.78
all_actions shape just before sample torch.Size([1, 15, 1])
action scaled by temperature: tensor([[218]], device='cuda:0')
action picked by argmax: tensor([218], device='cuda:0')
tensor([[218, 225, 235, 207,  95, 258, 200, 126, 163, 187]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
19          1      219       4        20
366         2      219       4        94
796         3      219       3       251
925         4      219       3       107
1212        5      219       4       121
       user_id  item_id  rating  timestep
12441       46      219       3       157
12756       47      219       4       199
12836       48      219       4         6
13278       49      219       5       175
13562       50      219       4       186
average_rating for this rec across 50 users from same group (less noisy) was: 3.64
all_actions shape just before sample torch.Size([1, 16, 1])
action scaled by temperature: tensor([[235]], device='cuda:0')
action picked by argmax: tensor([235], device='cuda:0')
tensor([[235, 227, 218, 207,  94, 258,  40, 225, 173,  14]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
57          1      236       5        58
392         2      236       4       120
770         3      236       4       225
825         4      236       5         7
1151        5      236       4        60
       user_id  item_id  rating  timestep
12321       46      236       3        37
12669       47      236       5       112
12940       48      236       3       110
13113       49      236       4        10
13638       50      236       3       262
average_rating for this rec across 50 users from same group (less noisy) was: 4.26
all_actions shape just before sample torch.Size([1, 17, 1])
action scaled by temperature: tensor([[227]], device='cuda:0')
action picked by argmax: tensor([227], device='cuda:0')
tensor([[227, 235, 225, 151,  37, 266, 214,  95,  14, 187]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
205         1      228       4       206
490         2      228       3       218
663         3      228       3       118
1070        4      228       2       252
1271        5      228       3       180
       user_id  item_id  rating  timestep
12329       46      228       4        45
12703       47      228       3       146
12879       48      228       5        49
13111       49      228       2         8
13530       50      228       4       154
average_rating for this rec across 50 users from same group (less noisy) was: 3.34
all_actions shape just before sample torch.Size([1, 18, 1])
action scaled by temperature: tensor([[37]], device='cuda:0')
action picked by argmax: tensor([37], device='cuda:0')
tensor([[ 37,  22, 143, 266, 254, 228, 100,  31, 230, 151]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
118         1       38       3       119
455         2       38       2       183
757         3       38       5       212
856         4       38       4        38
1253        5       38       5       162
       user_id  item_id  rating  timestep
12320       46       38       2        36
12622       47       38       3        65
13068       48       38       3       238
13336       49       38       3       233
13466       50       38       5        90
average_rating for this rec across 50 users from same group (less noisy) was: 3.36
all_actions shape just before sample torch.Size([1, 19, 1])
action scaled by temperature: tensor([[95]], device='cuda:0')
action picked by argmax: tensor([95], device='cuda:0')
tensor([[ 95, 167, 142, 143, 266, 196, 100,  14,  50, 187]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
167         1       96       3       168
352         2       96       3        80
654         3       96       5       109
879         4       96       3        61
1136        5       96       3        45
       user_id  item_id  rating  timestep
12407       46       96       3       123
12748       47       96       4       191
12851       48       96       4        21
13222       49       96       5       119
13437       50       96       4        61
average_rating for this rec across 50 users from same group (less noisy) was: 3.9
all_actions shape just before sample torch.Size([1, 20, 1])
action scaled by temperature: tensor([[196]], device='cuda:0')
action picked by argmax: tensor([196], device='cuda:0')
tensor([[196, 152,  50,  59, 244, 266,  26,  14, 212,  17]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
98          1      197       3        99
369         2      197       4        97
729         3      197       3       184
867         4      197       5        49
1109        5      197       4        18
       user_id  item_id  rating  timestep
12311       46      197       2        27
12645       47      197       4        88
13014       48      197       3       184
13119       49      197       1        16
13636       50      197       3       260
average_rating for this rec across 50 users from same group (less noisy) was: 3.28
all_actions shape just before sample torch.Size([1, 21, 1])
action scaled by temperature: tensor([[26]], device='cuda:0')
action picked by argmax: tensor([26], device='cuda:0')
tensor([[ 26, 127, 217, 218, 115,  14,  56, 266,  70,  11]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
55          1       27       4        56
387         2       27       4       115
795         3       27       4       250
1011        4       27       5       193
1266        5       27       4       175
       user_id  item_id  rating  timestep
12433       46       27       4       149
12635       47       27       5        78
12969       48       27       4       139
13275       49       27       5       172
13544       50       27       5       168
average_rating for this rec across 50 users from same group (less noisy) was: 4.36
all_actions shape just before sample torch.Size([1, 22, 1])
action scaled by temperature: tensor([[217]], device='cuda:0')
action picked by argmax: tensor([217], device='cuda:0')
tensor([[217,  14, 127, 182, 218, 169, 237,  56,  26, 152]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
161         1      218       4       162
347         2      218       3        75
661         3      218       4       116
979         4      218       4       161
1361        5      218       3       270
       user_id  item_id  rating  timestep
12443       46      218       3       159
12659       47      218       4       102
13017       48      218       5       187
13170       49      218       4        67
13621       50      218       4       245
average_rating for this rec across 50 users from same group (less noisy) was: 3.88
all_actions shape just before sample torch.Size([1, 23, 1])
action scaled by temperature: tensor([[169]], device='cuda:0')
action picked by argmax: tensor([169], device='cuda:0')
tensor([[169, 127, 196,  14, 235, 157,  81,  56,  77, 137]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
126         1      170       5       127
429         2      170       5       157
722         3      170       4       177
983         4      170       5       165
1126        5      170       4        35
       user_id  item_id  rating  timestep
12490       46      170       4       206
12602       47      170       4        45
13027       48      170       5       197
13304       49      170       5       201
13599       50      170       5       223
average_rating for this rec across 50 users from same group (less noisy) was: 4.54
all_actions shape just before sample torch.Size([1, 24, 1])
action scaled by temperature: tensor([[14]], device='cuda:0')
action picked by argmax: tensor([14], device='cuda:0')
tensor([[ 14, 169, 127,  36,  15,  25, 142, 237,  67,  17]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
245         1       15       5       246
419         2       15       5       147
685         3       15       5       140
880         4       15       5        62
1234        5       15       3       143
       user_id  item_id  rating  timestep
12325       46       15       4        41
12584       47       15       5        27
13102       48       15       2       272
13313       49       15       5       210
13413       50       15       3        37
average_rating for this rec across 50 users from same group (less noisy) was: 3.8
all_actions shape just before sample torch.Size([1, 25, 1])
action scaled by temperature: tensor([[36]], device='cuda:0')
action picked by argmax: tensor([36], device='cuda:0')
tensor([[ 36, 147, 169, 191,  10,  81, 132,  50, 183, 165]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
201         1       37       2       202
424         2       37       5       152
565         3       37       4        20
1025        4       37       3       207
1221        5       37       4       130
       user_id  item_id  rating  timestep
12390       46       37       4       106
12575       47       37       4        18
13059       48       37       4       229
13368       49       37       5       265
13436       50       37       3        60
average_rating for this rec across 50 users from same group (less noisy) was: 3.72
all_actions shape just before sample torch.Size([1, 26, 1])
action scaled by temperature: tensor([[191]], device='cuda:0')
action picked by argmax: tensor([191], device='cuda:0')
tensor([[191, 160,  81, 227, 148, 220,   8,  53, 228, 257]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
32          1      192       4        33
537         2      192       4       265
582         3      192       5        37
1010        4      192       5       192
1170        5      192       4        79
       user_id  item_id  rating  timestep
12369       46      192       5        85
12673       47      192       5       116
13020       48      192       5       190
13277       49      192       4       174
13457       50      192       4        81
average_rating for this rec across 50 users from same group (less noisy) was: 4.34
all_actions shape just before sample torch.Size([1, 27, 1])
action scaled by temperature: tensor([[109]], device='cuda:0')
action picked by argmax: tensor([109], device='cuda:0')
tensor([[109, 166, 138,  67,   1, 128,  35, 188, 220, 257]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
132         1      110       4       133
472         2      110       5       200
687         3      110       5       142
910         4      110       5        92
1217        5      110       4       126
       user_id  item_id  rating  timestep
12408       46      110       5       124
12729       47      110       5       172
12956       48      110       5       126
13369       49      110       5       266
13458       50      110       5        82
average_rating for this rec across 50 users from same group (less noisy) was: 4.66
all_actions shape just before sample torch.Size([1, 28, 1])
action scaled by temperature: tensor([[166]], device='cuda:0')
action picked by argmax: tensor([166], device='cuda:0')
tensor([[166, 258, 109, 248, 144, 271,  50,  36,   1, 211]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
141         1      167       4       142
539         2      167       5       267
791         3      167       4       246
1054        4      167       4       236
1153        5      167       3        62
       user_id  item_id  rating  timestep
12348       46      167       4        64
12628       47      167       4        71
12941       48      167       5       111
13112       49      167       4         9
13578       50      167       2       202
average_rating for this rec across 50 users from same group (less noisy) was: 4.2
all_actions shape just before sample torch.Size([1, 29, 1])
action scaled by temperature: tensor([[248]], device='cuda:0')
action picked by argmax: tensor([248], device='cuda:0')
tensor([[248, 244,  50, 144, 258,   6, 109, 154, 172, 271]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
113         1      249       5       114
445         2      249       5       173
590         3      249       4        45
1075        4      249       4       257
1115        5      249       5        24
       user_id  item_id  rating  timestep
12502       46      249       5       218
12627       47      249       5        70
13065       48      249       4       235
13191       49      249       5        88
13541       50      249       5       165
average_rating for this rec across 50 users from same group (less noisy) was: 4.7
all_actions shape just before sample torch.Size([1, 30, 1])
action scaled by temperature: tensor([[237]], device='cuda:0')
action picked by argmax: tensor([237], device='cuda:0')
tensor([[237, 109,  82, 244, 189,  50, 169,   2, 150, 202]], device='cuda:0')
Just recommended 30 new items to 50 users from group 1 and the total rating was 122.36000000000001
train_loss is: 0.8819875292582054
action scaled by temperature: tensor([[143]], device='cuda:0')
action picked by argmax: tensor([180], device='cuda:0')
tensor([[180,  44, 200, 237, 169,  28, 233, 218, 203, 247]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
73          1      181       5        74
326         2      181       4        54
708         3      181       5       163
934         4      181       4       116
1231        5      181       5       140
       user_id  item_id  rating  timestep
12317       46      181       4        33
12688       47      181       5       131
13048       48      181       5       218
13131       49      181       5        28
13517       50      181       5       141
average_rating for this rec across 50 users from same group (less noisy) was: 4.68
all_actions shape just before sample torch.Size([1, 1, 1])
action scaled by temperature: tensor([[21]], device='cuda:0')
action picked by argmax: tensor([173], device='cuda:0')
tensor([[173, 147, 174, 189,  57, 193,  27, 235, 208, 159]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
214         1      174       4       215
281         2      174       4         9
741         3      174       4       196
896         4      174       5        78
1116        5      174       4        25
       user_id  item_id  rating  timestep
12288       46      174       4         4
12807       47      174       4       250
13007       48      174       5       177
13168       49      174       4        65
13478       50      174       5       102
average_rating for this rec across 50 users from same group (less noisy) was: 4.2
all_actions shape just before sample torch.Size([1, 2, 1])
action scaled by temperature: tensor([[244]], device='cuda:0')
action picked by argmax: tensor([159], device='cuda:0')
tensor([[159, 265, 244, 162, 193, 257, 118, 169, 253,  27]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
48          1      160       3        49
514         2      160       4       242
790         3      160       3       245
849         4      160       3        31
1264        5      160       4       173
       user_id  item_id  rating  timestep
12473       46      160       5       189
12595       47      160       3        38
13099       48      160       4       269
13202       49      160       2        99
13526       50      160       3       150
average_rating for this rec across 50 users from same group (less noisy) was: 3.56
all_actions shape just before sample torch.Size([1, 3, 1])
action scaled by temperature: tensor([[216]], device='cuda:0')
action picked by argmax: tensor([216], device='cuda:0')
tensor([[216,  27, 253, 131,  65, 265,  46, 142, 272,  57]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
148         1      217       4       149
288         2      217       5        16
639         3      217       4        94
1073        4      217       3       255
1245        5      217       3       154
       user_id  item_id  rating  timestep
12456       46      217       4       172
12582       47      217       3        25
12937       48      217       4       107
13147       49      217       4        44
13432       50      217       4        56
average_rating for this rec across 50 users from same group (less noisy) was: 3.94
all_actions shape just before sample torch.Size([1, 4, 1])
action scaled by temperature: tensor([[101]], device='cuda:0')
action picked by argmax: tensor([101], device='cuda:0')
tensor([[101,  27, 253, 272, 205,  65, 257, 265,  46, 162]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
103         1      102       4       104
377         2      102       4       105
581         3      102       3        36
1082        4      102       5       264
1107        5      102       4        16
       user_id  item_id  rating  timestep
12374       46      102       5        90
12638       47      102       5        81
12875       48      102       5        45
13115       49      102       5        12
13571       50      102       4       195
average_rating for this rec across 50 users from same group (less noisy) was: 4.1
all_actions shape just before sample torch.Size([1, 5, 1])
action scaled by temperature: tensor([[253]], device='cuda:0')
action picked by argmax: tensor([253], device='cuda:0')
tensor([[253, 194,   4, 176, 223, 228, 119, 208,  46,  27]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
102         1      254       3       103
293         2      254       4        21
648         3      254       3       103
987         4      254       4       169
1301        5      254       5       210
       user_id  item_id  rating  timestep
12416       46      254       4       132
12624       47      254       4        67
12971       48      254       4       141
13226       49      254       4       123
13624       50      254       5       248
average_rating for this rec across 50 users from same group (less noisy) was: 4.12
all_actions shape just before sample torch.Size([1, 6, 1])
action scaled by temperature: tensor([[240]], device='cuda:0')
action picked by argmax: tensor([240], device='cuda:0')
tensor([[240, 215, 142, 269, 198, 108, 124,   5, 192,   0]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
200         1      241       4       201
397         2      241       5       125
583         3      241       2        38
883         4      241       4        65
1199        5      241       4       108
       user_id  item_id  rating  timestep
12545       46      241       5       261
12770       47      241       3       213
13006       48      241       5       176
13145       49      241       5        42
13557       50      241       3       181
average_rating for this rec across 50 users from same group (less noisy) was: 3.62
all_actions shape just before sample torch.Size([1, 7, 1])
action scaled by temperature: tensor([[108]], device='cuda:0')
action picked by argmax: tensor([108], device='cuda:0')
tensor([[108, 188, 240, 124,  88, 192, 149,   5, 179,  44]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
217         1      109       4       218
521         2      109       5       249
808         3      109       4       263
1013        4      109       5       195
1332        5      109       5       241
       user_id  item_id  rating  timestep
12395       46      109       5       111
12654       47      109       5        97
13079       48      109       5       249
13139       49      109       5        36
13588       50      109       5       212
average_rating for this rec across 50 users from same group (less noisy) was: 4.9
all_actions shape just before sample torch.Size([1, 8, 1])
action scaled by temperature: tensor([[0]], device='cuda:0')
action picked by argmax: tensor([0], device='cuda:0')
tensor([[  0,  88,  93, 240, 123, 257,   5,  13, 224, 261]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
62          1        1       4        63
522         2        1       5       250
671         3        1       4       126
892         4        1       4        74
1204        5        1       5       113
       user_id  item_id  rating  timestep
12375       46        1       5        91
12816       47        1       5       259
13045       48        1       4       215
13375       49        1       5       272
13542       50        1       5       166
average_rating for this rec across 50 users from same group (less noisy) was: 4.66
all_actions shape just before sample torch.Size([1, 9, 1])
action scaled by temperature: tensor([[123]], device='cuda:0')
action picked by argmax: tensor([123], device='cuda:0')
tensor([[123,  21,   5, 200, 188, 240, 247,   0,  82, 204]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
178         1      124       5       179
430         2      124       3       158
600         3      124       4        55
826         4      124       5         8
1098        5      124       4         7
       user_id  item_id  rating  timestep
12550       46      124       3       266
12607       47      124       5        50
12899       48      124       4        69
13176       49      124       3        73
13398       50      124       5        22
average_rating for this rec across 50 users from same group (less noisy) was: 4.44
all_actions shape just before sample torch.Size([1, 10, 1])
action scaled by temperature: tensor([[247]], device='cuda:0')
action picked by argmax: tensor([247], device='cuda:0')
tensor([[247, 123, 240, 258,  98, 167, 200, 135,   0,  82]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
182         1      248       4       183
295         2      248       5        23
739         3      248       5       194
853         4      248       4        35
1345        5      248       4       254
       user_id  item_id  rating  timestep
12548       46      248       5       264
12573       47      248       5        16
12837       48      248       4         7
13252       49      248       4       149
13495       50      248       5       119
average_rating for this rec across 50 users from same group (less noisy) was: 4.46
all_actions shape just before sample torch.Size([1, 11, 1])
action scaled by temperature: tensor([[167]], device='cuda:0')
action picked by argmax: tensor([167], device='cuda:0')
tensor([[167,  82,  78,  74,  31,   5, 252, 261, 123, 145]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
38          1      168       5        39
418         2      168       3       146
699         3      168       4       154
928         4      168       5       110
1133        5      168       5        42
       user_id  item_id  rating  timestep
12493       46      168       3       209
12781       47      168       4       224
12921       48      168       3        91
13219       49      168       5       116
13564       50      168       4       188
average_rating for this rec across 50 users from same group (less noisy) was: 4.08
all_actions shape just before sample torch.Size([1, 12, 1])
action scaled by temperature: tensor([[261]], device='cuda:0')
action picked by argmax: tensor([261], device='cuda:0')
tensor([[261, 145,  77,  31, 123,  12, 269,  61, 270, 221]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
188         1      262       5       189
292         2      262       4        20
676         3      262       3       131
914         4      262       3        96
1194        5      262       3       103
       user_id  item_id  rating  timestep
12551       46      262       5       267
12620       47      262       5        63
12953       48      262       5       123
13350       49      262       4       247
13419       50      262       4        43
average_rating for this rec across 50 users from same group (less noisy) was: 4.0
all_actions shape just before sample torch.Size([1, 13, 1])
action scaled by temperature: tensor([[34]], device='cuda:0')
action picked by argmax: tensor([34], device='cuda:0')
tensor([[ 34,  77,  70,  10,  51, 111,  89,  52,  26, 268]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
171         1       35       3       172
523         2       35       4       251
764         3       35       5       219
839         4       35       3        21
1224        5       35       4       133
       user_id  item_id  rating  timestep
12498       46       35       3       214
12701       47       35       4       144
13023       48       35       2       193
13159       49       35       4        56
13622       50       35       4       246
average_rating for this rec across 50 users from same group (less noisy) was: 4.04
all_actions shape just before sample torch.Size([1, 14, 1])
action scaled by temperature: tensor([[77]], device='cuda:0')
action picked by argmax: tensor([77], device='cuda:0')
tensor([[ 77,  34,  89,  46, 270, 120, 124,  51, 112,  63]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
252         1       78       5       253
311         2       78       4        39
630         3       78       3        85
1085        4       78       4       267
1321        5       78       4       230
       user_id  item_id  rating  timestep
12290       46       78       3         6
12727       47       78       3       170
12855       48       78       4        25
13256       49       78       4       153
13543       50       78       3       167
average_rating for this rec across 50 users from same group (less noisy) was: 3.74
all_actions shape just before sample torch.Size([1, 15, 1])
action scaled by temperature: tensor([[46]], device='cuda:0')
action picked by argmax: tensor([46], device='cuda:0')
tensor([[ 46, 112, 107, 266, 127,  36, 125, 194, 230,   4]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
135         1       47       5       136
350         2       47       5        78
801         3       47       5       256
905         4       47       4        87
1275        5       47       5       184
       user_id  item_id  rating  timestep
12291       46       47       5         7
12594       47       47       4        37
13013       48       47       5       183
13248       49       47       5       145
13569       50       47       5       193
average_rating for this rec across 50 users from same group (less noisy) was: 4.42
all_actions shape just before sample torch.Size([1, 16, 1])
action scaled by temperature: tensor([[264]], device='cuda:0')
action picked by argmax: tensor([264], device='cuda:0')
tensor([[264, 112, 211,   1, 165,  24,  68,  31,  17,  62]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
44          1      265       4        45
487         2      265       5       215
787         3      265       5       242
1078        4      265       3       260
1314        5      265       5       223
       user_id  item_id  rating  timestep
12475       46      265       3       191
12666       47      265       3       109
12847       48      265       4        17
13201       49      265       4        98
13560       50      265       5       184
average_rating for this rec across 50 users from same group (less noisy) was: 3.64
all_actions shape just before sample torch.Size([1, 17, 1])
action scaled by temperature: tensor([[96]], device='cuda:0')
action picked by argmax: tensor([96], device='cuda:0')
tensor([[ 96, 257, 193, 185,  31, 176,  40, 112, 205, 250]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
46          1       97       5        47
363         2       97       4        91
656         3       97       5       111
1059        4       97       4       241
1138        5       97       5        47
       user_id  item_id  rating  timestep
12431       46       97       5       147
12715       47       97       5       158
12880       48       97       5        50
13198       49       97       5        95
13414       50       97       4        38
average_rating for this rec across 50 users from same group (less noisy) was: 4.5
all_actions shape just before sample torch.Size([1, 18, 1])
action scaled by temperature: tensor([[12]], device='cuda:0')
action picked by argmax: tensor([12], device='cuda:0')
tensor([[ 12, 111,   8,  33, 194, 259, 130,  32, 257, 178]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
192         1       13       4       193
315         2       13       5        43
733         3       13       3       188
1066        4       13       5       248
1346        5       13       5       255
       user_id  item_id  rating  timestep
12377       46       13       4        93
12821       47       13       4       264
12916       48       13       5        86
13235       49       13       5       132
13449       50       13       4        73
average_rating for this rec across 50 users from same group (less noisy) was: 4.54
all_actions shape just before sample torch.Size([1, 19, 1])
action scaled by temperature: tensor([[178]], device='cuda:0')
action picked by argmax: tensor([178], device='cuda:0')
tensor([[178,  12, 255, 224, 130, 106, 111, 187, 117, 161]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
176         1      179       4       177
372         2      179       5       100
551         3      179       5         6
821         4      179       4         3
1183        5      179       4        92
       user_id  item_id  rating  timestep
12511       46      179       4       227
12697       47      179       5       140
12871       48      179       5        41
13208       49      179       5       105
13632       50      179       4       256
average_rating for this rec across 50 users from same group (less noisy) was: 4.48
all_actions shape just before sample torch.Size([1, 20, 1])
action scaled by temperature: tensor([[111]], device='cuda:0')
action picked by argmax: tensor([111], device='cuda:0')
tensor([[111, 255,  27, 158,  33, 142,  32, 134,  12, 224]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
271         1      112       4       272
479         2      112       5       207
553         3      112       5         8
1041        4      112       5       223
1094        5      112       5         3
       user_id  item_id  rating  timestep
12382       46      112       5        98
12566       47      112       5         9
12954       48      112       4       124
13319       49      112       4       216
13388       50      112       5        12
average_rating for this rec across 50 users from same group (less noisy) was: 4.7
all_actions shape just before sample torch.Size([1, 21, 1])
action scaled by temperature: tensor([[255]], device='cuda:0')
action picked by argmax: tensor([255], device='cuda:0')
tensor([[255, 117, 187, 155, 111, 253, 256,  37, 264,  58]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
85          1      256       2        86
409         2      256       4       137
693         3      256       4       148
889         4      256       5        71
1191        5      256       5       100
       user_id  item_id  rating  timestep
12509       46      256       4       225
12728       47      256       4       171
12993       48      256       5       163
13128       49      256       5        25
13480       50      256       4       104
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 22, 1])
action scaled by temperature: tensor([[117]], device='cuda:0')
action picked by argmax: tensor([117], device='cuda:0')
tensor([[117, 255,  68,  98,  39, 178, 139, 135, 164, 148]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
70          1      118       4        71
404         2      118       4       132
643         3      118       5        98
1000        4      118       5       182
1302        5      118       4       211
       user_id  item_id  rating  timestep
12489       46      118       4       205
12576       47      118       4        19
12923       48      118       4        93
13374       49      118       3       271
13566       50      118       4       190
average_rating for this rec across 50 users from same group (less noisy) was: 4.3
all_actions shape just before sample torch.Size([1, 23, 1])
action scaled by temperature: tensor([[39]], device='cuda:0')
action picked by argmax: tensor([39], device='cuda:0')
tensor([[ 39, 135, 178, 130,  67, 100, 187, 179, 164, 180]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
101         1       40       5       102
275         2       40       5         3
550         3       40       4         5
1065        4       40       5       247
1189        5       40       5        98
       user_id  item_id  rating  timestep
12542       46       40       5       258
12805       47       40       5       248
12866       48       40       5        36
13122       49       40       5        19
13587       50       40       4       211
average_rating for this rec across 50 users from same group (less noisy) was: 4.68
all_actions shape just before sample torch.Size([1, 24, 1])
action scaled by temperature: tensor([[101]], device='cuda:0')
action picked by argmax: tensor([101], device='cuda:0')
tensor([[101, 249,  79, 154,  47, 159, 257, 218,  57, 235]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
103         1      102       4       104
377         2      102       4       105
581         3      102       3        36
1082        4      102       5       264
1107        5      102       4        16
       user_id  item_id  rating  timestep
12374       46      102       5        90
12638       47      102       5        81
12875       48      102       5        45
13115       49      102       5        12
13571       50      102       4       195
average_rating for this rec across 50 users from same group (less noisy) was: 4.1
all_actions shape just before sample torch.Size([1, 25, 1])
action scaled by temperature: tensor([[154]], device='cuda:0')
action picked by argmax: tensor([154], device='cuda:0')
tensor([[154,  55, 228, 223, 267, 206, 123, 253, 121, 229]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
249         1      155       5       250
345         2      155       2        73
697         3      155       4       152
819         4      155       4         1
1100        5      155       3         9
       user_id  item_id  rating  timestep
12437       46      155       2       153
12774       47      155       4       217
13033       48      155       3       203
13343       49      155       4       240
13482       50      155       3       106
average_rating for this rec across 50 users from same group (less noisy) was: 3.44
all_actions shape just before sample torch.Size([1, 26, 1])
action scaled by temperature: tensor([[235]], device='cuda:0')
action picked by argmax: tensor([235], device='cuda:0')
tensor([[235, 257, 223, 101, 253,  63, 134, 206, 250, 208]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
57          1      236       5        58
392         2      236       4       120
770         3      236       4       225
825         4      236       5         7
1151        5      236       4        60
       user_id  item_id  rating  timestep
12321       46      236       3        37
12669       47      236       5       112
12940       48      236       3       110
13113       49      236       4        10
13638       50      236       3       262
average_rating for this rec across 50 users from same group (less noisy) was: 4.26
all_actions shape just before sample torch.Size([1, 27, 1])
action scaled by temperature: tensor([[223]], device='cuda:0')
action picked by argmax: tensor([223], device='cuda:0')
tensor([[223, 249, 106, 264,  47, 207, 248,  90, 163,  67]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
194         1      224       4       195
511         2      224       4       239
726         3      224       5       181
861         4      224       4        43
1145        5      224       5        54
       user_id  item_id  rating  timestep
12371       46      224       5        87
12578       47      224       5        21
12946       48      224       4       116
13334       49      224       5       231
13417       50      224       4        41
average_rating for this rec across 50 users from same group (less noisy) was: 4.4
all_actions shape just before sample torch.Size([1, 28, 1])
action scaled by temperature: tensor([[207]], device='cuda:0')
action picked by argmax: tensor([207], device='cuda:0')
tensor([[207, 169,  69,   8, 241, 125, 179, 186, 245,  79]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
61          1      208       5        62
364         2      208       3        92
745         3      208       3       200
1074        4      208       5       256
1278        5      208       3       187
       user_id  item_id  rating  timestep
12429       46      208       5       145
12753       47      208       5       196
12912       48      208       5        82
13308       49      208       1       205
13400       50      208       4        24
average_rating for this rec across 50 users from same group (less noisy) was: 4.04
all_actions shape just before sample torch.Size([1, 29, 1])
action scaled by temperature: tensor([[169]], device='cuda:0')
action picked by argmax: tensor([169], device='cuda:0')
tensor([[169, 186,  69, 207, 237, 206, 159, 194,  54, 193]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
126         1      170       5       127
429         2      170       5       157
722         3      170       4       177
983         4      170       5       165
1126        5      170       4        35
       user_id  item_id  rating  timestep
12490       46      170       4       206
12602       47      170       4        45
13027       48      170       5       197
13304       49      170       5       201
13599       50      170       5       223
average_rating for this rec across 50 users from same group (less noisy) was: 4.54
all_actions shape just before sample torch.Size([1, 30, 1])
action scaled by temperature: tensor([[125]], device='cuda:0')
action picked by argmax: tensor([125], device='cuda:0')
tensor([[125,  73,  18,  67,  80, 258, 175,  51, 169, 198]], device='cuda:0')
Just recommended 30 new items to 50 users from group 1 and the total rating was 126.64000000000003
train_loss is: 0.7435204574506576
action scaled by temperature: tensor([[197]], device='cuda:0')
action picked by argmax: tensor([180], device='cuda:0')
tensor([[180, 157, 187, 268, 265, 215,  76, 113, 250,  44]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
73          1      181       5        74
326         2      181       4        54
708         3      181       5       163
934         4      181       4       116
1231        5      181       5       140
       user_id  item_id  rating  timestep
12317       46      181       4        33
12688       47      181       5       131
13048       48      181       5       218
13131       49      181       5        28
13517       50      181       5       141
average_rating for this rec across 50 users from same group (less noisy) was: 4.68
all_actions shape just before sample torch.Size([1, 1, 1])
action scaled by temperature: tensor([[265]], device='cuda:0')
action picked by argmax: tensor([59], device='cuda:0')
tensor([[ 59,  24, 115, 125, 235, 103, 147,  36, 173,  42]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
58          1       60       5        59
460         2       60       4       188
689         3       60       4       144
1018        4       60       4       200
1262        5       60       4       171
       user_id  item_id  rating  timestep
12461       46       60       3       177
12587       47       60       3        30
12868       48       60       2        38
13178       49       60       5        75
13649       50       60       3       273
average_rating for this rec across 50 users from same group (less noisy) was: 3.82
all_actions shape just before sample torch.Size([1, 2, 1])
action scaled by temperature: tensor([[8]], device='cuda:0')
action picked by argmax: tensor([8], device='cuda:0')
tensor([[  8, 255,  12, 214, 175, 244, 227, 233, 172, 253]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
268         1        9       4       269
360         2        9       4        88
573         3        9       4        28
894         4        9       4        76
1213        5        9       4       122
       user_id  item_id  rating  timestep
12358       46        9       4        74
12680       47        9       3       123
12845       48        9       3        15
13300       49        9       4       197
13584       50        9       4       208
average_rating for this rec across 50 users from same group (less noisy) was: 3.72
all_actions shape just before sample torch.Size([1, 3, 1])
action scaled by temperature: tensor([[145]], device='cuda:0')
action picked by argmax: tensor([139], device='cuda:0')
tensor([[139,  16, 145, 109,  12, 214, 119, 173, 175, 233]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
175         1      140       4       176
290         2      140       4        18
659         3      140       3       114
1005        4      140       4       187
1179        5      140       5        88
       user_id  item_id  rating  timestep
12482       46      140       3       198
12778       47      140       4       221
13043       48      140       5       213
13285       49      140       4       182
13604       50      140       5       228
average_rating for this rec across 50 users from same group (less noisy) was: 4.16
all_actions shape just before sample torch.Size([1, 4, 1])
action scaled by temperature: tensor([[109]], device='cuda:0')
action picked by argmax: tensor([112], device='cuda:0')
tensor([[112, 133, 154,  76, 268, 109, 251, 110,  92,  52]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
229         1      113       5       230
305         2      113       3        33
611         3      113       3        66
1032        4      113       5       214
1356        5      113       4       265
       user_id  item_id  rating  timestep
12513       46      113       5       229
12828       47      113       3       271
12843       48      113       1        13
13169       49      113       4        66
13472       50      113       4        96
average_rating for this rec across 50 users from same group (less noisy) was: 3.62
all_actions shape just before sample torch.Size([1, 5, 1])
action scaled by temperature: tensor([[135]], device='cuda:0')
action picked by argmax: tensor([225], device='cuda:0')
tensor([[225, 255, 187,  62,  99,   7, 218,  80,  75, 135]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
77          1      226       4        78
291         2      226       4        19
632         3      226       4        87
918         4      226       4       100
1222        5      226       4       131
       user_id  item_id  rating  timestep
12432       46      226       4       148
12672       47      226       5       115
12834       48      226       5         4
13255       49      226       5       152
13415       50      226       4        39
average_rating for this rec across 50 users from same group (less noisy) was: 4.46
all_actions shape just before sample torch.Size([1, 6, 1])
action scaled by temperature: tensor([[239]], device='cuda:0')
action picked by argmax: tensor([239], device='cuda:0')
tensor([[239, 217, 255,  37,   2, 149, 114,   7,  71, 154]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
187         1      240       4       188
438         2      240       2       166
711         3      240       4       166
911         4      240       3        93
1162        5      240       5        71
       user_id  item_id  rating  timestep
12384       46      240       4       100
12819       47      240       3       262
12972       48      240       4       142
13230       49      240       4       127
13454       50      240       2        78
average_rating for this rec across 50 users from same group (less noisy) was: 3.72
all_actions shape just before sample torch.Size([1, 7, 1])
action scaled by temperature: tensor([[224]], device='cuda:0')
action picked by argmax: tensor([224], device='cuda:0')
tensor([[224,  95,  19, 157,  87, 153,  41,  27,  37, 126]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
69          1      225       5        70
355         2      225       4        83
723         3      225       4       178
827         4      225       5         9
1291        5      225       4       200
       user_id  item_id  rating  timestep
12318       46      225       5        34
12629       47      225       4        72
13075       48      225       5       245
13306       49      225       4       203
13477       50      225       4       101
average_rating for this rec across 50 users from same group (less noisy) was: 4.52
all_actions shape just before sample torch.Size([1, 8, 1])
action scaled by temperature: tensor([[138]], device='cuda:0')
action picked by argmax: tensor([138], device='cuda:0')
tensor([[138,  35, 256,   1, 250, 259,  20, 230,  54, 235]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
224         1      139       3       225
317         2      139       4        45
767         3      139       4       222
1084        4      139       4       266
1305        5      139       5       214
       user_id  item_id  rating  timestep
12333       46      139       3        49
12662       47      139       2       105
12900       48      139       3        70
13303       49      139       5       200
13591       50      139       4       215
average_rating for this rec across 50 users from same group (less noisy) was: 4.02
all_actions shape just before sample torch.Size([1, 9, 1])
action scaled by temperature: tensor([[158]], device='cuda:0')
action picked by argmax: tensor([158], device='cuda:0')
tensor([[158,  31, 133,  36, 214, 199,  29, 106, 138, 259]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
129         1      159       3       130
480         2      159       3       208
579         3      159       3        34
1057        4      159       3       239
1270        5      159       2       179
       user_id  item_id  rating  timestep
12525       46      159       5       241
12736       47      159       4       179
12973       48      159       5       143
13326       49      159       4       223
13490       50      159       4       114
average_rating for this rec across 50 users from same group (less noisy) was: 3.6
all_actions shape just before sample torch.Size([1, 10, 1])
action scaled by temperature: tensor([[199]], device='cuda:0')
action picked by argmax: tensor([199], device='cuda:0')
tensor([[199, 150,  42, 216, 176, 257, 235, 222,  40,  57]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
78          1      200       3        79
285         2      200       3        13
644         3      200       4        99
855         4      200       4        37
1249        5      200       5       158
       user_id  item_id  rating  timestep
12286       46      200       5         2
12625       47      200       5        68
13016       48      200       4       186
13186       49      200       5        83
13509       50      200       4       133
average_rating for this rec across 50 users from same group (less noisy) was: 4.04
all_actions shape just before sample torch.Size([1, 11, 1])
action scaled by temperature: tensor([[31]], device='cuda:0')
action picked by argmax: tensor([31], device='cuda:0')
tensor([[ 31,  83,  99, 122,  37,  82,  56, 214, 157, 256]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
207         1       32       4       208
505         2       32       4       233
813         3       32       5       268
833         4       32       5        15
1309        5       32       4       218
       user_id  item_id  rating  timestep
12338       46       32       3        54
12783       47       32       3       226
12917       48       32       5        87
13318       49       32       4       215
13390       50       32       3        14
average_rating for this rec across 50 users from same group (less noisy) was: 4.1
all_actions shape just before sample torch.Size([1, 12, 1])
action scaled by temperature: tensor([[214]], device='cuda:0')
action picked by argmax: tensor([214], device='cuda:0')
tensor([[214, 259, 238, 133, 158, 118,  36,  39, 201,  21]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
51          1      215       4        52
503         2      215       4       231
773         3      215       5       228
1002        4      215       4       184
1312        5      215       5       221
       user_id  item_id  rating  timestep
12436       46      215       3       152
12637       47      215       4        80
12844       48      215       4        14
13199       49      215       4        96
13475       50      215       4        99
average_rating for this rec across 50 users from same group (less noisy) was: 4.08
all_actions shape just before sample torch.Size([1, 13, 1])
action scaled by temperature: tensor([[259]], device='cuda:0')
action picked by argmax: tensor([259], device='cuda:0')
tensor([[259,  76,  48,  63, 219,  54, 158, 226,  29,  52]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
241         1      260       5       242
427         2      260       5       155
709         3      260       5       164
906         4      260       3        88
1149        5      260       5        58
       user_id  item_id  rating  timestep
12293       46      260       3         9
12601       47      260       5        44
12960       48      260       4       130
13175       49      260       5        72
13511       50      260       4       135
average_rating for this rec across 50 users from same group (less noisy) was: 4.16
all_actions shape just before sample torch.Size([1, 14, 1])
action scaled by temperature: tensor([[76]], device='cuda:0')
action picked by argmax: tensor([76], device='cuda:0')
tensor([[ 76, 214, 118,  43, 209,  35, 259,  90, 212,   7]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
243         1       77       5       244
432         2       77       5       160
743         3       77       5       198
835         4       77       4        17
1233        5       77       4       142
       user_id  item_id  rating  timestep
12393       46       77       3       109
12719       47       77       4       162
13098       48       77       5       268
13143       49       77       4        40
13500       50       77       3       124
average_rating for this rec across 50 users from same group (less noisy) was: 3.96
all_actions shape just before sample torch.Size([1, 15, 1])
action scaled by temperature: tensor([[167]], device='cuda:0')
action picked by argmax: tensor([167], device='cuda:0')
tensor([[167, 117, 214,  78, 224,  12, 161,  44, 259,   8]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
38          1      168       5        39
418         2      168       3       146
699         3      168       4       154
928         4      168       5       110
1133        5      168       5        42
       user_id  item_id  rating  timestep
12493       46      168       3       209
12781       47      168       4       224
12921       48      168       3        91
13219       49      168       5       116
13564       50      168       4       188
average_rating for this rec across 50 users from same group (less noisy) was: 4.08
all_actions shape just before sample torch.Size([1, 16, 1])
action scaled by temperature: tensor([[12]], device='cuda:0')
action picked by argmax: tensor([12], device='cuda:0')
tensor([[ 12, 161, 214, 123,  31, 170, 230, 245, 269,  92]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
192         1       13       4       193
315         2       13       5        43
733         3       13       3       188
1066        4       13       5       248
1346        5       13       5       255
       user_id  item_id  rating  timestep
12377       46       13       4        93
12821       47       13       4       264
12916       48       13       5        86
13235       49       13       5       132
13449       50       13       4        73
average_rating for this rec across 50 users from same group (less noisy) was: 4.54
all_actions shape just before sample torch.Size([1, 17, 1])
action scaled by temperature: tensor([[32]], device='cuda:0')
action picked by argmax: tensor([32], device='cuda:0')
tensor([[ 32, 185,   8,  12,  83, 124, 203, 269, 111,  52]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
117         1       33       3       118
463         2       33       2       191
738         3       33       2       193
837         4       33       5        19
1267        5       33       3       176
       user_id  item_id  rating  timestep
12454       46       33       4       170
12590       47       33       4        33
12848       48       33       4        18
13360       49       33       4       257
13418       50       33       5        42
average_rating for this rec across 50 users from same group (less noisy) was: 3.6
all_actions shape just before sample torch.Size([1, 18, 1])
action scaled by temperature: tensor([[66]], device='cuda:0')
action picked by argmax: tensor([66], device='cuda:0')
tensor([[ 66, 165,   8, 269, 234, 111, 203, 134,  12, 251]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
158         1       67       4       159
457         2       67       4       185
650         3       67       4       105
1076        4       67       5       258
1322        5       67       5       231
       user_id  item_id  rating  timestep
12304       46       67       5        20
12644       47       67       3        87
12846       48       67       5        16
13233       49       67       4       130
13407       50       67       3        31
average_rating for this rec across 50 users from same group (less noisy) was: 3.94
all_actions shape just before sample torch.Size([1, 19, 1])
action scaled by temperature: tensor([[163]], device='cuda:0')
action picked by argmax: tensor([163], device='cuda:0')
tensor([[163, 264, 107,  37, 165,  53, 189,  79, 200,  56]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
33          1      164       4        34
378         2      164       3       106
701         3      164       5       156
893         4      164       4        75
1338        5      164       4       247
       user_id  item_id  rating  timestep
12418       46      164       5       134
12718       47      164       4       161
13069       48      164       5       239
13265       49      164       4       162
13576       50      164       4       200
average_rating for this rec across 50 users from same group (less noisy) was: 4.46
all_actions shape just before sample torch.Size([1, 20, 1])
action scaled by temperature: tensor([[233]], device='cuda:0')
action picked by argmax: tensor([233], device='cuda:0')
tensor([[233,  84,  10,  82,   4, 209, 210, 154, 255,  52]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
39          1      234       4        40
543         2      234       4       271
707         3      234       4       162
1083        4      234       2       265
1364        5      234       4       273
       user_id  item_id  rating  timestep
12363       46      234       3        79
12812       47      234       5       255
12943       48      234       3       113
13126       49      234       5        23
13420       50      234       4        44
average_rating for this rec across 50 users from same group (less noisy) was: 4.0
all_actions shape just before sample torch.Size([1, 21, 1])
action scaled by temperature: tensor([[82]], device='cuda:0')
action picked by argmax: tensor([82], device='cuda:0')
tensor([[ 82, 162, 209, 262, 137, 233, 263,  84,   4, 194]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
23          1       83       4        24
368         2       83       5        96
712         3       83       5       167
1081        4       83       3       263
1124        5       83       5        33
       user_id  item_id  rating  timestep
12536       46       83       4       252
12603       47       83       4        46
12913       48       83       3        83
13185       49       83       4        82
13548       50       83       5       172
average_rating for this rec across 50 users from same group (less noisy) was: 4.28
all_actions shape just before sample torch.Size([1, 22, 1])
action scaled by temperature: tensor([[127]], device='cuda:0')
action picked by argmax: tensor([127], device='cuda:0')
tensor([[127, 196, 241,  54, 223, 243,   7, 181,  84, 171]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
261         1      128       4       262
297         2      128       5        25
682         3      128       4       137
869         4      128       3        51
1358        5      128       4       267
       user_id  item_id  rating  timestep
12541       46      128       4       257
12674       47      128       3       117
12840       48      128       4        10
13344       49      128       5       241
13619       50      128       4       243
average_rating for this rec across 50 users from same group (less noisy) was: 4.08
all_actions shape just before sample torch.Size([1, 23, 1])
action scaled by temperature: tensor([[45]], device='cuda:0')
action picked by argmax: tensor([45], device='cuda:0')
tensor([[ 45, 226, 257,  74,  91,  75, 203, 171, 127, 179]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
139         1       46       5       140
296         2       46       5        24
714         3       46       5       169
973         4       46       3       155
1219        5       46       5       128
       user_id  item_id  rating  timestep
12425       46       46       5       141
12651       47       46       5        94
12862       48       46       4        32
13247       49       46       4       144
13537       50       46       3       161
average_rating for this rec across 50 users from same group (less noisy) was: 4.14
all_actions shape just before sample torch.Size([1, 24, 1])
action scaled by temperature: tensor([[179]], device='cuda:0')
action picked by argmax: tensor([179], device='cuda:0')
tensor([[179, 176, 174, 171, 203,  10,  45,   8,  91, 178]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
13          1      180       4        14
477         2      180       5       205
563         3      180       3        18
965         4      180       5       147
1218        5      180       5       127
       user_id  item_id  rating  timestep
12516       46      180       4       232
12671       47      180       5       114
12860       48      180       5        30
13363       49      180       5       260
13433       50      180       5        57
average_rating for this rec across 50 users from same group (less noisy) was: 4.58
all_actions shape just before sample torch.Size([1, 25, 1])
action scaled by temperature: tensor([[74]], device='cuda:0')
action picked by argmax: tensor([74], device='cuda:0')
tensor([[ 74, 241,  91,  10, 148, 143,  54, 194, 169, 132]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
195         1       75       5       196
284         2       75       5        12
737         3       75       5       192
1026        4       75       4       208
1111        5       75       3        20
       user_id  item_id  rating  timestep
12410       46       75       5       126
12652       47       75       3        95
12974       48       75       3       144
13348       49       75       2       245
13573       50       75       4       197
average_rating for this rec across 50 users from same group (less noisy) was: 3.6
all_actions shape just before sample torch.Size([1, 26, 1])
action scaled by temperature: tensor([[99]], device='cuda:0')
action picked by argmax: tensor([99], device='cuda:0')
tensor([[ 99,  44, 218,  53,  62, 194, 210, 234, 173, 101]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
181         1      100       5       182
298         2      100       4        26
779         3      100       5       234
902         4      100       5        84
1101        5      100       5        10
       user_id  item_id  rating  timestep
12367       46      100       5        83
12682       47      100       5       125
13064       48      100       5       234
13324       49      100       5       221
13421       50      100       4        45
average_rating for this rec across 50 users from same group (less noisy) was: 4.78
all_actions shape just before sample torch.Size([1, 27, 1])
action scaled by temperature: tensor([[44]], device='cuda:0')
action picked by argmax: tensor([44], device='cuda:0')
tensor([[ 44, 241,  54,  17, 101, 194, 218, 206, 226, 158]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
223         1       45       4       224
337         2       45       4        65
608         3       45       3        63
931         4       45       3       113
1241        5       45       4       150
       user_id  item_id  rating  timestep
12328       46       45       4        44
12737       47       45       4       180
13058       48       45       3       228
13244       49       45       4       141
13631       50       45       3       255
average_rating for this rec across 50 users from same group (less noisy) was: 3.84
all_actions shape just before sample torch.Size([1, 28, 1])
action scaled by temperature: tensor([[53]], device='cuda:0')
action picked by argmax: tensor([53], device='cuda:0')
tensor([[ 53, 189, 161,  15, 182, 177, 122, 146, 249, 219]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
235         1       54       5       236
536         2       54       4       264
645         3       54       5       100
1050        4       54       4       232
1197        5       54       4       106
       user_id  item_id  rating  timestep
12353       46       54       5        69
12559       47       54       4         2
12978       48       54       4       148
13283       49       54       3       180
13424       50       54       3        48
average_rating for this rec across 50 users from same group (less noisy) was: 3.88
all_actions shape just before sample torch.Size([1, 29, 1])
action scaled by temperature: tensor([[24]], device='cuda:0')
action picked by argmax: tensor([24], device='cuda:0')
tensor([[ 24,  49, 150,  55, 152, 147, 204, 157, 271, 259]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
50          1       25       5        51
277         2       25       4         5
749         3       25       4       204
1042        4       25       5       224
1232        5       25       5       141
       user_id  item_id  rating  timestep
12295       46       25       5        11
12795       47       25       4       238
13004       48       25       5       174
13315       49       25       4       212
13403       50       25       4        27
average_rating for this rec across 50 users from same group (less noisy) was: 4.68
all_actions shape just before sample torch.Size([1, 30, 1])
action scaled by temperature: tensor([[204]], device='cuda:0')
action picked by argmax: tensor([204], device='cuda:0')
tensor([[204,  49, 164, 240,  58, 246, 264, 150,  30,  24]], device='cuda:0')
Just recommended 30 new items to 50 users from group 1 and the total rating was 123.13999999999999
train_loss is: 0.6232675256794447
action scaled by temperature: tensor([[179]], device='cuda:0')
action picked by argmax: tensor([237], device='cuda:0')
tensor([[237, 268,  37,  76,  30, 223, 246,   9,  28, 265]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
228         1      238       4       229
475         2      238       3       203
719         3      238       3       174
860         4      238       5        42
1166        5      238       5        75
       user_id  item_id  rating  timestep
12462       46      238       3       178
12618       47      238       4        61
13000       48      238       5       170
13192       49      238       3        89
13431       50      238       5        55
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 1, 1])
action scaled by temperature: tensor([[185]], device='cuda:0')
action picked by argmax: tensor([233], device='cuda:0')
tensor([[233, 190, 109, 151, 224,  51,   0, 266,  78, 228]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
39          1      234       4        40
543         2      234       4       271
707         3      234       4       162
1083        4      234       2       265
1364        5      234       4       273
       user_id  item_id  rating  timestep
12363       46      234       3        79
12812       47      234       5       255
12943       48      234       3       113
13126       49      234       5        23
13420       50      234       4        44
average_rating for this rec across 50 users from same group (less noisy) was: 4.0
all_actions shape just before sample torch.Size([1, 2, 1])
action scaled by temperature: tensor([[171]], device='cuda:0')
action picked by argmax: tensor([245], device='cuda:0')
tensor([[245, 224, 194, 113, 117, 211,   6, 108,  60, 167]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
231         1      246       4       232
332         2      246       5        60
766         3      246       4       221
974         4      246       5       156
1225        5      246       5       134
       user_id  item_id  rating  timestep
12413       46      246       4       129
12561       47      246       4         4
12838       48      246       3         8
13332       49      246       4       229
13554       50      246       4       178
average_rating for this rec across 50 users from same group (less noisy) was: 4.3
all_actions shape just before sample torch.Size([1, 3, 1])
action scaled by temperature: tensor([[254]], device='cuda:0')
action picked by argmax: tensor([254], device='cuda:0')
tensor([[254,  94, 213, 100,  55, 167,  15, 193, 252,  49]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
153         1      255       5       154
544         2      255       5       272
618         3      255       4        73
989         4      255       5       171
1214        5      255       4       123
       user_id  item_id  rating  timestep
12365       46      255       5        81
12724       47      255       4       167
12933       48      255       4       103
13227       49      255       3       124
13601       50      255       3       225
average_rating for this rec across 50 users from same group (less noisy) was: 4.5
all_actions shape just before sample torch.Size([1, 4, 1])
action scaled by temperature: tensor([[170]], device='cuda:0')
action picked by argmax: tensor([170], device='cuda:0')
tensor([[170,  66, 243, 155,   3,  40,  24, 256,  71, 107]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
80          1      171       5        81
348         2      171       4        76
556         3      171       3        11
1027        4      171       3       209
1299        5      171       5       208
       user_id  item_id  rating  timestep
12477       46      171       3       193
12826       47      171       4       269
12852       48      171       5        22
13357       49      171       5       254
13476       50      171       4       100
average_rating for this rec across 50 users from same group (less noisy) was: 3.96
all_actions shape just before sample torch.Size([1, 5, 1])
action scaled by temperature: tensor([[137]], device='cuda:0')
action picked by argmax: tensor([137], device='cuda:0')
tensor([[137,  40, 239, 168,   0,  21, 268,  66, 235, 135]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
197         1      138       4       198
542         2      138       4       270
636         3      138       5        91
926         4      138       4       108
1195        5      138       5       104
       user_id  item_id  rating  timestep
12538       46      138       4       254
12596       47      138       4        39
13053       48      138       4       223
13354       49      138       5       251
13519       50      138       5       143
average_rating for this rec across 50 users from same group (less noisy) was: 4.36
all_actions shape just before sample torch.Size([1, 6, 1])
action scaled by temperature: tensor([[272]], device='cuda:0')
action picked by argmax: tensor([272], device='cuda:0')
tensor([[272, 180,  40, 243,  19, 240, 267,  74, 103,  25]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
232         1      273       5       233
334         2      273       5        62
694         3      273       4       149
994         4      273       5       176
1131        5      273       5        40
       user_id  item_id  rating  timestep
12539       46      273       4       255
12788       47      273       5       231
12951       48      273       5       121
13264       49      273       5       161
13408       50      273       5        32
average_rating for this rec across 50 users from same group (less noisy) was: 4.5
all_actions shape just before sample torch.Size([1, 7, 1])
action scaled by temperature: tensor([[11]], device='cuda:0')
action picked by argmax: tensor([11], device='cuda:0')
tensor([[ 11,  90, 227, 169, 258, 244, 198, 237,  45, 142]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
28          1       12       4        29
466         2       12       3       194
765         3       12       5       220
845         4       12       5        27
1207        5       12       3       116
       user_id  item_id  rating  timestep
12471       46       12       4       187
12693       47       12       5       136
12980       48       12       4       150
13184       49       12       3        81
13608       50       12       4       232
average_rating for this rec across 50 users from same group (less noisy) was: 3.7
all_actions shape just before sample torch.Size([1, 8, 1])
action scaled by temperature: tensor([[92]], device='cuda:0')
action picked by argmax: tensor([92], device='cuda:0')
tensor([[ 92, 177, 138, 144, 171, 187, 119,  58,   9,  84]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
240         1       93       5       241
512         2       93       5       240
614         3       93       4        69
881         4       93       5        63
1326        5       93       5       235
       user_id  item_id  rating  timestep
12349       46       93       5        65
12787       47       93       5       230
12886       48       93       5        56
13259       49       93       5       156
13386       50       93       4        10
average_rating for this rec across 50 users from same group (less noisy) was: 4.58
all_actions shape just before sample torch.Size([1, 9, 1])
action scaled by temperature: tensor([[171]], device='cuda:0')
action picked by argmax: tensor([171], device='cuda:0')
tensor([[171, 177,  92, 205, 223, 160,  79, 136, 218,  29]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
6           1      172       4         7
376         2      172       4       104
568         3      172       3        23
964         4      172       4       146
1252        5      172       4       161
       user_id  item_id  rating  timestep
12301       46      172       3        17
12572       47      172       4        15
13077       48      172       4       247
13163       49      172       4        60
13546       50      172       3       170
average_rating for this rec across 50 users from same group (less noisy) was: 4.08
all_actions shape just before sample torch.Size([1, 10, 1])
action scaled by temperature: tensor([[177]], device='cuda:0')
action picked by argmax: tensor([177], device='cuda:0')
tensor([[177, 171, 136, 160, 205, 213, 223, 153, 224, 209]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
12          1      178       4        13
535         2      178       4       263
717         3      178       5       172
1062        4      178       4       244
1150        5      178       4        59
       user_id  item_id  rating  timestep
12323       46      178       3        39
12760       47      178       5       203
12878       48      178       4        48
13355       49      178       5       252
13620       50      178       4       244
average_rating for this rec across 50 users from same group (less noisy) was: 4.22
all_actions shape just before sample torch.Size([1, 11, 1])
action scaled by temperature: tensor([[190]], device='cuda:0')
action picked by argmax: tensor([190], device='cuda:0')
tensor([[190, 142, 213, 171, 192,  69,  92,  65, 215, 216]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
128         1      191       5       129
357         2      191       4        85
609         3      191       4        64
862         4      191       5        44
1319        5      191       4       228
       user_id  item_id  rating  timestep
12515       46      191       5       231
12649       47      191       5        92
12915       48      191       4        85
13130       49      191       5        27
13506       50      191       5       130
average_rating for this rec across 50 users from same group (less noisy) was: 4.48
all_actions shape just before sample torch.Size([1, 12, 1])
action scaled by temperature: tensor([[192]], device='cuda:0')
action picked by argmax: tensor([192], device='cuda:0')
tensor([[192,  73, 243, 265, 216,  59, 151,  41, 190, 242]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
11          1      193       3        12
393         2      193       4       121
628         3      193       5        83
878         4      193       5        60
1325        5      193       4       234
       user_id  item_id  rating  timestep
12327       46      193       3        43
12762       47      193       3       205
12992       48      193       5       162
13129       49      193       5        26
13493       50      193       3       117
average_rating for this rec across 50 users from same group (less noisy) was: 4.14
all_actions shape just before sample torch.Size([1, 13, 1])
action scaled by temperature: tensor([[265]], device='cuda:0')
action picked by argmax: tensor([265], device='cuda:0')
tensor([[265, 160,  12, 216, 192, 122, 170, 200,  51, 208]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
81          1      266       3        82
342         2      266       3        70
793         3      266       4       248
901         4      266       3        83
1113        5      266       4        22
       user_id  item_id  rating  timestep
12394       46      266       5       110
12827       47      266       2       270
12927       48      266       5        97
13151       49      266       4        48
13393       50      266       5        17
average_rating for this rec across 50 users from same group (less noisy) was: 3.82
all_actions shape just before sample torch.Size([1, 14, 1])
action scaled by temperature: tensor([[216]], device='cuda:0')
action picked by argmax: tensor([216], device='cuda:0')
tensor([[216, 195,  33, 115, 185, 223, 190, 266, 122, 145]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
148         1      217       4       149
288         2      217       5        16
639         3      217       4        94
1073        4      217       3       255
1245        5      217       3       154
       user_id  item_id  rating  timestep
12456       46      217       4       172
12582       47      217       3        25
12937       48      217       4       107
13147       49      217       4        44
13432       50      217       4        56
average_rating for this rec across 50 users from same group (less noisy) was: 3.94
all_actions shape just before sample torch.Size([1, 15, 1])
action scaled by temperature: tensor([[266]], device='cuda:0')
action picked by argmax: tensor([266], device='cuda:0')
tensor([[266, 191,  33,  40, 150,   6, 207,  23, 228, 109]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
71          1      267       5        72
328         2      267       5        56
672         3      267       5       127
1022        4      267       5       204
1335        5      267       5       244
       user_id  item_id  rating  timestep
12387       46      267       5       103
12633       47      267       4        76
13003       48      267       5       173
13204       49      267       5       101
13626       50      267       5       250
average_rating for this rec across 50 users from same group (less noisy) was: 4.78
all_actions shape just before sample torch.Size([1, 16, 1])
action scaled by temperature: tensor([[244]], device='cuda:0')
action picked by argmax: tensor([244], device='cuda:0')
tensor([[244,  23,   8, 173, 205, 114, 121,  22, 252,  64]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
244         1      245       3       245
422         2      245       5       150
710         3      245       4       165
980         4      245       2       162
1313        5      245       4       222
       user_id  item_id  rating  timestep
12529       46      245       2       245
12723       47      245       3       166
12986       48      245       3       156
13133       49      245       4        30
13507       50      245       2       131
average_rating for this rec across 50 users from same group (less noisy) was: 3.48
all_actions shape just before sample torch.Size([1, 17, 1])
action scaled by temperature: tensor([[169]], device='cuda:0')
action picked by argmax: tensor([169], device='cuda:0')
tensor([[169,  79, 101, 237, 257, 175, 181, 264, 213,  54]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
126         1      170       5       127
429         2      170       5       157
722         3      170       4       177
983         4      170       5       165
1126        5      170       4        35
       user_id  item_id  rating  timestep
12490       46      170       4       206
12602       47      170       4        45
13027       48      170       5       197
13304       49      170       5       201
13599       50      170       5       223
average_rating for this rec across 50 users from same group (less noisy) was: 4.54
all_actions shape just before sample torch.Size([1, 18, 1])
action scaled by temperature: tensor([[197]], device='cuda:0')
action picked by argmax: tensor([197], device='cuda:0')
tensor([[197,  76, 128, 101,  69,  78,  83, 196,  56, 146]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
124         1      198       4       125
499         2      198       3       227
547         3      198       3         2
1072        4      198       3       254
1122        5      198       3        31
       user_id  item_id  rating  timestep
12427       46      198       4       143
12739       47      198       3       182
13054       48      198       4       224
13196       49      198       3        93
13607       50      198       5       231
average_rating for this rec across 50 users from same group (less noisy) was: 3.72
all_actions shape just before sample torch.Size([1, 19, 1])
action scaled by temperature: tensor([[146]], device='cuda:0')
action picked by argmax: tensor([146], device='cuda:0')
tensor([[146,   5, 263, 205, 161, 130,  39,  48, 139, 160]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
97          1      147       4        98
492         2      147       4       220
612         3      147       4        67
897         4      147       3        79
1350        5      147       5       259
       user_id  item_id  rating  timestep
12336       46      147       5        52
12647       47      147       4        90
12962       48      147       4       132
13367       49      147       4       264
13443       50      147       5        67
average_rating for this rec across 50 users from same group (less noisy) was: 4.24
all_actions shape just before sample torch.Size([1, 20, 1])
action scaled by temperature: tensor([[37]], device='cuda:0')
action picked by argmax: tensor([37], device='cuda:0')
tensor([[ 37,  22, 271, 130, 107, 209, 228, 177, 199,   8]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
118         1       38       3       119
455         2       38       2       183
757         3       38       5       212
856         4       38       4        38
1253        5       38       5       162
       user_id  item_id  rating  timestep
12320       46       38       2        36
12622       47       38       3        65
13068       48       38       3       238
13336       49       38       3       233
13466       50       38       5        90
average_rating for this rec across 50 users from same group (less noisy) was: 3.36
all_actions shape just before sample torch.Size([1, 21, 1])
action scaled by temperature: tensor([[209]], device='cuda:0')
action picked by argmax: tensor([209], device='cuda:0')
tensor([[209,  39, 268, 245,  95, 238, 154,  76, 199, 196]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
60          1      210       5        61
336         2      210       4        64
564         3      210       3        19
916         4      210       2        98
1118        5      210       5        27
       user_id  item_id  rating  timestep
12528       46      210       4       244
12569       47      210       4        12
12854       48      210       3        24
13288       49      210       4       185
13535       50      210       5       159
average_rating for this rec across 50 users from same group (less noisy) was: 3.94
all_actions shape just before sample torch.Size([1, 22, 1])
action scaled by temperature: tensor([[11]], device='cuda:0')
action picked by argmax: tensor([11], device='cuda:0')
tensor([[ 11, 252, 109, 119,  16, 271, 181,  28, 193, 133]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
28          1       12       4        29
466         2       12       3       194
765         3       12       5       220
845         4       12       5        27
1207        5       12       3       116
       user_id  item_id  rating  timestep
12471       46       12       4       187
12693       47       12       5       136
12980       48       12       4       150
13184       49       12       3        81
13608       50       12       4       232
average_rating for this rec across 50 users from same group (less noisy) was: 3.7
all_actions shape just before sample torch.Size([1, 23, 1])
action scaled by temperature: tensor([[138]], device='cuda:0')
action picked by argmax: tensor([138], device='cuda:0')
tensor([[138,  25, 222,  92, 129, 144,  82, 191, 177, 203]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
224         1      139       3       225
317         2      139       4        45
767         3      139       4       222
1084        4      139       4       266
1305        5      139       5       214
       user_id  item_id  rating  timestep
12333       46      139       3        49
12662       47      139       2       105
12900       48      139       3        70
13303       49      139       5       200
13591       50      139       4       215
average_rating for this rec across 50 users from same group (less noisy) was: 4.02
all_actions shape just before sample torch.Size([1, 24, 1])
action scaled by temperature: tensor([[129]], device='cuda:0')
action picked by argmax: tensor([129], device='cuda:0')
tensor([[129,  28, 213, 181, 118, 232,  18, 138, 260,  82]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
165         1      130       4       166
533         2      130       5       261
759         3      130       5       214
895         4      130       5        77
1182        5      130       4        91
       user_id  item_id  rating  timestep
12417       46      130       5       133
12813       47      130       5       256
13076       48      130       5       246
13229       49      130       5       126
13570       50      130       5       194
average_rating for this rec across 50 users from same group (less noisy) was: 4.46
all_actions shape just before sample torch.Size([1, 25, 1])
action scaled by temperature: tensor([[28]], device='cuda:0')
action picked by argmax: tensor([28], device='cuda:0')
tensor([[ 28, 129, 152, 171, 161, 170, 213,  64, 137,  74]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
189         1       29       4       190
450         2       29       3       178
625         3       29       2        80
908         4       29       4        90
1359        5       29       3       268
       user_id  item_id  rating  timestep
12424       46       29       3       140
12661       47       29       4       104
12989       48       29       4       159
13239       49       29       3       136
13445       50       29       3        69
average_rating for this rec across 50 users from same group (less noisy) was: 3.58
all_actions shape just before sample torch.Size([1, 26, 1])
action scaled by temperature: tensor([[206]], device='cuda:0')
action picked by argmax: tensor([206], device='cuda:0')
tensor([[206,  70, 261,  67, 260, 143, 151, 181, 191,  39]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
56          1      207       5        57
362         2      207       4        90
657         3      207       4       112
834         4      207       5        16
1156        5      207       5        65
       user_id  item_id  rating  timestep
12324       46      207       5        40
12751       47      207       3       194
12949       48      207       5       119
13307       49      207       5       204
13412       50      207       4        36
average_rating for this rec across 50 users from same group (less noisy) was: 4.24
all_actions shape just before sample torch.Size([1, 27, 1])
action scaled by temperature: tensor([[144]], device='cuda:0')
action picked by argmax: tensor([144], device='cuda:0')
tensor([[144,  45, 155,  10,  37, 107, 271,  36, 260, 103]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
36          1      145       4        37
299         2      145       4        27
724         3      145       4       179
864         4      145       4        46
1132        5      145       4        41
       user_id  item_id  rating  timestep
12452       46      145       4       168
12749       47      145       4       192
13008       48      145       5       178
13317       49      145       4       214
13442       50      145       3        66
average_rating for this rec across 50 users from same group (less noisy) was: 4.14
all_actions shape just before sample torch.Size([1, 28, 1])
action scaled by temperature: tensor([[106]], device='cuda:0')
action picked by argmax: tensor([106], device='cuda:0')
tensor([[106, 111, 168, 105, 144,  65, 175, 258,   8, 201]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
173         1      107       4       174
382         2      107       4       110
769         3      107       4       224
995         4      107       5       177
1261        5      107       4       170
       user_id  item_id  rating  timestep
12344       46      107       3        60
12657       47      107       4       100
12939       48      107       5       109
13284       49      107       3       181
13531       50      107       4       155
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 29, 1])
action scaled by temperature: tensor([[111]], device='cuda:0')
action picked by argmax: tensor([111], device='cuda:0')
tensor([[111,  29, 168, 239, 106,  40,  48,  22, 118,  80]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
271         1      112       4       272
479         2      112       5       207
553         3      112       5         8
1041        4      112       5       223
1094        5      112       5         3
       user_id  item_id  rating  timestep
12382       46      112       5        98
12566       47      112       5         9
12954       48      112       4       124
13319       49      112       4       216
13388       50      112       5        12
average_rating for this rec across 50 users from same group (less noisy) was: 4.7
all_actions shape just before sample torch.Size([1, 30, 1])
action scaled by temperature: tensor([[239]], device='cuda:0')
action picked by argmax: tensor([239], device='cuda:0')
tensor([[239, 105,  55,   3, 180, 260,   7, 198, 144,  40]], device='cuda:0')
Just recommended 30 new items to 50 users from group 1 and the total rating was 123.59999999999998
train_loss is: 0.5383243517244243
action scaled by temperature: tensor([[67]], device='cuda:0')
action picked by argmax: tensor([237], device='cuda:0')
tensor([[237,  76, 205, 268, 180, 109, 246,  30,   0, 169]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
228         1      238       4       229
475         2      238       3       203
719         3      238       3       174
860         4      238       5        42
1166        5      238       5        75
       user_id  item_id  rating  timestep
12462       46      238       3       178
12618       47      238       4        61
13000       48      238       5       170
13192       49      238       3        89
13431       50      238       5        55
average_rating for this rec across 50 users from same group (less noisy) was: 4.06
all_actions shape just before sample torch.Size([1, 1, 1])
action scaled by temperature: tensor([[18]], device='cuda:0')
action picked by argmax: tensor([109], device='cuda:0')
tensor([[109,  64, 190, 266, 151, 150,  95,   4,   5,  52]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
132         1      110       4       133
472         2      110       5       200
687         3      110       5       142
910         4      110       5        92
1217        5      110       4       126
       user_id  item_id  rating  timestep
12408       46      110       5       124
12729       47      110       5       172
12956       48      110       5       126
13369       49      110       5       266
13458       50      110       5        82
average_rating for this rec across 50 users from same group (less noisy) was: 4.66
all_actions shape just before sample torch.Size([1, 2, 1])
action scaled by temperature: tensor([[241]], device='cuda:0')
action picked by argmax: tensor([241], device='cuda:0')
tensor([[241,  94, 144, 238,  27, 141,  62, 169,  95,  39]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
210         1      242       5       211
333         2      242       5        61
602         3      242       4        57
975         4      242       2       157
1297        5      242       5       206
       user_id  item_id  rating  timestep
12442       46      242       4       158
12609       47      242       4        52
13081       48      242       5       251
13312       49      242       5       209
13628       50      242       5       252
average_rating for this rec across 50 users from same group (less noisy) was: 4.08
all_actions shape just before sample torch.Size([1, 3, 1])
action scaled by temperature: tensor([[149]], device='cuda:0')
action picked by argmax: tensor([149], device='cuda:0')
tensor([[149, 217, 218, 105,  26, 134, 148,   1, 131, 229]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
59          1      150       4        60
274         2      150       1         2
792         3      150       3       247
952         4      150       4       134
1175        5      150       3        84
       user_id  item_id  rating  timestep
12343       46      150       3        59
12750       47      150       3       193
13050       48      150       2       220
13125       49      150       2        22
13522       50      150       4       146
average_rating for this rec across 50 users from same group (less noisy) was: 3.26
all_actions shape just before sample torch.Size([1, 4, 1])
action scaled by temperature: tensor([[90]], device='cuda:0')
action picked by argmax: tensor([90], device='cuda:0')
tensor([[ 90,  79,  57,  61, 217, 143, 105,  56, 128,  67]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
26          1       91       4        27
452         2       91       4       180
580         3       91       2        35
982         4       91       3       164
1198        5       91       4       107
       user_id  item_id  rating  timestep
12411       46       91       3       127
12568       47       91       4        11
13005       48       91       5       175
13291       49       91       5       188
13603       50       91       5       227
average_rating for this rec across 50 users from same group (less noisy) was: 3.9
all_actions shape just before sample torch.Size([1, 5, 1])
action scaled by temperature: tensor([[69]], device='cuda:0')
action picked by argmax: tensor([69], device='cuda:0')
tensor([[ 69, 227,  96, 129,  64, 204,  81, 103,  22, 173]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
72          1       70       4        73
282         2       70       2        10
591         3       70       5        46
949         4       70       3       131
1329        5       70       3       238
       user_id  item_id  rating  timestep
12414       46       70       5       130
12691       47       70       4       134
12894       48       70       5        64
13323       49       70       5       220
13404       50       70       4        28
average_rating for this rec across 50 users from same group (less noisy) was: 4.08
all_actions shape just before sample torch.Size([1, 6, 1])
action scaled by temperature: tensor([[96]], device='cuda:0')
action picked by argmax: tensor([96], device='cuda:0')
tensor([[ 96,  69, 204,  82, 227,  68,  81, 192,  43, 116]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
46          1       97       5        47
363         2       97       4        91
656         3       97       5       111
1059        4       97       4       241
1138        5       97       5        47
       user_id  item_id  rating  timestep
12431       46       97       5       147
12715       47       97       5       158
12880       48       97       5        50
13198       49       97       5        95
13414       50       97       4        38
average_rating for this rec across 50 users from same group (less noisy) was: 4.5
all_actions shape just before sample torch.Size([1, 7, 1])
action scaled by temperature: tensor([[40]], device='cuda:0')
action picked by argmax: tensor([40], device='cuda:0')
tensor([[ 40, 173,  10,  99,  38, 272,  71, 184, 204,  34]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
66          1       41       4        67
353         2       41       5        81
756         3       41       3       211
1060        4       41       2       242
1343        5       41       3       252
       user_id  item_id  rating  timestep
12376       46       41       3        92
12615       47       41       3        58
12882       48       41       3        52
13156       49       41       5        53
13485       50       41       4       109
average_rating for this rec across 50 users from same group (less noisy) was: 3.66
all_actions shape just before sample torch.Size([1, 8, 1])
action scaled by temperature: tensor([[58]], device='cuda:0')
action picked by argmax: tensor([58], device='cuda:0')
tensor([[ 58, 235, 239, 182,  82,  10, 268, 164,  48,  71]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
40          1       59       4        41
309         2       59       4        37
622         3       59       4        77
1063        4       59       3       245
1144        5       59       4        53
       user_id  item_id  rating  timestep
12484       46       59       4       200
12757       47       59       4       200
12968       48       59       4       138
13243       49       59       4       140
13594       50       59       4       218
average_rating for this rec across 50 users from same group (less noisy) was: 4.16
all_actions shape just before sample torch.Size([1, 9, 1])
action scaled by temperature: tensor([[235]], device='cuda:0')
action picked by argmax: tensor([235], device='cuda:0')
tensor([[235, 268, 204,  58, 156, 123, 164, 242,  82,  10]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
57          1      236       5        58
392         2      236       4       120
770         3      236       4       225
825         4      236       5         7
1151        5      236       4        60
       user_id  item_id  rating  timestep
12321       46      236       3        37
12669       47      236       5       112
12940       48      236       3       110
13113       49      236       4        10
13638       50      236       3       262
average_rating for this rec across 50 users from same group (less noisy) was: 4.26
all_actions shape just before sample torch.Size([1, 10, 1])
action scaled by temperature: tensor([[268]], device='cuda:0')
action picked by argmax: tensor([268], device='cuda:0')
tensor([[268, 120, 204,  77,  81, 235, 225,  99, 220,  35]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
146         1      269       5       147
338         2      269       4        66
695         3      269       5       150
1049        4      269       5       231
1295        5      269       4       204
       user_id  item_id  rating  timestep
12474       46      269       4       190
12685       47      269       5       128
13091       48      269       4       261
13338       49      269       4       235
13558       50      269       5       182
average_rating for this rec across 50 users from same group (less noisy) was: 4.12
all_actions shape just before sample torch.Size([1, 11, 1])
action scaled by temperature: tensor([[120]], device='cuda:0')
action picked by argmax: tensor([120], device='cuda:0')
tensor([[120, 112, 220,  81, 225, 268,  35, 188, 109,   8]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
140         1      121       4       141
340         2      121       4        68
548         3      121       4         3
1028        4      121       4       210
1324        5      121       4       233
       user_id  item_id  rating  timestep
12449       46      121       3       165
12767       47      121       4       210
13025       48      121       4       195
13269       49      121       4       166
13383       50      121       4         7
average_rating for this rec across 50 users from same group (less noisy) was: 4.02
all_actions shape just before sample torch.Size([1, 12, 1])
action scaled by temperature: tensor([[220]], device='cuda:0')
action picked by argmax: tensor([220], device='cuda:0')
tensor([[220,  67,   7, 109, 250,  35, 128,  71,  20, 236]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
225         1      221       4       226
380         2      221       4       108
549         3      221       4         4
854         4      221       4        36
1188        5      221       5        97
       user_id  item_id  rating  timestep
12421       46      221       3       137
12641       47      221       4        84
13072       48      221       4       242
13351       49      221       5       248
13455       50      221       4        79
average_rating for this rec across 50 users from same group (less noisy) was: 4.16
all_actions shape just before sample torch.Size([1, 13, 1])
action scaled by temperature: tensor([[67]], device='cuda:0')
action picked by argmax: tensor([67], device='cuda:0')
tensor([[ 67, 162, 184, 110, 133,  94, 265,   1,  34, 211]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
191         1       68       3       192
351         2       68       2        79
623         3       68       4        78
866         4       68       5        48
1237        5       68       3       146
       user_id  item_id  rating  timestep
12499       46       68       3       215
12639       47       68       5        82
13060       48       68       4       230
13114       49       68       3        11
13452       50       68       5        76
average_rating for this rec across 50 users from same group (less noisy) was: 3.82
all_actions shape just before sample torch.Size([1, 14, 1])
action scaled by temperature: tensor([[133]], device='cuda:0')
action picked by argmax: tensor([133], device='cuda:0')
tensor([[133, 162, 265, 198,  47,  67, 245,  63, 229, 155]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
247         1      134       3       248
412         2      134       4       140
728         3      134       3       183
1048        4      134       4       230
1308        5      134       4       217
       user_id  item_id  rating  timestep
12383       46      134       4        99
12702       47      134       5       145
12872       48      134       4        42
13298       49      134       5       195
13645       50      134       5       269
average_rating for this rec across 50 users from same group (less noisy) was: 4.32
all_actions shape just before sample torch.Size([1, 15, 1])
action scaled by temperature: tensor([[198]], device='cuda:0')
action picked by argmax: tensor([198], device='cuda:0')
tensor([[198,  79, 183,  94, 251, 254,  28, 124, 102, 133]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
154         1      199       4       155
273         2      199       4         1
713         3      199       4       168
843         4      199       3        25
1279        5      199       4       188
       user_id  item_id  rating  timestep
12476       46      199       4       192
12664       47      199       4       107
13090       48      199       5       260
13349       49      199       5       246
13402       50      199       4        26
average_rating for this rec across 50 users from same group (less noisy) was: 4.1
all_actions shape just before sample torch.Size([1, 16, 1])
action scaled by temperature: tensor([[34]], device='cuda:0')
action picked by argmax: tensor([34], device='cuda:0')
tensor([[ 34, 189, 236, 265, 133, 102,  17, 261, 228, 129]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
171         1       35       3       172
523         2       35       4       251
764         3       35       5       219
839         4       35       3        21
1224        5       35       4       133
       user_id  item_id  rating  timestep
12498       46       35       3       214
12701       47       35       4       144
13023       48       35       2       193
13159       49       35       4        56
13622       50       35       4       246
average_rating for this rec across 50 users from same group (less noisy) was: 4.04
all_actions shape just before sample torch.Size([1, 17, 1])
action scaled by temperature: tensor([[254]], device='cuda:0')
action picked by argmax: tensor([254], device='cuda:0')
tensor([[254,  81,  95,  16,  56,  93,  14, 165,  94,  59]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
153         1      255       5       154
544         2      255       5       272
618         3      255       4        73
989         4      255       5       171
1214        5      255       4       123
       user_id  item_id  rating  timestep
12365       46      255       5        81
12724       47      255       4       167
12933       48      255       4       103
13227       49      255       3       124
13601       50      255       3       225
average_rating for this rec across 50 users from same group (less noisy) was: 4.5
all_actions shape just before sample torch.Size([1, 18, 1])
action scaled by temperature: tensor([[155]], device='cuda:0')
action picked by argmax: tensor([155], device='cuda:0')
tensor([[155,   9,  41, 215,  30,  87, 157, 262, 243, 219]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
88          1      156       5        89
478         2      156       3       206
606         3      156       2        61
898         4      156       3        80
1283        5      156       3       192
       user_id  item_id  rating  timestep
12518       46      156       3       234
12830       47      156       5       273
12853       48      156       4        23
13361       49      156       3       258
13438       50      156       4        62
average_rating for this rec across 50 users from same group (less noisy) was: 3.52
all_actions shape just before sample torch.Size([1, 19, 1])
action scaled by temperature: tensor([[219]], device='cuda:0')
action picked by argmax: tensor([219], device='cuda:0')
tensor([[219,  84, 243,  34, 257, 174, 151, 215,  87, 265]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
220         1      220       4       221
495         2      220       5       223
814         3      220       5       269
859         4      220       4        41
1178        5      220       5        87
       user_id  item_id  rating  timestep
12313       46      220       5        29
12606       47      220       4        49
13022       48      220       4       192
13347       49      220       4       244
13521       50      220       5       145
average_rating for this rec across 50 users from same group (less noisy) was: 4.4
all_actions shape just before sample torch.Size([1, 20, 1])
action scaled by temperature: tensor([[84]], device='cuda:0')
action picked by argmax: tensor([84], device='cuda:0')
tensor([[ 84,  25, 223, 236, 132, 154, 267,  86,  60, 158]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
238         1       85       4       239
289         2       85       5        17
802         3       85       4       257
1069        4       85       5       251
1306        5       85       5       215
       user_id  item_id  rating  timestep
12403       46       85       3       119
12623       47       85       5        66
13082       48       85       4       252
13218       49       85       5       115
13630       50       85       4       254
average_rating for this rec across 50 users from same group (less noisy) was: 3.82
all_actions shape just before sample torch.Size([1, 21, 1])
action scaled by temperature: tensor([[25]], device='cuda:0')
action picked by argmax: tensor([25], device='cuda:0')
tensor([[ 25,  23,  84, 143,  99,  52, 196, 228,  35, 267]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
134         1       26       4       135
413         2       26       3       141
576         3       26       5        31
1087        4       26       5       269
1287        5       26       3       196
       user_id  item_id  rating  timestep
12487       46       26       5       203
12611       47       26       5        54
12983       48       26       5       153
13149       49       26       5        46
13625       50       26       4       249
average_rating for this rec across 50 users from same group (less noisy) was: 4.36
all_actions shape just before sample torch.Size([1, 22, 1])
action scaled by temperature: tensor([[55]], device='cuda:0')
action picked by argmax: tensor([55], device='cuda:0')
tensor([[ 55,  34, 249, 189, 174,  35, 265,  99, 129, 194]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
17          1       56       4        18
500         2       56       4       228
617         3       56       3        72
1080        4       56       4       262
1108        5       56       5        17
       user_id  item_id  rating  timestep
12459       46       56       5       175
12782       47       56       4       225
13071       48       56       4       241
13174       49       56       3        71
13516       50       56       5       140
average_rating for this rec across 50 users from same group (less noisy) was: 4.14
all_actions shape just before sample torch.Size([1, 23, 1])
action scaled by temperature: tensor([[158]], device='cuda:0')
action picked by argmax: tensor([158], device='cuda:0')
tensor([[158,  78, 222, 268, 212, 256,  41,  44,  92, 174]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
129         1      159       3       130
480         2      159       3       208
579         3      159       3        34
1057        4      159       3       239
1270        5      159       2       179
       user_id  item_id  rating  timestep
12525       46      159       5       241
12736       47      159       4       179
12973       48      159       5       143
13326       49      159       4       223
13490       50      159       4       114
average_rating for this rec across 50 users from same group (less noisy) was: 3.6
all_actions shape just before sample torch.Size([1, 24, 1])
action scaled by temperature: tensor([[78]], device='cuda:0')
action picked by argmax: tensor([78], device='cuda:0')
tensor([[ 78, 140, 187, 222, 145,  89, 212,  20, 103,  56]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
3           1       79       4         4
349         2       79       1        77
783         3       79       1       238
841         4       79       3        23
1235        5       79       4       144
       user_id  item_id  rating  timestep
12547       46       79       3       263
12589       47       79       1        32
12914       48       79       3        84
13356       49       79       2       253
13496       50       79       2       120
average_rating for this rec across 50 users from same group (less noisy) was: 2.62
all_actions shape just before sample torch.Size([1, 25, 1])
action scaled by temperature: tensor([[166]], device='cuda:0')
action picked by argmax: tensor([166], device='cuda:0')
tensor([[166,  84, 181, 248,  87, 212,   9, 103, 188, 221]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
141         1      167       4       142
539         2      167       5       267
791         3      167       4       246
1054        4      167       4       236
1153        5      167       3        62
       user_id  item_id  rating  timestep
12348       46      167       4        64
12628       47      167       4        71
12941       48      167       5       111
13112       49      167       4         9
13578       50      167       2       202
average_rating for this rec across 50 users from same group (less noisy) was: 4.2
all_actions shape just before sample torch.Size([1, 26, 1])
action scaled by temperature: tensor([[9]], device='cuda:0')
action picked by argmax: tensor([9], device='cuda:0')
tensor([[  9,   8,  84, 181, 225, 166, 157, 258, 130, 115]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
256         1       10       5       257
308         2       10       5        36
626         3       10       4        81
1055        4       10       4       237
1193        5       10       5       102
       user_id  item_id  rating  timestep
12521       46       10       5       237
12698       47       10       5       141
12982       48       10       4       152
13245       49       10       5       142
13461       50       10       4        85
average_rating for this rec across 50 users from same group (less noisy) was: 4.56
all_actions shape just before sample torch.Size([1, 27, 1])
action scaled by temperature: tensor([[248]], device='cuda:0')
action picked by argmax: tensor([248], device='cuda:0')
tensor([[248, 258, 166, 233,  68, 164,  84, 239,  15, 240]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
113         1      249       5       114
445         2      249       5       173
590         3      249       4        45
1075        4      249       4       257
1115        5      249       5        24
       user_id  item_id  rating  timestep
12502       46      249       5       218
12627       47      249       5        70
13065       48      249       4       235
13191       49      249       5        88
13541       50      249       5       165
average_rating for this rec across 50 users from same group (less noisy) was: 4.7
all_actions shape just before sample torch.Size([1, 28, 1])
action scaled by temperature: tensor([[68]], device='cuda:0')
action picked by argmax: tensor([68], device='cuda:0')
tensor([[ 68,  84, 231, 191,   8, 205, 143, 132, 108,  24]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
90          1       69       3        91
513         2       69       4       241
665         3       69       4       120
988         4       69       5       170
1117        5       69       4        26
       user_id  item_id  rating  timestep
12451       46       69       4       167
12690       47       69       5       133
12874       48       69       4        44
13224       49       69       4       121
13590       50       69       4       214
average_rating for this rec across 50 users from same group (less noisy) was: 3.92
all_actions shape just before sample torch.Size([1, 29, 1])
action scaled by temperature: tensor([[233]], device='cuda:0')
action picked by argmax: tensor([233], device='cuda:0')
tensor([[233, 132, 259, 239, 187, 191,   4, 234, 190,  74]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
39          1      234       4        40
543         2      234       4       271
707         3      234       4       162
1083        4      234       2       265
1364        5      234       4       273
       user_id  item_id  rating  timestep
12363       46      234       3        79
12812       47      234       5       255
12943       48      234       3       113
13126       49      234       5        23
13420       50      234       4        44
average_rating for this rec across 50 users from same group (less noisy) was: 4.0
all_actions shape just before sample torch.Size([1, 30, 1])
action scaled by temperature: tensor([[108]], device='cuda:0')
action picked by argmax: tensor([108], device='cuda:0')
tensor([[108, 113, 194,  92, 231, 200,  15,  27,  60, 245]], device='cuda:0')
Just recommended 30 new items to 50 users from group 1 and the total rating was 121.53999999999999
train_loss is: 0.5073483480166082
action scaled by temperature: tensor([[143]], device='cuda:0')
action picked by argmax: tensor([76], device='cuda:0')
tensor([[ 76, 107,  30, 237,  37, 246, 205, 268,  28,  39]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
243         1       77       5       244
432         2       77       5       160
743         3       77       5       198
835         4       77       4        17
1233        5       77       4       142
       user_id  item_id  rating  timestep
12393       46       77       3       109
12719       47       77       4       162
13098       48       77       5       268
13143       49       77       4        40
13500       50       77       3       124
average_rating for this rec across 50 users from same group (less noisy) was: 3.96
all_actions shape just before sample torch.Size([1, 1, 1])
action scaled by temperature: tensor([[72]], device='cuda:0')
action picked by argmax: tensor([246], device='cuda:0')
tensor([[246, 117,  68, 145, 148, 132, 113, 230, 158,  21]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
185         1      247       4       186
384         2      247       4       112
620         3      247       5        75
986         4      247       5       168
1337        5      247       4       246
       user_id  item_id  rating  timestep
12355       46      247       4        71
12740       47      247       4       183
12928       48      247       5        98
13339       49      247       3       236
13639       50      247       4       263
average_rating for this rec across 50 users from same group (less noisy) was: 4.12
all_actions shape just before sample torch.Size([1, 2, 1])
action scaled by temperature: tensor([[180]], device='cuda:0')
action picked by argmax: tensor([39], device='cuda:0')
tensor([[ 39, 180, 237, 272,  38, 251,  63, 164, 230, 106]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
101         1       40       5       102
275         2       40       5         3
550         3       40       4         5
1065        4       40       5       247
1189        5       40       5        98
       user_id  item_id  rating  timestep
12542       46       40       5       258
12805       47       40       5       248
12866       48       40       5        36
13122       49       40       5        19
13587       50       40       4       211
average_rating for this rec across 50 users from same group (less noisy) was: 4.68
all_actions shape just before sample torch.Size([1, 3, 1])
action scaled by temperature: tensor([[224]], device='cuda:0')
action picked by argmax: tensor([224], device='cuda:0')
tensor([[224, 227,   0,  37,   8, 233,  36,  61, 115,  64]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
69          1      225       5        70
355         2      225       4        83
723         3      225       4       178
827         4      225       5         9
1291        5      225       4       200
       user_id  item_id  rating  timestep
12318       46      225       5        34
12629       47      225       4        72
13075       48      225       5       245
13306       49      225       4       203
13477       50      225       4       101
average_rating for this rec across 50 users from same group (less noisy) was: 4.52
all_actions shape just before sample torch.Size([1, 4, 1])
action scaled by temperature: tensor([[227]], device='cuda:0')
action picked by argmax: tensor([227], device='cuda:0')
tensor([[227, 196, 151, 270,  48,   0, 203,  52, 224,   8]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
205         1      228       4       206
490         2      228       3       218
663         3      228       3       118
1070        4      228       2       252
1271        5      228       3       180
       user_id  item_id  rating  timestep
12329       46      228       4        45
12703       47      228       3       146
12879       48      228       5        49
13111       49      228       2         8
13530       50      228       4       154
average_rating for this rec across 50 users from same group (less noisy) was: 3.34
all_actions shape just before sample torch.Size([1, 5, 1])
action scaled by temperature: tensor([[105]], device='cuda:0')
action picked by argmax: tensor([105], device='cuda:0')
tensor([[105, 111, 258, 203, 196,  70, 167, 249, 187,  89]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
151         1      106       4       152
453         2      106       4       181
605         3      106       5        60
1071        4      106       2       253
1228        5      106       3       137
       user_id  item_id  rating  timestep
12389       46      106       4       105
12808       47      106       4       251
12996       48      106       4       166
13279       49      106       4       176
13559       50      106       5       183
average_rating for this rec across 50 users from same group (less noisy) was: 4.14
all_actions shape just before sample torch.Size([1, 6, 1])
action scaled by temperature: tensor([[111]], device='cuda:0')
action picked by argmax: tensor([111], device='cuda:0')
tensor([[111, 105, 233, 203,  80,  99, 176,   8,  12, 207]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
271         1      112       4       272
479         2      112       5       207
553         3      112       5         8
1041        4      112       5       223
1094        5      112       5         3
       user_id  item_id  rating  timestep
12382       46      112       5        98
12566       47      112       5         9
12954       48      112       4       124
13319       49      112       4       216
13388       50      112       5        12
average_rating for this rec across 50 users from same group (less noisy) was: 4.7
all_actions shape just before sample torch.Size([1, 7, 1])
action scaled by temperature: tensor([[176]], device='cuda:0')
action picked by argmax: tensor([176], device='cuda:0')
tensor([[176, 241, 106,  26, 158, 237,  89, 235,   3, 168]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
254         1      177       4       255
307         2      177       5        35
690         3      177       4       145
1030        4      177       4       212
1102        5      177       3        11
       user_id  item_id  rating  timestep
12549       46      177       5       265
12714       47      177       5       157
13097       48      177       5       267
13118       49      177       4        15
13401       50      177       4        25
average_rating for this rec across 50 users from same group (less noisy) was: 4.16
all_actions shape just before sample torch.Size([1, 8, 1])
action scaled by temperature: tensor([[210]], device='cuda:0')
action picked by argmax: tensor([210], device='cuda:0')
tensor([[210, 197, 156, 152,  46,  89, 145,  61, 168, 246]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
121         1      211       5       122
531         2      211       5       259
686         3      211       4       141
857         4      211       4        39
1247        5      211       3       156
       user_id  item_id  rating  timestep
12331       46      211       5        47
12772       47      211       4       215
13056       48      211       4       226
13177       49      211       4        74
13538       50      211       4       162
average_rating for this rec across 50 users from same group (less noisy) was: 4.22
all_actions shape just before sample torch.Size([1, 9, 1])
action scaled by temperature: tensor([[152]], device='cuda:0')
action picked by argmax: tensor([152], device='cuda:0')
tensor([[152, 210, 200, 237, 227,  61, 187, 169, 220,  14]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
27          1      153       4        28
428         2      153       1       156
586         3      153       3        41
884         4      153       5        66
1288        5      153       5       197
       user_id  item_id  rating  timestep
12423       46      153       3       139
12632       47      153       4        75
12955       48      153       3       125
13197       49      153       4        94
13405       50      153       4        29
average_rating for this rec across 50 users from same group (less noisy) was: 3.58
all_actions shape just before sample torch.Size([1, 10, 1])
action scaled by temperature: tensor([[247]], device='cuda:0')
action picked by argmax: tensor([247], device='cuda:0')
tensor([[247, 189, 115, 210,  21, 100,  31, 124, 265, 163]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
182         1      248       4       183
295         2      248       5        23
739         3      248       5       194
853         4      248       4        35
1345        5      248       4       254
       user_id  item_id  rating  timestep
12548       46      248       5       264
12573       47      248       5        16
12837       48      248       4         7
13252       49      248       4       149
13495       50      248       5       119
average_rating for this rec across 50 users from same group (less noisy) was: 4.46
all_actions shape just before sample torch.Size([1, 11, 1])
action scaled by temperature: tensor([[21]], device='cuda:0')
action picked by argmax: tensor([21], device='cuda:0')
tensor([[ 21, 115, 226, 105,  85,  38, 186, 216,  95, 210]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
87          1       22       4        88
425         2       22       4       153
554         3       22       4         9
997         4       22       4       179
1263        5       22       5       172
       user_id  item_id  rating  timestep
12335       46       22       4        51
12810       47       22       5       253
12839       48       22       5         9
13116       49       22       4        13
13577       50       22       4       201
average_rating for this rec across 50 users from same group (less noisy) was: 4.24
all_actions shape just before sample torch.Size([1, 12, 1])
action scaled by temperature: tensor([[115]], device='cuda:0')
action picked by argmax: tensor([115], device='cuda:0')
tensor([[115,  38,  21, 107,  65, 249,  95,  40,  78, 245]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
67          1      116       4        68
361         2      116       5        89
638         3      116       5        93
996         4      116       5       178
1352        5      116       4       261
       user_id  item_id  rating  timestep
12312       46      116       3        28
12563       47      116       4         6
12970       48      116       4       140
13358       49      116       5       255
13484       50      116       5       108
average_rating for this rec across 50 users from same group (less noisy) was: 4.28
all_actions shape just before sample torch.Size([1, 13, 1])
action scaled by temperature: tensor([[222]], device='cuda:0')
action picked by argmax: tensor([222], device='cuda:0')
tensor([[222,  96,  55, 112,  92, 223, 165, 145,  84,  95]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
198         1      223       3       199
386         2      223       4       114
640         3      223       5        95
936         4      223       5       118
1310        5      223       4       219
       user_id  item_id  rating  timestep
12409       46      223       5       125
12619       47      223       5        62
12967       48      223       4       137
13372       49      223       5       269
13567       50      223       4       191
average_rating for this rec across 50 users from same group (less noisy) was: 4.54
all_actions shape just before sample torch.Size([1, 14, 1])
action scaled by temperature: tensor([[165]], device='cuda:0')
action picked by argmax: tensor([165], device='cuda:0')
tensor([[165, 153,  29,  84, 117,  20, 264, 222, 145,  93]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
92          1      166       5        93
327         2      166       4        55
664         3      166       5       119
1004        4      166       4       186
1172        5      166       4        81
       user_id  item_id  rating  timestep
12428       46      166       5       144
12711       47      166       5       154
12888       48      166       5        58
13340       49      166       3       237
13508       50      166       4       132
average_rating for this rec across 50 users from same group (less noisy) was: 4.34
all_actions shape just before sample torch.Size([1, 15, 1])
action scaled by temperature: tensor([[153]], device='cuda:0')
action picked by argmax: tensor([153], device='cuda:0')
tensor([[153, 165, 134, 198,  57,   6, 236, 146, 184,  93]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
186         1      154       5       187
433         2      154       5       161
566         3      154       4        21
875         4      154       5        57
1157        5      154       4        66
       user_id  item_id  rating  timestep
12351       46      154       5        67
12734       47      154       4       177
13011       48      154       4       181
13253       49      154       5       150
13572       50      154       3       196
average_rating for this rec across 50 users from same group (less noisy) was: 4.32
all_actions shape just before sample torch.Size([1, 16, 1])
action scaled by temperature: tensor([[146]], device='cuda:0')
action picked by argmax: tensor([146], device='cuda:0')
tensor([[146, 153, 271, 163,  97, 158, 184, 117,   0,  93]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
97          1      147       4        98
492         2      147       4       220
612         3      147       4        67
897         4      147       3        79
1350        5      147       5       259
       user_id  item_id  rating  timestep
12336       46      147       5        52
12647       47      147       4        90
12962       48      147       4       132
13367       49      147       4       264
13443       50      147       5        67
average_rating for this rec across 50 users from same group (less noisy) was: 4.24
all_actions shape just before sample torch.Size([1, 17, 1])
action scaled by temperature: tensor([[68]], device='cuda:0')
action picked by argmax: tensor([68], device='cuda:0')
tensor([[ 68,  38, 271, 242, 205, 266, 164, 165, 188,  82]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
90          1       69       3        91
513         2       69       4       241
665         3       69       4       120
988         4       69       5       170
1117        5       69       4        26
       user_id  item_id  rating  timestep
12451       46       69       4       167
12690       47       69       5       133
12874       48       69       4        44
13224       49       69       4       121
13590       50       69       4       214
average_rating for this rec across 50 users from same group (less noisy) was: 3.92
all_actions shape just before sample torch.Size([1, 18, 1])
action scaled by temperature: tensor([[38]], device='cuda:0')
action picked by argmax: tensor([38], device='cuda:0')
tensor([[ 38, 237, 126, 146,  21, 205, 107,  76,  68, 258]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
264         1       39       3       265
276         2       39       3         4
670         3       39       2       125
899         4       39       3        81
1171        5       39       4        80
       user_id  item_id  rating  timestep
12532       46       39       3       248
12562       47       39       3         5
13086       48       39       2       256
13210       49       39       3       107
13467       50       39       3        91
average_rating for this rec across 50 users from same group (less noisy) was: 3.04
all_actions shape just before sample torch.Size([1, 19, 1])
action scaled by temperature: tensor([[0]], device='cuda:0')
action picked by argmax: tensor([0], device='cuda:0')
tensor([[  0, 253,  39, 177,  98,  76,  16,  22, 156,  31]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
62          1        1       4        63
522         2        1       5       250
671         3        1       4       126
892         4        1       4        74
1204        5        1       5       113
       user_id  item_id  rating  timestep
12375       46        1       5        91
12816       47        1       5       259
13045       48        1       4       215
13375       49        1       5       272
13542       50        1       5       166
average_rating for this rec across 50 users from same group (less noisy) was: 4.66
all_actions shape just before sample torch.Size([1, 20, 1])
action scaled by temperature: tensor([[253]], device='cuda:0')
action picked by argmax: tensor([253], device='cuda:0')
tensor([[253,  22, 134,  73, 223,   0,  21,  98, 133, 249]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
102         1      254       3       103
293         2      254       4        21
648         3      254       3       103
987         4      254       4       169
1301        5      254       5       210
       user_id  item_id  rating  timestep
12416       46      254       4       132
12624       47      254       4        67
12971       48      254       4       141
13226       49      254       4       123
13624       50      254       5       248
average_rating for this rec across 50 users from same group (less noisy) was: 4.12
all_actions shape just before sample torch.Size([1, 21, 1])
action scaled by temperature: tensor([[216]], device='cuda:0')
action picked by argmax: tensor([216], device='cuda:0')
tensor([[216,  51, 224,  41,  94, 262, 106, 264, 214,  16]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
148         1      217       4       149
288         2      217       5        16
639         3      217       4        94
1073        4      217       3       255
1245        5      217       3       154
       user_id  item_id  rating  timestep
12456       46      217       4       172
12582       47      217       3        25
12937       48      217       4       107
13147       49      217       4        44
13432       50      217       4        56
average_rating for this rec across 50 users from same group (less noisy) was: 3.94
all_actions shape just before sample torch.Size([1, 22, 1])
action scaled by temperature: tensor([[244]], device='cuda:0')
action picked by argmax: tensor([244], device='cuda:0')
tensor([[244, 265,  60,  65, 157, 174, 194, 258,   3, 261]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
244         1      245       3       245
422         2      245       5       150
710         3      245       4       165
980         4      245       2       162
1313        5      245       4       222
       user_id  item_id  rating  timestep
12529       46      245       2       245
12723       47      245       3       166
12986       48      245       3       156
13133       49      245       4        30
13507       50      245       2       131
average_rating for this rec across 50 users from same group (less noisy) was: 3.48
all_actions shape just before sample torch.Size([1, 23, 1])
action scaled by temperature: tensor([[60]], device='cuda:0')
action picked by argmax: tensor([60], device='cuda:0')
tensor([[ 60,  65,  43, 147, 265, 234, 255,   0,  78, 137]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
107         1       61       5       108
402         2       61       5       130
784         3       61       5       239
904         4       61       5        86
1135        5       61       4        44
       user_id  item_id  rating  timestep
12522       46       61       5       238
12713       47       61       4       156
12883       48       61       3        53
13153       49       61       5        50
13536       50       61       5       160
average_rating for this rec across 50 users from same group (less noisy) was: 4.38
all_actions shape just before sample torch.Size([1, 24, 1])
action scaled by temperature: tensor([[233]], device='cuda:0')
action picked by argmax: tensor([233], device='cuda:0')
tensor([[233, 252, 137, 196,  78, 174, 203,  11, 249,  98]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
39          1      234       4        40
543         2      234       4       271
707         3      234       4       162
1083        4      234       2       265
1364        5      234       4       273
       user_id  item_id  rating  timestep
12363       46      234       3        79
12812       47      234       5       255
12943       48      234       3       113
13126       49      234       5        23
13420       50      234       4        44
average_rating for this rec across 50 users from same group (less noisy) was: 4.0
all_actions shape just before sample torch.Size([1, 25, 1])
action scaled by temperature: tensor([[238]], device='cuda:0')
action picked by argmax: tensor([238], device='cuda:0')
tensor([[238, 112, 239, 100,  61, 209,  92,  27, 271,  72]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
91          1      239       5        92
481         2      239       4       209
596         3      239       5        51
962         4      239       5       144
1362        5      239       5       271
       user_id  item_id  rating  timestep
12486       46      239       5       202
12613       47      239       4        56
13047       48      239       4       217
13194       49      239       4        91
13525       50      239       5       149
average_rating for this rec across 50 users from same group (less noisy) was: 4.58
all_actions shape just before sample torch.Size([1, 26, 1])
action scaled by temperature: tensor([[61]], device='cuda:0')
action picked by argmax: tensor([61], device='cuda:0')
tensor([[ 61,   4, 107, 145,  13,  47,  60,  92, 177,  76]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
30          1       62       5        31
312         2       62       4        40
601         3       62       5        56
972         4       62       5       154
1216        5       62       4       125
       user_id  item_id  rating  timestep
12507       46       62       5       223
12631       47       62       5        74
12897       48       62       5        67
13296       49       62       4       193
13527       50       62       5       151
average_rating for this rec across 50 users from same group (less noisy) was: 4.76
all_actions shape just before sample torch.Size([1, 27, 1])
action scaled by temperature: tensor([[92]], device='cuda:0')
action picked by argmax: tensor([92], device='cuda:0')
tensor([[ 92,   4, 222, 118,  52, 171, 211, 184, 145, 107]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
240         1       93       5       241
512         2       93       5       240
614         3       93       4        69
881         4       93       5        63
1326        5       93       5       235
       user_id  item_id  rating  timestep
12349       46       93       5        65
12787       47       93       5       230
12886       48       93       5        56
13259       49       93       5       156
13386       50       93       4        10
average_rating for this rec across 50 users from same group (less noisy) was: 4.58
all_actions shape just before sample torch.Size([1, 28, 1])
action scaled by temperature: tensor([[205]], device='cuda:0')
action picked by argmax: tensor([205], device='cuda:0')
tensor([[205,  55,  22,  72, 117,  83, 153,  61, 145, 118]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
199         1      206       3       200
408         2      206       4       136
800         3      206       4       255
935         4      206       3       117
1159        5      206       4        68
       user_id  item_id  rating  timestep
12540       46      206       3       256
12585       47      206       4        28
12935       48      206       3       105
13364       49      206       5       261
13505       50      206       3       129
average_rating for this rec across 50 users from same group (less noisy) was: 4.16
all_actions shape just before sample torch.Size([1, 29, 1])
action scaled by temperature: tensor([[55]], device='cuda:0')
action picked by argmax: tensor([55], device='cuda:0')
tensor([[ 55, 253, 134, 145, 203,  57, 119,  72,  63, 114]], device='cuda:0')
eval_data_filtered_by_item df looks like:
      user_id  item_id  rating  timestep
17          1       56       4        18
500         2       56       4       228
617         3       56       3        72
1080        4       56       4       262
1108        5       56       5        17
       user_id  item_id  rating  timestep
12459       46       56       5       175
12782       47       56       4       225
13071       48       56       4       241
13174       49       56       3        71
13516       50       56       5       140
average_rating for this rec across 50 users from same group (less noisy) was: 4.14
all_actions shape just before sample torch.Size([1, 30, 1])
action scaled by temperature: tensor([[22]], device='cuda:0')
action picked by argmax: tensor([22], device='cuda:0')
tensor([[ 22, 140, 222, 205, 239, 163, 159,  72, 200, 213]], device='cuda:0')
Just recommended 30 new items to 50 users from group 1 and the total rating was 125.6
train_losses: [5.612226200974695, 5.59168387330286, 5.548368201408212, 5.4558416719306, 5.347176379809096, 5.272738347859143, 5.202136873654579, 5.113597835035629, 4.9234972043668845, 4.438720459263075, 3.6412902553331907, 2.908746226193154, 2.370224792663365, 1.9018510394989083, 1.4825113587183496, 1.1576772299531388, 0.951196176820694, 0.874626581799494, 0.8449372646471137, 0.8391315379099215, 0.925891102993325, 1.038963648554397, 1.1113772661718604, 1.0983493858820772, 1.0098734669489404, 0.8819875292582054, 0.7435204574506576, 0.6232675256794447, 0.5383243517244243, 0.5073483480166082]
rewards_per_epoch: [109.92000000000006, 124.86000000000004, 124.01999999999998, 109.77999999999999, 123.45999999999995, 119.82000000000001, 127.04000000000005, 120.41999999999997, 131.01999999999998, 129.11999999999998, 126.58000000000003, 116.50000000000003, 129.52, 125.92000000000002, 124.48, 122.24000000000001, 122.24000000000001, 122.24000000000001, 117.17999999999998, 121.28, 117.74000000000004, 125.48, 122.22, 121.98, 122.36000000000001, 126.64000000000003, 123.13999999999999, 123.59999999999998, 121.53999999999999, 125.6]
30 64 6 8 128 data/goodreads_eval_20pc_constant_state.tsv 14080 0.0048 True 256 30
